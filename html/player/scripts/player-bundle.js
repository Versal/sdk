/*!
 * player v1.6.4
 * a masterpiece! from 092120c on 19. August 2014
 */
window._||!function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.6.0";var T=x.each=x.forEach=function(e,t,r){if(null==e)return e;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o=x.keys(e),i=0,s=o.length;s>i;i++)if(t.call(r,e[o[i]],o[i],e)===n)return;return e};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,x.property(t))},x.where=function(e,t){return x.filter(e,x.matches(t))},x.findWhere=function(e,t){return x.find(e,x.matches(t))},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var r=-1/0,i=-1/0;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;u>i&&(r=e,i=u)}),r},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var r=1/0,i=1/0;return T(e,function(e,s,o){var u=t?t.call(n,e,s,o):e;i>u&&(r=e,i=u)}),r},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=x.values(e)),e[x.random(e.length-1)]):x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return null==e?x.identity:x.isFunction(e)?e:x.property(e)};x.sortBy=function(e,t,n){return t=k(t),x.pluck(x.map(e,function(e,r,i){return{value:e,index:r,criteria:t.call(n,e,r,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={};return n=k(n),T(t,function(s,o){var u=n.call(r,s,o,t);e(i,u,s)}),i}};x.groupBy=L(function(e,t,n){x.has(e,t)?e[t].push(n):e[t]=[n]}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.partition=function(e,t,n){t=k(t);var r=[],i=[];return T(e,function(e){(t.call(n,e)?r:i).push(e)}),[r,i]},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.contains(t,e)})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);r>i;)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){for(var n=0,r=t.slice(),i=0,s=r.length;s>i;i++)r[i]===x&&(r[i]=arguments[n++]);for(;n<arguments.length;)r.push(arguments[n++]);return e.apply(this,r)}},x.bindAll=function(e){var t=u.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:x.now(),o=null,s=e.apply(r,i),r=i=null};return function(){var f=x.now();u||n.leading!==!1||(u=f);var l=t-(f-u);return r=this,i=arguments,0>=l?(clearTimeout(o),o=null,u=f,s=e.apply(r,i),r=i=null):o||n.trailing===!1||(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u,a=function(){var f=x.now()-o;t>f?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i),s=i=null))};return function(){s=this,i=arguments,o=x.now();var f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i),s=i=null),u}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return x.partial(t,e)},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=function(e){if(!x.isObject(e))return[];if(E)return E(e);var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){for(var t=x.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=e[t[i]];return r},x.pairs=function(e){for(var t=x.keys(e),n=t.length,r=new Array(n),i=0;n>i;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){for(var t={},n=x.keys(e),r=0,i=n.length;i>r;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1;n.push(e),r.push(t);var a=0,l=!0;if("[object Array]"==i){if(a=e.length,l=a==t.length)for(;a--&&(l=M(e[a],t[a],n,r)););}else{for(var c in e)if(x.has(e,c)&&(a++,!(l=x.has(t,c)&&M(e[c],t[c],n,r))))break;if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return void 0===e},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.constant=function(e){return function(){return e}},x.property=function(e){return function(t){return t[e]}},x.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},x.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},x.now=Date.now||function(){return(new Date).getTime()};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(null==e)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","  ":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this);if(!window._.cloneDeep){var cloneDeep=function(e){console&&console.warn&&console.warn("_.cloneDeep is not part of underscore and will be deprecated");if(e===null||typeof e!="object")return e;var t=e.constructor();for(var n in e)t[n]=cloneDeep(e[n]);return t};_.mixin({cloneDeep:cloneDeep})}window.jQuery||!function(e,t){function n(e){var t=e.length,n=lt.type(e);return lt.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function r(e){var t=Nt[e]={};return lt.each(e.match(ht)||[],function(e,n){t[n]=!0}),t}function i(e,n,r,i){if(lt.acceptData(e)){var s,o,u=lt.expando,a=e.nodeType,f=a?lt.cache:e,l=a?e[u]:e[u]&&u;if(l&&f[l]&&(i||f[l].data)||r!==t||"string"!=typeof n)return l||(l=a?e[u]=tt.pop()||lt.guid++:u),f[l]||(f[l]=a?{}:{toJSON:lt.noop}),("object"==typeof n||"function"==typeof n)&&(i?f[l]=lt.extend(f[l],n):f[l].data=lt.extend(f[l].data,n)),o=f[l],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[lt.camelCase(n)]=r),"string"==typeof n?(s=o[n],null==s&&(s=o[lt.camelCase(n)])):s=o,s}}function s(e,t,n){if(lt.acceptData(e)){var r,i,s=e.nodeType,o=s?lt.cache:e,a=s?e[lt.expando]:lt.expando;if(o[a]){if(t&&(r=n?o[a]:o[a].data)){lt.isArray(t)?t=t.concat(lt.map(t,lt.camelCase)):t in r?t=[t]:(t=lt.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;for(;i--;)delete r[t[i]];if(n?!u(r):!lt.isEmptyObject(r))return}(n||(delete o[a].data,u(o[a])))&&(s?lt.cleanData([e],!0):lt.support.deleteExpando||o!=o.window?delete o[a]:o[a]=null)}}}function o(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(kt,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:Ct.test(r)?lt.parseJSON(r):r}catch(s){}lt.data(e,n,r)}else r=t}return r}function u(e){var t;for(t in e)if(("data"!==t||!lt.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function a(){return!0}function f(){return!1}function l(){try{return Q.activeElement}catch(e){}}function c(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function h(e,t,n){if(lt.isFunction(t))return lt.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return lt.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(Ut.test(t))return lt.filter(t,e,n);t=lt.filter(t,e)}return lt.grep(e,function(e){return lt.inArray(e,t)>=0!==n})}function p(e){var t=Vt.split("|"),n=e.createDocumentFragment();if(n.createElement)for(;t.length;)n.createElement(t.pop());return n}function d(e,t){return lt.nodeName(e,"table")&&lt.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function v(e){return e.type=(null!==lt.find.attr(e,"type"))+"/"+e.type,e}function m(e){var t=sn.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var n,r=0;null!=(n=e[r]);r++)lt._data(n,"globalEval",!t||lt._data(t[r],"globalEval"))}function y(e,t){if(1===t.nodeType&&lt.hasData(e)){var n,r,i,s=lt._data(e),o=lt._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;i>r;r++)lt.event.add(t,n,u[n][r])}o.data&&(o.data=lt.extend({},o.data))}}function b(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!lt.support.noCloneEvent&&t[lt.expando]){i=lt._data(t);for(r in i.events)lt.removeEvent(t,r,i.handle);t.removeAttribute(lt.expando)}"script"===n&&t.text!==e.text?(v(t).text=e.text,m(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),lt.support.html5Clone&&e.innerHTML&&!lt.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&tn.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function w(e,n){var r,i,s=0,o=typeof e.getElementsByTagName!==J?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==J?e.querySelectorAll(n||"*"):t;if(!o)for(o=[],r=e.childNodes||e;null!=(i=r[s]);s++)!n||lt.nodeName(i,n)?o.push(i):lt.merge(o,w(i,n));return n===t||n&&lt.nodeName(e,n)?lt.merge([e],o):o}function E(e){tn.test(e.type)&&(e.defaultChecked=e.checked)}function S(e,t){if(t in e)return t;for(var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Nn.length;i--;)if(t=Nn[i]+n,t in e)return t;return r}function x(e,t){return e=t||e,"none"===lt.css(e,"display")||!lt.contains(e.ownerDocument,e)}function T(e,t){for(var n,r,i,s=[],o=0,u=e.length;u>o;o++)r=e[o],r.style&&(s[o]=lt._data(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&x(r)&&(s[o]=lt._data(r,"olddisplay",L(r.nodeName)))):s[o]||(i=x(r),(n&&"none"!==n||!i)&&lt._data(r,"olddisplay",i?n:lt.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function N(e,t,n){var r=yn.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function C(e,t,n,r,i){for(var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===n&&(o+=lt.css(e,n+Tn[s],!0,i)),r?("content"===n&&(o-=lt.css(e,"padding"+Tn[s],!0,i)),"margin"!==n&&(o-=lt.css(e,"border"+Tn[s]+"Width",!0,i))):(o+=lt.css(e,"padding"+Tn[s],!0,i),"padding"!==n&&(o+=lt.css(e,"border"+Tn[s]+"Width",!0,i)));return o}function k(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=cn(e),o=lt.support.boxSizing&&"border-box"===lt.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=hn(e,t,s),(0>i||null==i)&&(i=e.style[t]),bn.test(i))return i;r=o&&(lt.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+C(e,t,n||(o?"border":"content"),r,s)+"px"}function L(e){var t=Q,n=En[e];return n||(n=A(e,t),"none"!==n&&n||(ln=(ln||lt("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(ln[0].contentWindow||ln[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=A(e,t),ln.detach()),En[e]=n),n}function A(e,t){var n=lt(t.createElement(e)).appendTo(t.body),r=lt.css(n[0],"display");return n.remove(),r}function O(e,t,n,r){var i;if(lt.isArray(t))lt.each(t,function(t,i){n||kn.test(e)?r(e,i):O(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==lt.type(t))r(e,t);else for(i in t)O(e+"["+i+"]",t[i],n,r)}function M(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(ht)||[];if(lt.isFunction(n))for(;r=s[i++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function _(e,t,n,r){function i(u){var a;return s[u]=!0,lt.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||o||s[f]?o?!(a=f):void 0:(t.dataTypes.unshift(f),i(f),!1)}),a}var s={},o=e===Wn;return i(t.dataTypes[0])||!s["*"]&&i("*")}function D(e,n){var r,i,s=lt.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((s[i]?e:r||(r={}))[i]=n[i]);return r&&lt.extend(!0,e,r),e}function P(e,n,r){for(var i,s,o,u,a=e.contents,f=e.dataTypes;"*"===f[0];)f.shift(),s===t&&(s=e.mimeType||n.getResponseHeader("Content-Type"));if(s)for(u in a)if(a[u]&&a[u].test(s)){f.unshift(u);break}if(f[0]in r)o=f[0];else{for(u in r){if(!f[0]||e.converters[u+" "+f[0]]){o=u;break}i||(i=u)}o=o||i}return o?(o!==f[0]&&f.unshift(o),r[o]):void 0}function H(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];for(s=l.shift();s;)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function B(){try{return new e.XMLHttpRequest}catch(t){}}function j(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function F(){return setTimeout(function(){Zn=t}),Zn=lt.now()}function I(e,t,n){for(var r,i=(sr[t]||[]).concat(sr["*"]),s=0,o=i.length;o>s;s++)if(r=i[s].call(n,t,e))return r}function q(e,t,n){var r,i,s=0,o=ir.length,u=lt.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;for(var t=Zn||F(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:lt.extend({},t),opts:lt.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Zn||F(),duration:n.duration,tweens:[],createTween:function(t,n){var r=lt.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(R(l,f.opts.specialEasing);o>s;s++)if(r=ir[s].call(f,e,l,f.opts))return r;return lt.map(l,I,f),lt.isFunction(f.opts.start)&&f.opts.start.call(e,f),lt.fx.timer(lt.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function R(e,t){var n,r,i,s,o;for(n in e)if(r=lt.camelCase(n),i=t[r],s=e[n],lt.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=lt.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function U(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&x(e),p=lt._data(e,"fxshow");n.queue||(u=lt._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,lt.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===lt.css(e,"display")&&"none"===lt.css(e,"float")&&(lt.support.inlineBlockNeedsLayout&&"inline"!==L(e.nodeName)?c.zoom=1:c.display="inline-block")),n.overflow&&(c.overflow="hidden",lt.support.shrinkWrapBlocks||f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],tr.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show"))continue;l[r]=p&&p[r]||lt.style(e,r)}if(!lt.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=lt._data(e,"fxshow",{}),s&&(p.hidden=!h),h?lt(e).show():f.done(function(){lt(e).hide()}),f.done(function(){var t;lt._removeData(e,"fxshow");for(t in l)lt.style(e,t,l[t])});for(r in l)o=I(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function z(e,t,n,r,i){return new z.prototype.init(e,t,n,r,i)}function W(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Tn[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function X(e){return lt.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var V,$,J=typeof t,K=e.location,Q=e.document,G=Q.documentElement,Y=e.jQuery,Z=e.$,et={},tt=[],nt="1.10.2",rt=tt.concat,it=tt.push,st=tt.slice,ot=tt.indexOf,ut=et.toString,at=et.hasOwnProperty,ft=nt.trim,lt=function(e,t){return new lt.fn.init(e,t,$)},ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ht=/\S+/g,pt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,dt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,vt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,mt=/^[\],:{}\s]*$/,gt=/(?:^|:|,)(?:\s*\[)+/g,yt=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,bt=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,wt=/^-ms-/,Et=/-([\da-z])/gi,St=function(e,t){return t.toUpperCase()},xt=function(e){(Q.addEventListener||"load"===e.type||"complete"===Q.readyState)&&(Tt(),lt.ready())},Tt=function(){Q.addEventListener?(Q.removeEventListener("DOMContentLoaded",xt,!1),e.removeEventListener("load",xt,!1)):(Q.detachEvent("onreadystatechange",xt),e.detachEvent("onload",xt))};lt.fn=lt.prototype={jquery:nt,constructor:lt,init:function(e,n,r){var i,s;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:dt.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof lt?n[0]:n,lt.merge(this,lt.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:Q,!0)),vt.test(i[1])&&lt.isPlainObject(n))for(i in n)lt.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(s=Q.getElementById(i[2]),s&&s.parentNode){if(s.id!==i[2])return r.find(e);this.length=1,this[0]=s}return this.context=Q,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):lt.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),lt.makeArray(e,this))},selector:"",length:0,toArray:function(){return st.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=lt.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return lt.each(this,e,t)},ready:function(e){return lt.ready.promise().done(e),this},slice:function(){return this.pushStack(st.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(lt.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:it,sort:[].sort,splice:[].splice},lt.fn.init.prototype=lt.fn,lt.extend=lt.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[1]||{},a=2),"object"==typeof u||lt.isFunction(u)||(u={}),f===a&&(u=this,--a);f>a;a++)if(null!=(s=arguments[a]))for(i in s)e=u[i],r=s[i],u!==r&&(l&&r&&(lt.isPlainObject(r)||(n=lt.isArray(r)))?(n?(n=!1,o=e&&lt.isArray(e)?e:[]):o=e&&lt.isPlainObject(e)?e:{},u[i]=lt.extend(l,o,r)):r!==t&&(u[i]=r));return u},lt.extend({expando:"jQuery"+(nt+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===lt&&(e.$=Z),t&&e.jQuery===lt&&(e.jQuery=Y),lt},isReady:!1,readyWait:1,holdReady:function(e){e?lt.readyWait++:lt.ready(!0)},ready:function(e){if(e===!0?!--lt.readyWait:!lt.isReady){if(!Q.body)return setTimeout(lt.ready);lt.isReady=!0,e!==!0&&--lt.readyWait>0||(V.resolveWith(Q,[lt]),lt.fn.trigger&&lt(Q).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===lt.type(e)},isArray:Array.isArray||function(e){return"array"===lt.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?et[ut.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==lt.type(e)||e.nodeType||lt.isWindow(e))return!1;try{if(e.constructor&&!at.call(e,"constructor")&&!at.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(lt.support.ownLast)for(n in e)return at.call(e,n);for(n in e);return n===t||at.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||Q;var r=vt.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=lt.buildFragment([e],t,i),i&&lt(i).remove(),lt.merge([],r.childNodes))},parseJSON:function(t){return e.JSON&&e.JSON.parse?e.JSON.parse(t):null===t?t:"string"==typeof t&&(t=lt.trim(t),t&&mt.test(t.replace(yt,"@").replace(bt,"]").replace(gt,"")))?(new Function("return "+t))():(lt.error("Invalid JSON: "+t),void 0)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||lt.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&lt.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(wt,"ms-").replace(Et,St)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,r){var i,s=0,o=e.length,u=n(e);if(r){if(u)for(;o>s&&(i=t.apply(e[s],r),i!==!1);s++);else for(s in e)if(i=t.apply(e[s],r),i===!1)break}else if(u)for(;o>s&&(i=t.call(e[s],s,e[s]),i!==!1);s++);else for(s in e)if(i=t.call(e[s],s,e[s]),i===!1)break;return e},trim:ft&&!ft.call("﻿ ")?function(e){return null==e?"":ft.call(e)}:function(e){return null==e?"":(e+"").replace(pt,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(n(Object(e))?lt.merge(r,"string"==typeof e?[e]:e):it.call(r,e)),r},inArray:function(e,t,n){var r;if(t){if(ot)return ot.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if("number"==typeof r)for(;r>s;s++)e[i++]=n[s];else for(;n[s]!==t;)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,r){var i,s=0,o=e.length,u=n(e),a=[];if(u)for(;o>s;s++)i=t(e[s],s,r),null!=i&&(a[a.length]=i);else for(s in e)i=t(e[s],s,r),null!=i&&(a[a.length]=i);return rt.apply([],a)},guid:1,proxy:function(e,n){var r,i,s;return"string"==typeof n&&(s=e[n],n=e,e=s),lt.isFunction(e)?(r=st.call(arguments,2),i=function(){return e.apply(n||this,r.concat(st.call(arguments)))},i.guid=e.guid=e.guid||lt.guid++,i):t},access:function(e,n,r,i,s,o,u){var a=0,f=e.length,l=null==r;if("object"===lt.type(r)){s=!0;for(a in r)lt.access(e,n,a,r[a],!0,o,u)}else if(i!==t&&(s=!0,lt.isFunction(i)||(u=!0),l&&(u?(n.call(e,i),n=null):(l=n,n=function(e,t,n){return l.call(lt(e),n)})),n))for(;f>a;a++)n(e[a],r,u?i:i.call(e[a],a,n(e[a],r)));return s?e:l?n.call(e):f?n(e[0],r):o},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),lt.ready.promise=function(t){if(!V)if(V=lt.Deferred(),"complete"===Q.readyState)setTimeout(lt.ready);else if(Q.addEventListener)Q.addEventListener("DOMContentLoaded",xt,!1),e.addEventListener("load",xt,!1);else{Q.attachEvent("onreadystatechange",xt),e.attachEvent("onload",xt);var n=!1;try{n=null==e.frameElement&&Q.documentElement}catch(r){}n&&n.doScroll&&function i(){if(!lt.isReady){try{n.doScroll("left")}catch(e){return setTimeout(i,50)}Tt(),lt.ready()}}()}return V.promise(t)},lt.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){et["[object "+t+"]"]=t.toLowerCase()}),$=lt(Q),function(e,t){function n(e,t,n,r){var i,s,o,u,a,f,l,c,d,v;if((t?t.ownerDocument||t:q)!==_&&M(t),t=t||_,n=n||[],!e||"string"!=typeof e)return n;if(1!==(u=t.nodeType)&&9!==u)return[];if(P&&!r){if(i=bt.exec(e))if(o=i[1]){if(9===u){if(s=t.getElementById(o),!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&F(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return et.apply(n,t.getElementsByTagName(e)),n;if((o=i[3])&&x.getElementsByClassName&&t.getElementsByClassName)return et.apply(n,t.getElementsByClassName(o)),n}if(x.qsa&&(!H||!H.test(e))){if(c=l=I,d=t,v=9===u&&e,1===u&&"object"!==t.nodeName.toLowerCase()){for(f=h(e),(l=t.getAttribute("id"))?c=l.replace(St,"\\$&"):t.setAttribute("id",c),c="[id='"+c+"'] ",a=f.length;a--;)f[a]=c+p(f[a]);d=pt.test(e)&&t.parentNode||t,v=f.join(",")}if(v)try{return et.apply(n,d.querySelectorAll(v)),n}catch(m){}finally{l||t.removeAttribute("id")}}}return E(e.replace(ft,"$1"),t,n,r)}function r(){function e(n,r){return t.push(n+=" ")>N.cacheLength&&delete e[t.shift()],e[n]=r}var t=[];return e}function i(e){return e[I]=!0,e}function s(e){var t=_.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),r=e.length;r--;)N.attrHandle[n[r]]=t}function u(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||K)-(~e.sourceIndex||K);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function f(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e){return i(function(t){return t=+t,i(function(n,r){for(var i,s=e([],n.length,t),o=s.length;o--;)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function c(){}function h(e,t){var r,i,s,o,u,a,f,l=W[e+" "];if(l)return t?0:l.slice(0);for(u=e,a=[],f=N.preFilter;u;){(!r||(i=ct.exec(u)))&&(i&&(u=u.slice(i[0].length)||u),a.push(s=[])),r=!1,(i=ht.exec(u))&&(r=i.shift(),s.push({value:r,type:i[0].replace(ft," ")}),u=u.slice(r.length));for(o in N.filter)!(i=gt[o].exec(u))||f[o]&&!(i=f[o](i))||(r=i.shift(),s.push({value:r,type:o,matches:i}),u=u.slice(r.length));if(!r)break}return t?u.length:u?n.error(e):W(e,a).slice(0)}function p(e){for(var t=0,n=e.length,r="";n>t;t++)r+=e[t].value;return r}function d(e,t,n){var r=t.dir,i=n&&"parentNode"===r,s=U++;return t.first?function(t,n,s){for(;t=t[r];)if(1===t.nodeType||i)return e(t,n,s)}:function(t,n,o){var u,a,f,l=R+" "+s;if(o){for(;t=t[r];)if((1===t.nodeType||i)&&e(t,n,o))return!0}else for(;t=t[r];)if(1===t.nodeType||i)if(f=t[I]||(t[I]={}),(a=f[r])&&a[0]===l){if((u=a[1])===!0||u===T)return u===!0}else if(a=f[r]=[l],a[1]=e(t,n,o)||T,a[1]===!0)return!0}}function v(e){return e.length>1?function(t,n,r){for(var i=e.length;i--;)if(!e[i](t,n,r))return!1;return!0}:e[0]}function m(e,t,n,r,i){for(var s,o=[],u=0,a=e.length,f=null!=t;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function g(e,t,n,r,s,o){return r&&!r[I]&&(r=g(r)),s&&!s[I]&&(s=g(s,o)),i(function(i,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=i||w(t||"*",u.nodeType?[u]:u,[]),g=!e||!i&&t?v:m(v,h,e,u,a),y=n?s||(i?e:d||r)?[]:o:g;if(n&&n(g,y,u,a),r)for(f=m(y,p),r(f,[],u,a),l=f.length;l--;)(c=f[l])&&(y[p[l]]=!(g[p[l]]=c));if(i){if(s||e){if(s){for(f=[],l=y.length;l--;)(c=y[l])&&f.push(g[l]=c);s(null,y=[],f,a)}for(l=y.length;l--;)(c=y[l])&&(f=s?nt.call(i,c):h[l])>-1&&(i[f]=!(o[f]=c))}}else y=m(y===o?y.splice(d,y.length):y),s?s(null,o,y,a):et.apply(o,y)})}function y(e){for(var t,n,r,i=e.length,s=N.relative[e[0].type],o=s||N.relative[" "],u=s?1:0,a=d(function(e){return e===t},o,!0),f=d(function(e){return nt.call(t,e)>-1},o,!0),l=[function(e,n,r){return!s&&(r||n!==A)||((t=n).nodeType?a(e,n,r):f(e,n,r))}];i>u;u++)if(n=N.relative[e[u].type])l=[d(v(l),n)];else{if(n=N.filter[e[u].type].apply(null,e[u].matches),n[I]){for(r=++u;i>r&&!N.relative[e[r].type];r++);return g(u>1&&v(l),u>1&&p(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(ft,"$1"),n,r>u&&y(e.slice(u,r)),i>r&&y(e=e.slice(r)),i>r&&p(e))}l.push(n)}return v(l)}function b(e,t){var r=0,s=t.length>0,o=e.length>0,u=function(i,u,a,f,l){var c,h,p,d=[],v=0,g="0",y=i&&[],b=null!=l,w=A,E=i||o&&N.find.TAG("*",l&&u.parentNode||u),S=R+=null==w?1:Math.random()||.1;for(b&&(A=u!==_&&u,T=r);null!=(c=E[g]);g++){if(o&&c){for(h=0;p=e[h++];)if(p(c,u,a)){f.push(c);break}b&&(R=S,T=++r)}s&&((c=!p&&c)&&v--,i&&y.push(c))}if(v+=g,s&&g!==v){for(h=0;p=t[h++];)p(y,d,u,a);if(i){if(v>0)for(;g--;)y[g]||d[g]||(d[g]=Y.call(f));d=m(d)}et.apply(f,d),b&&!i&&d.length>0&&v+t.length>1&&n.uniqueSort(f)}return b&&(R=S,A=w),y};return s?i(u):u}function w(e,t,r){for(var i=0,s=t.length;s>i;i++)n(e,t[i],r);return r}function E(e,t,n,r){var i,s,o,u,a,f=h(e);if(!r&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&x.getById&&9===t.nodeType&&P&&N.relative[s[1].type]){if(t=(N.find.ID(o.matches[0].replace(xt,Tt),t)||[])[0],!t)return n;e=e.slice(s.shift().value.length)}for(i=gt.needsContext.test(e)?0:s.length;i--&&(o=s[i],!N.relative[u=o.type]);)if((a=N.find[u])&&(r=a(o.matches[0].replace(xt,Tt),pt.test(s[0].type)&&t.parentNode||t))){if(s.splice(i,1),e=r.length&&p(s),!e)return et.apply(n,r),n;break}}return L(e,f)(r,t,!P,n,pt.test(e)),n}var S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I="sizzle"+ -(new Date),q=e.document,R=0,U=0,z=r(),W=r(),X=r(),V=!1,$=function(e,t){return e===t?(V=!0,0):0},J=typeof t,K=1<<31,Q={}.hasOwnProperty,G=[],Y=G.pop,Z=G.push,et=G.push,tt=G.slice,nt=G.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1},rt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",it="[\\x20\\t\\r\\n\\f]",st="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=st.replace("w","w#"),ut="\\["+it+"*("+st+")"+it+"*(?:([*^$|!~]?=)"+it+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ot+")|)|)"+it+"*\\]",at=":("+st+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ut.replace(3,8)+")*)|.*)\\)|)",ft=new RegExp("^"+it+"+|((?:^|[^\\\\])(?:\\\\.)*)"+it+"+$","g"),ct=new RegExp("^"+it+"*,"+it+"*"),ht=new RegExp("^"+it+"*([>+~]|"+it+")"+it+"*"),pt=new RegExp(it+"*[+~]"),dt=new RegExp("="+it+"*([^\\]'\"]*)"+it+"*\\]","g"),vt=new RegExp(at),mt=new RegExp("^"+ot+"$"),gt={ID:new RegExp("^#("+st+")"),CLASS:new RegExp("^\\.("+st+")"),TAG:new RegExp("^("+st.replace("w","w*")+")"),ATTR:new RegExp("^"+ut),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+it+"*(even|odd|(([+-]|)(\\d*)n|)"+it+"*(?:([+-]|)"+it+"*(\\d+)|))"+it+"*\\)|)","i"),bool:new RegExp("^(?:"+rt+")$","i"),needsContext:new RegExp("^"+it+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+it+"*((?:-\\d)?\\d*)"+it+"*\\)|)(?=[^-]|$)","i")},yt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,wt=/^(?:input|select|textarea|button)$/i,Et=/^h\d$/i,St=/'|\\/g,xt=new RegExp("\\\\([\\da-f]{1,6}"+it+"?|("+it+")|.)","ig"),Tt=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{et.apply(G=tt.call(q.childNodes),q.childNodes),G[q.childNodes.length].nodeType}catch(Nt){et={apply:G.length?function(e,t){Z.apply(e,tt.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}k=n.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},x=n.support={},M=n.setDocument=function(e){var t=e?e.ownerDocument||e:q,n=t.defaultView;return t!==_&&9===t.nodeType&&t.documentElement?(_=t,D=t.documentElement,P=!k(t),n&&n.attachEvent&&n!==n.top&&n.attachEvent("onbeforeunload",function(){M()}),x.attributes=s(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=s(function(e){return e.appendChild(t.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=s(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),x.getById=s(function(e){return D.appendChild(e).id=I,!t.getElementsByName||!t.getElementsByName(I).length}),x.getById?(N.find.ID=function(e,t){if(typeof t.getElementById!==J&&P){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},N.filter.ID=function(e){var t=e.replace(xt,Tt);return function(e){return e.getAttribute("id")===t}}):(delete N.find.ID,N.filter.ID=function(e){var t=e.replace(xt,Tt);return function(e){var n=typeof e.getAttributeNode!==J&&e.getAttributeNode("id");return n&&n.value===t}}),N.find.TAG=x.getElementsByTagName?function(e,t){return typeof t.getElementsByTagName!==J?t.getElementsByTagName(e):void 0}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){for(;n=s[i++];)1===n.nodeType&&r.push(n);return r}return s},N.find.CLASS=x.getElementsByClassName&&function(e,t){return typeof t.getElementsByClassName!==J&&P?t.getElementsByClassName(e):void 0},B=[],H=[],(x.qsa=yt.test(t.querySelectorAll))&&(s(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||H.push("\\["+it+"*(?:value|"+rt+")"),e.querySelectorAll(":checked").length||H.push(":checked")}),s(function(e){var n=t.createElement("input");n.setAttribute("type","hidden"),e.appendChild(n).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&H.push("[*^$]="+it+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||H.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),H.push(",.*:")})),(x.matchesSelector=yt.test(j=D.webkitMatchesSelector||D.mozMatchesSelector||D.oMatchesSelector||D.msMatchesSelector))&&s(function(e){x.disconnectedMatch=j.call(e,"div"),j.call(e,"[s!='']:x"),B.push("!=",at)}),H=H.length&&new RegExp(H.join("|")),B=B.length&&new RegExp(B.join("|")),F=yt.test(D.contains)||D.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},$=D.compareDocumentPosition?function(e,n){if(e===n)return V=!0,0;var r=n.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(n);return r?1&r||!x.sortDetached&&n.compareDocumentPosition(e)===r?e===t||F(q,e)?-1:n===t||F(q,n)?1:O?nt.call(O,e)-nt.call(O,n):0:4&r?-1:1:e.compareDocumentPosition?-1:1}:function(e,n){var r,i=0,s=e.parentNode,o=n.parentNode,a=[e],f=[n];if(e===n)return V=!0,0;if(!s||!o)return e===t?-1:n===t?1:s?-1:o?1:O?nt.call(O,e)-nt.call(O,n):0;if(s===o)return u(e,n);for(r=e;r=r.parentNode;)a.unshift(r);for(r=n;r=r.parentNode;)f.unshift(r);for(;a[i]===f[i];)i++;return i?u(a[i],f[i]):a[i]===q?-1:f[i]===q?1:0},t):_},n.matches=function(e,t){return n(e,null,null,t)},n.matchesSelector=function(e,t){if((e.ownerDocument||e)!==_&&M(e),t=t.replace(dt,"='$1']"),!(!x.matchesSelector||!P||B&&B.test(t)||H&&H.test(t)))try{var r=j.call(e,t);if(r||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(i){}return n(t,_,null,[e]).length>0},n.contains=function(e,t){return(e.ownerDocument||e)!==_&&M(e),F(e,t)},n.attr=function(e,n){(e.ownerDocument||e)!==_&&M(e);var r=N.attrHandle[n.toLowerCase()],i=r&&Q.call(N.attrHandle,n.toLowerCase())?r(e,n,!P):t;return i===t?x.attributes||!P?e.getAttribute(n):(i=e.getAttributeNode(n))&&i.specified?i.value:null:i},n.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},n.uniqueSort=function(e){var t,n=[],r=0,i=0;if(V=!x.detectDuplicates,O=!x.sortStable&&e.slice(0),e.sort($),V){for(;t=e[i++];)t===e[i]&&(r=n.push(i));for(;r--;)e.splice(n[r],1)}return e},C=n.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=C(t);return n},N=n.selectors={cacheLength:50,createPseudo:i,match:gt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xt,Tt),e[3]=(e[4]||e[5]||"").replace(xt,Tt),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||n.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&n.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return gt.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&vt.test(r)&&(n=h(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xt,Tt).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=z[e+" "];return t||(t=new RegExp("(^|"+it+")"+e+"("+it+"|$)"))&&z(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==J&&e.getAttribute("class")||"")})},ATTR:function(e,t,r){return function(i){var s=n.attr(i,e);return null==s?"!="===t:t?(s+="","="===t?s===r:"!="===t?s!==r:"^="===t?r&&0===s.indexOf(r):"*="===t?r&&s.indexOf(r)>-1:"$="===t?r&&s.slice(-r.length)===r:"~="===t?(" "+s+" ").indexOf(r)>-1:"|="===t?s===r||s.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){for(;v;){for(c=t;c=c[v];)if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){for(l=m[I]||(m[I]={}),f=l[e]||[],p=f[0]===R&&f[1],h=f[0]===R&&f[2],c=p&&m.childNodes[p];c=++p&&c&&c[v]||(h=p=0)||d.pop();)if(1===c.nodeType&&++h&&c===t){l[e]=[R,p,h];break}}else if(y&&(f=(t[I]||(t[I]={}))[e])&&f[0]===R)h=f[1];else for(;(c=++p&&c&&c[v]||(h=p=0)||d.pop())&&((u?c.nodeName.toLowerCase()!==g:1!==c.nodeType)||!++h||(y&&((c[I]||(c[I]={}))[e]=[R,h]),c!==t)););return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var r,s=N.pseudos[e]||N.setFilters[e.toLowerCase()]||n.error("unsupported pseudo: "+e);return s[I]?s(t):s.length>1?(r=[e,e,"",t],N.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,n){for(var r,i=s(e,t),o=i.length;o--;)r=nt.call(e,i[o]),e[r]=!(n[r]=i[o])}):function(e){return s(e,0,r)}):s}},pseudos:{not:i(function(e){var t=[],n=[],r=L(e.replace(ft,"$1"));return r[I]?i(function(e,t,n,i){for(var s,o=r(e,null,i,[]),u=e.length;u--;)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:i(function(e){return function(t){return n(e,t).length>0}}),contains:i(function(e){return function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:i(function(e){return mt.test(e||"")||n.error("unsupported lang: "+e),e=e.replace(xt,Tt).toLowerCase(),function(t){var n;do if(n=P?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===D},focus:function(e){return e===_.activeElement&&(!_.hasFocus||_.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!N.pseudos.empty(e)},header:function(e){return Et.test(e.nodeName)},input:function(e){return wt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:l(function(){return[0]}),last:l(function(e,t){return[t-1]}),eq:l(function(e,t,n){return[0>n?n+t:n]}),even:l(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:l(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:l(function(e,t,n){for(var r=0>n?n+t:n;--r>=0;)e.push(r);return e}),gt:l(function(e,t,n){for(var r=0>n?n+t:n;++r<t;)e.push(r);return e})}},N.pseudos.nth=N.pseudos.eq;for(S in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})N.pseudos[S]=a(S);for(S in{submit:!0,reset:!0})N.pseudos[S]=f(S);c.prototype=N.filters=N.pseudos,N.setFilters=new c,L=n.compile=function(e,t){var n,r=[],i=[],s=X[e+" "];if(!s){for(t||(t=h(e)),n=t.length;n--;)s=y(t[n]),s[I]?r.push(s):i.push(s);s=X(e,b(i,r))}return s},x.sortStable=I.split("").sort($).join("")===I,x.detectDuplicates=V,M(),x.sortDetached=s(function(e){return 1&e.compareDocumentPosition(_.createElement("div"))}),s(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),x.attributes&&s(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),s(function(e){return null==e.getAttribute("disabled")})||o(rt,function(e,t,n){var r;return n?void 0:(r=e.getAttributeNode(t))&&r.specified?r.value:e[t]===!0?t.toLowerCase():null}),lt.find=n,lt.expr=n.selectors,lt.expr[":"]=lt.expr.pseudos,lt.unique=n.uniqueSort,lt.text=n.getText,lt.isXMLDoc=n.isXML,lt.contains=n.contains}(e);var Nt={};lt.Callbacks=function(e){e="string"==typeof e?Nt[e]||r(e):lt.extend({},e);var n,i,s,o,u,a,f=[],l=!e.once&&[],c=function(t){for(i=e.memory&&t,s=!0,u=a||0,a=0,o=f.length,n=!0;f&&o>u;u++)if(f[u].apply(t[0],t[1])===!1&&e.stopOnFalse){i=!1;break}n=!1,f&&(l?l.length&&c(l.shift()):i?f=[]:h.disable())},h={add:function(){if(f){var t=f.length;!function r(t){lt.each(t,function(t,n){var i=lt.type(n);"function"===i?e.unique&&h.has(n)||f.push(n):n&&n.length&&"string"!==i&&r(n)})}(arguments),n?o=f.length:i&&(a=t,c(i))}return this},remove:function(){return f&&lt.each(arguments,function(e,t){for(var r;(r=lt.inArray(t,f,r))>-1;)f.splice(r,1),n&&(o>=r&&o--,u>=r&&u--)}),this},has:function(e){return e?lt.inArray(e,f)>-1:!!f&&!!f.length},empty:function(){return f=[],o=0,this},disable:function(){return f=l=i=t,this},disabled:function(){return!f},lock:function(){return l=t,i||h.disable(),this},locked:function(){return!l},fireWith:function(e,t){return!f||s&&!l||(t=t||[],t=[e,t.slice?t.slice():t],n?l.push(t):c(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!s}};return h},lt.extend({Deferred:function(e){var t=[["resolve","done",lt.Callbacks("once memory"),"resolved"],["reject","fail",lt.Callbacks("once memory"),"rejected"],["notify","progress",lt.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return lt.Deferred(function(n){lt.each(t,function(t,s){var o=s[0],u=lt.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&lt.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?lt.extend(e,r):r}},i={};return r.pipe=r.then,lt.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t,n,r,i=0,s=st.call(arguments),o=s.length,u=1!==o||e&&lt.isFunction(e.promise)?o:0,a=1===u?e:lt.Deferred(),f=function(e,n,r){return function(i){n[e]=this,r[e]=arguments.length>1?st.call(arguments):i,r===t?a.notifyWith(n,r):--u||a.resolveWith(n,r)}};if(o>1)for(t=new Array(o),n=new Array(o),r=new Array(o);o>i;i++)s[i]&&lt.isFunction(s[i].promise)?s[i].promise().done(f(i,r,s)).fail(a.reject).progress(f(i,n,t)):--u;return u||a.resolveWith(r,s),a.promise()}}),lt.support=function(t){var n,r,i,s,o,u,a,f,l,c=Q.createElement("div");if(c.setAttribute("className","t"),c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=c.getElementsByTagName("*")||[],r=c.getElementsByTagName("a")[0],!r||!r.style||!n.length)return t;s=Q.createElement("select"),u=s.appendChild(Q.createElement("option")),i=c.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==c.className,t.leadingWhitespace=3===c.firstChild.nodeType,t.tbody=!c.getElementsByTagName("tbody").length,t.htmlSerialize=!!c.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!i.value,t.optSelected=u.selected,t.enctype=!!Q.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==Q.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,i.checked=!0,t.noCloneChecked=i.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled;try{delete c.test}catch(h){t.deleteExpando=!1}i=Q.createElement("input"),i.setAttribute("value",""),t.input=""===i.getAttribute("value"),i.value="t",i.setAttribute("type","radio"),t.radioValue="t"===i.value,i.setAttribute("checked","t"),i.setAttribute("name","t"),o=Q.createDocumentFragment(),o.appendChild(i),t.appendChecked=i.checked,t.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,c.attachEvent&&(c.attachEvent("onclick",function(){t.noCloneEvent=!1}),c.cloneNode(!0).click());for(l in{submit:!0,change:!0,focusin:!0})c.setAttribute(a="on"+l,"t"),t[l+"Bubbles"]=a in e||c.attributes[a].expando===!1;c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===c.style.backgroundClip;for(l in lt(t))break;return t.ownLast="0"!==l,lt(function(){var n,r,i,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",o=Q.getElementsByTagName("body")[0];o&&(n=Q.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",o.appendChild(n).appendChild(c),c.innerHTML="<table><tr><td></td><td>t</td></tr></table>",i=c.getElementsByTagName("td"),i[0].style.cssText="padding:0;margin:0;border:0;display:none",f=0===i[0].offsetHeight,i[0].style.display="",i[1].style.display="none",t.reliableHiddenOffsets=f&&0===i[0].offsetHeight,c.innerHTML="",c.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",lt.swap(o,null!=o.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===c.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(c,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(c,null)||{width:"4px"}).width,r=c.appendChild(Q.createElement("div")),r.style.cssText=c.style.cssText=s,r.style.marginRight=r.style.width="0",c.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof c.style.zoom!==J&&(c.innerHTML="",c.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===c.offsetWidth,c.style.display="block",c.innerHTML="<div></div>",c.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==c.offsetWidth,t.inlineBlockNeedsLayout&&(o.style.zoom=1)),o.removeChild(n),n=c=i=r=null)}),n=s=o=u=r=i=null,t}({});var Ct=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,kt=/([A-Z])/g;lt.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?lt.cache[e[lt.expando]]:e[lt.expando],!!e&&!u(e)},data:function(e,t,n){return i(e,t,n)},removeData:function(e,t){return s(e,t)},_data:function(e,t,n){return i(e,t,n,!0)},_removeData:function(e,t){return s(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&lt.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),lt.fn.extend({data:function(e,n){var r,i,s=null,u=0,a=this[0];if(e===t){if(this.length&&(s=lt.data(a),1===a.nodeType&&!lt._data(a,"parsedAttrs"))){for(r=a.attributes;u<r.length;u++)i=r[u].name,0===i.indexOf("data-")&&(i=lt.camelCase(i.slice(5)),o(a,i,s[i]));lt._data(a,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){lt.data(this,e)}):arguments.length>1?this.each(function(){lt.data(this,e,n)}):a?o(a,e,lt.data(a,e)):null},removeData:function(e){return this.each(function(){lt.removeData(this,e)})}}),lt.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=lt._data(e,t),n&&(!r||lt.isArray(n)?r=lt._data(e,t,lt.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=lt.queue(e,t),r=n.length,i=n.shift(),s=lt._queueHooks(e,t),o=function(){lt.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return lt._data(e,n)||lt._data(e,n,{empty:lt.Callbacks("once memory").add(function(){lt._removeData(e,t+"queue"),lt._removeData(e,n)})})}}),lt.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),arguments.length<r?lt.queue(this[0],e):n===t?this:this.each(function(){var t=lt.queue(this,e,n);lt._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&lt.dequeue(this,e)})},dequeue:function(e){return this.each(function(){lt.dequeue(this,e)})},delay:function(e,t){return e=lt.fx?lt.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=lt.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};for("string"!=typeof e&&(n=e,e=t),e=e||"fx";u--;)r=lt._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var Lt,At,Ot=/[\t\r\n\f]/g,Mt=/\r/g,_t=/^(?:input|select|textarea|button|object)$/i,Dt=/^(?:a|area)$/i,Pt=/^(?:checked|selected)$/i,Ht=lt.support.getSetAttribute,Bt=lt.support.input;lt.fn.extend({attr:function(e,t){return lt.access(this,lt.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){lt.removeAttr(this,e)})},prop:function(e,t){return lt.access(this,lt.prop,e,t,arguments.length>1)},removeProp:function(e){return e=lt.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(lt.isFunction(e))return this.each(function(t){lt(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(ht)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Ot," "):" ")){for(s=0;i=t[s++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=lt.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(lt.isFunction(e))return this.each(function(t){lt(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(ht)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(Ot," "):"")){for(s=0;i=t[s++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");n.className=e?lt.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):lt.isFunction(e)?this.each(function(n){lt(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,r=0,i=lt(this),s=e.match(ht)||[];t=s[r++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else(n===J||"boolean"===n)&&(this.className&&lt._data(this,"__className__",this.className),this.className=this.className||e===!1?"":lt._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Ot," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(arguments.length)return i=lt.isFunction(e),this.each(function(n){var s;1===this.nodeType&&(s=i?e.call(this,n,lt(this).val()):e,null==s?s="":"number"==typeof s?s+="":lt.isArray(s)&&(s=lt.map(s,function(e){return null==e?"":e+""})),r=lt.valHooks[this.type]||lt.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,s,"value")!==t||(this.value=s))});if(s)return r=lt.valHooks[s.type]||lt.valHooks[s.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(s,"value"))!==t?n:(n=s.value,"string"==typeof n?n.replace(Mt,""):null==n?"":n)}}),lt.extend({valHooks:{option:{get:function(e){var t=lt.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){for(var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(lt.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&lt.nodeName(n.parentNode,"optgroup"))){if(t=lt(n).val(),s)return t;o.push(t)}return o},set:function(e,t){for(var n,r,i=e.options,s=lt.makeArray(t),o=i.length;o--;)r=i[o],(r.selected=lt.inArray(lt(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,n,r){var i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===J?lt.prop(e,n,r):(1===o&&lt.isXMLDoc(e)||(n=n.toLowerCase(),i=lt.attrHooks[n]||(lt.expr.match.bool.test(n)?At:Lt)),r===t?i&&"get"in i&&null!==(s=i.get(e,n))?s:(s=lt.find.attr(e,n),null==s?t:s):null!==r?i&&"set"in i&&(s=i.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r):(lt.removeAttr(e,n),void 0))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(ht);if(s&&1===e.nodeType)for(;n=s[i++];)r=lt.propFix[n]||n,lt.expr.match.bool.test(n)?Bt&&Ht||!Pt.test(n)?e[r]=!1:e[lt.camelCase("default-"+n)]=e[r]=!1:lt.attr(e,n,""),e.removeAttribute(Ht?n:r)},attrHooks:{type:{set:function(e,t){if(!lt.support.radioValue&&"radio"===t&&lt.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return o=1!==u||!lt.isXMLDoc(e),o&&(n=lt.propFix[n]||n,s=lt.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&null!==(i=s.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=lt.find.attr(e,"tabindex");return t?parseInt(t,10):_t.test(e.nodeName)||Dt.test(e.nodeName)&&e.href?0:-1}}}}),At={set:function(e,t,n){return t===!1?lt.removeAttr(e,n):Bt&&Ht||!Pt.test(n)?e.setAttribute(!Ht&&lt.propFix[n]||n,n):e[lt.camelCase("default-"+n)]=e[n]=!0,n}},lt.each(lt.expr.match.bool.source.match(/\w+/g),function(e,n){var r=lt.expr.attrHandle[n]||lt.find.attr;lt.expr.attrHandle[n]=Bt&&Ht||!Pt.test(n)?function(e,n,i){var s=lt.expr.attrHandle[n],o=i?t:(lt.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return lt.expr.attrHandle[n]=s,o}:function(e,n,r){return r?t:e[lt.camelCase("default-"+n)]?n.toLowerCase():null}}),Bt&&Ht||(lt.attrHooks.value={set:function(e,t,n){return lt.nodeName(e,"input")?(e.defaultValue=t,void 0):Lt&&Lt.set(e,t,n)}}),Ht||(Lt={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},lt.expr.attrHandle.id=lt.expr.attrHandle.name=lt.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null},lt.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:Lt.set},lt.attrHooks.contenteditable={set:function(e,t,n){Lt.set(e,""===t?!1:t,n)}},lt.each(["width","height"],function(e,t){lt.attrHooks[t]={set:function(e,n){return""===n?(e.setAttribute(t,"auto"),n):void 0}}})),lt.support.hrefNormalized||lt.each(["href","src"],function(e,t){lt.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),lt.support.style||(lt.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),lt.support.optSelected||(lt.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),lt.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){lt.propFix[this.toLowerCase()]=this}),lt.support.enctype||(lt.propFix.enctype="encoding"),lt.each(["radio","checkbox"],function(){lt.valHooks[this]={set:function(e,t){return lt.isArray(t)?e.checked=lt.inArray(lt(e).val(),t)>=0:void 0}},lt.support.checkOn||(lt.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var jt=/^(?:input|select|textarea)$/i,Ft=/^key/,It=/^(?:mouse|contextmenu)|click/,qt=/^(?:focusinfocus|focusoutblur)$/,Rt=/^([^.]*)(?:\.(.+)|)$/;lt.event={global:{},add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,v,m,g=lt._data(e);if(g){for(r.handler&&(f=r,r=f.handler,s=f.selector),r.guid||(r.guid=lt.guid++),(u=g.events)||(u=g.events={}),(c=g.handle)||(c=g.handle=function(e){return typeof lt===J||e&&lt.event.triggered===e.type?t:lt.event.dispatch.apply(c.elem,arguments)},c.elem=e),n=(n||"").match(ht)||[""],a=n.length;a--;)o=Rt.exec(n[a])||[],d=m=o[1],v=(o[2]||"").split(".").sort(),d&&(l=lt.event.special[d]||{},d=(s?l.delegateType:l.bindType)||d,l=lt.event.special[d]||{},h=lt.extend({type:d,origType:m,data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&lt.expr.match.needsContext.test(s),namespace:v.join(".")},f),(p=u[d])||(p=u[d]=[],p.delegateCount=0,l.setup&&l.setup.call(e,i,v,c)!==!1||(e.addEventListener?e.addEventListener(d,c,!1):e.attachEvent&&e.attachEvent("on"+d,c))),l.add&&(l.add.call(e,h),h.handler.guid||(h.handler.guid=r.guid)),s?p.splice(p.delegateCount++,0,h):p.push(h),lt.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=lt.hasData(e)&&lt._data(e);if(m&&(l=m.events)){for(t=(t||"").match(ht)||[""],f=t.length;f--;)if(u=Rt.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){for(c=lt.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=l[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;s--;)o=h[s],!i&&v!==o.origType||n&&n.guid!==o.guid||u&&!u.test(o.namespace)||r&&r!==o.selector&&("**"!==r||!o.selector)||(h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o));a&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||lt.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)lt.event.remove(e,p+t[f],n,r,!0);lt.isEmptyObject(l)&&(delete m.handle,lt._removeData(e,"events"))}},trigger:function(n,r,i,s){var o,u,a,f,l,c,h,p=[i||Q],d=at.call(n,"type")?n.type:n,v=at.call(n,"namespace")?n.namespace.split("."):[];if(a=c=i=i||Q,3!==i.nodeType&&8!==i.nodeType&&!qt.test(d+lt.event.triggered)&&(d.indexOf(".")>=0&&(v=d.split("."),d=v.shift(),v.sort()),u=d.indexOf(":")<0&&"on"+d,n=n[lt.expando]?n:new lt.Event(d,"object"==typeof n&&n),n.isTrigger=s?2:3,n.namespace=v.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:lt.makeArray(r,[n]),l=lt.event.special[d]||{},s||!l.trigger||l.trigger.apply(i,r)!==!1)){if(!s&&!l.noBubble&&!lt.isWindow(i)){for(f=l.delegateType||d,qt.test(f+d)||(a=a.parentNode);a;a=a.parentNode)p.push(a),c=a;c===(i.ownerDocument||Q)&&p.push(c.defaultView||c.parentWindow||e)}for(h=0;(a=p[h++])&&!n.isPropagationStopped();)n.type=h>1?f:l.bindType||d,o=(lt._data(a,"events")||{})[n.type]&&lt._data(a,"handle"),o&&o.apply(a,r),o=u&&a[u],o&&lt.acceptData(a)&&o.apply&&o.apply(a,r)===!1&&n.preventDefault();if(n.type=d,!s&&!n.isDefaultPrevented()&&(!l._default||l._default.apply(p.pop(),r)===!1)&&lt.acceptData(i)&&u&&i[d]&&!lt.isWindow(i)){c=i[u],c&&(i[u]=null),lt.event.triggered=d;try{i[d]()}catch(m){}lt.event.triggered=t,c&&(i[u]=c)}return n.result}},dispatch:function(e){e=lt.event.fix(e);var n,r,i,s,o,u=[],a=st.call(arguments),f=(lt._data(this,"events")||{})[e.type]||[],l=lt.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){for(u=lt.event.handlers.call(this,e,f),n=0;(s=u[n++])&&!e.isPropagationStopped();)for(e.currentTarget=s.elem,o=0;(i=s.handlers[o++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((lt.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,s,o,u=[],a=n.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||"click"!==e.type))for(;f!=this;f=f.parentNode||this)if(1===f.nodeType&&(f.disabled!==!0||"click"!==e.type)){for(s=[],o=0;a>o;o++)i=n[o],r=i.selector+" ",s[r]===t&&(s[r]=i.needsContext?lt(r,this).index(f)>=0:lt.find(r,this,null,[f]).length),s[r]&&s.push(i);s.length&&u.push({elem:f,handlers:s})}return a<n.length&&u.push({elem:this,handlers:n.slice(a)}),u},fix:function(e){if(e[lt.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];for(o||(this.fixHooks[i]=o=It.test(i)?this.mouseHooks:Ft.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new lt.Event(s),t=r.length;t--;)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||Q),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,o.filter?o.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,o=n.button,u=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||Q,s=i.documentElement,r=i.body,e.pageX=n.clientX+(s&&s.scrollLeft||r&&r.scrollLeft||0)-(s&&s.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||r&&r.scrollTop||0)-(s&&s.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&u&&(e.relatedTarget=u===e.target?n.toElement:u),e.which||o===t||(e.which=1&o?1:2&o?3:4&o?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==l()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return lt.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(e){return lt.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=lt.extend(new lt.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?lt.event.trigger(i,null,t):lt.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},lt.removeEvent=Q.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===J&&(e[r]=null),e.detachEvent(r,n))},lt.Event=function(e,t){return this instanceof lt.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?a:f):this.type=e,t&&lt.extend(this,t),this.timeStamp=e&&e.timeStamp||lt.now(),this[lt.expando]=!0,void 0):new lt.Event(e,t)},lt.Event.prototype={isDefaultPrevented:f,isPropagationStopped:f,isImmediatePropagationStopped:f,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=a,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=a,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=a,this.stopPropagation()}},lt.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){lt.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!lt.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),lt.support.submitBubbles||(lt.event.special.submit={setup:function(){return lt.nodeName(this,"form")?!1:(lt.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=lt.nodeName(n,"input")||lt.nodeName(n,"button")?n.form:t;r&&!lt._data(r,"submitBubbles")&&(lt.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),lt._data(r,"submitBubbles",!0))}),void 0)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&lt.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return lt.nodeName(this,"form")?!1:(lt.event.remove(this,"._submit"),void 0)}}),lt.support.changeBubbles||(lt.event.special.change={setup:function(){return jt.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(lt.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),lt.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),lt.event.simulate("change",this,e,!0)})),!1):(lt.event.add(this,"beforeactivate._change",function(e){var t=e.target;jt.test(t.nodeName)&&!lt._data(t,"changeBubbles")&&(lt.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||lt.event.simulate("change",this.parentNode,e,!0)}),lt._data(t,"changeBubbles",!0))}),void 0)},handle:function(e){var t=e.target;return this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type?e.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return lt.event.remove(this,"._change"),!jt.test(this.nodeName)}}),lt.support.focusinBubbles||lt.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){lt.event.simulate(t,e.target,lt.event.fix(e),!0)};lt.event.special[t]={setup:function(){0===n++&&Q.addEventListener(e,r,!0)},teardown:function(){0===--n&&Q.removeEventListener(e,r,!0)}}}),lt.fn.extend({on:function(e,n,r,i,s){var o,u;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(o in e)this.on(o,n,r,e[o],s);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=f;else if(!i)return this;return 1===s&&(u=i,i=function(e){return lt().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=lt.guid++)),this.each(function(){lt.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,lt(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,n,e[s]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=f),this.each(function(){lt.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){lt.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?lt.event.trigger(e,t,n,!0):void 0}});var Ut=/^.[^:#\[\.,]*$/,zt=/^(?:parents|prev(?:Until|All))/,Wt=lt.expr.match.needsContext,Xt={children:!0,contents:!0,next:!0,prev:!0};lt.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(lt(e).filter(function(){for(t=0;i>t;t++)if(lt.contains(r[t],this))return!0}));for(t=0;i>t;t++)lt.find(e,r[t],n);return n=this.pushStack(i>1?lt.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=lt(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(lt.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(h(this,e||[],!0))},filter:function(e){return this.pushStack(h(this,e||[],!1))},is:function(e){return!!h(this,"string"==typeof e&&Wt.test(e)?lt(e):e||[],!1).length},closest:function(e,t){for(var n,r=0,i=this.length,s=[],o=Wt.test(e)||"string"!=typeof e?lt(e,t||this.context):0;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&lt.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?lt.unique(s):s)},index:function(e){return e?"string"==typeof e?lt.inArray(this[0],lt(e)):lt.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?lt(e,t):lt.makeArray(e&&e.nodeType?[e]:e),r=lt.merge(this.get(),n);return this.pushStack(lt.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),lt.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return lt.dir(e,"parentNode")},parentsUntil:function(e,t,n){return lt.dir(e,"parentNode",n)},next:function(e){return c(e,"nextSibling")},prev:function(e){return c(e,"previousSibling")},nextAll:function(e){return lt.dir(e,"nextSibling")},prevAll:function(e){return lt.dir(e,"previousSibling")},nextUntil:function(e,t,n){return lt.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return lt.dir(e,"previousSibling",n)},siblings:function(e){return lt.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return lt.sibling(e.firstChild)},contents:function(e){return lt.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:lt.merge([],e.childNodes)}},function(e,t){lt.fn[e]=function(n,r){var i=lt.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=lt.filter(r,i)),this.length>1&&(Xt[e]||(i=lt.unique(i)),zt.test(e)&&(i=i.reverse())),this.pushStack(i)}}),lt.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?lt.find.matchesSelector(r,e)?[r]:[]:lt.find.matches(e,lt.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){for(var i=[],s=e[n];s&&9!==s.nodeType&&(r===t||1!==s.nodeType||!lt(s).is(r));)1===s.nodeType&&i.push(s),s=s[n];return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var Vt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",$t=/ jQuery\d+="(?:null|\d+)"/g,Jt=new RegExp("<(?:"+Vt+")[\\s/>]","i"),Kt=/^\s+/,Qt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Gt=/<([\w:]+)/,Yt=/<tbody/i,Zt=/<|&#?\w+;/,en=/<(?:script|style|link)/i,tn=/^(?:checkbox|radio)$/i,nn=/checked\s*(?:[^=]|=\s*.checked.)/i,rn=/^$|\/(?:java|ecma)script/i,sn=/^true\/(.*)/,on=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,un={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:lt.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},an=p(Q),fn=an.appendChild(Q.createElement("div"));un.optgroup=un.option,un.tbody=un.tfoot=un.colgroup=un.caption=un.thead,un.th=un.td,lt.fn.extend({text:function(e){return lt.access(this,function(e){return e===t?lt.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Q).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=d(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?lt.filter(e,this):this,i=0;null!=(n=r[i]);i++)t||1!==n.nodeType||lt.cleanData(w(n)),n.parentNode&&(t&&lt.contains(n.ownerDocument,n)&&g(w(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&lt.cleanData(w(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&lt.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return lt.clone(this,e,t)})},html:function(e){return lt.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace($t,""):t;if(!("string"!=typeof e||en.test(e)||!lt.support.htmlSerialize&&Jt.test(e)||!lt.support.leadingWhitespace&&Kt.test(e)||un[(Gt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(Qt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(lt.cleanData(w(n,!1)),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=lt.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),lt(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=rt.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,p=e[0],d=lt.isFunction(p);if(d||!(1>=l||"string"!=typeof p||lt.support.checkClone)&&nn.test(p))return this.each(function(r){var i=c.eq(r);d&&(e[0]=p.call(this,r,i.html())),i.domManip(e,t,n)});if(l&&(a=lt.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=a.firstChild,1===a.childNodes.length&&(a=r),r)){for(o=lt.map(w(a,"script"),v),s=o.length;l>f;f++)i=a,f!==h&&(i=lt.clone(i,!0,!0),s&&lt.merge(o,w(i,"script"))),t.call(this[f],i,f);if(s)for(u=o[o.length-1].ownerDocument,lt.map(o,m),f=0;s>f;f++)i=o[f],rn.test(i.type||"")&&!lt._data(i,"globalEval")&&lt.contains(u,i)&&(i.src?lt._evalUrl(i.src):lt.globalEval((i.text||i.textContent||i.innerHTML||"").replace(on,"")));a=r=null}return this}}),lt.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){lt.fn[e]=function(e){for(var n,r=0,i=[],s=lt(e),o=s.length-1;o>=r;r++)n=r===o?this:this.clone(!0),lt(s[r])[t](n),it.apply(i,n.get());return this.pushStack(i)}}),lt.extend({clone:function(e,t,n){var r,i,s,o,u,a=lt.contains(e.ownerDocument,e);if(lt.support.html5Clone||lt.isXMLDoc(e)||!Jt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(fn.innerHTML=e.outerHTML,fn.removeChild(s=fn.firstChild)),!(lt.support.noCloneEvent&&lt.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||lt.isXMLDoc(e)))for(r=w(s),u=w(e),o=0;null!=(i=u[o]);++o)r[o]&&b(i,r[o]);if(t)if(n)for(u=u||w(e),r=r||w(s),o=0;null!=(i=u[o]);o++)y(i,r[o]);else y(e,s);return r=w(s,"script"),r.length>0&&g(r,!a&&w(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){for(var i,s,o,u,a,f,l,c=e.length,h=p(t),d=[],v=0;c>v;v++)if(s=e[v],s||0===s)if("object"===lt.type(s))lt.merge(d,s.nodeType?[s]:s);else if(Zt.test(s)){for(u=u||h.appendChild(t.createElement("div")),a=(Gt.exec(s)||["",""])[1].toLowerCase(),l=un[a]||un._default,u.innerHTML=l[1]+s.replace(Qt,"<$1></$2>")+l[2],i=l[0];i--;)u=u.lastChild;if(!lt.support.leadingWhitespace&&Kt.test(s)&&d.push(t.createTextNode(Kt.exec(s)[0])),!lt.support.tbody)for(s="table"!==a||Yt.test(s)?"<table>"!==l[1]||Yt.test(s)?0:u:u.firstChild,i=s&&s.childNodes.length;i--;)lt.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f);for(lt.merge(d,u.childNodes),u.textContent="";u.firstChild;)u.removeChild(u.firstChild);u=h.lastChild}else d.push(t.createTextNode(s));for(u&&h.removeChild(u),lt.support.appendChecked||lt.grep(w(d,"input"),E),v=0;s=d[v++];)if((!r||-1===lt.inArray(s,r))&&(o=lt.contains(s.ownerDocument,s),u=w(h.appendChild(s),"script"),o&&g(u),n))for(i=0;s=u[i++];)rn.test(s.type||"")&&n.push(s);return u=null,h},cleanData:function(e,t){for(var n,r,i,s,o=0,u=lt.expando,a=lt.cache,f=lt.support.deleteExpando,l=lt.event.special;null!=(n=e[o]);o++)if((t||lt.acceptData(n))&&(i=n[u],s=i&&a[i])){if(s.events)for(r in s.events)l[r]?lt.event.remove(n,r):lt.removeEvent(n,r,s.handle);a[i]&&(delete a[i],f?delete n[u]:typeof n.removeAttribute!==J?n.removeAttribute(u):n[u]=null,tt.push(i))}},_evalUrl:function(e){return lt.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),lt.fn.extend({wrapAll:function(e){if(lt.isFunction(e))return this.each(function(t){lt(this).wrapAll(e.call(this,t))});if(this[0]){var t=lt(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return lt.isFunction(e)?this.each(function(t){lt(this).wrapInner(e.call(this,t))}):this.each(function(){var t=lt(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=lt.isFunction(e);return this.each(function(n){lt(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){lt.nodeName(this,"body")||lt(this).replaceWith(this.childNodes)}).end()}});var ln,cn,hn,pn=/alpha\([^)]*\)/i,dn=/opacity\s*=\s*([^)]*)/,vn=/^(top|right|bottom|left)$/,mn=/^(none|table(?!-c[ea]).+)/,gn=/^margin/,yn=new RegExp("^("+ct+")(.*)$","i"),bn=new RegExp("^("+ct+")(?!px)[a-z%]+$","i"),wn=new RegExp("^([+-])=("+ct+")","i"),En={BODY:"block"},Sn={position:"absolute",visibility:"hidden",display:"block"},xn={letterSpacing:0,fontWeight:400},Tn=["Top","Right","Bottom","Left"],Nn=["Webkit","O","Moz","ms"];lt.fn.extend({css:function(e,n){return lt.access(this,function(e,n,r){var i,s,o={},u=0;if(lt.isArray(n)){for(s=cn(e),i=n.length;i>u;u++)o[n[u]]=lt.css(e,n[u],!1,s);return o}return r!==t?lt.style(e,n,r):lt.css(e,n)},e,n,arguments.length>1)},show:function(){return T(this,!0)},hide:function(){return T(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){x(this)?lt(this).show():lt(this).hide()})}}),lt.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=hn(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":lt.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,u,a=lt.camelCase(n),f=e.style;if(n=lt.cssProps[a]||(lt.cssProps[a]=S(f,a)),u=lt.cssHooks[n]||lt.cssHooks[a],r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];if(o=typeof r,"string"===o&&(s=wn.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(lt.css(e,n)),o="number"),!(null==r||"number"===o&&isNaN(r)||("number"!==o||lt.cssNumber[a]||(r+="px"),lt.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(f[n]="inherit"),u&&"set"in u&&(r=u.set(e,r,i))===t)))try{f[n]=r}catch(l){}}},css:function(e,n,r,i){var s,o,u,a=lt.camelCase(n);return n=lt.cssProps[a]||(lt.cssProps[a]=S(e.style,a)),u=lt.cssHooks[n]||lt.cssHooks[a],u&&"get"in u&&(o=u.get(e,!0,r)),o===t&&(o=hn(e,n,i)),"normal"===o&&n in xn&&(o=xn[n]),""===r||r?(s=parseFloat(o),r===!0||lt.isNumeric(s)?s||0:o):o}}),e.getComputedStyle?(cn=function(t){return e.getComputedStyle(t,null)},hn=function(e,n,r){var i,s,o,u=r||cn(e),a=u?u.getPropertyValue(n)||u[n]:t,f=e.style;return u&&(""!==a||lt.contains(e.ownerDocument,e)||(a=lt.style(e,n)),bn.test(a)&&gn.test(n)&&(i=f.width,s=f.minWidth,o=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=u.width,f.width=i,f.minWidth=s,f.maxWidth=o)),a}):Q.documentElement.currentStyle&&(cn=function(e){return e.currentStyle},hn=function(e,n,r){var i,s,o,u=r||cn(e),a=u?u[n]:t,f=e.style;return null==a&&f&&f[n]&&(a=f[n]),bn.test(a)&&!vn.test(n)&&(i=f.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),f.left="fontSize"===n?"1em":a,a=f.pixelLeft+"px",f.left=i,o&&(s.left=o)),""===a?"auto":a}),lt.each(["height","width"],function(e,t){lt.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&mn.test(lt.css(e,"display"))?lt.swap(e,Sn,function(){return k(e,t,r)}):k(e,t,r):void 0},set:function(e,n,r){var i=r&&cn(e);return N(e,n,r?C(e,t,r,lt.support.boxSizing&&"border-box"===lt.css(e,"boxSizing",!1,i),i):0)}}}),lt.support.opacity||(lt.cssHooks.opacity={get:function(e,t){return dn.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=lt.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===lt.trim(s.replace(pn,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=pn.test(s)?s.replace(pn,i):s+" "+i)}}),lt(function(){lt.support.reliableMarginRight||(lt.cssHooks.marginRight={get:function(e,t){return t?lt.swap(e,{display:"inline-block"},hn,[e,"marginRight"]):void 0}}),!lt.support.pixelPosition&&lt.fn.position&&lt.each(["top","left"],function(e,t){lt.cssHooks[t]={get:function(e,n){return n?(n=hn(e,t),bn.test(n)?lt(e).position()[t]+"px":n):void 0}}})}),lt.expr&&lt.expr.filters&&(lt.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!lt.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||lt.css(e,"display"))},lt.expr.filters.visible=function(e){return!lt.expr.filters.hidden(e)}),lt.each({margin:"",padding:"",border:"Width"},function(e,t){lt.cssHooks[e+t]={expand:function(n){for(var r=0,i={},s="string"==typeof n?n.split(" "):[n];4>r;r++)i[e+Tn[r]+t]=s[r]||s[r-2]||s[0];return i}},gn.test(e)||(lt.cssHooks[e+t].set=N)});var Cn=/%20/g,kn=/\[\]$/,Ln=/\r?\n/g,An=/^(?:submit|button|image|reset|file)$/i,On=/^(?:input|select|textarea|keygen)/i;lt.fn.extend({serialize:function(){return lt.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=lt.prop(this,"elements");return e?lt.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!lt(this).is(":disabled")&&On.test(this.nodeName)&&!An.test(e)&&(this.checked||!tn.test(e))}).map(function(e,t){var n=lt(this).val();return null==n?null:lt.isArray(n)?lt.map(n,function(e){return{name:t.name,value:e.replace(Ln,"\r\n")}}):{name:t.name,value:n.replace(Ln,"\r\n")}}).get()}}),lt.param=function(e,n){var r,i=[],s=function(e,t){t=lt.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=lt.ajaxSettings&&lt.ajaxSettings.traditional),lt.isArray(e)||e.jquery&&!lt.isPlainObject(e))lt.each(e,function(){s(this.name,this.value)});else for(r in e)O(r,e[r],n,s);return i.join("&").replace(Cn,"+")},lt.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){lt.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),lt.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Mn,_n,Dn=lt.now(),Pn=/\?/,Hn=/#.*$/,Bn=/([?&])_=[^&]*/,jn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Fn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,In=/^(?:GET|HEAD)$/,qn=/^\/\//,Rn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Un=lt.fn.load,zn={},Wn={},Xn="*/".concat("*");try{_n=K.href}catch(Vn){_n=Q.createElement("a"),_n.href="",_n=_n.href}Mn=Rn.exec(_n.toLowerCase())||[],lt.fn.load=function(e,n,r){if("string"!=typeof e&&Un)return Un.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),lt.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(o="POST"),u.length>0&&lt.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){s=arguments,u.html(i?lt("<div>").append(lt.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,s||[e.responseText,t,e])}),this},lt.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){lt.fn[t]=function(e){return this.on(t,e)}}),lt.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_n,type:"GET",isLocal:Fn.test(Mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Xn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":lt.parseJSON,"text xml":lt.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?D(D(e,lt.ajaxSettings),t):D(lt.ajaxSettings,e)},ajaxPrefilter:M(zn),ajaxTransport:M(Wn),ajax:function(e,n){function r(e,n,r,i){var s,c,y,b,E,x=n;2!==w&&(w=2,a&&clearTimeout(a),l=t,u=i||"",S.readyState=e>0?4:0,s=e>=200&&300>e||304===e,r&&(b=P(h,S,r)),b=H(h,b,S,s),s?(h.ifModified&&(E=S.getResponseHeader("Last-Modified"),E&&(lt.lastModified[o]=E),E=S.getResponseHeader("etag"),E&&(lt.etag[o]=E)),204===e||"HEAD"===h.type?x="nocontent":304===e?x="notmodified":(x=b.state,c=b.data,y=b.error,s=!y)):(y=x,(e||!x)&&(x="error",0>e&&(e=0))),S.status=e,S.statusText=(n||x)+"",s?v.resolveWith(p,[c,x,S]):v.rejectWith(p,[S,x,y]),S.statusCode(g),g=t,f&&d.trigger(s?"ajaxSuccess":"ajaxError",[S,h,s?c:y]),m.fireWith(p,[S,x]),f&&(d.trigger("ajaxComplete",[S,h]),--lt.active||lt.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var i,s,o,u,a,f,l,c,h=lt.ajaxSetup({},n),p=h.context||h,d=h.context&&(p.nodeType||p.jquery)?lt(p):lt.event,v=lt.Deferred(),m=lt.Callbacks("once memory"),g=h.statusCode||{},y={},b={},w=0,E="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(2===w){if(!c)for(c={};t=jn.exec(u);)c[t[1].toLowerCase()]=t[2];t=c[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===w?u:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return w||(e=b[n]=b[n]||e,y[e]=t),this},overrideMimeType:function(e){return w||(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>w)for(t in e)g[t]=[g[t],e[t]];else S.always(e[S.status]);return this},abort:function(e){var t=e||E;return l&&l.abort(t),r(0,t),this}};if(v.promise(S).complete=m.add,S.success=S.done,S.error=S.fail,h.url=((e||h.url||_n)+"").replace(Hn,"").replace(qn,Mn[1]+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=lt.trim(h.dataType||"*").toLowerCase().match(ht)||[""],null==h.crossDomain&&(i=Rn.exec(h.url.toLowerCase()),h.crossDomain=!(!i||i[1]===Mn[1]&&i[2]===Mn[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(Mn[3]||("http:"===Mn[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=lt.param(h.data,h.traditional)),_(zn,h,n,S),2===w)return S;f=h.global,f&&0===lt.active++&&lt.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!In.test(h.type),o=h.url,h.hasContent||(h.data&&(o=h.url+=(Pn.test(o)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=Bn.test(o)?o.replace(Bn,"$1_="+Dn++):o+(Pn.test(o)?"&":"?")+"_="+Dn++)),h.ifModified&&(lt.lastModified[o]&&S.setRequestHeader("If-Modified-Since",lt.lastModified[o]),lt.etag[o]&&S.setRequestHeader("If-None-Match",lt.etag[o])),(h.data&&h.hasContent&&h.contentType!==!1||n.contentType)&&S.setRequestHeader("Content-Type",h.contentType),S.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+Xn+"; q=0.01":""):h.accepts["*"]);for(s in h.headers)S.setRequestHeader(s,h.headers[s]);if(!h.beforeSend||h.beforeSend.call(p,S,h)!==!1&&2!==w){E="abort";for(s in{success:1,error:1,complete:1})S[s](h[s]);if(l=_(Wn,h,n,S)){S.readyState=1,f&&d.trigger("ajaxSend",[S,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){S.abort("timeout")},h.timeout));try{w=1,l.send(y,r)}catch(x){if(!(2>w))throw x;r(-1,x)}}else r(-1,"No Transport");return S}return S.abort()},getJSON:function(e,t,n){return lt.get(e,t,n,"json")},getScript:function(e,n){return lt.get(e,t,n,"script")}}),lt.each(["get","post"],function(e,n){lt[n]=function(e,r,i,s){return lt.isFunction(r)&&(s=s||i,i=r,r=t),lt.ajax({url:e,type:n,dataType:s,data:r,success:i})}}),lt.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return lt.globalEval(e),e}}}),lt.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),lt.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=Q.head||lt("head")[0]||Q.documentElement;return{send:function(t,i){n=Q.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var $n=[],Jn=/(=)\?(?=&|$)|\?\?/;lt.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=$n.pop()||lt.expando+"_"+Dn++;return this[e]=!0,e}}),lt.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.jsonp!==!1&&(Jn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Jn.test(n.data)&&"data");return a||"jsonp"===n.dataTypes[0]?(s=n.jsonpCallback=lt.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a?n[a]=n[a].replace(Jn,"$1"+s):n.jsonp!==!1&&(n.url+=(Pn.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||lt.error(s+" was not called"),u[0]},n.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,$n.push(s)),u&&lt.isFunction(o)&&o(u[0]),u=o=t}),"script"):void 0});var Kn,Qn,Gn=0,Yn=e.ActiveXObject&&function(){var e;for(e in Kn)Kn[e](t,!0)};lt.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&B()||j()}:B,Qn=lt.ajaxSettings.xhr(),lt.support.cors=!!Qn&&"withCredentials"in Qn,Qn=lt.support.ajax=!!Qn,Qn&&lt.ajaxTransport(function(n){if(!n.crossDomain||lt.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();if(n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async),n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c;try{if(r&&(i||4===a.readyState))if(r=t,o&&(a.onreadystatechange=lt.noop,Yn&&delete Kn[o]),i)4!==a.readyState&&a.abort();else{c={},u=a.status,f=a.getAllResponseHeaders(),"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(h){l=""}u||!n.isLocal||n.crossDomain?1223===u&&(u=204):u=c.text?200:404}}catch(p){i||s(-1,p)}c&&s(u,l,c,f)},n.async?4===a.readyState?setTimeout(r):(o=++Gn,Yn&&(Kn||(Kn={},lt(e).unload(Yn)),Kn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Zn,er,tr=/^(?:toggle|show|hide)$/,nr=new RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),rr=/queueHooks$/,ir=[U],sr={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=nr.exec(t),s=i&&i[3]||(lt.cssNumber[e]?"":"px"),o=(lt.cssNumber[e]||"px"!==s&&+r)&&nr.exec(lt.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,lt.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};lt.Animation=lt.extend(q,{tweener:function(e,t){lt.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,i=e.length;i>r;r++)n=e[r],sr[n]=sr[n]||[],sr[n].unshift(t)},prefilter:function(e,t){t?ir.unshift(e):ir.push(e)}}),lt.Tween=z,z.prototype={constructor:z,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(lt.cssNumber[n]?"":"px")},cur:function(){var e=z.propHooks[this.prop];return e&&e.get?e.get(this):z.propHooks._default.get(this)},run:function(e){var t,n=z.propHooks[this.prop];return this.pos=t=this.options.duration?lt.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):z.propHooks._default.set(this),this}},z.prototype.init.prototype=z.prototype,z.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=lt.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){lt.fx.step[e.prop]?lt.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[lt.cssProps[e.prop]]||lt.cssHooks[e.prop])?lt.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},z.propHooks.scrollTop=z.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},lt.each(["toggle","show","hide"],function(e,t){var n=lt.fn[t];lt.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(W(t,!0),e,r,i)}}),lt.fn.extend({fadeTo:function(e,t,n,r){return this.filter(x).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=lt.isEmptyObject(e),s=lt.speed(t,n,r),o=function(){var t=q(this,lt.extend({},e),s);(i||lt._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",s=lt.timers,o=lt._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&rr.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem!==this||null!=e&&s[n].queue!==e||(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&lt.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=lt._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=lt.timers,o=r?r.length:0;for(n.finish=!0,lt.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),lt.each({slideDown:W("show"),slideUp:W("hide"),slideToggle:W("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){lt.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),lt.speed=function(e,t,n){var r=e&&"object"==typeof e?lt.extend({},e):{complete:n||!n&&t||lt.isFunction(e)&&e,duration:e,easing:n&&t||t&&!lt.isFunction(t)&&t};return r.duration=lt.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in lt.fx.speeds?lt.fx.speeds[r.duration]:lt.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){lt.isFunction(r.old)&&r.old.call(this),r.queue&&lt.dequeue(this,r.queue)},r},lt.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},lt.timers=[],lt.fx=z.prototype.init,lt.fx.tick=function(){var e,n=lt.timers,r=0;for(Zn=lt.now();r<n.length;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||lt.fx.stop(),Zn=t},lt.fx.timer=function(e){e()&&lt.timers.push(e)&&lt.fx.start()},lt.fx.interval=13,lt.fx.start=function(){er||(er=setInterval(lt.fx.tick,lt.fx.interval))},lt.fx.stop=function(){clearInterval(er),er=null},lt.fx.speeds={slow:600,fast:200,_default:400},lt.fx.step={},lt.expr&&lt.expr.filters&&(lt.expr.filters.animated=function(e){return lt.grep(lt.timers,function(t){return e===t.elem}).length}),lt.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){lt.offset.setOffset(this,e,t)});var n,r,i={top:0,left:0},s=this[0],o=s&&s.ownerDocument;if(o)return n=o.documentElement,lt.contains(n,s)?(typeof s.getBoundingClientRect!==J&&(i=s.getBoundingClientRect()),r=X(o),{top:i.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:i.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):i},lt.offset={setOffset:function(e,t,n){var r=lt.css(e,"position");"static"===r&&(e.style.position="relative");var i,s,o=lt(e),u=o.offset(),a=lt.css(e,"top"),f=lt.css(e,"left"),l=("absolute"===r||"fixed"===r)&&lt.inArray("auto",[a,f])>-1,c={},h={};l?(h=o.position(),i=h.top,s=h.left):(i=parseFloat(a)||0,s=parseFloat(f)||0),lt.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(c.top=t.top-u.top+i),null!=t.left&&(c.left=t.left-u.left+s),"using"in t?t.using.call(e,c):o.css(c)}},lt.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===lt.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),lt.nodeName(e[0],"html")||(n=e.offset()),n.top+=lt.css(e[0],"borderTopWidth",!0),n.left+=lt.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-lt.css(r,"marginTop",!0),left:t.left-n.left-lt.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||G;e&&!lt.nodeName(e,"html")&&"static"===lt.css(e,"position");)e=e.offsetParent;return e||G})}}),lt.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);lt.fn[e]=function(i){return lt.access(this,function(e,i,s){var o=X(e);return s===t?o?n in o?o[n]:o.document.documentElement[i]:e[i]:(o?o.scrollTo(r?lt(o).scrollLeft():s,r?s:lt(o).scrollTop()):e[i]=s,void 0)},e,i,arguments.length,null)}}),lt.each({Height:"height",Width:"width"},function(e,n){lt.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){lt.fn[i]=function(i,s){var o=arguments.length&&(r||"boolean"!=typeof i),u=r||(i===!0||s===!0?"margin":"border");return lt.access(this,function(n,r,i){var s;return lt.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?lt.css(n,r,u):lt.style(n,r,i,u)},n,o?i:t,o,null)}})}),lt.fn.size=function(){return this.length},lt.fn.andSelf=lt.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=lt:(e.jQuery=e.$=lt,"function"==typeof define&&define.amd&&define("jquery",[],function(){return lt}))}(window),window.Backbone||!function(){var e,t=this,n=t.Backbone,r=[],i=r.push,s=r.slice,o=r.splice;e="undefined"!=typeof exports?exports:t.Backbone={},e.VERSION="1.0.0";var u=t._;u||"undefined"==typeof require||(u=require("underscore")),e.$=t.jQuery||t.Zepto||t.ender||t.$,e.noConflict=function(){return t.Backbone=n,this},e.emulateHTTP=!1,e.emulateJSON=!1;var a=e.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(o=e?[e]:u.keys(this._events),a=0,f=o.length;f>a;a++)if(e=o[a],s=this._events[e]){if(this._events[e]=r=[],t||n)for(c=0,h=s.length;h>c;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;"object"==typeof t&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){for(var s=n.split(f),o=0,u=s.length;u>o;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:for(;++r<i;)(n=e[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s);return;case 2:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:for(;++r<i;)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:for(;++r<i;)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=u.uniqueId("l"));return i[s]=t,"object"==typeof n&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(e,a);var p=e.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(t,d)),t.parse&&(r=this.parse(r,t)||{}),(n=u.result(this,"defaults"))&&(r=u.defaults({},r,n)),this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return u.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(null==e)return this;if("object"==typeof e?(i=e,n=t):(i={})[e]=t,n||(n={}),!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;p>h;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e)u.isEqual(r[i],t=e[i])||((n||(n={}))[i]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){return t.set(t.parse(r,e),e)?(n&&n(t,r,e),t.trigger("sync",t,r,e),void 0):!1},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;if(null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t,!(!r||n&&n.wait||this.set(r,n)))return!1;if(n=u.extend({validate:!0},n),!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),void 0===n.parse&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);return n.wait&&(t=u.extend(r||{},t)),u.isObject(t)&&!a.set(t,n)?!1:(f&&f(a,e,n),a.trigger("sync",a,e,n),void 0)},j(this,n),i=this.isNew()?"create":n.patch?"patch":"update","patch"===i&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;j(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||B();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t||{},{validationError:n})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(e){p.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var m=e.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};u.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.defaults(t||{},y))},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;r>n;n++)s=this.get(e[n]),s&&(delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s));return this},set:function(e,t){t=u.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),u.isArray(e)||(e=e?[e]:[]);var n,r,s,a,f,l=t.at,c=this.comparator&&null==l&&t.sort!==!1,h=u.isString(this.comparator)?this.comparator:null,p=[],d=[],v={};for(n=0,r=e.length;r>n;n++)(s=this._prepareModel(e[n],t))&&((a=this.get(s))?(t.remove&&(v[a.cid]=!0),t.merge&&(a.set(s.attributes,t),c&&!f&&a.hasChanged(h)&&(f=!0))):t.add&&(p.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)));if(t.remove){for(n=0,r=this.length;r>n;++n)v[(s=this.models[n]).cid]||d.push(s);d.length&&this.remove(d,t)}if(p.length&&(c&&(f=!0),this.length+=p.length,null!=l?o.apply(this.models,[l,0].concat(p)):i.apply(this.models,p)),f&&this.sort({silent:!0}),t.silent)return this;for(n=0,r=p.length;r>n;n++)(s=p[n]).trigger("add",s,this,t);return f&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?u.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(e){m.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var w=["groupBy","countBy","sortBy"];u.each(w,function(e){m.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var E=e.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];u.extend(E.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,n){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(u.isFunction(n)||(n=this[e[t]]),n){var r=t.match(S),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,""===s?this.$el.on(i,n):this.$el.on(i,s,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,x)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(u.result(this,"el"),!1);else{var t=u.extend({},u.result(this,"attributes"));this.id&&(t.id=u.result(this,"id")),this.className&&(t["class"]=u.result(this,"className"));var n=e.$("<"+u.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}}),e.sync=function(t,n,r){var i=T[t];u.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:i,dataType:"json"};if(r.url||(s.url=u.result(n,"url")||B()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===i||"DELETE"===i||"PATCH"===i)){s.type="POST",r.emulateJSON&&(s.data._method=i);var o=r.beforeSend;r.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",i),o?o.apply(this,arguments):void 0}}"GET"===s.type||r.emulateJSON||(s.processData=!1),"PATCH"!==s.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=r.xhr=e.ajax(u.extend(s,r));return n.trigger("request",n,a,r),a};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var N=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(t,n,r){u.isRegExp(t)||(t=this._routeToRegExp(t)),u.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var i=this;return e.history.route(t,function(s){var o=i._extractParameters(t,s);r&&r.apply(i,o),i.trigger.apply(i,["route:"+n].concat(o)),i.trigger("route",n,o),e.history.trigger("route",i,n,o)}),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=u.result(this,"routes");for(var e,t=u.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=e.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(t){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,i=D.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);this.root=("/"+this.root+"/").replace(_,"/"),i&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var s=this.location,o=s.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&s.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+s.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return n},navigate:function(e,t){if(!O.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),e.history=new O;var H=function(e,t){var n,r=this;n=e&&u.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},u.extend(n,r,t);var i=function(){this.constructor=n};return i.prototype=r.prototype,n.prototype=new i,e&&u.extend(n.prototype,e),n.__super__=r.prototype,n};p.extend=m.extend=N.extend=E.extend=O.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this);if(!window.Backbone.Marionette){Backbone.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength()},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===n?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[n],this._updateLength()},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(r){t.isFunction(r[e])&&r[e].apply(r,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return t.each(r,function(e){n.prototype[e]=function(){var n=t.values(this._views),r=[n].concat(t.toArray(arguments));return t[e].apply(t,r)}}),n}(Backbone,_),Backbone.Wreqr=function(e,t,n){var r={};return r.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var r=null;t.isObject(e)&&!t.isFunction(e)&&(r=e.context,e=e.callback),this.setHandler(n,e,r)},this)},setHandler:function(e,t,n){var r={callback:t,context:n};this._wreqrHandlers[e]=r,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(!t)throw new Error("Handler not found for '"+e+"'");return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,n),r.CommandStorage=function(){var t=function(e){this.options=e,this._commands={},n.isFunction(this.initialize)&&this.initialize(e)};return n.extend(t.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),t}(),r.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,n)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,t,r){var i=this.storage.getCommands(e);n.each(i.instances,function(e){t.apply(r,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var t,r=e.storageType||this.storageType;t=n.isFunction(r)?new r:r,this.storage=t}})}(r),r.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return this.getHandler(e).apply(this,t)}})}(r),r.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,n),r}(Backbone,Backbone.Marionette,_);var Marionette=function(e,t,n){function r(e){return o.call(e)}function i(e,t){var n=new Error(e);throw n.name=t||"Error",n}var s={};t.Marionette=s,s.$=t.$;var o=Array.prototype.slice;return s.extend=t.Model.extend,s.getOption=function(e,t){if(e&&t){var n;return n=e.options&&t in e.options&&void 0!==e.options[t]?e.options[t]:e[t]}},s.triggerMethod=function(){function e(e,t,n){return n.toUpperCase()}var t=/(^|:)(\w)/gi,r=function(r){var i="on"+r.replace(t,e),s=this[i];return n.isFunction(this.trigger)&&this.trigger.apply(this,arguments),n.isFunction(s)?s.apply(this,n.tail(arguments)):void 0};return r}(),s.MonitorDOMRefresh=function(){function e(e){e._isShown=!0,r(e)}function t(e){e._isRendered=!0,r(e)}function r(e){e._isShown&&e._isRendered&&n.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}return function(n){n.listenTo(n,"show",function(){e(n)}),n.listenTo(n,"render",function(){t(n)})}}(),function(e){function t(e,t,r,s){var o=s.split(/\s+/);n.each(o,function(n){var s=e[n];s||i("Method '"+n+"' was configured as an event handler, but does not exist."),e.listenTo(t,r,s,e)})}function r(e,t,n,r){e.listenTo(t,n,r,e)}function s(e,t,r,i){var s=i.split(/\s+/);n.each(s,function(n){var i=e[n];e.stopListening(t,r,i,e)})}function o(e,t,n,r){e.stopListening(t,n,r,e)}function u(e,t,r,i,s){t&&r&&(n.isFunction(r)&&(r=r.call(e)),n.each(r,function(r,o){n.isFunction(r)?i(e,t,o,r):s(e,t,o,r)}))}e.bindEntityEvents=function(e,n,i){u(e,n,i,r,t)},e.unbindEntityEvents=function(e,t,n){u(e,t,n,o,s)}}(s),s.Callbacks=function(){this._deferred=s.$.Deferred(),this._callbacks=[]},n.extend(s.Callbacks.prototype,{add:function(e,t){this._callbacks.push({cb:e,ctx:t}),this._deferred.done(function(n,r){t&&(n=t),e.call(n,r)})},run:function(e,t){this._deferred.resolve(t,e)},reset:function(){var e=this._callbacks;this._deferred=s.$.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),s.Controller=function(e){this.triggerMethod=s.triggerMethod,this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},s.Controller.extend=s.extend,n.extend(s.Controller.prototype,t.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),s.Region=function(e){if(this.options=e||{},this.el=s.getOption(this,"el"),!this.el){var t=new Error("An 'el' must be specified for a region.");throw t.name="NoElError",t}if(this.initialize){var n=Array.prototype.slice.apply(arguments);this.initialize.apply(this,n)}},n.extend(s.Region,{buildRegion:function(e,t){var r="string"==typeof e,i="string"==typeof e.selector,s="undefined"==typeof e.regionType,o="function"==typeof e;if(!o&&!r&&!i)throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");var u,a;r&&(u=e),e.selector&&(u=e.selector),o&&(a=e),!o&&s&&(a=t),e.regionType&&(a=e.regionType);var f=new a({el:u});return e.parentEl&&(f.getEl=function(t){var r=e.parentEl;return n.isFunction(r)&&(r=r()),r.find(t)}),f}}),n.extend(s.Region.prototype,t.Events,{show:function(e){this.ensureEl();var t=e.isClosed||n.isUndefined(e.$el),r=e!==this.currentView;r&&this.close(),e.render(),(r||t)&&this.open(e),this.currentView=e,s.triggerMethod.call(this,"show",e),s.triggerMethod.call(e,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(e){return s.$(e)},open:function(e){this.$el.empty().append(e.el)},close:function(){var e=this.currentView;e&&!e.isClosed&&(e.close?e.close():e.remove&&e.remove(),s.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(e){this.currentView=e},reset:function(){this.close(),delete this.$el}}),s.Region.extend=s.extend,s.RegionManager=function(e){var t=e.Controller.extend({constructor:function(t){this._regions={},e.Controller.prototype.constructor.call(this,t)},addRegions:function(e,t){var r={};return n.each(e,function(e,i){"string"==typeof e&&(e={selector:e}),e.selector&&(e=n.defaults({},e,t));var s=this.addRegion(i,e);r[i]=s},this),r},addRegion:function(t,r){var i,s=n.isObject(r),o=n.isString(r),u=!!r.selector;return i=o||s&&u?e.Region.buildRegion(r,e.Region):n.isFunction(r)?e.Region.buildRegion(r,e.Region):r,this._store(t,i),this.triggerMethod("region:add",t,i),i},get:function(e){return this._regions[e]},removeRegion:function(e){var t=this._regions[e];this._remove(e,t)},removeRegions:function(){n.each(this._regions,function(e,t){this._remove(t,e)},this)},closeRegions:function(){n.each(this._regions,function(e){e.close()},this)},close:function(){this.removeRegions();var t=Array.prototype.slice.call(arguments);e.Controller.prototype.close.apply(this,t)},_store:function(e,t){this._regions[e]=t,this._setLength()},_remove:function(e,t){t.close(),delete this._regions[e],this._setLength(),this.triggerMethod("region:remove",e,t)},_setLength:function(){this.length=n.size(this._regions)}}),r=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return n.each(r,function(e){t.prototype[e]=function(){var t=n.values(this._regions),r=[t].concat(n.toArray(arguments));return n[e].apply(n,r)}}),t}(s),s.TemplateCache=function(e){this.templateId=e},n.extend(s.TemplateCache,{templateCaches:{},get:function(e){var t=this.templateCaches[e];return t||(t=new s.TemplateCache(e),this.templateCaches[e]=t),t.load()},clear:function(){var e,t=r(arguments),n=t.length;if(n>0)for(e=0;n>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(s.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var e=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(e),this.compiledTemplate},loadTemplate:function(e){var t=s.$(e).html();return t&&0!==t.length||i("Could not find template: '"+e+"'","NoTemplateError"),t},compileTemplate:function(e){return n.template(e)}}),s.Renderer={render:function(e,t){if(!e){var n=new Error("Cannot render the template since it's false, null or undefined.");throw n.name="TemplateNotFoundError",n}var r;return r="function"==typeof e?e:s.TemplateCache.get(e),r(t)}},s.View=t.View.extend({constructor:function(){n.bindAll(this,"render");var e=Array.prototype.slice.apply(arguments);t.View.prototype.constructor.apply(this,e),s.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:s.triggerMethod,getTemplate:function(){return s.getOption(this,"template")},mixinTemplateHelpers:function(e){e=e||{};var t=s.getOption(this,"templateHelpers");return n.isFunction(t)&&(t=t.call(this)),n.extend(e,t)},configureTriggers:function(){if(this.triggers){var e={},t=n.result(this,"triggers");return n.each(t,function(t,n){e[n]=function(e){e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation();var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(t,n)}},this),e}},delegateEvents:function(e){this._delegateDOMEvents(e),s.bindEntityEvents(this,this.model,s.getOption(this,"modelEvents")),s.bindEntityEvents(this,this.collection,s.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(e){e=e||this.events,n.isFunction(e)&&(e=e.call(this));var r={},i=this.configureTriggers();n.extend(r,e,i),t.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){var e=Array.prototype.slice.call(arguments);t.View.prototype.undelegateEvents.apply(this,e),s.unbindEntityEvents(this,this.model,s.getOption(this,"modelEvents")),s.unbindEntityEvents(this,this.collection,s.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var e=this.triggerMethod("before:close");e!==!1&&(this.isClosed=!0,this.triggerMethod("close"),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(n.keys(e),function(t){var n=e[t];this.ui[t]=this.$(n)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),s.ItemView=s.View.extend({constructor:function(){s.View.prototype.constructor.apply(this,r(arguments))},serializeData:function(){var e={};return this.model?e=this.model.toJSON():this.collection&&(e={items:this.collection.toJSON()}),e},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var e=this.serializeData();e=this.mixinTemplateHelpers(e);var t=this.getTemplate(),n=s.Renderer.render(t,e);return this.$el.html(n),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),s.View.prototype.close.apply(this,r(arguments)),this.triggerMethod("item:closed"))}}),s.CollectionView=s.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),s.View.prototype.constructor.apply(this,r(arguments)),this._initialEvents()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(e){this.closeEmptyView();var t=this.getItemView(e),n=this.collection.indexOf(e);this.addItemView(e,t,n)},onShowCalled:function(){this.children.each(function(e){s.triggerMethod.call(e,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.closeEmptyView(),this.closeChildren(),this.collection&&this.collection.length>0?this.showCollection():this.showEmptyView()},showCollection:function(){var e;this.collection.each(function(t,n){e=this.getItemView(t),this.addItemView(t,e,n)},this)},showEmptyView:function(){var e=s.getOption(this,"emptyView");if(e&&!this._showingEmptyView){this._showingEmptyView=!0;var n=new t.Model;this.addItemView(n,e,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getItemView:function(){var e=s.getOption(this,"itemView");return e||i("An `itemView` must be specified","NoItemViewError"),e},addItemView:function(e,t,r){var i=s.getOption(this,"itemViewOptions");n.isFunction(i)&&(i=i.call(this,e,r));var o=this.buildItemView(e,t,i);this.addChildViewEventForwarding(o),this.triggerMethod("before:item:added",o),this.children.add(o),this.renderItemView(o,r),this._isShown&&s.triggerMethod.call(o,"show"),this.triggerMethod("after:item:added",o)},addChildViewEventForwarding:function(e){var t=s.getOption(this,"itemViewEventPrefix");this.listenTo(e,"all",function(){var n=r(arguments);n[0]=t+":"+n[0],n.splice(1,0,e),s.triggerMethod.apply(this,n)},this)},renderItemView:function(e,t){e.render(),this.appendHtml(this,e,t)},buildItemView:function(e,t,r){var i=n.extend({model:e},r);return new t(i)},removeItemView:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},removeChildView:function(e){e&&(this.stopListening(e),e.close?e.close():e.remove&&e.remove(),this.children.remove(e)),this.triggerMethod("item:removed",e)},checkEmpty:function(){this.collection&&0!==this.collection.length||this.showEmptyView()},appendHtml:function(e,t){e.$el.append(t.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),s.View.prototype.close.apply(this,r(arguments)))},closeChildren:function(){this.children.each(function(e){this.removeChildView(e)},this),this.checkEmpty()}}),s.CompositeView=s.CollectionView.extend({constructor:function(){s.CollectionView.prototype.constructor.apply(this,r(arguments))},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this._renderChildren,this))},getItemView:function(){var e=s.getOption(this,"itemView")||this.constructor;return e||i("An `itemView` must be specified","NoItemViewError"),e},serializeData:function(){var e={};return this.model&&(e=this.model.toJSON()),e},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var e=this.renderModel();return this.$el.html(e),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(s.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e);var t=this.getTemplate();return s.Renderer.render(t,e)},appendHtml:function(e,t){var n=this.getItemViewContainer(e);n.append(t.el)},getItemViewContainer:function(e){if("$itemViewContainer"in e)return e.$itemViewContainer;var t,r=s.getOption(e,"itemViewContainer");if(r){var o=n.isFunction(r)?r():r;t=e.$(o),t.length<=0&&i("The specified `itemViewContainer` was not found: "+e.itemViewContainer,"ItemViewContainerMissingError")}else t=e.$el;return e.$itemViewContainer=t,t},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),s.Layout=s.ItemView.extend({regionType:s.Region,constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),s.ItemView.prototype.constructor.call(this,e)},render:function(){this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions();var e=Array.prototype.slice.apply(arguments),t=s.ItemView.prototype.render.apply(this,e);return t},close:function(){if(!this.isClosed){this.regionManager.close();var e=Array.prototype.slice.apply(arguments);s.ItemView.prototype.close.apply(this,e)}},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},_buildRegions:function(e){var t=this,n={regionType:s.getOption(this,"regionType"),parentEl:function(){return t.$el}};return this.regionManager.addRegions(e,n)},_initializeRegions:function(e){var t;this._initRegionManager(),t=n.isFunction(this.regions)?this.regions(e):this.regions||{},this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(e){e.reset()})},_initRegionManager:function(){this.regionManager=new s.RegionManager,this.listenTo(this.regionManager,"region:add",function(e,t){this[e]=t,this.trigger("region:add",e,t)}),this.listenTo(this.regionManager,"region:remove",function(e,t){delete this[e],this.trigger("region:remove",e,t)})}}),s.AppRouter=t.Router.extend({constructor:function(e){t.Router.prototype.constructor.apply(this,r(arguments)),this.options=e||{};var n=s.getOption(this,"appRoutes"),i=this._getController();this.processAppRoutes(i,n)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},processAppRoutes:function(e,t){if(t){var r=n.keys(t).reverse();n.each(r,function(n){this._addAppRoute(e,n,t[n])},this)}},_getController:function(){return s.getOption(this,"controller")},_addAppRoute:function(e,t,r){var i=e[r];if(!i)throw new Error("Method '"+r+"' was not found on the controller");this.route(t,r,n.bind(i,e))}}),s.Application=function(e){this._initRegionManager(),this._initCallbacks=new s.Callbacks,this.vent=new t.Wreqr.EventAggregator,this.commands=new t.Wreqr.Commands,this.reqres=new t.Wreqr.RequestResponse,this.submodules={},n.extend(this,e),this.triggerMethod=s.triggerMethod},n.extend(s.Application.prototype,t.Events,{execute:function(){var e=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,e)},request:function(){var e=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,e)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("initialize:before",e),this._initCallbacks.run(e,this),this.triggerMethod("initialize:after",e),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(e){this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},module:function(){var e=r(arguments);return e.unshift(this),s.Module.create.apply(s.Module,e)},_initRegionManager:function(){this._regionManager=new s.RegionManager,this.listenTo(this._regionManager,"region:add",function(e,t){this[e]=t}),this.listenTo(this._regionManager,"region:remove",function(e){delete this[e]})}}),s.Application.extend=s.extend,s.Module=function(e,t){this.moduleName=e,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,this.startWithParent=!0,this.triggerMethod=s.triggerMethod},n.extend(s.Module.prototype,t.Events,{addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,s.triggerMethod.call(this,"before:stop"),n.each(this.submodules,function(e){e.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),s.triggerMethod.call(this,"stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,r){if(e){var i=n.flatten([this,this.app,t,s,s.$,n,r]);e.apply(this,i)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new s.Callbacks,this._finalizerCallbacks=new s.Callbacks}}),n.extend(s.Module,{create:function(e,t,i){var s=e,o=r(arguments);o.splice(0,3),t=t.split(".");var u=t.length,a=[];return a[u-1]=i,n.each(t,function(t,n){var r=s;s=this._getModule(r,t,e),this._addModuleDefinition(r,s,a[n],o)},this),s},_getModule:function(e,t,n){var r=e[t];return r||(r=new s.Module(t,n),e[t]=r,e.submodules[t]=r),r},_addModuleDefinition:function(e,t,r,i){var s,o;n.isFunction(r)?(s=r,o=!0):n.isObject(r)?(s=r.define,o=r.startWithParent):o=!0,s&&t.addDefinition(s,i),t.startWithParent=t.startWithParent&&o,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),s}(this,Backbone,_)}window.Processing||!function(e,t,n,r){function i(t,n){return t in e?e[t]:"function"==typeof e[n]?e[n]:function(e){if(e instanceof Array)return e;if("number"==typeof e){var t=[];return t.length=e,t}}}function s(e){if("string"==typeof e){for(var t=0,i=0;i<e.length;++i)t=4294967295&31*t+e.charCodeAt(i);return t}return"object"!=typeof e?4294967295&e:e.hashCode instanceof Function?e.hashCode():(e.$id===r&&(e.$id=n.floor(65536*n.random())-32768<<16|n.floor(65536*n.random())),e.$id)}function o(e,t){return null===e||null===t?null===e&&null===t:"string"==typeof e?e===t:"object"!=typeof e?e===t:e.equals instanceof Function?e.equals(t):e===t}function u(){}function a(e,t,n){if(!e.hasOwnProperty(t)||"function"!=typeof e[t])return e[t]=n,void 0;var r=e[t];if("$overloads"in r)return r.$defaultOverload=n,void 0;if("$overloads"in n||r.length!==n.length){var i,s;"$overloads"in n?(i=n.$overloads.slice(0),i[r.length]=r,s=n.$defaultOverload):(i=[],i[n.length]=n,i[r.length]=r,s=r);var o=function(){var e=o.$overloads[arguments.length]||("$methodArgsIndex"in o&&arguments.length>o.$methodArgsIndex?o.$overloads[o.$methodArgsIndex]:null)||o.$defaultOverload;return e.apply(this,arguments)};o.$overloads=i,"$methodArgsIndex"in n&&(o.$methodArgsIndex=n.$methodArgsIndex),o.$defaultOverload=s,o.name=t,e[t]=o}}function f(e,t){function n(n){A.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},enumerable:!0})}var r=[];for(var i in t)"function"==typeof t[i]?a(e,i,t[i]):"$"===i.charAt(0)||i in e||r.push(i);for(;r.length>0;)n(r.shift());e.$super=t}function l(e){return"string"!=typeof e?!1:-1!==["byte","int","char","color","float","long","double"].indexOf(e)}function c(e){var r=250,i=e.size/r,s=t.createElement("canvas");s.width=2*r,s.height=2*r,s.style.opacity=0;var o=e.getCSSDefinition(r+"px","normal"),u=s.getContext("2d");u.font=o;var a="dbflkhyjqpg";s.width=u.measureText(a).width,u.font=o;var f=t.createElement("div");f.style.position="absolute",f.style.opacity=0,f.style.fontFamily='"'+e.name+'"',f.style.fontSize=r+"px",f.innerHTML=a+"<br/>"+a,t.body.appendChild(f);var l=s.width,c=s.height,h=c/2;u.fillStyle="white",u.fillRect(0,0,l,c),u.fillStyle="black",u.fillText(a,0,h);for(var p=u.getImageData(0,0,l,c).data,d=0,v=4*l,g=p.length;++d<g&&255===p[d];)m();var y=n.round(d/v);for(d=g-1;--d>0&&255===p[d];)m();var b=n.round(d/v);if(e.ascent=i*(h-y),e.descent=i*(b-h),t.defaultView.getComputedStyle){var w=t.defaultView.getComputedStyle(f,null).getPropertyValue("height");w=i*w.replace("px",""),w>=2*e.size&&(e.leading=n.round(w/2))}return t.body.removeChild(f),e.caching?u:void 0}function h(e,t){e===r&&(e=""),this.name=e,t===r&&(t=0),this.size=t,this.glyph=!1,this.ascent=0,this.descent=0,this.leading=1.2*t;var n=e.indexOf(" Italic Bold");-1!==n&&(e=e.substring(0,n)),this.style="normal";var i=e.indexOf(" Italic");-1!==i&&(e=e.substring(0,i),this.style="italic"),this.weight="normal";var s=e.indexOf(" Bold");if(-1!==s&&(e=e.substring(0,s),this.weight="bold"),this.family="sans-serif",e!==r)switch(e){case"sans-serif":case"serif":case"monospace":case"fantasy":case"cursive":this.family=e;break;default:this.family='"'+e+'", sans-serif'}this.context2d=c(this),this.css=this.getCSSDefinition(),this.context2d&&(this.context2d.font=this.css)}function p(){var e,t,n=["abs","acos","alpha","ambient","ambientLight","append","applyMatrix","arc","arrayCopy","asin","atan","atan2","background","beginCamera","beginDraw","beginShape","bezier","bezierDetail","bezierPoint","bezierTangent","bezierVertex","binary","blend","blendColor","blit_resize","blue","box","breakShape","brightness","camera","ceil","Character","color","colorMode","concat","constrain","copy","cos","createFont","createGraphics","createImage","cursor","curve","curveDetail","curvePoint","curveTangent","curveTightness","curveVertex","day","degrees","directionalLight","disableContextMenu","dist","draw","ellipse","ellipseMode","emissive","enableContextMenu","endCamera","endDraw","endShape","exit","exp","expand","externals","fill","filter","floor","focused","frameCount","frameRate","frustum","get","glyphLook","glyphTable","green","height","hex","hint","hour","hue","image","imageMode","intersect","join","key","keyCode","keyPressed","keyReleased","keyTyped","lerp","lerpColor","lightFalloff","lights","lightSpecular","line","link","loadBytes","loadFont","loadGlyphs","loadImage","loadPixels","loadShape","loadXML","loadStrings","log","loop","mag","map","match","matchAll","max","millis","min","minute","mix","modelX","modelY","modelZ","modes","month","mouseButton","mouseClicked","mouseDragged","mouseMoved","mouseOut","mouseOver","mousePressed","mouseReleased","mouseScroll","mouseScrolled","mouseX","mouseY","name","nf","nfc","nfp","nfs","noCursor","noFill","noise","noiseDetail","noiseSeed","noLights","noLoop","norm","normal","noSmooth","noStroke","noTint","ortho","param","parseBoolean","parseByte","parseChar","parseFloat","parseInt","peg","perspective","PImage","pixels","PMatrix2D","PMatrix3D","PMatrixStack","pmouseX","pmouseY","point","pointLight","popMatrix","popStyle","pow","print","printCamera","println","printMatrix","printProjection","PShape","PShapeSVG","pushMatrix","pushStyle","quad","radians","random","Random","randomSeed","rect","rectMode","red","redraw","requestImage","resetMatrix","reverse","rotate","rotateX","rotateY","rotateZ","round","saturation","save","saveFrame","saveStrings","scale","screenX","screenY","screenZ","second","set","setup","shape","shapeMode","shared","shearX","shearY","shininess","shorten","sin","size","smooth","sort","specular","sphere","sphereDetail","splice","split","splitTokens","spotLight","sq","sqrt","status","str","stroke","strokeCap","strokeJoin","strokeWeight","subset","tan","text","textAlign","textAscent","textDescent","textFont","textLeading","textMode","textSize","texture","textureMode","textWidth","tint","toImageData","touchCancel","touchEnd","touchMove","touchStart","translate","transform","triangle","trim","unbinary","unhex","updatePixels","use3DContext","vertex","width","XMLElement","XML","year","__contains","__equals","__equalsIgnoreCase","__frameRate","__hashCode","__int_cast","__instanceof","__keyPressed","__mousePressed","__printStackTrace","__replace","__replaceAll","__replaceFirst","__toCharArray","__split","__codePointAt","__startsWith","__endsWith","__matches"],r={};for(e=0,t=n.length;t>e;++e)r[n[e]]=null;for(var i in H.lib)if(H.lib.hasOwnProperty(i)&&H.lib[i].exports){var s=H.lib[i].exports;for(e=0,t=s.length;t>e;++e)r[s[e]]=null}return r}function d(e){function t(e){for(var t=[],n=e.split(/([\{\[\(\)\]\}])/),r=n[0],i=[],s=1;s<n.length;s+=2){var o=n[s];if("["===o||"{"===o||"("===o)i.push(r),r=o;else if("]"===o||"}"===o||")"===o){var u="}"===o?"A":")"===o?"B":"C",a=t.length;t.push(r+o),r=i.pop()+'"'+u+(a+1)+'"'}r+=n[s+1]}return t.unshift(r),t}function n(e,t){return e.replace(/'(\d+)'/g,function(e,n){var r=t[n];return"/"===r.charAt(0)?r:/^'((?:[^'\\\n])|(?:\\.[0-9A-Fa-f]*))'$/.test(r)?"(new $p.Character("+r+"))":r})}function i(e){var t,n=/^\s*/.exec(e);if(n[0].length===e.length)t={left:n[0],middle:"",right:""};else{var r=/\s*$/.exec(e);t={left:n[0],middle:e.substring(n[0].length,r.index),right:r[0]}}return t.untrim=function(e){return this.left+e+this.right},t}function s(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function o(e,t){for(var n=0,r=t.length;r>n;++n)e[t[n]]=null;return e}function u(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function a(e){return e.substring(2,e.length-1)}function f(e,t){var n=At.length;return At.push(e),'"'+t+n+'"'}function l(){return"class"+ ++Mt}function c(e,t,n){e.classId=t,e.scopeId=n,Ot[t]=e}function h(e){var t=e;return t=t.replace(_t,function(e){return f(e,"E")}),t=t.replace(Dt,function(e){return f(e,"D")}),t=t.replace(jt,function(e){return f(e,"H")})}function d(e,t){var n=e.replace(Ht,function(e,n,r){return r!==t?e:f(e,"G")});return n}function v(e){this.name=e}function m(e,t){this.params=e,this.methodArgsParam=t}function g(e){var t=s(e.substring(1,e.length-1)),n=[],r=null;if(""!==t)for(var i=t.split(","),o=0;o<i.length;++o){var u=/\b([A-Za-z_$][\w$]*\b)(\s*"[ABC][\d]*")*\s*$/.exec(i[o]);if(o===i.length-1&&i[o].indexOf("...")>=0){r=new v(u[1]);break}n.push(new v(u[1]))}return new m(n,r)}function y(e){function t(e,t,n,r){var o=At[r];s=!0;var u=i(o.substring(1,o.length-1));return"__"+n+(""===u.middle?f("("+t.replace(/\.\s*$/,"")+")","B"):f("("+t.replace(/\.\s*$/,"")+","+u.middle+")","B"))}function n(e,t,n){return s=!0,"__instanceof"+f("("+t+", "+n+")","B")}var r=e;r=r.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s*"C\d+")+\s*("A\d+")/g,function(e,t,n){return n}),r=r.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s*"B\d+")\s*("A\d+")/g,function(e){return f(e,"F")}),r=r.replace(jt,function(e){return f(e,"H")}),r=r.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)\s*("C\d+"(?:\s*"C\d+")*)/g,function(e,t,n){var r=n.replace(/"C(\d+)"/g,function(e,t){return At[t]}).replace(/\[\s*\]/g,"[null]").replace(/\s*\]\s*\[\s*/g,", "),i="{"+r.substring(1,r.length-1)+"}",s="('"+t+"', "+f(i,"A")+")";return"$p.createJavaArray"+f(s,"B")}),r=r.replace(/(\.\s*length)\s*"B\d+"/g,"$1"),r=r.replace(/#([0-9A-Fa-f]{6})\b/g,function(e,t){return"0xFF"+t}),r=r.replace(/"B(\d+)"(\s*(?:[\w$']|"B))/g,function(e,t,n){var r=At[t];if(!/^\(\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\s*(?:"C\d+"\s*)*\)$/.test(r))return e;if(/^\(\s*int\s*\)$/.test(r))return"(int)"+n;var i=r.split(/"C(\d+)"/g);return i.length>1&&!/^\[\s*\]$/.test(At[i[1]])?e:""+n}),r=r.replace(/\(int\)([^,\]\)\}\?\:\*\+\-\/\^\|\%\&\~<\>\=]+)/g,function(e,t){var n=i(t);return n.untrim("__int_cast("+n.middle+")")}),r=r.replace(/\bsuper(\s*"B\d+")/g,"$$superCstr$1").replace(/\bsuper(\s*\.)/g,"$$super$1"),r=r.replace(/\b0+((\d*)(?:\.[\d*])?(?:[eE][\-\+]?\d+)?[fF]?)\b/,function(e,t,n){return t===n?e:""===n?"0"+t:t}),r=r.replace(/\b(\.?\d+\.?)[fF]\b/g,"$1"),r=r.replace(/([^\s])%([^=\s])/g,"$1 % $2"),r=r.replace(/\b(frameRate|keyPressed|mousePressed)\b(?!\s*"B)/g,"__$1"),r=r.replace(/\b(boolean|byte|char|float|int)\s*"B/g,function(e,t){return"parse"+t.substring(0,1).toUpperCase()+t.substring(1)+'"B'}),r=r.replace(/\bpixels\b\s*(("C(\d+)")|\.length)?(\s*=(?!=)([^,\]\)\}]+))?/g,function(e,t,n,r,i,s){if(n){var o=At[r];return i?"pixels.setPixel"+f("("+o.substring(1,o.length-1)+","+s+")","B"):"pixels.getPixel"+f("("+o.substring(1,o.length-1)+")","B")}return t?"pixels.getLength"+f("()","B"):i?"pixels.set"+f("("+s+")","B"):"pixels.toArray"+f("()","B")});var s;do s=!1,r=r.replace(/((?:'\d+'|\b[A-Za-z_$][\w$]*\s*(?:"[BC]\d+")*)\s*\.\s*(?:[A-Za-z_$][\w$]*\s*(?:"[BC]\d+"\s*)*\.\s*)*)(replace|replaceAll|replaceFirst|contains|equals|equalsIgnoreCase|hashCode|toCharArray|printStackTrace|split|startsWith|endsWith|codePointAt|matches)\s*"B(\d+)"/g,t);while(s);do s=!1,r=r.replace(/((?:'\d+'|\b[A-Za-z_$][\w$]*\s*(?:"[BC]\d+")*)\s*(?:\.\s*[A-Za-z_$][\w$]*\s*(?:"[BC]\d+"\s*)*)*)instanceof\s+([A-Za-z_$][\w$]*\s*(?:\.\s*[A-Za-z_$][\w$]*)*)/g,n);while(s);return r=r.replace(/\bthis(\s*"B\d+")/g,"$$constr$1")}function b(e,t){this.baseInterfaceName=e,this.body=t,t.owner=this}function w(e){var t=(new RegExp(/\bnew\s*([A-Za-z_$][\w$]*\s*(?:\.\s*[A-Za-z_$][\w$]*)*)\s*"B\d+"\s*"A(\d+)"/)).exec(e),n=St,r=l();St=r;var i=t[1]+"$"+r,s=new b(i,xt(At[t[2]],i,"","implements "+t[1]));return c(s,r,n),St=n,s}function E(e,t,n){this.name=e,this.params=t,this.body=n}function S(e){var t=(new RegExp(/\b([A-Za-z_$][\w$]*)\s*"B(\d+)"\s*"A(\d+)"/)).exec(e);return new E("function"!==t[1]?t[1]:null,g(At[t[2]]),Nt(At[t[3]]))}function x(e){this.members=e}function N(e){for(var t=e.split(","),n=0;n<t.length;++n){var r=t[n].indexOf(":");t[n]=0>r?{value:Lt(t[n])}:{label:s(t[n].substring(0,r)),value:Lt(s(t[n].substring(r+1)))}}return new x(t)}function C(e){if("("===e.charAt(0)||"["===e.charAt(0))return e.charAt(0)+C(e.substring(1,e.length-1))+e.charAt(e.length-1);if("{"===e.charAt(0))return/^\{\s*(?:[A-Za-z_$][\w$]*|'\d+')\s*:/.test(e)?"{"+f(e.substring(1,e.length-1),"I")+"}":"["+C(e.substring(1,e.length-1))+"]";var t=i(e),n=y(t.middle);return n=n.replace(/"[ABC](\d+)"/g,function(e,t){return C(At[t])}),t.untrim(n)}function k(e){return e.replace(/(\.\s*)?((?:\b[A-Za-z_]|\$)[\w$]*)(\s*\.\s*([A-Za-z_$][\w$]*)(\s*\()?)?/g,function(e,t,n,i,s,o){if(t)return e;var u={name:n,member:s,callSign:!!o};return Et(u)+(i===r?"":i)})}function L(e,t){this.expr=e,this.transforms=t}function O(e,t,n){this.name=e,this.value=t,this.isDefault=n}function M(e,t){var n,r,i,o=e.indexOf("=");return 0>o?(n=e,r=t,i=!0):(n=e.substring(0,o),r=Lt(e.substring(o+1)),i=!1),new O(s(n.replace(/(\s*"C\d+")+/g,"")),r,i)}function _(e){return"int"===e||"float"===e?"0":"boolean"===e?"false":"color"===e?"0x00000000":"null"}function D(e,t){this.definitions=e,this.varType=t}function P(e){this.expression=e}function H(e){if(Pt.test(e)){for(var t=Bt.exec(e),n=e.substring(t[0].length).split(","),r=_(t[2]),i=0;i<n.length;++i)n[i]=M(n[i],r);return new D(n,t[2])}return new P(Lt(e))}function B(e,t,n){this.initStatement=e,this.condition=t,this.step=n}function j(e,t){this.initStatement=e,this.container=t}function F(e,t){this.initStatement=e,this.container=t}function I(e){var t;return/\bin\b/.test(e)?(t=e.substring(1,e.length-1).split(/\bin\b/g),new j(H(s(t[0])),Lt(t[1]))):e.indexOf(":")>=0&&e.indexOf(";")<0?(t=e.substring(1,e.length-1).split(":"),new F(H(s(t[0])),Lt(t[1]))):(t=e.substring(1,e.length-1).split(";"),new B(H(s(t[0])),Lt(t[1]),Lt(t[2])))}function q(e){e.sort(function(e,t){return t.weight-e.weight})}function R(e,t,n){this.name=e,this.body=t,this.isStatic=n,t.owner=this}function U(e,t,n){this.name=e,this.body=t,this.isStatic=n,t.owner=this}function z(e){var t=_t.exec(e);_t.lastIndex=0;var n,r=t[1].indexOf("static")>=0,i=At[a(t[6])],s=St,o=l();return St=o,n="interface"===t[2]?new R(t[3],Tt(i,t[3],t[4]),r):new U(t[3],xt(i,t[3],t[4],t[5]),r),c(n,o,s),St=s,n}function W(e,t,n,r){this.name=e,this.params=t,this.body=n,this.isStatic=r}function X(e){var t=Dt.exec(e);Dt.lastIndex=0;var n=t[1].indexOf("static")>=0,r=";"!==t[6]?At[a(t[6])]:"{}";return new W(t[3],g(At[a(t[4])]),Nt(r),n)}function V(e,t,n){this.definitions=e,this.fieldType=t,this.isStatic=n}function $(e){for(var t=Bt.exec(e),n=t[1].indexOf("static")>=0,r=e.substring(t[0].length).split(/,\s*/g),i=_(t[2]),s=0;s<r.length;++s)r[s]=M(r[s],i);return new V(r,t[2],n)}function J(e,t){this.params=e,this.body=t}function K(e){var t=(new RegExp(/"B(\d+)"\s*"A(\d+)"/)).exec(e),n=g(At[t[1]]);return new J(n,Nt(At[t[2]]))}function Q(e,t,n,r,i,s){var o,u;for(this.name=e,this.interfacesNames=t,this.methodsNames=n,this.fields=r,this.innerClasses=i,this.misc=s,o=0,u=r.length;u>o;++o)r[o].owner=this}function G(e,t,n,r,i,s,o,u,a){var f,l;for(this.name=e,this.baseClassName=t,this.interfacesNames=n,this.functions=r,this.methods=i,this.fields=s,this.cstrs=o,this.innerClasses=u,this.misc=a,f=0,l=s.length;l>f;++f)s[f].owner=this}function Y(e,t){this.name=e,this.body=t,t.owner=this}function Z(e,t){this.name=e,this.body=t,t.owner=this}function et(e){var t=_t.exec(e);_t.lastIndex=0;var n=At[a(t[6])],r=St,i=l();St=i;var s;return s="interface"===t[2]?new Y(t[3],Tt(n,t[3],t[4])):new Z(t[3],xt(n,t[3],t[4],t[5])),c(s,i,r),St=r,s}function tt(e,t,n){this.name=e,this.params=t,this.body=n}function nt(e){var t=Dt.exec(e);return Dt.lastIndex=0,new tt(t[3],g(At[a(t[4])]),Nt(At[a(t[6])]))}function rt(e){var t=e;return t=t.replace(/\b(catch\s*"B\d+"\s*"A\d+")(\s*catch\s*"B\d+"\s*"A\d+")+/g,"$1")}function it(e,t){this.argument=e,this.misc=t}function st(e,t){this.argument=e,this.misc=t}function ot(e,t,n){this.name=e,this.argument=t,this.misc=n}function ut(e){this.expr=e}function at(e){this.label=e}function ft(e){for(var t=[],n=0,r=e.length;r>n;++n){var i=e[n];i instanceof D?t=t.concat(i.getNames()):i instanceof it&&i.argument.initStatement instanceof D?t=t.concat(i.argument.initStatement.getNames()):(i instanceof R||i instanceof U||i instanceof Y||i instanceof Z||i instanceof tt||i instanceof E)&&t.push(i.name)}return o({},t)}function lt(e){this.statements=e}function ct(e){this.statements=e}function ht(){function e(e,t){for(var n,s=t.split("."),o=e.scope;o;){if(o.hasOwnProperty(s[0])){n=o[s[0]];break}o=o.scope}n===r&&(n=i[s[0]]);for(var u=1,a=s.length;a>u&&n;++u)n=n.inScope[s[u]];return n}var t,n,i={};for(t in Ot)if(Ot.hasOwnProperty(t)){n=Ot[t];var s=n.scopeId,o=n.name;if(s){var u=Ot[s];n.scope=u,u.inScope===r&&(u.inScope={}),u.inScope[o]=n}else i[o]=n}for(t in Ot)if(Ot.hasOwnProperty(t)){n=Ot[t];var a=n.body.baseClassName;if(a){var f=e(n,a);f&&(n.base=f,f.derived||(f.derived=[]),f.derived.push(n))}var l,c,h=n.body.interfacesNames,p=[];if(h&&h.length>0){for(l=0,c=h.length;c>l;++l){var d=e(n,h[l]);p.push(d),d&&(d.derived||(d.derived=[]),d.derived.push(n))}p.length>0&&(n.interfaces=p)}}}function pt(){function e(e,t){var n=s[e];if(!n)return!1;var r=n.indexOf(t);return 0>r?!1:(n.splice(r,1),n.length>0?!1:(delete s[e],!0))}var t,n,r,i=[],s={};for(t in Ot)if(Ot.hasOwnProperty(t))if(r=Ot[t],r.inScope||r.derived){var o=[];if(r.inScope)for(n in r.inScope)r.inScope.hasOwnProperty(n)&&o.push(r.inScope[n]);r.derived&&(o=o.concat(r.derived)),s[t]=o}else i.push(t),r.weight=0;for(;i.length>0;)if(t=i.shift(),r=Ot[t],r.scopeId&&e(r.scopeId,r)&&(i.push(r.scopeId),Ot[r.scopeId].weight=r.weight+1),r.base&&e(r.base.classId,r)&&(i.push(r.base.classId),r.base.weight=r.weight+1),r.interfaces){var u,a;for(u=0,a=r.interfaces.length;a>u;++u)r.interfaces[u]&&e(r.interfaces[u].classId,r)&&(i.push(r.interfaces[u].classId),r.interfaces[u].weight=r.weight+1)}}var dt=p(),vt=e.replace(/\r\n?|\n\r/g,"\n"),mt=[],gt=vt.replace(/("(?:[^"\\\n]|\\.)*")|('(?:[^'\\\n]|\\.)*')|(([\[\(=|&!\^:?]\s*)(\/(?![*\/])(?:[^\/\\\n]|\\.)*\/[gim]*)\b)|(\/\/[^\n]*\n)|(\/\*(?:(?!\*\/)(?:.|\n))*\*\/)/g,function(e,t,n,r,i,s,o,u){var a;return t||n?(a=mt.length,mt.push(e),"'"+a+"'"):r?(a=mt.length,mt.push(s),i+"'"+a+"'"):""!==u?" ":"\n"});gt=gt.replace(/__x([0-9A-F]{4})/g,function(e,t){return"__x005F_x"+t}),gt=gt.replace(/\$/g,"__x0024");var yt,bt=gt,wt=function(e,t,n,r){return t||r?e:(yt=!0,"")};do yt=!1,bt=bt.replace(/([<]?)<\s*((?:\?|[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\[\])*(?:\s+(?:extends|super)\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)?(?:\s*,\s*(?:\?|[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\[\])*(?:\s+(?:extends|super)\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)?)*)\s*>([=]?)/g,wt);while(yt);var Et,St,xt,Tt,Nt,Ct,kt,Lt,At=t(bt),Ot={},Mt=0,_t=/\b((?:(?:public|private|final|protected|static|abstract)\s+)*)(class|interface)\s+([A-Za-z_$][\w$]*\b)(\s+extends\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\b)*)?(\s+implements\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\b)*)?\s*("A\d+")/g,Dt=/\b((?:(?:public|private|final|protected|static|abstract|synchronized)\s+)*)((?!(?:else|new|return|throw|function|public|private|protected)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*([A-Za-z_$][\w$]*\b)\s*("B\d+")(\s*throws\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)*)?\s*("A\d+"|;)/g,Pt=/^((?:(?:public|private|final|protected|static)\s+)*)((?!(?:else|new|return|throw)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*([A-Za-z_$][\w$]*\b)\s*(?:"C\d+"\s*)*([=,]|$)/,Ht=/\b((?:(?:public|private|final|protected|static|abstract)\s+)*)((?!(?:new|return|throw)\b)[A-Za-z_$][\w$]*\b)\s*("B\d+")(\s*throws\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)*)?\s*("A\d+")/g,Bt=/^((?:(?:public|private|final|protected|static)\s+)*)((?!(?:new|return|throw)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*/,jt=/\bfunction(?:\s+([A-Za-z_$][\w$]*))?\s*("B\d+")\s*("A\d+")/g;v.prototype.toString=function(){return this.name},m.prototype.getNames=function(){for(var e=[],t=0,n=this.params.length;n>t;++t)e.push(this.params[t].name);return e},m.prototype.prependMethodArgs=function(e){return this.methodArgsParam?"{\nvar "+this.methodArgsParam.name+" = Array.prototype.slice.call(arguments, "+this.params.length+");\n"+e.substring(1):e},m.prototype.toString=function(){if(0===this.params.length)return"()";for(var e="(",t=0,n=this.params.length;n>t;++t)e+=this.params[t]+", ";return e.substring(0,e.length-2)+")"},b.prototype.toString=function(){return"new ("+this.body+")"},E.prototype.toString=function(){var e=Et,t=o({"this":null},this.params.getNames());Et=function(n){return t.hasOwnProperty(n.name)?n.name:e(n)};var n="function";this.name&&(n+=" "+this.name);var r=this.params.prependMethodArgs(this.body.toString());return n+=this.params+" "+r,Et=e,n},x.prototype.toString=function(){var e=Et;Et=function(t){return"this"===t.name?"this":e(t)};for(var t="",n=0,r=this.members.length;r>n;++n)this.members[n].label&&(t+=this.members[n].label+": "),t+=this.members[n].value.toString()+", ";return Et=e,t.substring(0,t.length-2)},L.prototype.toString=function(){var e=this.transforms,t=k(this.expr);return t.replace(/"!(\d+)"/g,function(t,n){return e[n].toString()})},Lt=function(e){var t=[],n=C(e);return n=n.replace(/"H(\d+)"/g,function(e,n){return t.push(S(At[n])),'"!'+(t.length-1)+'"'}),n=n.replace(/"F(\d+)"/g,function(e,n){return t.push(w(At[n])),'"!'+(t.length-1)+'"'}),n=n.replace(/"I(\d+)"/g,function(e,n){return t.push(N(At[n])),'"!'+(t.length-1)+'"'}),new L(n,t)},O.prototype.toString=function(){return this.name+" = "+this.value},D.prototype.getNames=function(){for(var e=[],t=0,n=this.definitions.length;n>t;++t)e.push(this.definitions[t].name);return e},D.prototype.toString=function(){return"var "+this.definitions.join(",")},P.prototype.toString=function(){return this.expression.toString()},B.prototype.toString=function(){return"("+this.initStatement+"; "+this.condition+"; "+this.step+")"},j.prototype.toString=function(){var e=this.initStatement.toString();return e.indexOf("=")>=0&&(e=e.substring(0,e.indexOf("="))),"("+e+" in "+this.container+")"},F.iteratorId=0,F.prototype.toString=function(){var e=this.initStatement.toString(),t="$it"+F.iteratorId++,n=e.replace(/^\s*var\s*/,"").split("=")[0],r="var "+t+" = new $p.ObjectIterator("+this.container+"), "+n+" = void(0)",i=t+".hasNext() && (("+n+" = "+t+".next()) || true)";return"("+r+"; "+i+";)"},R.prototype.toString=function(){return""+this.body},U.prototype.toString=function(){return""+this.body},W.prototype.toString=function(){var e=o({},this.params.getNames()),t=Et;Et=function(n){return e.hasOwnProperty(n.name)?n.name:t(n)};var n=this.params.prependMethodArgs(this.body.toString()),r="function "+this.methodId+this.params+" "+n+"\n";return Et=t,r},V.prototype.getNames=function(){for(var e=[],t=0,n=this.definitions.length;n>t;++t)e.push(this.definitions[t].name);return e},V.prototype.toString=function(){var e=Et({name:"[this]"});if(this.isStatic){for(var t=this.owner.name,n=[],r=0,i=this.definitions.length;i>r;++r){var s=this.definitions[r],o=s.name,u=t+"."+o,a="if("+u+" === void(0)) {\n"+" "+u+" = "+s.value+"; }\n"+"$p.defineProperty("+e+", "+"'"+o+"', { get: function(){return "+u+";}, "+"set: function(val){"+u+" = val;} });\n";n.push(a)}return n.join("")}return e+"."+this.definitions.join("; "+e+".")},J.prototype.toString=function(){var e=o({},this.params.getNames()),t=Et;Et=function(n){return e.hasOwnProperty(n.name)?n.name:t(n)};var n="function $constr_"+this.params.params.length+this.params.toString(),r=this.params.prependMethodArgs(this.body.toString());return/\$(superCstr|constr)\b/.test(r)||(r="{\n$superCstr();\n"+r.substring(1)),Et=t,n+r+"\n"},Q.prototype.getMembers=function(e,t,n){this.owner.base&&this.owner.base.body.getMembers(e,t,n);var r,i,s,o;for(r=0,s=this.fields.length;s>r;++r){var u=this.fields[r].getNames();for(i=0,o=u.length;o>i;++i)e[u[i]]=this.fields[r]}for(r=0,s=this.methodsNames.length;s>r;++r){var a=this.methodsNames[r];t[a]=!0}for(r=0,s=this.innerClasses.length;s>r;++r){var f=this.innerClasses[r];n[f.name]=f}},Q.prototype.toString=function(){function e(e){for(var t=0;e;)++t,e=e.scope;return t}e(this.owner);var t=this.name,n="",r="",i={},s={},o={};this.getMembers(i,s,o);var u,a;if(this.owner.interfaces){var f,l=[];for(u=0,a=this.interfacesNames.length;a>u;++u)this.owner.interfaces[u]&&(f=Et({name:this.interfacesNames[u]}),l.push(f),n+="$p.extendInterfaceMembers("+t+", "+f+");\n");r+=t+".$interfaces = ["+l.join(", ")+"];\n"}for(r+=t+".$isInterface = true;\n",r+=t+".$methods = ['"+this.methodsNames.join("', '")+"'];\n",q(this.innerClasses),u=0,a=this.innerClasses.length;a>u;++u){var c=this.innerClasses[u];c.isStatic&&(n+=t+"."+c.name+" = "+c+";\n")}for(u=0,a=this.fields.length;a>u;++u){var h=this.fields[u];h.isStatic&&(n+=t+"."+h.definitions.join(";\n"+t+".")+";\n")}return"(function() {\nfunction "+t+"() { throw 'Unable to create the interface'; }\n"+n+r+"return "+t+";\n"+"})()"},Tt=function(e,t,n){var s=e.substring(1,e.length-1);s=h(s),s=d(s,t);var o=[],u=[];s=s.replace(/"([DE])(\d+)"/g,function(e,t,n){return"D"===t?o.push(n):"E"===t&&u.push(n),""});var a,f,l,c=s.split(/;(?:\s*;)*/g);for(n!==r&&(a=n.replace(/^\s*extends\s+(.+?)\s*$/g,"$1").split(/\s*,\s*/g)),f=0,l=o.length;l>f;++f){var p=X(At[o[f]]);o[f]=p.name}for(f=0,l=c.length-1;l>f;++f){var v=i(c[f]);c[f]=$(v.middle)}var m=c.pop();for(f=0,l=u.length;l>f;++f)u[f]=z(At[u[f]]);return new Q(t,a,o,c,u,{tail:m})},G.prototype.getMembers=function(e,t,n){this.owner.base&&this.owner.base.body.getMembers(e,t,n);var r,i,s,o;for(r=0,s=this.fields.length;s>r;++r){var u=this.fields[r].getNames();for(i=0,o=u.length;o>i;++i)e[u[i]]=this.fields[r]}for(r=0,s=this.methods.length;s>r;++r){var a=this.methods[r];t[a.name]=a}for(r=0,s=this.innerClasses.length;s>r;++r){var f=this.innerClasses[r];n[f.name]=f}},G.prototype.toString=function(){function e(e){for(var t=0;e;)++t,e=e.scope;return t}var t=e(this.owner),n="$this_"+t,r=this.name,i="var "+n+" = this;\n",o="",u="",a={},f={},l={};this.getMembers(a,f,l);var c=Et;Et=function(e){var t=e.name;return"this"===t?e.callSign||!e.member?n+".$self":n:a.hasOwnProperty(t)?a[t].isStatic?r+"."+t:n+"."+t:l.hasOwnProperty(t)?n+"."+t:f.hasOwnProperty(t)?f[t].isStatic?r+"."+t:n+".$self."+t:c(e)};var h;this.baseClassName?(h=c({name:this.baseClassName}),i+="var $super = { $upcast: "+n+" };\n",i+="function $superCstr(){"+h+".apply($super,arguments);if(!('$self' in $super)) $p.extendClassChain($super)}\n",u+=r+".$base = "+h+";\n"):i+="function $superCstr(){$p.extendClassChain("+n+")}\n",this.owner.base&&(o+="$p.extendStaticMembers("+r+", "+h+");\n");var p,d,v,m;if(this.owner.interfaces){var g,y=[];for(p=0,d=this.interfacesNames.length;d>p;++p)this.owner.interfaces[p]&&(g=c({name:this.interfacesNames[p]}),y.push(g),o+="$p.extendInterfaceMembers("+r+", "+g+");\n");u+=r+".$interfaces = ["+y.join(", ")+"];\n"}for(this.functions.length>0&&(i+=this.functions.join("\n")+"\n"),q(this.innerClasses),p=0,d=this.innerClasses.length;d>p;++p){var b=this.innerClasses[p];b.isStatic?(o+=r+"."+b.name+" = "+b+";\n",i+=n+"."+b.name+" = "+r+"."+b.name+";\n"):i+=n+"."+b.name+" = "+b+";\n"}for(p=0,d=this.fields.length;d>p;++p){var w=this.fields[p];if(w.isStatic)for(o+=r+"."+w.definitions.join(";\n"+r+".")+";\n",v=0,m=w.definitions.length;m>v;++v){var E=w.definitions[v].name,S=r+"."+E;i+="$p.defineProperty("+n+", '"+E+"', {"+"get: function(){return "+S+"}, "+"set: function(val){"+S+" = val}});\n"}else i+=n+"."+w.definitions.join(";\n"+n+".")+";\n"}var x={};for(p=0,d=this.methods.length;d>p;++p){var T=this.methods[p],N=x[T.name],C=T.name+"$"+T.params.params.length,k=!!T.params.methodArgsParam;N?(++N,C+="_"+N):N=1,T.methodId=C,x[T.name]=N,T.isStatic?(o+=T,o+="$p.addMethod("+r+", '"+T.name+"', "+C+", "+k+");\n",i+="$p.addMethod("+n+", '"+T.name+"', "+C+", "+k+");\n"):(i+=T,i+="$p.addMethod("+n+", '"+T.name+"', "+C+", "+k+");\n")}i+=s(this.misc.tail),this.cstrs.length>0&&(i+=this.cstrs.join("\n")+"\n"),i+="function $constr() {\n";var L=[];for(p=0,d=this.cstrs.length;d>p;++p){var A=this.cstrs[p].params.params.length,O=!!this.cstrs[p].params.methodArgsParam;L.push("if(arguments.length "+(O?">=":"===")+" "+A+") { "+"$constr_"+A+".apply("+n+", arguments); }")}return L.length>0&&(i+=L.join(" else ")+" else "),i+="$superCstr();\n}\n",i+="$constr.apply(null, arguments);\n",Et=c,"(function() {\nfunction "+r+"() {\n"+i+"}\n"+o+u+"return "+r+";\n"+"})()"},xt=function(e,t,n,s){var o=e.substring(1,e.length-1);o=h(o),o=d(o,t);var u=[],a=[],f=[],l=[];o=o.replace(/"([DEGH])(\d+)"/g,function(e,t,n){return"D"===t?u.push(n):"E"===t?a.push(n):"H"===t?l.push(n):f.push(n),""});var c,p,v,m=o.replace(/^(?:\s*;)+/,"").split(/;(?:\s*;)*/g);for(n!==r&&(c=n.replace(/^\s*extends\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)\s*$/g,"$1")),s!==r&&(p=s.replace(/^\s*implements\s+(.+?)\s*$/g,"$1").split(/\s*,\s*/g)),v=0;v<l.length;++v)l[v]=S(At[l[v]]);for(v=0;v<u.length;++v)u[v]=X(At[u[v]]);for(v=0;v<m.length-1;++v){var g=i(m[v]);m[v]=$(g.middle)}var y=m.pop();for(v=0;v<f.length;++v)f[v]=K(At[f[v]]);for(v=0;v<a.length;++v)a[v]=z(At[a[v]]);return new G(t,c,p,l,u,m,f,a,{tail:y})},Y.prototype.toString=function(){return"var "+this.name+" = "+this.body+";\n"+"$p."+this.name+" = "+this.name+";\n"},Z.prototype.toString=function(){return"var "+this.name+" = "+this.body+";\n"+"$p."+this.name+" = "+this.name+";\n"},tt.prototype.toString=function(){var e=o({},this.params.getNames()),t=Et;Et=function(n){return e.hasOwnProperty(n.name)?n.name:t(n)};var n=this.params.prependMethodArgs(this.body.toString()),r="function "+this.name+this.params+" "+n+"\n"+"$p."+this.name+" = "+this.name+";";return Et=t,r},it.prototype.toString=function(){return this.misc.prefix+this.argument.toString()},st.prototype.toString=function(){return this.misc.prefix+this.argument.toString()},ot.prototype.toString=function(){var e=this.misc.prefix;return this.argument!==r&&(e+=this.argument.toString()),e},ut.prototype.toString=function(){return"case "+this.expr+":"},at.prototype.toString=function(){return this.label},Ct=function(e,t,n){var o=new RegExp(/\b(catch|for|if|switch|while|with)\s*"B(\d+)"|\b(do|else|finally|return|throw|try|break|continue)\b|("[ADEH](\d+)")|\b(case)\s+([^:]+):|\b([A-Za-z_$][\w$]*\s*:)|(;)/g),u=[];e=rt(e);for(var a,f,l=0;null!==(a=o.exec(e));){if(a[1]!==r){var c=e.lastIndexOf('"B',o.lastIndex),h=e.substring(l,c);"for"===a[1]?u.push(new it(I(At[a[2]]),{prefix:h})):"catch"===a[1]?u.push(new st(g(At[a[2]]),{prefix:h})):u.push(new ot(a[1],Lt(At[a[2]]),{prefix:h}))}else if(a[3]!==r)u.push(new ot(a[3],r,{prefix:e.substring(l,o.lastIndex)}));else if(a[4]!==r){if(f=e.substring(l,o.lastIndex-a[4].length),0!==s(f).length)continue;u.push(f);var p=a[4].charAt(1),d=a[5];"D"===p?u.push(t(At[d])):"E"===p?u.push(n(At[d])):"H"===p?u.push(S(At[d])):u.push(Nt(At[d]))}else if(a[6]!==r)u.push(new ut(Lt(s(a[7]))));else if(a[8]!==r){if(f=e.substring(l,o.lastIndex-a[8].length),0!==s(f).length)continue;u.push(new at(e.substring(l,o.lastIndex)))}else{var v=i(e.substring(l,o.lastIndex-1));u.push(v.left),u.push(H(v.middle)),u.push(v.right+";")}l=o.lastIndex}var m=i(e.substring(l));return u.push(m.left),""!==m.middle&&(u.push(H(m.middle)),u.push(";"+m.right)),u},lt.prototype.toString=function(){var e=ft(this.statements),t=Et;u(e)||(Et=function(n){return e.hasOwnProperty(n.name)?n.name:t(n)});var n="{\n"+this.statements.join("")+"\n}";return Et=t,n},Nt=function(e){var t=i(e.substring(1,e.length-1));return new lt(Ct(t.middle))},ct.prototype.toString=function(){for(var e,t=[],n=[],r=0,i=this.statements.length;i>r;++r)e=this.statements[r],e instanceof Z||e instanceof Y?t.push(e):n.push(e);q(t);var s=ft(this.statements);Et=function(e){var t=e.name;return s.hasOwnProperty(t)?t:dt.hasOwnProperty(t)||T.hasOwnProperty(t)||A.hasOwnProperty(t)?"$p."+t:t};var o="// this code was autogenerated from PJS\n(function($p) {\n"+t.join("")+"\n"+n.join("")+"\n})";return Et=null,o},kt=function(){var e=h(At[0]);return e=e.replace(/\bimport\s+[^;]+;/g,""),new ct(Ct(e,nt,et))};var Ft=kt();ht(Ft),pt(Ft);var It=Ft.toString();return It=It.replace(/\s*\n(?:[\t ]*\n)+/g,"\n\n"),It=It.replace(/__x([0-9A-F]{4})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}),n(It,mt)}function v(e,t){var n=(new RegExp(/\/\*\s*@pjs\s+((?:[^\*]|\*+[^\*\/])*)\*\//g)).exec(e);if(n&&2===n.length)for(var r=[],i=n.splice(1,2)[0].replace(/\{([\s\S]*?)\}/g,function(){return function(e,t){return r.push(t),"{"+(r.length-1)+"}"}}()).replace("\n","").replace("\r","").split(";"),s=function(e){return e.replace(/^\s*["']?/,"").replace(/["']?\s*$/,"")},o=0,u=i.length;u>o;o++){var a=i[o].split("=");if(a&&2===a.length){var f=s(a[0]),l=s(a[1]),c=[];if("preload"===f){c=l.split(",");for(var p=0,d=c.length;d>p;p++){var v=s(c[p]);t.imageCache.add(v)}}else if("font"===f){c=l.split(",");for(var m=0,g=c.length;g>m;m++){var y=s(c[m]),b=/^\{(\d*?)\}$/.exec(y);h.preloading.add(b?JSON.parse("{"+r[b[1]]+"}"):y)}}else"pauseOnBlur"===f?t.options.pauseOnBlur="true"===l:"globalKeyEvents"===f?t.options.globalKeyEvents="true"===l:"param-"===f.substring(0,6)?t.params[f.substring(6)]=l:t.options[f]=l}}return e}var m=function(){},g=function(){return"console"in e?function(t){e.console.log("Processing.js: "+t)}:m}(),y=function(e){var t=new XMLHttpRequest;if(t.open("GET",e,!1),t.overrideMimeType&&t.overrideMimeType("text/plain"),t.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT"),t.send(null),200!==t.status&&0!==t.status)throw"XMLHttpRequest failed, status code "+t.status;return t.responseText},b="document"in this&&!("fake"in this.document);if(t.head=t.head||t.getElementsByTagName("head")[0],t.documentMode>=9&&!t.doctype)throw"The doctype directive is missing. The recommended doctype in Internet Explorer is the HTML5 doctype: <!DOCTYPE html>";var w=i("Float32Array","WebGLFloatArray"),E=i("Int32Array","WebGLIntArray"),S=i("Uint16Array","WebGLUnsignedShortArray"),x=i("Uint8Array","WebGLUnsignedByteArray"),T={X:0,Y:1,Z:2,R:3,G:4,B:5,A:6,U:7,V:8,NX:9,NY:10,NZ:11,EDGE:12,SR:13,SG:14,SB:15,SA:16,SW:17,TX:18,TY:19,TZ:20,VX:21,VY:22,VZ:23,VW:24,AR:25,AG:26,AB:27,DR:3,DG:4,DB:5,DA:6,SPR:28,SPG:29,SPB:30,SHINE:31,ER:32,EG:33,EB:34,BEEN_LIT:35,VERTEX_FIELD_COUNT:36,P2D:1,JAVA2D:1,WEBGL:2,P3D:2,OPENGL:2,PDF:0,DXF:0,OTHER:0,WINDOWS:1,MAXOSX:2,LINUX:3,EPSILON:1e-4,MAX_FLOAT:3.4028235e38,MIN_FLOAT:-3.4028235e38,MAX_INT:2147483647,MIN_INT:-2147483648,PI:n.PI,TWO_PI:2*n.PI,HALF_PI:n.PI/2,THIRD_PI:n.PI/3,QUARTER_PI:n.PI/4,DEG_TO_RAD:n.PI/180,RAD_TO_DEG:180/n.PI,WHITESPACE:"  \n\r\f ",RGB:1,ARGB:2,HSB:3,ALPHA:4,CMYK:5,TIFF:0,TARGA:1,JPEG:2,GIF:3,BLUR:11,GRAY:12,INVERT:13,OPAQUE:14,POSTERIZE:15,THRESHOLD:16,ERODE:17,DILATE:18,REPLACE:0,BLEND:1,ADD:2,SUBTRACT:4,LIGHTEST:8,DARKEST:16,DIFFERENCE:32,EXCLUSION:64,MULTIPLY:128,SCREEN:256,OVERLAY:512,HARD_LIGHT:1024,SOFT_LIGHT:2048,DODGE:4096,BURN:8192,ALPHA_MASK:4278190080,RED_MASK:16711680,GREEN_MASK:65280,BLUE_MASK:255,CUSTOM:0,ORTHOGRAPHIC:2,PERSPECTIVE:3,POINT:2,POINTS:2,LINE:4,LINES:4,TRIANGLE:8,TRIANGLES:9,TRIANGLE_STRIP:10,TRIANGLE_FAN:11,QUAD:16,QUADS:16,QUAD_STRIP:17,POLYGON:20,PATH:21,RECT:30,ELLIPSE:31,ARC:32,SPHERE:40,BOX:41,GROUP:0,PRIMITIVE:1,GEOMETRY:3,VERTEX:0,BEZIER_VERTEX:1,CURVE_VERTEX:2,BREAK:3,CLOSESHAPE:4,OPEN:1,CLOSE:2,CORNER:0,CORNERS:1,RADIUS:2,CENTER_RADIUS:2,CENTER:3,DIAMETER:3,CENTER_DIAMETER:3,BASELINE:0,TOP:101,BOTTOM:102,NORMAL:1,NORMALIZED:1,IMAGE:2,MODEL:4,SHAPE:5,SQUARE:"butt",ROUND:"round",PROJECT:"square",MITER:"miter",BEVEL:"bevel",AMBIENT:0,DIRECTIONAL:1,SPOT:3,BACKSPACE:8,TAB:9,ENTER:10,RETURN:13,ESC:27,DELETE:127,CODED:65535,SHIFT:16,CONTROL:17,ALT:18,CAPSLK:20,PGUP:33,PGDN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLK:144,META:157,INSERT:155,ARROW:"default",CROSS:"crosshair",HAND:"pointer",MOVE:"move",TEXT:"text",WAIT:"wait",NOCURSOR:"url('data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='), auto",DISABLE_OPENGL_2X_SMOOTH:1,ENABLE_OPENGL_2X_SMOOTH:-1,ENABLE_OPENGL_4X_SMOOTH:2,ENABLE_NATIVE_FONTS:3,DISABLE_DEPTH_TEST:4,ENABLE_DEPTH_TEST:-4,ENABLE_DEPTH_SORT:5,DISABLE_DEPTH_SORT:-5,DISABLE_OPENGL_ERROR_REPORT:6,ENABLE_OPENGL_ERROR_REPORT:-6,ENABLE_ACCURATE_TEXTURES:7,DISABLE_ACCURATE_TEXTURES:-7,HINT_COUNT:10,SINCOS_LENGTH:720,PRECISIONB:15,PRECISIONF:32768,PREC_MAXVAL:32767,PREC_ALPHA_SHIFT:9,PREC_RED_SHIFT:1,NORMAL_MODE_AUTO:0,NORMAL_MODE_SHAPE:1,NORMAL_MODE_VERTEX:2,MAX_LIGHTS:8},N=function(e){if(e.iterator instanceof Function)return e.iterator();if(!(e instanceof Array))throw"Unable to iterate: "+e;var t=-1;this.hasNext=function(){return++t<e.length},this.next=function(){return e[t]}},C=function(){function e(e){var t=0;this.hasNext=function(){return t<e.length},this.next=function(){return e[t++]},this.remove=function(){e.splice(t,1)}}function t(n){var r;n instanceof t?r=n.toArray():(r=[],"number"==typeof n&&(r.length=n>0?n:0)),this.get=function(e){return r[e]},this.contains=function(e){return this.indexOf(e)>-1},this.indexOf=function(e){for(var t=0,n=r.length;n>t;++t)if(o(e,r[t]))return t;return-1},this.lastIndexOf=function(e){for(var t=r.length-1;t>=0;--t)if(o(e,r[t]))return t;return-1},this.add=function(){if(1===arguments.length)r.push(arguments[0]);else{if(2!==arguments.length)throw"Please use the proper number of parameters.";var e=arguments[0];if("number"!=typeof e)throw typeof e+" is not a number";if(!(e>=0&&e<=r.length))throw e+" is not a valid index";r.splice(e,0,arguments[1])}},this.addAll=function(e,t){var n;if("number"==typeof e){if(0>e||e>r.length)throw"Index out of bounds for addAll: "+e+" greater or equal than "+r.length;for(n=new N(t);n.hasNext();)r.splice(e++,0,n.next())}else for(n=new N(e);n.hasNext();)r.push(n.next())},this.set=function(){if(2!==arguments.length)throw"Please use the proper number of parameters.";var e=arguments[0];if("number"!=typeof e)throw typeof e+" is not a number";if(!(e>=0&&e<r.length))throw e+" is not a valid index.";r.splice(e,1,arguments[1])},this.size=function(){return r.length},this.clear=function(){r.length=0},this.remove=function(e){return"number"==typeof e?r.splice(e,1)[0]:(e=this.indexOf(e),e>-1?(r.splice(e,1),!0):!1)},this.removeAll=function(e){var n,r,i,s=new t;for(s.addAll(this),this.clear(),n=0,r=0;n<s.size();n++)i=s.get(n),e.contains(i)||this.add(r++,i);return this.size()<s.size()?!0:!1},this.isEmpty=function(){return!r.length},this.clone=function(){return new t(this)},this.toArray=function(){return r.slice(0)},this.iterator=function(){return new e(r)}}return t}(),k=function(){function e(){function t(e){var t=s(e)%c.length;return 0>t?c.length+t:t}function n(){if(!(h<=l*c.length)){for(var e=[],n=0;n<c.length;++n)c[n]!==r&&(e=e.concat(c[n]));var i=2*c.length;c=[],c.length=i;for(var s=0;s<e.length;++s){var o=t(e[s].key),u=c[o];u===r&&(c[o]=u=[]),u.push(e[s])}}}function i(e,t){function n(){for(;!u;)if(++o,s>=c.length)u=!0;else{if(!(c[s]===r||o>=c[s].length))return;o=-1,++s}}var i,s=0,o=-1,u=!1;this.hasNext=function(){return!u},this.next=function(){return i=e(c[s][o]),n(),i},this.remove=function(){i!==r&&(t(i),--o,n())},n()}function u(e,t,n){this.clear=function(){p.clear()},this.contains=function(e){return t(e)},this.containsAll=function(e){for(var t=e.iterator();t.hasNext();)if(!this.contains(t.next()))return!1;return!0},this.isEmpty=function(){return p.isEmpty()},this.iterator=function(){return new i(e,n)},this.remove=function(e){return this.contains(e)?(n(e),!0):!1},this.removeAll=function(e){for(var t=e.iterator(),r=!1;t.hasNext();){var i=t.next();this.contains(i)&&(n(i),r=!0)}return!0},this.retainAll=function(e){for(var t=this.iterator(),r=[];t.hasNext();){var i=t.next();e.contains(i)||r.push(i)}for(var s=0;s<r.length;++s)n(r[s]);return r.length>0},this.size=function(){return p.size()},this.toArray=function(){for(var e=[],t=this.iterator();t.hasNext();)e.push(t.next());return e}}function a(e){this._isIn=function(t){return t===p&&e.removed===r},this.equals=function(t){return o(e.key,t.getKey())},this.getKey=function(){return e.key},this.getValue=function(){return e.value},this.hashCode=function(){return s(e.key)},this.setValue=function(t){var n=e.value;return e.value=t,n}}if(1===arguments.length&&arguments[0]instanceof e)return arguments[0].clone();var f=arguments.length>0?arguments[0]:16,l=arguments.length>1?arguments[1]:.75,c=[];c.length=f;var h=0,p=this;this.clear=function(){h=0,c=[],c.length=f},this.clone=function(){var t=new e;return t.putAll(this),t},this.containsKey=function(e){var n=t(e),i=c[n];if(i===r)return!1;for(var s=0;s<i.length;++s)if(o(i[s].key,e))return!0;return!1},this.containsValue=function(e){for(var t=0;t<c.length;++t){var n=c[t];if(n!==r)for(var i=0;i<n.length;++i)if(o(n[i].value,e))return!0}return!1},this.entrySet=function(){return new u(function(e){return new a(e)},function(e){return e instanceof a&&e._isIn(p)},function(e){return p.remove(e.getKey())})},this.get=function(e){var n=t(e),i=c[n];if(i===r)return null;for(var s=0;s<i.length;++s)if(o(i[s].key,e))return i[s].value;return null},this.isEmpty=function(){return 0===h},this.keySet=function(){return new u(function(e){return e.key},function(e){return p.containsKey(e)},function(e){return p.remove(e)})},this.values=function(){return new u(function(e){return e.value},function(e){return p.containsValue(e)},function(e){return p.removeByValue(e)})},this.put=function(e,i){var s=t(e),u=c[s];if(u===r)return++h,c[s]=[{key:e,value:i}],n(),null;for(var a=0;a<u.length;++a)if(o(u[a].key,e)){var f=u[a].value;return u[a].value=i,f}return++h,u.push({key:e,value:i}),n(),null},this.putAll=function(e){for(var t=e.entrySet().iterator();t.hasNext();){var n=t.next();this.put(n.getKey(),n.getValue())}},this.remove=function(e){var n=t(e),i=c[n];if(i===r)return null;for(var s=0;s<i.length;++s)if(o(i[s].key,e)){--h;var u=i[s].value;return i[s].removed=!0,i.length>1?i.splice(s,1):c[n]=r,u}return null},this.removeByValue=function(e){var t,n,r,i;for(t in c)if(c.hasOwnProperty(t))for(n=0,r=c[t].length;r>n;n++)if(i=c[t][n],i.value===e)return c[t].splice(n,1),!0;return!1},this.size=function(){return h}}return e}(),L=function(){function e(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function t(e){return function(t,n){var r=t.get();return r[e](n),r}}e.dist=function(e,t){return e.dist(t)},e.dot=function(e,t){return e.dot(t)},e.cross=function(e,t){return e.cross(t)},e.angleBetween=function(e,t){return n.acos(e.dot(t)/(e.mag()*t.mag()))},e.prototype={set:function(e,t,n){1===arguments.length?this.set(e.x||e[0]||0,e.y||e[1]||0,e.z||e[2]||0):(this.x=e,this.y=t,this.z=n)},get:function(){return new e(this.x,this.y,this.z)},mag:function(){var e=this.x,t=this.y,r=this.z;return n.sqrt(e*e+t*t+r*r)},add:function(e,t,n){1===arguments.length?(this.x+=e.x,this.y+=e.y,this.z+=e.z):(this.x+=e,this.y+=t,this.z+=n)},sub:function(e,t,n){1===arguments.length?(this.x-=e.x,this.y-=e.y,this.z-=e.z):(this.x-=e,this.y-=t,this.z-=n)},mult:function(e){"number"==typeof e?(this.x*=e,this.y*=e,this.z*=e):(this.x*=e.x,this.y*=e.y,this.z*=e.z)},div:function(e){"number"==typeof e?(this.x/=e,this.y/=e,this.z/=e):(this.x/=e.x,this.y/=e.y,this.z/=e.z)},dist:function(e){var t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return n.sqrt(t*t+r*r+i*i)},dot:function(e,t,n){return 1===arguments.length?this.x*e.x+this.y*e.y+this.z*e.z:this.x*e+this.y*t+this.z*n},cross:function(t){var n=this.x,r=this.y,i=this.z;return new e(r*t.z-t.y*i,i*t.x-t.z*n,n*t.y-t.x*r)},normalize:function(){var e=this.mag();e>0&&this.div(e)},limit:function(e){this.mag()>e&&(this.normalize(),this.mult(e))},heading2D:function(){return-n.atan2(-this.y,this.x)},toString:function(){return"["+this.x+", "+this.y+", "+this.z+"]"},array:function(){return[this.x,this.y,this.z]}};for(var r in e.prototype)e.prototype.hasOwnProperty(r)&&!e.hasOwnProperty(r)&&(e[r]=t(r));return e}();u.prototype=T;var A=new u;A.ArrayList=C,A.HashMap=k,A.PVector=L,A.ObjectIterator=N,A.PConstants=T,A.defineProperty=function(e,t,n){"defineProperty"in Object?Object.defineProperty(e,t,n):(n.hasOwnProperty("get")&&e.__defineGetter__(t,n.get),n.hasOwnProperty("set")&&e.__defineSetter__(t,n.set))},A.extendClassChain=function(e){for(var t=[e],n=e.$upcast;n;n=n.$upcast)f(n,e),t.push(n),e=n;for(;t.length>0;)t.pop().$self=e},A.extendStaticMembers=function(e,t){f(e,t)},A.extendInterfaceMembers=function(e,t){f(e,t)},A.addMethod=function(e,t,n,r){var i=e[t];if(i||r){var s=n.length;if("$overloads"in i)i.$overloads[s]=n;else{var o=function(){var e=o.$overloads[arguments.length]||("$methodArgsIndex"in o&&arguments.length>o.$methodArgsIndex?o.$overloads[o.$methodArgsIndex]:null)||o.$defaultOverload;return e.apply(this,arguments)},u=[];i&&(u[i.length]=i),u[s]=n,o.$overloads=u,o.$defaultOverload=i||n,r&&(o.$methodArgsIndex=s),o.name=t,e[t]=o}}else e[t]=n},A.createJavaArray=function(e,t){var n=null,r=null;if("string"==typeof e&&("boolean"===e?r=!1:l(e)&&(r=0)),"number"==typeof t[0]){var i=0|t[0];if(t.length<=1){n=[],n.length=i;for(var s=0;i>s;++s)n[s]=r}else{n=[];for(var o=t.slice(1),u=0;i>u;++u)n.push(A.createJavaArray(e,o))}}return n};var O={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};!function(e){function t(e){return function(){throw"Processing.js does not support "+e+"."}}for(var n,r,i="open() createOutput() createInput() BufferedReader selectFolder() dataPath() createWriter() selectOutput() beginRecord() saveStream() endRecord() selectInput() saveBytes() createReader() beginRaw() endRaw() PrintWriter delay()".split(" "),s=i.length;s--;)n=i[s],r=n.replace("()",""),e[r]=t(n)}(A),A.defineProperty(A,"screenWidth",{get:function(){return e.innerWidth}}),A.defineProperty(A,"screenHeight",{get:function(){return e.innerHeight}}),A.defineProperty(A,"online",{get:function(){return!0}});var M=[],_={},D=function(e){M.splice(_[e],1),delete _[e]},P=function(e){e.externals.canvas.id!==r&&e.externals.canvas.id.length||(e.externals.canvas.id="__processing"+M.length),_[e.externals.canvas.id]=M.length,M.push(e)};h.prototype.caching=!0,h.prototype.getCSSDefinition=function(e,t){e===r&&(e=this.size+"px"),t===r&&(t=this.leading+"px");var n=[this.style,"normal",this.weight,e+"/"+t,this.family];return n.join(" ")},h.prototype.measureTextWidth=function(e){return this.context2d.measureText(e).width},h.prototype.measureTextWidthFallback=function(e){var n=t.createElement("canvas"),r=n.getContext("2d");return r.font=this.css,r.measureText(e).width},h.PFontCache={length:0},h.get=function(e,t){t=(0|10*t+.5)/10;var n=h.PFontCache,r=e+"/"+t;if(!n[r]){if(n[r]=new h(e,t),n.length++,50===n.length){h.prototype.measureTextWidth=h.prototype.measureTextWidthFallback,h.prototype.caching=!1;var i;for(i in n)"length"!==i&&(n[i].context2d=null);return new h(e,t)}if(400===n.length)return h.PFontCache={},h.get=h.getFallback,new h(e,t)}return n[r]},h.getFallback=function(e,t){return new h(e,t)},h.list=function(){return["sans-serif","serif","monospace","fantasy","cursive"]},h.preloading={template:{},initialized:!1,initialize:function(){var e=function(){var e="#E3KAI2wAgT1MvMg7Eo3VmNtYX7ABi3CxnbHlm7Abw3kaGVhZ7ACs3OGhoZWE7A53CRobXR47AY3AGbG9jYQ7G03Bm1heH7ABC3CBuYW1l7Ae3AgcG9zd7AI3AE#B3AQ2kgTY18PPPUACwAg3ALSRoo3#yld0xg32QAB77#E777773B#E3C#I#Q77773E#Q7777777772CMAIw7AB77732B#M#Q3wAB#g3B#E#E2BB//82BB////w#B7#gAEg3E77x2B32B#E#Q#MTcBAQ32gAe#M#QQJ#E32M#QQJ#I#g32Q77#",t=function(e){return"AAAAAAAA".substr(~~e?7-e:6)};return e.replace(/[#237]/g,t)},n=t.createElement("style");n.setAttribute("type","text/css"),n.innerHTML='@font-face {\n  font-family: "PjsEmptyFont";\n  src: url(\'data:application/x-font-ttf;base64,'+e()+"')\n"+"       format('truetype');\n"+"}",t.head.appendChild(n);var r=t.createElement("span");r.style.cssText='position: absolute; top: 0; left: 0; opacity: 0; font-family: "PjsEmptyFont", fantasy;',r.innerHTML="AAAAAAAA",t.body.appendChild(r),this.template=r,this.initialized=!0},getElementWidth:function(e){return t.defaultView.getComputedStyle(e,"").getPropertyValue("width")},timeAttempted:0,pending:function(e){this.initialized||this.initialize();for(var n,r,i=this.getElementWidth(this.template),s=0;s<this.fontList.length;s++){if(n=this.fontList[s],r=this.getElementWidth(n),this.timeAttempted<4e3&&r===i)return this.timeAttempted+=e,!0;t.body.removeChild(n),this.fontList.splice(s--,1),this.timeAttempted=0}return 0===this.fontList.length?!1:!0},fontList:[],addedList:{},add:function(e){this.initialized||this.initialize();var n="object"==typeof e?e.fontFace:e,r="object"==typeof e?e.url:e;if(!this.addedList[n]){var i=t.createElement("style");i.setAttribute("type","text/css"),i.innerHTML="@font-face{\n  font-family: '"+n+"';\n  src:  url('"+r+"');\n}\n",t.head.appendChild(i),this.addedList[n]=!0;var s=t.createElement("span");s.style.cssText="position: absolute; top: 0; left: 0; opacity: 0;",s.style.fontFamily='"'+n+'", "PjsEmptyFont", fantasy',s.innerHTML="AAAAAAAA",t.body.appendChild(s),this.fontList.push(s)}}},A.PFont=h;var H=this.Processing=function(i,o){function u(e){H.debug("Unimplemented - "+e)}function a(e,t,n,i){var s=Yn.locations[e];s===r&&(s=kt.getUniformLocation(t,n),Yn.locations[e]=s),null!==s&&(4===i.length?kt.uniform4fv(s,i):3===i.length?kt.uniform3fv(s,i):2===i.length?kt.uniform2fv(s,i):kt.uniform1f(s,i))}function f(e,t,n,i){var s=Yn.locations[e];s===r&&(s=kt.getUniformLocation(t,n),Yn.locations[e]=s),null!==s&&(4===i.length?kt.uniform4iv(s,i):3===i.length?kt.uniform3iv(s,i):2===i.length?kt.uniform2iv(s,i):kt.uniform1i(s,i))}function l(e,t,n,i,s){var o=Yn.locations[e];o===r&&(o=kt.getUniformLocation(t,n),Yn.locations[e]=o),-1!==o&&(16===s.length?kt.uniformMatrix4fv(o,i,s):9===s.length?kt.uniformMatrix3fv(o,i,s):kt.uniformMatrix2fv(o,i,s))}function c(e,t,n,i,s){var o=Yn.attributes[e];o===r&&(o=kt.getAttribLocation(t,n),Yn.attributes[e]=o),-1!==o&&(kt.bindBuffer(kt.ARRAY_BUFFER,s),kt.vertexAttribPointer(o,i,kt.FLOAT,!1,0,0),kt.enableVertexAttribArray(o))}function p(e,t,n){var i=Yn.attributes[e];i===r&&(i=kt.getAttribLocation(t,n),Yn.attributes[e]=i),-1!==i&&kt.disableVertexAttribArray(i)}function d(e,t,r,i){var s,o,u,a;if(3===Vn){var f=Ct.color.toRGB(e,t,r);s=f[0],o=f[1],u=f[2]}else s=n.round(255*(e/Rn)),o=n.round(255*(t/Un)),u=n.round(255*(r/zn));return a=n.round(255*(i/qn)),s=0>s?0:s,o=0>o?0:o,u=0>u?0:u,a=0>a?0:a,s=s>255?255:s,o=o>255?255:o,u=u>255?255:u,a=a>255?255:a,4278190080&a<<24|16711680&s<<16|65280&o<<8|255&u}function v(e,t){var r;return 4278190080&e?(r=n.round(255*(t/qn)),r=r>255?255:r,r=0>r?0:r,e-(4278190080&e)+(4278190080&r<<24)):1===Vn?d(e,e,e,t):3===Vn?d(0,0,e/Rn*zn,t):void 0}function g(e){if(Rn>=e&&e>=0){if(1===Vn)return d(e,e,e,qn);if(3===Vn)return d(0,0,e/Rn*zn,qn)}return e?(e>2147483647&&(e-=4294967296),e):void 0}function b(e){var t,n,r;t=(255&e>>16)/255,n=(255&e>>8)/255,r=(255&e)/255;var i,s,o=Ct.max(Ct.max(t,n),r),u=Ct.min(Ct.min(t,n),r);return u===o?[0,0,o*zn]:(s=(o-u)/o,i=t===o?(n-r)/(o-u):n===o?2+(r-t)/(o-u):4+(t-n)/(o-u),i/=6,0>i?i+=1:i>1&&(i-=1),[i*Rn,s*Un,o*zn])}function N(){kt.save()}function C(){kt.restore(),gn=!0,pn=!0}function k(){var e=(Date.now()-Qn)/1e3;Gn++;var t=Gn/e;e>.5&&(Qn=Date.now(),Gn=0,Ct.__frameRate=t),Ct.frameCount++}function M(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n),Ai.push({elem:e,type:t,fn:n})}function _(e){var t=e.elem,n=e.type,r=e.fn;t.removeEventListener?t.removeEventListener(n,r,!1):t.detachEvent&&t.detachEvent("on"+n,r)}function B(e,t,i,s,o,u){var a=0>e?i:t,f=0===o,l=o===r||0>o?0:o,c=n.abs(e);if(f)for(l=1,c*=10;n.abs(n.round(c)-c)>1e-6&&7>l;)++l,c*=10;else 0!==l&&(c*=n.pow(10,l));var h,p=2*c;if(n.floor(c)===c)h=c;else if(n.floor(p)===p){var d=n.floor(c);h=d+d%2}else h=n.round(c);for(var v="",m=s+l;m>0||h>0;)m--,v=""+h%10+v,h=n.floor(h/10);if(u!==r)for(var g=v.length-3-l;g>0;)v=v.substring(0,g)+u+v.substring(g),g-=3;return l>0?a+v.substring(0,v.length-l)+"."+v.substring(v.length-l,v.length):a+v}function j(e,t,n,r,i,s){if(e instanceof Array){for(var o=[],u=0,a=e.length;a>u;u++)o.push(B(e[u],t,n,r,i,s));return o}return B(e,t,n,r,i,s)}function F(e){var t=parseInt("0x"+e,16);return t>2147483647&&(t-=4294967296),t}function I(e){return Array.prototype.slice.call(e,1)}function q(e){return"number"==typeof e?0!==e:"boolean"==typeof e?e:"string"==typeof e?"true"===e.toLowerCase():e instanceof bi?49===e.code||84===e.code||116===e.code:void 0}function R(e){return"number"==typeof e?e:"boolean"==typeof e?e?1:0:"string"==typeof e?parseFloat(e):e instanceof bi?e.code:void 0}function U(e,t){if("number"==typeof e)return 4294967295&e;if("boolean"==typeof e)return e?1:0;if("string"==typeof e){var n=parseInt(e,t||10);return 4294967295&n}return e instanceof bi?e.code:void 0}function W(e,t){var n=e||362436069,r=t||521288629,i=function(){return n=4294967295&36969*(65535&n)+(n>>>16),r=4294967295&18e3*(65535&r)+(r>>>16),4294967295&((65535&n)<<16|65535&r)};this.nextDouble=function(){var e=i()/4294967296;return 0>e?1+e:e},this.nextInt=i}function X(e){function t(e,t,n,r){var i=15&e,s=8>i?t:n,o=4>i?n:12===i||14===i?t:r;return(0===(1&i)?s:-s)+(0===(2&i)?o:-o)}function i(e,t,n){var r=0===(1&e)?t:n;return 0===(2&e)?-r:r}function s(e,t){return 0===(1&e)?-t:t}function o(e,t,n){return t+e*(n-t)}var u,a,f=e!==r?new W(e):W.createRandomized(),l=new x(512);for(u=0;256>u;++u)l[u]=u;for(u=0;256>u;++u){var c=l[a=255&f.nextInt()];l[a]=l[u],l[u]=c}for(u=0;256>u;++u)l[u+256]=l[u];this.noise3d=function(e,r,i){var s=255&n.floor(e),u=255&n.floor(r),a=255&n.floor(i);e-=n.floor(e),r-=n.floor(r),i-=n.floor(i);var f=(3-2*e)*e*e,c=(3-2*r)*r*r,h=(3-2*i)*i*i,p=l[s]+u,d=l[p]+a,v=l[p+1]+a,m=l[s+1]+u,g=l[m]+a,y=l[m+1]+a;return o(h,o(c,o(f,t(l[d],e,r,i),t(l[g],e-1,r,i)),o(f,t(l[v],e,r-1,i),t(l[y],e-1,r-1,i))),o(c,o(f,t(l[d+1],e,r,i-1),t(l[g+1],e-1,r,i-1)),o(f,t(l[v+1],e,r-1,i-1),t(l[y+1],e-1,r-1,i-1))))},this.noise2d=function(e,t){var r=255&n.floor(e),s=255&n.floor(t);e-=n.floor(e),t-=n.floor(t);var u=(3-2*e)*e*e,a=(3-2*t)*t*t,f=l[r]+s,c=l[r+1]+s;return o(a,o(u,i(l[f],e,t),i(l[c],e-1,t)),o(u,i(l[f+1],e,t-1),i(l[c+1],e-1,t-1)))},this.noise1d=function(e){var t=255&n.floor(e);e-=n.floor(e);var r=(3-2*e)*e*e;return o(r,s(l[t],e),s(l[t+1],e-1))}}function V(){ln&&(pn&&(kt.fillStyle=Ct.color.toString(hn),pn=!1),kt.fill())}function $(){dn&&(gn&&(kt.strokeStyle=Ct.color.toString(mn),gn=!1),kt.stroke())}function J(){V(),$(),kt.closePath()}function K(e,n,i){var s=Wi.shift();s===r&&(s={},s.canvas=t.createElement("canvas"),s.context=s.canvas.getContext("2d")),Wi.push(s);var o=s.canvas,u=s.context,a=n||e.width,f=i||e.height;return o.width=a,o.height=f,e?"data"in e?u.putImageData(e,0,0):(u.clearRect(0,0,a,f),u.drawImage(e,0,0,a,f)):u.clearRect(0,0,a,f),s}function Q(e){return{getLength:function(e){return function(){if(e.isRemote)throw"Image is loaded remotely. Cannot get length.";return e.imageData.data.length?e.imageData.data.length/4:0}}(e),getPixel:function(e){return function(t){var n=4*t,r=e.imageData.data;if(e.isRemote)throw"Image is loaded remotely. Cannot get pixels.";return(255&r[n+3])<<24|(255&r[n])<<16|(255&r[n+1])<<8|255&r[n+2]}}(e),setPixel:function(e){return function(t,n){var r=4*t,i=e.imageData.data;if(e.isRemote)throw"Image is loaded remotely. Cannot set pixel.";i[r+0]=255&n>>16,i[r+1]=255&n>>8,i[r+2]=255&n,i[r+3]=255&n>>24,e.__isDirty=!0}}(e),toArray:function(e){return function(){var t=[],n=e.imageData.data,r=e.width*e.height;if(e.isRemote)throw"Image is loaded remotely. Cannot get pixels.";for(var i=0,s=0;r>i;i++,s+=4)t.push((255&n[s+3])<<24|(255&n[s])<<16|(255&n[s+1])<<8|255&n[s+2]);return t}}(e),set:function(e){return function(t){var n,r,i;if(this.isRemote)throw"Image is loaded remotely. Cannot set pixels.";r=e.imageData.data;for(var s=0,o=t.length;o>s;s++)i=t[s],n=4*s,r[n+0]=255&i>>16,r[n+1]=255&i>>8,r[n+2]=255&i,r[n+3]=255&i>>24;e.__isDirty=!0}}(e)}}function Y(e,t){var n;if(e>=Ct.width||0>e||0>t||t>=Ct.height)return 0;if(hr){var r=4*((0|e)+Ct.width*(0|t));return n=Ct.imageData.data,(255&n[r+3])<<24|(255&n[r])<<16|(255&n[r+1])<<8|255&n[r+2]}return n=Ct.toImageData(0|e,0|t,1,1).data,(255&n[3])<<24|(255&n[0])<<16|(255&n[1])<<8|255&n[2]}function Z(e,t,n){if(n.isRemote)throw"Image is loaded remotely. Cannot get x,y.";var r=4*t*n.width+4*e,i=n.imageData.data;return(255&i[r+3])<<24|(255&i[r])<<16|(255&i[r+1])<<8|255&i[r+2]}function et(e,t,n,r){var i=new Xi(n,r,2);return i.fromImageData(Ct.toImageData(e,t,n,r)),i}function tt(e,t,r,i,s){if(s.isRemote)throw"Image is loaded remotely. Cannot get x,y,w,h.";for(var o=new Xi(r,i,2),u=o.imageData.data,a=s.width,f=s.height,l=s.imageData.data,c=n.max(0,-t),h=n.max(0,-e),p=n.min(i,f-t),d=n.min(r,a-e),v=c;p>v;++v)for(var m=4*((t+v)*a+(e+h)),g=4*(v*r+h),y=h;d>y;++y)u[g++]=l[m++],u[g++]=l[m++],u[g++]=l[m++],u[g++]=l[m++];return o.__isDirty=!0,o}function nt(){hr&&(kt=rn,hr=!1,Ct.updatePixels())}function rt(){function e(e,t){function n(){nt(),kt[t].apply(kt,arguments)}e[t]=n}function t(e,t){function n(){return nt(),kt[t]}function r(e){nt(),kt[t]=e}Ct.defineProperty(e,t,{get:n,set:r})}for(var n in kt)"function"==typeof kt[n]?e(this,n):t(this,n)}function it(){hr||(Ct.loadPixels(),null===cr&&(rn=kt,cr=new rt),hr=!0,kt=cr,sn=0)}function st(e,t,n){e<Ct.width&&e>=0&&t>=0&&t<Ct.height&&(it(),Ct.pixels.setPixel((0|e)+Ct.width*(0|t),n),++sn>pr&&nt())}function ot(e,t,n,r){if(r.isRemote)throw"Image is loaded remotely. Cannot set x,y.";var i=Ct.color.toArray(n),s=4*t*r.width+4*e,o=r.imageData.data;o[s]=i[0],o[s+1]=i[1],o[s+2]=i[2],o[s+3]=i[3]}function ut(e){return e instanceof String?e:"number"==typeof e?e===(0|e)?e.toString():Ct.nf(e,0,3):null===e||e===r?"":e.toString()}function at(e,t,n,r){var i,s;e.indexOf("\n")<0?(i=[e],s=1):(i=e.split(/\r?\n/g),s=i.length);var o=0;101===rr?o=ur+ar:3===rr?o=ur/2-(s-1)*fr/2:102===rr&&(o=-(ar+(s-1)*fr));for(var u=0;s>u;++u){var a=i[u];At.text$line(a,t,n+o,r,nr),o+=fr}}function ft(e,t,r,i,s,o){if(0!==e.length&&0!==i&&0!==s&&!(or>s)){for(var u=-1,a=0,f=0,l=[],c=0,h=e.length;h>c;c++){var p=e[c],d=" "===p,v=lr.measureTextWidth(p);if("\n"!==p&&i>=f+v)d&&(u=c),f+=v;else{if(u+1===a){if(!(c>0))return;u=c}"\n"===p?(l.push({text:e.substring(a,c),width:f}),a=c+1):(l.push({text:e.substring(a,u+1),width:f}),a=u+1),f=0,c=a-1}}h>a&&l.push({text:e.substring(a),width:f});var m=1,g=ur;3===nr?m=i/2:39===nr&&(m=i);var y=l.length,b=n.min(y,n.floor(s/fr));101===rr?g=ur+ar:3===rr?g=s/2-fr*(b/2-1):102===rr&&(g=ar+fr);var w,E,S;for(w=0;y>w&&(S=w*fr,!(g+S>s-ar));w++)E=l[w],At.text$line(E.text,t+m,r+g+S,o,nr)}}function lt(e){At="3D"===e?new mi:"2D"===e?new vi:new gi;for(var t in gi.prototype)gi.prototype.hasOwnProperty(t)&&t.indexOf("$")<0&&(Ct[t]=At[t]);At.$init()}function ct(e){return function(){return lt("2D"),At[e].apply(this,arguments)}}function ht(t){var n=t,r=0,i=0;if(Ct.pmouseX=Ct.mouseX,Ct.pmouseY=Ct.mouseY,n.offsetParent)do r+=n.offsetLeft,i+=n.offsetTop;while(n=n.offsetParent);n=t;do r-=n.scrollLeft||0,i-=n.scrollTop||0;while(n=n.parentNode);return r+=on,i+=un,r+=an,i+=fn,r+=e.pageXOffset,i+=e.pageYOffset,{X:r,Y:i}}function pt(e,t){var n=ht(e,t);Ct.mouseX=t.pageX-n.X,Ct.mouseY=t.pageY-n.Y}function dt(e){var t,n=ht(e.changedTouches[0].target,e.changedTouches[0]);for(t=0;t<e.touches.length;t++){var r=e.touches[t];r.offsetX=r.pageX-n.X,r.offsetY=r.pageY-n.Y}for(t=0;t<e.targetTouches.length;t++){var i=e.targetTouches[t];i.offsetX=i.pageX-n.X,i.offsetY=i.pageY-n.Y}for(t=0;t<e.changedTouches.length;t++){var s=e.changedTouches[t];s.offsetX=s.pageX-n.X,s.offsetY=s.pageY-n.Y}return e}function vt(e){var t=e.which||e.keyCode;switch(t){case 13:return 10;case 91:case 93:case 224:return 157;case 57392:return 17;case 46:return 127;case 45:return 155}return t}function mt(e){var t=e.which||e.keyCode,n=e.shiftKey||e.ctrlKey||e.altKey||e.metaKey;switch(t){case 13:t=n?13:10;break;case 8:t=n?127:8}return new bi(t)}function gt(e){return"function"==typeof e.preventDefault?e.preventDefault():"function"==typeof e.stopPropagation&&e.stopPropagation(),!1}function yt(){var e;for(e in dr)if(dr.hasOwnProperty(e))return Ct.__keyPressed=!0,void 0;Ct.__keyPressed=!1}function bt(){Ct.__keyPressed=!1,dr=[],vr=null}function wt(e,t){dr[e]=t,vr=null,Ct.key=t,Ct.keyCode=e,Ct.keyPressed(),Ct.keyCode=0,Ct.keyTyped(),yt()}function Et(e){var t=vt(e);if(127===t)return wt(t,new bi(127)),void 0;if(mr.indexOf(t)<0)return vr=t,void 0;var n=new bi(65535);return Ct.key=n,Ct.keyCode=t,dr[t]=n,Ct.keyPressed(),vr=null,yt(),gt(e)}function St(e){if(null!==vr){var t=vr,n=mt(e);return wt(t,n),gt(e)}}function xt(e){var t=vt(e),n=dr[t];n!==r&&(Ct.key=n,Ct.keyCode=t,Ct.keyReleased(),delete dr[t],yt())}if(!(this instanceof H))throw"called Processing constructor as if it were a function: missing 'new'.";var Tt,Nt=i===r&&o===r;if(Tt=Nt?t.createElement("canvas"):"string"==typeof i?t.getElementById(i):i,!(Tt instanceof HTMLCanvasElement))throw"called Processing constructor without passing canvas element reference or id.";var Ct=this;Ct.externals={canvas:Tt,context:r,sketch:r},Ct.name="Processing.js Instance",Ct.use3DContext=!1,Ct.focused=!1,Ct.breakShape=!1,Ct.glyphTable={},Ct.pmouseX=0,Ct.pmouseY=0,Ct.mouseX=0,Ct.mouseY=0,Ct.mouseButton=0,Ct.mouseScroll=0,Ct.mouseClicked=r,Ct.mouseDragged=r,Ct.mouseMoved=r,Ct.mousePressed=r,Ct.mouseReleased=r,Ct.mouseScrolled=r,Ct.mouseOver=r,Ct.mouseOut=r,Ct.touchStart=r,Ct.touchEnd=r,Ct.touchMove=r,Ct.touchCancel=r,Ct.key=r,Ct.keyCode=r,Ct.keyPressed=m,Ct.keyReleased=m,Ct.keyTyped=m,Ct.draw=r,Ct.setup=r,Ct.__mousePressed=!1,Ct.__keyPressed=!1,Ct.__frameRate=60,Ct.frameCount=0,Ct.width=100,Ct.height=100;var kt,Lt,At,Ot,Mt,_t,Dt,Pt,Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt,Yt,Zt,en,tn,nn,rn,sn,on,un,an,fn,ln=!0,cn=[1,1,1,1],hn=4294967295,pn=!0,dn=!0,vn=[0,0,0,1],mn=4278190080,gn=!0,yn=1,bn=!1,wn=!1,En=!0,Sn=0,xn=0,Tn=3,Nn=0,Cn=0,kn=0,Ln=0,An=60,On=1e3/An,Mn="default",_n=Tt.style.cursor,Dn=20,Pn=[],Hn=0,Bn=20,jn=!1,Fn=-3355444,In=20,qn=255,Rn=255,Un=255,zn=255,Wn=0,Xn=0,Vn=1,$n=null,Jn=null,Kn=Date.now(),Qn=Kn,Gn=0,Yn={attributes:{},locations:{}},Zn={width:0,height:0},er=2,tr=!1,nr=37,rr=0,ir=4,sr="Arial",or=12,ur=9,ar=2,fr=14,lr=h.get(sr,or),cr=null,hr=!1,pr=1e3,dr=[],vr=null,mr=[16,17,18,20,33,34,35,36,37,38,39,40,144,155,112,113,114,115,116,117,118,119,120,121,122,123,157];t.defaultView&&t.defaultView.getComputedStyle&&(on=parseInt(t.defaultView.getComputedStyle(Tt,null).paddingLeft,10)||0,un=parseInt(t.defaultView.getComputedStyle(Tt,null).paddingTop,10)||0,an=parseInt(t.defaultView.getComputedStyle(Tt,null).borderLeftWidth,10)||0,fn=parseInt(t.defaultView.getComputedStyle(Tt,null).borderTopWidth,10)||0);var gr,yr,br,wr,Er,Sr,xr,Tr,Nr,Cr=0,kr=0,Lr=0,Ar=[],Or=[],Mr=[],_r=new w(720),Dr=new w(720),Pr=!1,Hr=!1,Br=60*(n.PI/180),jr=Ct.width/2,Fr=Ct.height/2,Ir=Fr/n.tan(Br/2),qr=Ir/10,Rr=10*Ir,Ur=Ct.width/Ct.height,zr=[],Wr=[],Xr=0,Vr=!1,$r=!1,Jr=!0,Kr=0,Qr=[],Gr=new w([.5,.5,-0.5,.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,.5,-0.5,.5,.5,-0.5,.5,.5,.5,-0.5,.5,.5,-0.5,-0.5,.5,-0.5,-0.5,.5,.5,-0.5,.5,.5,.5,.5,.5,.5,-0.5,.5,.5,.5,.5,-0.5,.5,.5,-0.5,.5,.5,-0.5,-0.5,.5,.5,-0.5,.5,-0.5,-0.5,.5,-0.5,.5,-0.5,-0.5,.5,-0.5,-0.5,.5,-0.5,-0.5,-0.5,.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,.5,-0.5,.5,.5,-0.5,.5,.5,-0.5,.5,-0.5,-0.5,-0.5,-0.5,.5,.5,.5,.5,.5,-0.5,-0.5,.5,-0.5,-0.5,.5,-0.5,-0.5,.5,.5,.5,.5,.5]),Yr=new w([.5,.5,.5,.5,-0.5,.5,.5,.5,-0.5,.5,-0.5,-0.5,-0.5,.5,-0.5,-0.5,-0.5,-0.5,-0.5,.5,.5,-0.5,-0.5,.5,.5,.5,.5,.5,.5,-0.5,.5,.5,-0.5,-0.5,.5,-0.5,-0.5,.5,-0.5,-0.5,.5,.5,-0.5,.5,.5,.5,.5,.5,.5,-0.5,.5,.5,-0.5,-0.5,.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,.5,-0.5,-0.5,.5,.5,-0.5,.5]),Zr=new w([0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]),ei=new w([0,0,0,0,1,0,1,1,0,1,0,0]),ti=new w([0,0,1,0,0,1,0,0,1,0,0,1]),ni="varying vec4 vFrontColor;attribute vec3 aVertex;attribute vec4 aColor;uniform mat4 uView;uniform mat4 uProjection;uniform float uPointSize;void main(void) {  vFrontColor = aColor;  gl_PointSize = uPointSize;  gl_Position = uProjection * uView * vec4(aVertex, 1.0);}",ri="#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 vFrontColor;uniform bool uSmooth;void main(void){  if(uSmooth == true){    float dist = distance(gl_PointCoord, vec2(0.5));    if(dist > 0.5){      discard;    }  }  gl_FragColor = vFrontColor;}",ii="varying vec4 vFrontColor;attribute vec3 aVertex;attribute vec2 aTextureCoord;uniform vec4 uColor;uniform mat4 uModel;uniform mat4 uView;uniform mat4 uProjection;uniform float uPointSize;varying vec2 vTextureCoord;void main(void) {  gl_PointSize = uPointSize;  vFrontColor = uColor;  gl_Position = uProjection * uView * uModel * vec4(aVertex, 1.0);  vTextureCoord = aTextureCoord;}",si="#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 vFrontColor;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform int uIsDrawingText;uniform bool uSmooth;void main(void){  if(uSmooth == true){    float dist = distance(gl_PointCoord, vec2(0.5));    if(dist > 0.5){      discard;    }  }  if(uIsDrawingText == 1){    float alpha = texture2D(uSampler, vTextureCoord).a;    gl_FragColor = vec4(vFrontColor.rgb * alpha, alpha);  }  else{    gl_FragColor = vFrontColor;  }}",oi=/Windows/.test(navigator.userAgent),ui="varying vec4 vFrontColor;attribute vec3 aVertex;attribute vec3 aNormal;attribute vec4 aColor;attribute vec2 aTexture;varying   vec2 vTexture;uniform vec4 uColor;uniform bool uUsingMat;uniform vec3 uSpecular;uniform vec3 uMaterialEmissive;uniform vec3 uMaterialAmbient;uniform vec3 uMaterialSpecular;uniform float uShininess;uniform mat4 uModel;uniform mat4 uView;uniform mat4 uProjection;uniform mat4 uNormalTransform;uniform int uLightCount;uniform vec3 uFalloff;struct Light {  int type;  vec3 color;  vec3 position;  vec3 direction;  float angle;  vec3 halfVector;  float concentration;};uniform Light uLights0;uniform Light uLights1;uniform Light uLights2;uniform Light uLights3;uniform Light uLights4;uniform Light uLights5;uniform Light uLights6;uniform Light uLights7;Light getLight(int index){  if(index == 0) return uLights0;  if(index == 1) return uLights1;  if(index == 2) return uLights2;  if(index == 3) return uLights3;  if(index == 4) return uLights4;  if(index == 5) return uLights5;  if(index == 6) return uLights6;  return uLights7;}void AmbientLight( inout vec3 totalAmbient, in vec3 ecPos, in Light light ) {  float d = length( light.position - ecPos );  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ));  totalAmbient += light.color * attenuation;}void DirectionalLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float powerFactor = 0.0;  float nDotVP = max(0.0, dot( vertNormal, normalize(-light.position) ));  float nDotVH = max(0.0, dot( vertNormal, normalize(-light.position-normalize(ecPos) )));  if( nDotVP != 0.0 ){    powerFactor = pow( nDotVH, uShininess );  }  col += light.color * nDotVP;  spec += uSpecular * powerFactor;}void PointLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float powerFactor;   vec3 VP = light.position - ecPos;  float d = length( VP );   VP = normalize( VP );  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ));  float nDotVP = max( 0.0, dot( vertNormal, VP ));  vec3 halfVector = normalize( VP - normalize(ecPos) );  float nDotHV = max( 0.0, dot( vertNormal, halfVector ));  if( nDotVP == 0.0 ) {    powerFactor = 0.0;  }  else {    powerFactor = pow( nDotHV, uShininess );  }  spec += uSpecular * powerFactor * attenuation;  col += light.color * nDotVP * attenuation;}void SpotLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float spotAttenuation;  float powerFactor = 0.0;  vec3 VP = light.position - ecPos;  vec3 ldir = normalize( -light.direction );  float d = length( VP );  VP = normalize( VP );  float attenuation = 1.0 / ( uFalloff[0] + ( uFalloff[1] * d ) + ( uFalloff[2] * d * d ) );  float spotDot = dot( VP, ldir );"+(oi?"  spotAttenuation = 1.0; ":"  if( spotDot > cos( light.angle ) ) {    spotAttenuation = pow( spotDot, light.concentration );  }  else{    spotAttenuation = 0.0;  }  attenuation *= spotAttenuation;")+"  float nDotVP = max( 0.0, dot( vertNormal, VP ) );"+"  vec3 halfVector = normalize( VP - normalize(ecPos) );"+"  float nDotHV = max( 0.0, dot( vertNormal, halfVector ) );"+"  if( nDotVP != 0.0 ) {"+"    powerFactor = pow( nDotHV, uShininess );"+"  }"+"  spec += uSpecular * powerFactor * attenuation;"+"  col += light.color * nDotVP * attenuation;"+"}"+"void main(void) {"+"  vec3 finalAmbient = vec3( 0.0 );"+"  vec3 finalDiffuse = vec3( 0.0 );"+"  vec3 finalSpecular = vec3( 0.0 );"+"  vec4 col = uColor;"+"  if ( uColor[0] == -1.0 ){"+"    col = aColor;"+"  }"+"  vec3 norm = normalize(vec3( uNormalTransform * vec4( aNormal, 0.0 ) ));"+"  vec4 ecPos4 = uView * uModel * vec4(aVertex, 1.0);"+"  vec3 ecPos = (vec3(ecPos4))/ecPos4.w;"+"  if( uLightCount == 0 ) {"+"    vFrontColor = col + vec4(uMaterialSpecular, 1.0);"+"  }"+"  else {"+"    for( int i = 0; i < 8; i++ ) {"+"      Light l = getLight(i);"+"      if( i >= uLightCount ){"+"        break;"+"      }"+"      if( l.type == 0 ) {"+"        AmbientLight( finalAmbient, ecPos, l );"+"      }"+"      else if( l.type == 1 ) {"+"        DirectionalLight( finalDiffuse, finalSpecular, norm, ecPos, l );"+"      }"+"      else if( l.type == 2 ) {"+"        PointLight( finalDiffuse, finalSpecular, norm, ecPos, l );"+"      }"+"      else {"+"        SpotLight( finalDiffuse, finalSpecular, norm, ecPos, l );"+"      }"+"    }"+"   if( uUsingMat == false ) {"+"     vFrontColor = vec4("+"       vec3( col ) * finalAmbient +"+"       vec3( col ) * finalDiffuse +"+"       vec3( col ) * finalSpecular,"+"       col[3] );"+"   }"+"   else{"+"     vFrontColor = vec4( "+"       uMaterialEmissive + "+"       (vec3(col) * uMaterialAmbient * finalAmbient ) + "+"       (vec3(col) * finalDiffuse) + "+"       (uMaterialSpecular * finalSpecular), "+"       col[3] );"+"    }"+"  }"+"  vTexture.xy = aTexture.xy;"+"  gl_Position = uProjection * uView * uModel * vec4( aVertex, 1.0 );"+"}",ai="#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 vFrontColor;uniform sampler2D uSampler;uniform bool uUsingTexture;varying vec2 vTexture;void main(void){  if( uUsingTexture ){    gl_FragColor = vec4(texture2D(uSampler, vTexture.xy)) * vFrontColor;  }  else{    gl_FragColor = vFrontColor;  }}",fi=function(e,t,n){var r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw e.getShaderInfoLog(r);var i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw e.getShaderInfoLog(i);var s=e.createProgram();if(e.attachShader(s,r),e.attachShader(s,i),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw"Error linking shaders.";return s},li=function(e,t,n,r){return{x:e,y:t,w:n,h:r}},ci=li,hi=function(e,t,n,r,i){return{x:e,y:t,w:i?n:n-e,h:i?r:r-t}},pi=function(e,t,n,r){return{x:e-n/2,y:t-r/2,w:n,h:r}},di=function(){},vi=function(){},mi=function(){},gi=function(){};vi.prototype=new di,vi.prototype.constructor=vi,mi.prototype=new di,mi.prototype.constructor=mi,gi.prototype=new di,gi.prototype.constructor=gi,di.prototype.a3DOnlyFunction=m;var yi={},bi=Ct.Character=function(e){return this.code="string"==typeof e&&1===e.length?e.charCodeAt(0):"number"==typeof e?e:e instanceof bi?e:0/0,yi[this.code]===r?yi[this.code]=this:yi[this.code]};bi.prototype.toString=function(){return String.fromCharCode(this.code)},bi.prototype.valueOf=function(){return this.code};var wi=Ct.PShape=function(e){this.family=e||0,this.visible=!0,this.style=!0,this.children=[],this.nameTable=[],this.params=[],this.name="",this.image=null,this.matrix=null,this.kind=null,this.close=null,this.width=null,this.height=null,this.parent=null};wi.prototype={isVisible:function(){return this.visible},setVisible:function(e){this.visible=e},disableStyle:function(){this.style=!1;for(var e=0,t=this.children.length;t>e;e++)this.children[e].disableStyle()},enableStyle:function(){this.style=!0;for(var e=0,t=this.children.length;t>e;e++)this.children[e].enableStyle()},getFamily:function(){return this.family},getWidth:function(){return this.width},getHeight:function(){return this.height},setName:function(e){this.name=e},getName:function(){return this.name},draw:function(e){e=e||Ct,this.visible&&(this.pre(e),this.drawImpl(e),this.post(e))},drawImpl:function(e){0===this.family?this.drawGroup(e):1===this.family?this.drawPrimitive(e):3===this.family?this.drawGeometry(e):21===this.family&&this.drawPath(e)},drawPath:function(e){var t,n;if(0!==this.vertices.length){if(e.beginShape(),0===this.vertexCodes.length)if(2===this.vertices[0].length)for(t=0,n=this.vertices.length;n>t;t++)e.vertex(this.vertices[t][0],this.vertices[t][1]);else for(t=0,n=this.vertices.length;n>t;t++)e.vertex(this.vertices[t][0],this.vertices[t][1],this.vertices[t][2]);else{var r=0;if(2===this.vertices[0].length)for(t=0,n=this.vertexCodes.length;n>t;t++)0===this.vertexCodes[t]?(e.vertex(this.vertices[r][0],this.vertices[r][1],this.vertices[r].moveTo),e.breakShape=!1,r++):1===this.vertexCodes[t]?(e.bezierVertex(this.vertices[r+0][0],this.vertices[r+0][1],this.vertices[r+1][0],this.vertices[r+1][1],this.vertices[r+2][0],this.vertices[r+2][1]),r+=3):2===this.vertexCodes[t]?(e.curveVertex(this.vertices[r][0],this.vertices[r][1]),r++):3===this.vertexCodes[t]&&(e.breakShape=!0);else for(t=0,n=this.vertexCodes.length;n>t;t++)0===this.vertexCodes[t]?(e.vertex(this.vertices[r][0],this.vertices[r][1],this.vertices[r][2]),this.vertices[r].moveTo===!0?zr[zr.length-1].moveTo=!0:this.vertices[r].moveTo===!1&&(zr[zr.length-1].moveTo=!1),e.breakShape=!1):1===this.vertexCodes[t]?(e.bezierVertex(this.vertices[r+0][0],this.vertices[r+0][1],this.vertices[r+0][2],this.vertices[r+1][0],this.vertices[r+1][1],this.vertices[r+1][2],this.vertices[r+2][0],this.vertices[r+2][1],this.vertices[r+2][2]),r+=3):2===this.vertexCodes[t]?(e.curveVertex(this.vertices[r][0],this.vertices[r][1],this.vertices[r][2]),r++):3===this.vertexCodes[t]&&(e.breakShape=!0)}e.endShape(this.close?2:1)}},drawGeometry:function(e){var t,n;if(e.beginShape(this.kind),this.style)for(t=0,n=this.vertices.length;n>t;t++)e.vertex(this.vertices[t]);else for(t=0,n=this.vertices.length;n>t;t++){var r=this.vertices[t];0===r[2]?e.vertex(r[0],r[1]):e.vertex(r[0],r[1],r[2])}e.endShape()},drawGroup:function(e){for(var t=0,n=this.children.length;n>t;t++)this.children[t].draw(e)},drawPrimitive:function(e){if(2===this.kind)e.point(this.params[0],this.params[1]);else if(4===this.kind)4===this.params.length?e.line(this.params[0],this.params[1],this.params[2],this.params[3]):e.line(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]);else if(8===this.kind)e.triangle(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]);else if(16===this.kind)e.quad(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5],this.params[6],this.params[7]);else if(30===this.kind)if(null!==this.image){var t=ci;e.imageMode(0),e.image(this.image,this.params[0],this.params[1],this.params[2],this.params[3]),ci=t}else{var n=xn;e.rectMode(0),e.rect(this.params[0],this.params[1],this.params[2],this.params[3]),xn=n}else if(31===this.kind){var r=Tn;e.ellipseMode(0),e.ellipse(this.params[0],this.params[1],this.params[2],this.params[3]),Tn=r}else if(32===this.kind){var i=Tn;e.ellipseMode(0),e.arc(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]),Tn=i}else 41===this.kind?1===this.params.length?e.box(this.params[0]):e.box(this.params[0],this.params[1],this.params[2]):40===this.kind&&e.sphere(this.params[0])},pre:function(e){this.matrix&&(e.pushMatrix(),e.transform(this.matrix)),this.style&&(e.pushStyle(),this.styles(e))},post:function(e){this.matrix&&e.popMatrix(),this.style&&e.popStyle()},styles:function(e){this.stroke?(e.stroke(this.strokeColor),e.strokeWeight(this.strokeWeight),e.strokeCap(this.strokeCap),e.strokeJoin(this.strokeJoin)):e.noStroke(),this.fill?e.fill(this.fillColor):e.noFill()},getChild:function(e){var t,n;if("number"==typeof e)return this.children[e];var r;if(""===e||this.name===e)return this;if(this.nameTable.length>0){for(t=0,n=this.nameTable.length;n>t||r;t++)if(this.nameTable[t].getName===e){r=this.nameTable[t];break}if(r)return r}for(t=0,n=this.children.length;n>t;t++)if(r=this.children[t].getChild(e))return r;return null},getChildCount:function(){return this.children.length},addChild:function(e){this.children.push(e),e.parent=this,null!==e.getName()&&this.addName(e.getName(),e)},addName:function(e,t){null!==this.parent?this.parent.addName(e,t):this.nameTable.push([e,t])},translate:function(){2===arguments.length?(this.checkMatrix(2),this.matrix.translate(arguments[0],arguments[1])):(this.checkMatrix(3),this.matrix.translate(arguments[0],arguments[1],0))},checkMatrix:function(e){null===this.matrix?this.matrix=2===e?new Ct.PMatrix2D:new Ct.PMatrix3D:3===e&&this.matrix instanceof Ct.PMatrix2D&&(this.matrix=new Ct.PMatrix3D)},rotateX:function(e){this.rotate(e,1,0,0)},rotateY:function(e){this.rotate(e,0,1,0)},rotateZ:function(e){this.rotate(e,0,0,1)},rotate:function(){1===arguments.length?(this.checkMatrix(2),this.matrix.rotate(arguments[0])):(this.checkMatrix(3),this.matrix.rotate(arguments[0],arguments[1],arguments[2],arguments[3]))},scale:function(){2===arguments.length?(this.checkMatrix(2),this.matrix.scale(arguments[0],arguments[1])):3===arguments.length?(this.checkMatrix(2),this.matrix.scale(arguments[0],arguments[1],arguments[2])):(this.checkMatrix(2),this.matrix.scale(arguments[0]))},resetMatrix:function(){this.checkMatrix(2),this.matrix.reset()},applyMatrix:function(e){1===arguments.length?this.applyMatrix(e.elements[0],e.elements[1],0,e.elements[2],e.elements[3],e.elements[4],0,e.elements[5],0,0,1,0,0,0,0,1):6===arguments.length?(this.checkMatrix(2),this.matrix.apply(arguments[0],arguments[1],arguments[2],0,arguments[3],arguments[4],arguments[5],0,0,0,1,0,0,0,0,1)):16===arguments.length&&(this.checkMatrix(3),this.matrix.apply(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15]))}};var Ei=Ct.PShapeSVG=function(){if(Ct.PShape.call(this),1===arguments.length){if(this.element=arguments[0],this.vertexCodes=[],this.vertices=[],this.opacity=1,this.stroke=!1,this.strokeColor=4278190080,this.strokeWeight=1,this.strokeCap="butt",this.strokeJoin="miter",this.strokeGradient=null,this.strokeGradientPaint=null,this.strokeName=null,this.strokeOpacity=1,this.fill=!0,this.fillColor=4278190080,this.fillGradient=null,this.fillGradientPaint=null,this.fillName=null,this.fillOpacity=1,"svg"!==this.element.getName())throw"root is not <svg>, it's <"+this.element.getName()+">"}else 2===arguments.length&&("string"==typeof arguments[1]?arguments[1].indexOf(".svg")>-1&&(this.element=new Ct.XMLElement(Ct,arguments[1]),this.vertexCodes=[],this.vertices=[],this.opacity=1,this.stroke=!1,this.strokeColor=4278190080,this.strokeWeight=1,this.strokeCap="butt",this.strokeJoin="miter",this.strokeGradient="",this.strokeGradientPaint="",this.strokeName="",this.strokeOpacity=1,this.fill=!0,this.fillColor=4278190080,this.fillGradient=null,this.fillGradientPaint=null,this.fillOpacity=1):arguments[0]&&(this.element=arguments[1],this.vertexCodes=arguments[0].vertexCodes.slice(),this.vertices=arguments[0].vertices.slice(),this.stroke=arguments[0].stroke,this.strokeColor=arguments[0].strokeColor,this.strokeWeight=arguments[0].strokeWeight,this.strokeCap=arguments[0].strokeCap,this.strokeJoin=arguments[0].strokeJoin,this.strokeGradient=arguments[0].strokeGradient,this.strokeGradientPaint=arguments[0].strokeGradientPaint,this.strokeName=arguments[0].strokeName,this.fill=arguments[0].fill,this.fillColor=arguments[0].fillColor,this.fillGradient=arguments[0].fillGradient,this.fillGradientPaint=arguments[0].fillGradientPaint,this.fillName=arguments[0].fillName,this.strokeOpacity=arguments[0].strokeOpacity,this.fillOpacity=arguments[0].fillOpacity,this.opacity=arguments[0].opacity));this.name=this.element.getStringAttribute("id");var e=this.element.getStringAttribute("display","inline");this.visible="none"!==e;var t=this.element.getAttribute("transform");t&&(this.matrix=this.parseMatrix(t));var n=this.element.getStringAttribute("viewBox");if(null!==n){var r=n.split(" ");this.width=r[2],this.height=r[3]}var i=this.element.getStringAttribute("width"),s=this.element.getStringAttribute("height");if(null!==i)this.width=this.parseUnitSize(i),this.height=this.parseUnitSize(s);else if(0===this.width||0===this.height)throw this.width=1,this.height=1,"The width and/or height is not readable in the <svg> tag of this file.";this.parseColors(this.element),this.parseChildren(this.element)};Ei.prototype=new wi,Ei.prototype.parseMatrix=function(){function e(e){var t=[];return e.replace(/\((.*?)\)/,function(){return function(e,n){t=n.replace(/,+/g," ").split(/\s+/)}}()),t}return function(t){this.checkMatrix(2);var n=[];if(t.replace(/\s*(\w+)\((.*?)\)/g,function(e){n.push(Ct.trim(e))}),0===n.length)return null;for(var r=0,i=n.length;i>r;r++){var s=e(n[r]);if(-1!==n[r].indexOf("matrix"))this.matrix.set(s[0],s[2],s[4],s[1],s[3],s[5]);else if(-1!==n[r].indexOf("translate")){var o=s[0],u=2===s.length?s[1]:0;this.matrix.translate(o,u)}else if(-1!==n[r].indexOf("scale")){var a=s[0],f=2===s.length?s[1]:s[0];this.matrix.scale(a,f)}else if(-1!==n[r].indexOf("rotate")){var l=s[0];1===s.length?this.matrix.rotate(Ct.radians(l)):3===s.length&&(this.matrix.translate(s[1],s[2]),this.matrix.rotate(Ct.radians(s[0])),this.matrix.translate(-s[1],-s[2]))}else-1!==n[r].indexOf("skewX")?this.matrix.skewX(parseFloat(s[0])):-1!==n[r].indexOf("skewY")?this.matrix.skewY(s[0]):-1!==n[r].indexOf("shearX")?this.matrix.shearX(s[0]):-1!==n[r].indexOf("shearY")&&this.matrix.shearY(s[0])}return this.matrix}}(),Ei.prototype.parseChildren=function(e){for(var t=e.getChildren(),n=new Ct.PShape,r=0,i=t.length;i>r;r++){var s=this.parseChild(t[r]);s&&n.addChild(s)}this.children.push(n)},Ei.prototype.getName=function(){return this.name},Ei.prototype.parseChild=function(e){var t,n=e.getName();return"g"===n?t=new Ei(this,e):"defs"===n?t=new Ei(this,e):"line"===n?(t=new Ei(this,e),t.parseLine()):"circle"===n?(t=new Ei(this,e),t.parseEllipse(!0)):"ellipse"===n?(t=new Ei(this,e),t.parseEllipse(!1)):"rect"===n?(t=new Ei(this,e),t.parseRect()):"polygon"===n?(t=new Ei(this,e),t.parsePoly(!0)):"polyline"===n?(t=new Ei(this,e),t.parsePoly(!1)):"path"===n?(t=new Ei(this,e),t.parsePath()):"radialGradient"===n?u("PShapeSVG.prototype.parseChild, name = radialGradient"):"linearGradient"===n?u("PShapeSVG.prototype.parseChild, name = linearGradient"):"text"===n?u("PShapeSVG.prototype.parseChild, name = text"):"filter"===n?u("PShapeSVG.prototype.parseChild, name = filter"):"mask"===n?u("PShapeSVG.prototype.parseChild, name = mask"):m(),t},Ei.prototype.parsePath=function(){this.family=21,this.kind=0;var e=Ct.trim(this.element.getStringAttribute("d").replace(/[\s,]+/g," "));if(null!==e){e=Ct.__toCharArray(e);for(var t,n,r,i,s=0,o=0,u=0,a=0,f=0,l=0,c=0,h=0,p=0,d=0,v=0,m=0,g=0,y=0,b=0,w=0,E="",S=[],x=!1;b<e.length;)if(w=e[b].valueOf(),w>=65&&90>=w||w>=97&&122>=w){if(r=b,b++,b<e.length)for(S=[],w=e[b].valueOf();!(w>=65&&90>=w||w>=97&&100>=w||w>=102&&122>=w)&&x===!1;)32===w?(""!==E&&(S.push(parseFloat(E)),E=""),b++):45===w?101===e[b-1].valueOf()?(E+=e[b].toString(),b++):(""!==E&&S.push(parseFloat(E)),E=e[b].toString(),b++):(E+=e[b].toString(),b++),b===e.length?x=!0:w=e[b].valueOf();if(""!==E&&(S.push(parseFloat(E)),E=""),n=e[r],w=n.valueOf(),77===w){if(S.length>=2&&0===S.length%2&&(s=S[0],o=S[1],this.parsePathMoveto(s,o),S.length>2))for(r=2,i=S.length;i>r;r+=2)s=S[r],o=S[r+1],this.parsePathLineto(s,o)}else if(109===w){if(S.length>=2&&0===S.length%2&&(s+=S[0],o+=S[1],this.parsePathMoveto(s,o),S.length>2))for(r=2,i=S.length;i>r;r+=2)s+=S[r],o+=S[r+1],this.parsePathLineto(s,o)}else if(76===w){if(S.length>=2&&0===S.length%2)for(r=0,i=S.length;i>r;r+=2)s=S[r],o=S[r+1],this.parsePathLineto(s,o)}else if(108===w){if(S.length>=2&&0===S.length%2)for(r=0,i=S.length;i>r;r+=2)s+=S[r],o+=S[r+1],this.parsePathLineto(s,o)}else if(72===w)for(r=0,i=S.length;i>r;r++)s=S[r],this.parsePathLineto(s,o);else if(104===w)for(r=0,i=S.length;i>r;r++)s+=S[r],this.parsePathLineto(s,o);else if(86===w)for(r=0,i=S.length;i>r;r++)o=S[r],this.parsePathLineto(s,o);else if(118===w)for(r=0,i=S.length;i>r;r++)o+=S[r],this.parsePathLineto(s,o);else if(67===w){if(S.length>=6&&0===S.length%6)for(r=0,i=S.length;i>r;r+=6)f=S[r],c=S[r+1],l=S[r+2],h=S[r+3],p=S[r+4],d=S[r+5],this.parsePathCurveto(f,c,l,h,p,d),s=p,o=d}else if(99===w){if(S.length>=6&&0===S.length%6)for(r=0,i=S.length;i>r;r+=6)f=s+S[r],c=o+S[r+1],l=s+S[r+2],h=o+S[r+3],p=s+S[r+4],d=o+S[r+5],this.parsePathCurveto(f,c,l,h,p,d),s=p,o=d}else if(83===w){if(S.length>=4&&0===S.length%4)for(r=0,i=S.length;i>r;r+=4)"c"===t.toLowerCase()||"s"===t.toLowerCase()?(v=this.vertices[this.vertices.length-2][0],m=this.vertices[this.vertices.length-2][1],g=this.vertices[this.vertices.length-1][0],y=this.vertices[this.vertices.length-1][1],f=g+(g-v),c=y+(y-m)):(f=this.vertices[this.vertices.length-1][0],c=this.vertices[this.vertices.length-1][1]),l=S[r],h=S[r+1],p=S[r+2],d=S[r+3],this.parsePathCurveto(f,c,l,h,p,d),s=p,o=d}else if(115===w){if(S.length>=4&&0===S.length%4)for(r=0,i=S.length;i>r;r+=4)"c"===t.toLowerCase()||"s"===t.toLowerCase()?(v=this.vertices[this.vertices.length-2][0],m=this.vertices[this.vertices.length-2][1],g=this.vertices[this.vertices.length-1][0],y=this.vertices[this.vertices.length-1][1],f=g+(g-v),c=y+(y-m)):(f=this.vertices[this.vertices.length-1][0],c=this.vertices[this.vertices.length-1][1]),l=s+S[r],h=o+S[r+1],p=s+S[r+2],d=o+S[r+3],this.parsePathCurveto(f,c,l,h,p,d),s=p,o=d}else if(81===w){if(S.length>=4&&0===S.length%4)for(r=0,i=S.length;i>r;r+=4)u=S[r],a=S[r+1],p=S[r+2],d=S[r+3],this.parsePathQuadto(s,o,u,a,p,d),s=p,o=d}else if(113===w){if(S.length>=4&&0===S.length%4)for(r=0,i=S.length;i>r;r+=4)u=s+S[r],a=o+S[r+1],p=s+S[r+2],d=o+S[r+3],this.parsePathQuadto(s,o,u,a,p,d),s=p,o=d}else if(84===w){if(S.length>=2&&0===S.length%2)for(r=0,i=S.length;i>r;r+=2)"q"===t.toLowerCase()||"t"===t.toLowerCase()?(v=this.vertices[this.vertices.length-2][0],m=this.vertices[this.vertices.length-2][1],g=this.vertices[this.vertices.length-1][0],y=this.vertices[this.vertices.length-1][1],u=g+(g-v),a=y+(y-m)):(u=s,a=o),p=S[r],d=S[r+1],this.parsePathQuadto(s,o,u,a,p,d),s=p,o=d}else if(116===w){if(S.length>=2&&0===S.length%2)for(r=0,i=S.length;i>r;r+=2)"q"===t.toLowerCase()||"t"===t.toLowerCase()?(v=this.vertices[this.vertices.length-2][0],m=this.vertices[this.vertices.length-2][1],g=this.vertices[this.vertices.length-1][0],y=this.vertices[this.vertices.length-1][1],u=g+(g-v),a=y+(y-m)):(u=s,a=o),p=s+S[r],d=o+S[r+1],this.parsePathQuadto(s,o,u,a,p,d),s=p,o=d}else(90===w||122===w)&&(this.close=!0);t=n.toString()}else b++}},Ei.prototype.parsePathQuadto=function(e,t,n,r,i,s){if(!(this.vertices.length>0))throw"Path must start with M/m";this.parsePathCode(1),this.parsePathVertex(e+2*(n-e)/3,t+2*(r-t)/3),this.parsePathVertex(i+2*(n-i)/3,s+2*(r-s)/3),this.parsePathVertex(i,s)},Ei.prototype.parsePathCurveto=function(e,t,n,r,i,s){if(!(this.vertices.length>0))throw"Path must start with M/m";this.parsePathCode(1),this.parsePathVertex(e,t),this.parsePathVertex(n,r),this.parsePathVertex(i,s)},Ei.prototype.parsePathLineto=function(e,t){if(!(this.vertices.length>0))throw"Path must start with M/m";this.parsePathCode(0),this.parsePathVertex(e,t),this.vertices[this.vertices.length-1].moveTo=!1},Ei.prototype.parsePathMoveto=function(e,t){this.vertices.length>0&&this.parsePathCode(3),this.parsePathCode(0),this.parsePathVertex(e,t),this.vertices[this.vertices.length-1].moveTo=!0},Ei.prototype.parsePathVertex=function(e,t){var n=[];n[0]=e,n[1]=t,this.vertices.push(n)},Ei.prototype.parsePathCode=function(e){this.vertexCodes.push(e)},Ei.prototype.parsePoly=function(e){this.family=21,this.close=e;var t=Ct.trim(this.element.getStringAttribute("points").replace(/[,\s]+/g," "));if(null!==t){var n=t.split(" ");if(0!==n.length%2)throw"Error parsing polygon points: odd number of coordinates provided";for(var r=0,i=n.length;i>r;r++){var s=[];s[0]=n[r],s[1]=n[++r],this.vertices.push(s)}}},Ei.prototype.parseRect=function(){if(this.kind=30,this.family=1,this.params=[],this.params[0]=this.element.getFloatAttribute("x"),this.params[1]=this.element.getFloatAttribute("y"),this.params[2]=this.element.getFloatAttribute("width"),this.params[3]=this.element.getFloatAttribute("height"),this.params[2]<0||this.params[3]<0)throw"svg error: negative width or height found while parsing <rect>"},Ei.prototype.parseEllipse=function(e){this.kind=31,this.family=1,this.params=[],this.params[0]=0|this.element.getFloatAttribute("cx"),this.params[1]=0|this.element.getFloatAttribute("cy");var t,n;if(e){if(t=n=this.element.getFloatAttribute("r"),0>t)throw"svg error: negative radius found while parsing <circle>"}else if(t=this.element.getFloatAttribute("rx"),n=this.element.getFloatAttribute("ry"),0>t||0>n)throw"svg error: negative x-axis radius or y-axis radius found while parsing <ellipse>";this.params[0]-=t,this.params[1]-=n,this.params[2]=2*t,this.params[3]=2*n},Ei.prototype.parseLine=function(){this.kind=4,this.family=1,this.params=[],this.params[0]=this.element.getFloatAttribute("x1"),this.params[1]=this.element.getFloatAttribute("y1"),this.params[2]=this.element.getFloatAttribute("x2"),this.params[3]=this.element.getFloatAttribute("y2")},Ei.prototype.parseColors=function(e){if(e.hasAttribute("opacity")&&this.setOpacity(e.getAttribute("opacity")),e.hasAttribute("stroke")&&this.setStroke(e.getAttribute("stroke")),e.hasAttribute("stroke-width")&&this.setStrokeWeight(e.getAttribute("stroke-width")),e.hasAttribute("stroke-linejoin")&&this.setStrokeJoin(e.getAttribute("stroke-linejoin")),e.hasAttribute("stroke-linecap")&&this.setStrokeCap(e.getStringAttribute("stroke-linecap")),e.hasAttribute("fill")&&this.setFill(e.getStringAttribute("fill")),e.hasAttribute("style"))for(var t=e.getStringAttribute("style"),n=t.toString().split(";"),r=0,i=n.length;i>r;r++){var s=Ct.trim(n[r].split(":"));"fill"===s[0]?this.setFill(s[1]):"fill-opacity"===s[0]?this.setFillOpacity(s[1]):"stroke"===s[0]?this.setStroke(s[1]):"stroke-width"===s[0]?this.setStrokeWeight(s[1]):"stroke-linecap"===s[0]?this.setStrokeCap(s[1]):"stroke-linejoin"===s[0]?this.setStrokeJoin(s[1]):"stroke-opacity"===s[0]?this.setStrokeOpacity(s[1]):"opacity"===s[0]&&this.setOpacity(s[1])}},Ei.prototype.setFillOpacity=function(e){this.fillOpacity=parseFloat(e),this.fillColor=255*this.fillOpacity<<24|16777215&this.fillColor},Ei.prototype.setFill=function(e){var t=4278190080&this.fillColor;"none"===e?this.fill=!1:0===e.indexOf("#")?(this.fill=!0,4===e.length&&(e=e.replace(/#(.)(.)(.)/,"#$1$1$2$2$3$3")),this.fillColor=t|16777215&parseInt(e.substring(1),16)):0===e.indexOf("rgb")?(this.fill=!0,this.fillColor=t|this.parseRGB(e)):0===e.indexOf("url(#")?this.fillName=e.substring(5,e.length-1):O[e]&&(this.fill=!0,this.fillColor=t|16777215&parseInt(O[e].substring(1),16))},Ei.prototype.setOpacity=function(e){this.strokeColor=255*parseFloat(e)<<24|16777215&this.strokeColor,this.fillColor=255*parseFloat(e)<<24|16777215&this.fillColor},Ei.prototype.setStroke=function(e){var t=4278190080&this.strokeColor;"none"===e?this.stroke=!1:"#"===e.charAt(0)?(this.stroke=!0,4===e.length&&(e=e.replace(/#(.)(.)(.)/,"#$1$1$2$2$3$3")),this.strokeColor=t|16777215&parseInt(e.substring(1),16)):0===e.indexOf("rgb")?(this.stroke=!0,this.strokeColor=t|this.parseRGB(e)):0===e.indexOf("url(#")?this.strokeName=e.substring(5,e.length-1):O[e]&&(this.stroke=!0,this.strokeColor=t|16777215&parseInt(O[e].substring(1),16))},Ei.prototype.setStrokeWeight=function(e){this.strokeWeight=this.parseUnitSize(e)},Ei.prototype.setStrokeJoin=function(e){"miter"===e?this.strokeJoin="miter":"round"===e?this.strokeJoin="round":"bevel"===e&&(this.strokeJoin="bevel")},Ei.prototype.setStrokeCap=function(e){"butt"===e?this.strokeCap="butt":"round"===e?this.strokeCap="round":"square"===e&&(this.strokeCap="square")},Ei.prototype.setStrokeOpacity=function(e){this.strokeOpacity=parseFloat(e),this.strokeColor=255*this.strokeOpacity<<24|16777215&this.strokeColor},Ei.prototype.parseRGB=function(e){var t=e.substring(e.indexOf("(")+1,e.indexOf(")")),n=t.split(", ");return n[0]<<16|n[1]<<8|n[2]},Ei.prototype.parseUnitSize=function(e){var t=e.length-2;return 0>t?e:e.indexOf("pt")===t?1.25*parseFloat(e.substring(0,t)):e.indexOf("pc")===t?15*parseFloat(e.substring(0,t)):e.indexOf("mm")===t?3.543307*parseFloat(e.substring(0,t)):e.indexOf("cm")===t?35.43307*parseFloat(e.substring(0,t)):e.indexOf("in")===t?90*parseFloat(e.substring(0,t)):e.indexOf("px")===t?parseFloat(e.substring(0,t)):parseFloat(e)},Ct.shape=function(e,t,n,r,i){arguments.length>=1&&null!==arguments[0]&&e.isVisible()&&(Ct.pushMatrix(),3===Kr?5===arguments.length?(Ct.translate(t-r/2,n-i/2),Ct.scale(r/e.getWidth(),i/e.getHeight())):3===arguments.length?Ct.translate(t-e.getWidth()/2,-e.getHeight()/2):Ct.translate(-e.getWidth()/2,-e.getHeight()/2):0===Kr?5===arguments.length?(Ct.translate(t,n),Ct.scale(r/e.getWidth(),i/e.getHeight())):3===arguments.length&&Ct.translate(t,n):1===Kr&&(5===arguments.length?(r-=t,i-=n,Ct.translate(t,n),Ct.scale(r/e.getWidth(),i/e.getHeight())):3===arguments.length&&Ct.translate(t,n)),e.draw(Ct),(1===arguments.length&&3===Kr||arguments.length>1)&&Ct.popMatrix())},Ct.shapeMode=function(e){Kr=e},Ct.loadShape=function(e){return 1===arguments.length&&e.indexOf(".svg")>-1?new Ei(null,e):null};var Si=function(e,t,n,r,i){this.fullName=e||"",this.name=t||"",this.namespace=n||"",this.value=r,this.type=i};Si.prototype={getName:function(){return this.name},getFullName:function(){return this.fullName},getNamespace:function(){return this.namespace},getValue:function(){return this.value},getType:function(){return this.type},setValue:function(e){this.value=e}};var xi=Ct.XMLElement=function(e,t,n,i){this.attributes=[],this.children=[],this.fullName=null,this.name=null,this.namespace="",this.content=null,this.parent=null,this.lineNr="",this.systemID="",this.type="ELEMENT",e&&("string"==typeof e?t===r&&e.indexOf("<")>-1?this.parse(e):(this.fullName=e,this.namespace=t,this.systemId=n,this.lineNr=i):this.parse(t))};xi.prototype={parse:function(e){var t;try{var n=e.substring(e.length-4);(".xml"===n||".svg"===n)&&(e=y(e)),t=(new DOMParser).parseFromString(e,"text/xml");var r=t.documentElement;if(!r)throw"Error loading document";return this.parseChildrenRecursive(null,r),this}catch(i){throw i}},parseChildrenRecursive:function(e,t){var n,r,i,s,o,u;if(e?(n=new xi(t.nodeName),n.parent=e):(this.fullName=t.localName,this.name=t.nodeName,n=this),3===t.nodeType&&""!==t.textContent)return this.createPCDataElement(t.textContent);if(4===t.nodeType)return this.createCDataElement(t.textContent);if(t.attributes)for(s=0,o=t.attributes.length;o>s;s++)i=t.attributes[s],r=new Si(i.getname,i.nodeName,i.namespaceURI,i.nodeValue,i.nodeType),n.attributes.push(r);if(t.childNodes)for(s=0,o=t.childNodes.length;o>s;s++){var a=t.childNodes[s];u=n.parseChildrenRecursive(n,a),null!==u&&n.children.push(u)}return n},createElement:function(e,t,n,i){return n===r?new xi(e,t):new xi(e,t,n,i)},createPCDataElement:function(e){if(""===e.replace(/^\s+$/g,""))return null;var t=new xi;return t.type="TEXT",t.content=e,t},createCDataElement:function(e){var t=this.createPCDataElement(e);if(null===t)return null;t.type="CDATA";var n,r={"<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"};for(n in r)Object.hasOwnProperty(r,n)||(e=e.replace(new RegExp(n,"g"),r[n]));return t.cdata=e,t},hasAttribute:function(){return 1===arguments.length?null!==this.getAttribute(arguments[0]):2===arguments.length?null!==this.getAttribute(arguments[0],arguments[1]):void 0},equals:function(e){if(e instanceof xi){var t,n;if(this.fullName!==e.fullName)return!1;if(this.attributes.length!==e.getAttributeCount())return!1;if(this.attributes.length!==e.attributes.length)return!1;var r,i,s;for(t=0,n=this.attributes.length;n>t;t++){if(r=this.attributes[t].getName(),i=this.attributes[t].getNamespace(),s=e.findAttribute(r,i),null===s)return!1;if(this.attributes[t].getValue()!==s.getValue())return!1;if(this.attributes[t].getType()!==s.getType())return!1}if(this.children.length!==e.getChildCount())return!1;if(this.children.length>0){var o,u;for(t=0,n=this.children.length;n>t;t++)if(o=this.getChild(t),u=e.getChild(t),!o.equals(u))return!1;return!0}return this.content===e.content}return!1},getContent:function(){if("TEXT"===this.type||"CDATA"===this.type)return this.content;var e=this.children;return 1!==e.length||"TEXT"!==e[0].type&&"CDATA"!==e[0].type?null:e[0].content},getAttribute:function(){var e;return 2===arguments.length?(e=this.findAttribute(arguments[0]),e?e.getValue():arguments[1]):1===arguments.length?(e=this.findAttribute(arguments[0]),e?e.getValue():null):3===arguments.length?(e=this.findAttribute(arguments[0],arguments[1]),e?e.getValue():arguments[2]):void 0},getStringAttribute:function(){return 1===arguments.length?this.getAttribute(arguments[0]):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getString:function(e){return this.getStringAttribute(e)},getFloatAttribute:function(){return 1===arguments.length?parseFloat(this.getAttribute(arguments[0],0)):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getFloat:function(e){return this.getFloatAttribute(e)},getIntAttribute:function(){return 1===arguments.length?this.getAttribute(arguments[0],0):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getInt:function(e){return this.getIntAttribute(e)},hasChildren:function(){return this.children.length>0},addChild:function(e){null!==e&&(e.parent=this,this.children.push(e))},insertChild:function(e,t){if(e){if(null===e.getLocalName()&&!this.hasChildren()){var n=this.children[this.children.length-1];if(null===n.getLocalName())return n.setContent(n.getContent()+e.getContent()),void 0}e.parent=this,this.children.splice(t,0,e)}},getChild:function(e){if("number"==typeof e)return this.children[e];if(-1!==e.indexOf("/"))return this.getChildRecursive(e.split("/"),0);for(var t,n,r=0,i=this.getChildCount();i>r;r++)if(t=this.getChild(r),n=t.getName(),null!==n&&n===e)return t;return null},getChildren:function(){if(1===arguments.length){if("number"==typeof arguments[0])return this.getChild(arguments[0]);if(-1!==arguments[0].indexOf("/"))return this.getChildrenRecursive(arguments[0].split("/"),0);for(var e,t,n=[],r=0,i=this.getChildCount();i>r;r++)e=this.getChild(r),t=e.getName(),null!==t&&t===arguments[0]&&n.push(e);return n}return this.children},getChildCount:function(){return this.children.length},getChildRecursive:function(e,t){if(t===e.length)return this;for(var n,r,i=e[t],s=0,o=this.getChildCount();o>s;s++)if(n=this.getChild(s),r=n.getName(),null!==r&&r===i)return n.getChildRecursive(e,t+1);return null},getChildrenRecursive:function(e,t){if(t===e.length-1)return this.getChildren(e[t]);for(var n=this.getChildren(e[t]),r=[],i=0;i<n.length;i++)r=r.concat(n[i].getChildrenRecursive(e,t+1));return r},isLeaf:function(){return!this.hasChildren()},listChildren:function(){for(var e=[],t=0,n=this.children.length;n>t;t++)e.push(this.getChild(t).getName());return e},removeAttribute:function(e,t){this.namespace=t||"";for(var n=0,r=this.attributes.length;r>n;n++)if(this.attributes[n].getName()===e&&this.attributes[n].getNamespace()===this.namespace){this.attributes.splice(n,1);break}},removeChild:function(e){if(e)for(var t=0,n=this.children.length;n>t;t++)if(this.children[t].equals(e)){this.children.splice(t,1);break}},removeChildAtIndex:function(e){this.children.length>e&&this.children.splice(e,1)},findAttribute:function(e,t){this.namespace=t||"";for(var n=0,r=this.attributes.length;r>n;n++)if(this.attributes[n].getName()===e&&this.attributes[n].getNamespace()===this.namespace)return this.attributes[n];return null},setAttribute:function(){var e;if(3===arguments.length){var t=arguments[0].indexOf(":"),n=arguments[0].substring(t+1);e=this.findAttribute(n,arguments[1]),e?e.setValue(arguments[2]):(e=new Si(arguments[0],n,arguments[1],arguments[2],"CDATA"),this.attributes.push(e))}else e=this.findAttribute(arguments[0]),e?e.setValue(arguments[1]):(e=new Si(arguments[0],arguments[0],null,arguments[1],"CDATA"),this.attributes.push(e))},setString:function(e,t){this.setAttribute(e,t)},setInt:function(e,t){this.setAttribute(e,t)},setFloat:function(e,t){this.setAttribute(e,t)},setContent:function(e){this.children.length>0&&H.debug("Tried to set content for XMLElement with children"),this.content=e},setName:function(){if(1===arguments.length)this.name=arguments[0],this.fullName=arguments[0],this.namespace=null;else{var e=arguments[0].indexOf(":");this.name=null===arguments[1]||0>e?arguments[0]:arguments[0].substring(e+1),this.fullName=arguments[0],this.namespace=arguments[1]}},getName:function(){return this.fullName},getLocalName:function(){return this.name},getAttributeCount:function(){return this.attributes.length},toString:function(){if("TEXT"===this.type)return this.content;if("CDATA"===this.type)return this.cdata;var e,t,n=this.fullName,r="<"+n;for(e=0;e<this.attributes.length;e++){var i=this.attributes[e];r+=" "+i.getName()+"="+'"'+i.getValue()+'"'}if(0===this.children.length)r+=""===this.content?"/>":">"+this.content+"</"+n+">";else{for(r+=">",t=0;t<this.children.length;t++)r+=this.children[t].toString();r+="</"+n+">"}return r}},xi.parse=function(e){var t=new xi;return t.parse(e),t};var Ti=Ct.XML=Ct.XMLElement;Ct.loadXML=function(e){return new Ti(Ct,e)};var Ni=function(e){for(var t=0,r=0;r<e.length;r++)t=0!==r?n.max(t,n.abs(e[r])):n.abs(e[r]);var i=(t+"").indexOf(".");return 0===i?i=1:-1===i&&(i=(t+"").length),i},Ci=Ct.PMatrix2D=function(){0===arguments.length?this.reset():1===arguments.length&&arguments[0]instanceof Ci?this.set(arguments[0].array()):6===arguments.length&&this.set(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])};Ci.prototype={set:function(){if(6===arguments.length){var e=arguments;this.set([e[0],e[1],e[2],e[3],e[4],e[5]])}else 1===arguments.length&&arguments[0]instanceof Ci?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var e=new Ci;return e.set(this.elements),e},reset:function(){this.set([1,0,0,0,1,0])},array:function(){return this.elements.slice()},translate:function(e,t){this.elements[2]=e*this.elements[0]+t*this.elements[1]+this.elements[2],this.elements[5]=e*this.elements[3]+t*this.elements[4]+this.elements[5]},invTranslate:function(e,t){this.translate(-e,-t)},transpose:function(){},mult:function(e,t){var n,r;return e instanceof L?(n=e.x,r=e.y,t||(t=new L)):e instanceof Array&&(n=e[0],r=e[1],t||(t=[])),t instanceof Array?(t[0]=this.elements[0]*n+this.elements[1]*r+this.elements[2],t[1]=this.elements[3]*n+this.elements[4]*r+this.elements[5]):t instanceof L&&(t.x=this.elements[0]*n+this.elements[1]*r+this.elements[2],t.y=this.elements[3]*n+this.elements[4]*r+this.elements[5],t.z=0),t},multX:function(e,t){return e*this.elements[0]+t*this.elements[1]+this.elements[2]},multY:function(e,t){return e*this.elements[3]+t*this.elements[4]+this.elements[5]},skewX:function(e){this.apply(1,0,1,e,0,0)},skewY:function(e){this.apply(1,0,1,0,e,0)},shearX:function(e){this.apply(1,0,1,n.tan(e),0,0)},shearY:function(e){this.apply(1,0,1,0,n.tan(e),0)},determinant:function(){return this.elements[0]*this.elements[4]-this.elements[1]*this.elements[3]},invert:function(){var e=this.determinant();if(n.abs(e)>-2147483648){var t=this.elements[0],r=this.elements[1],i=this.elements[2],s=this.elements[3],o=this.elements[4],u=this.elements[5];return this.elements[0]=o/e,this.elements[3]=-s/e,this.elements[1]=-r/e,this.elements[4]=t/e,this.elements[2]=(r*u-o*i)/e,this.elements[5]=(s*i-t*u)/e,!0}return!1},scale:function(e,t){e&&!t&&(t=e),e&&t&&(this.elements[0]*=e,this.elements[1]*=t,this.elements[3]*=e,this.elements[4]*=t)},invScale:function(e,t){e&&!t&&(t=e),this.scale(1/e,1/t)},apply:function(){var e;1===arguments.length&&arguments[0]instanceof Ci?e=arguments[0].array():6===arguments.length?e=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(e=arguments[0]);for(var t=[0,0,this.elements[2],0,0,this.elements[5]],n=0,r=0;2>r;r++)for(var i=0;3>i;i++,n++)t[n]+=this.elements[3*r+0]*e[i+0]+this.elements[3*r+1]*e[i+3];this.elements=t.slice()},preApply:function(){var e;1===arguments.length&&arguments[0]instanceof Ci?e=arguments[0].array():6===arguments.length?e=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(e=arguments[0]);var t=[0,0,e[2],0,0,e[5]];t[2]=e[2]+this.elements[2]*e[0]+this.elements[5]*e[1],t[5]=e[5]+this.elements[2]*e[3]+this.elements[5]*e[4],t[0]=this.elements[0]*e[0]+this.elements[3]*e[1],t[3]=this.elements[0]*e[3]+this.elements[3]*e[4],t[1]=this.elements[1]*e[0]+this.elements[4]*e[1],t[4]=this.elements[1]*e[3]+this.elements[4]*e[4],this.elements=t.slice()},rotate:function(e){var t=n.cos(e),r=n.sin(e),i=this.elements[0],s=this.elements[1];this.elements[0]=t*i+r*s,this.elements[1]=-r*i+t*s,i=this.elements[3],s=this.elements[4],this.elements[3]=t*i+r*s,this.elements[4]=-r*i+t*s},rotateZ:function(e){this.rotate(e)},invRotateZ:function(e){this.rotateZ(e-n.PI)},print:function(){var e=Ni(this.elements),t=""+Ct.nfs(this.elements[0],e,4)+" "+Ct.nfs(this.elements[1],e,4)+" "+Ct.nfs(this.elements[2],e,4)+"\n"+Ct.nfs(this.elements[3],e,4)+" "+Ct.nfs(this.elements[4],e,4)+" "+Ct.nfs(this.elements[5],e,4)+"\n\n";Ct.println(t)}};var ki=Ct.PMatrix3D=function(){this.reset()};ki.prototype={set:function(){16===arguments.length?this.elements=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof ki?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var e=new ki;return e.set(this.elements),e},reset:function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},array:function(){return this.elements.slice()},translate:function(e,t,n){n===r&&(n=0),this.elements[3]+=e*this.elements[0]+t*this.elements[1]+n*this.elements[2],this.elements[7]+=e*this.elements[4]+t*this.elements[5]+n*this.elements[6],this.elements[11]+=e*this.elements[8]+t*this.elements[9]+n*this.elements[10],this.elements[15]+=e*this.elements[12]+t*this.elements[13]+n*this.elements[14]},transpose:function(){var e=this.elements[4];this.elements[4]=this.elements[1],this.elements[1]=e,e=this.elements[8],this.elements[8]=this.elements[2],this.elements[2]=e,e=this.elements[6],this.elements[6]=this.elements[9],this.elements[9]=e,e=this.elements[3],this.elements[3]=this.elements[12],this.elements[12]=e,e=this.elements[7],this.elements[7]=this.elements[13],this.elements[13]=e,e=this.elements[11],this.elements[11]=this.elements[14],this.elements[14]=e},mult:function(e,t){var n,r,i,s;return e instanceof L?(n=e.x,r=e.y,i=e.z,s=1,t||(t=new L)):e instanceof Array&&(n=e[0],r=e[1],i=e[2],s=e[3]||1,(!t||3!==t.length&&4!==t.length)&&(t=[0,0,0])),t instanceof Array&&(3===t.length?(t[0]=this.elements[0]*n+this.elements[1]*r+this.elements[2]*i+this.elements[3],t[1]=this.elements[4]*n+this.elements[5]*r+this.elements[6]*i+this.elements[7],t[2]=this.elements[8]*n+this.elements[9]*r+this.elements[10]*i+this.elements[11]):4===t.length&&(t[0]=this.elements[0]*n+this.elements[1]*r+this.elements[2]*i+this.elements[3]*s,t[1]=this.elements[4]*n+this.elements[5]*r+this.elements[6]*i+this.elements[7]*s,t[2]=this.elements[8]*n+this.elements[9]*r+this.elements[10]*i+this.elements[11]*s,t[3]=this.elements[12]*n+this.elements[13]*r+this.elements[14]*i+this.elements[15]*s)),t instanceof L&&(t.x=this.elements[0]*n+this.elements[1]*r+this.elements[2]*i+this.elements[3],t.y=this.elements[4]*n+this.elements[5]*r+this.elements[6]*i+this.elements[7],t.z=this.elements[8]*n+this.elements[9]*r+this.elements[10]*i+this.elements[11]),t},preApply:function(){var e;1===arguments.length&&arguments[0]instanceof ki?e=arguments[0].array():16===arguments.length?e=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(e=arguments[0]);for(var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0,r=0;4>r;r++)for(var i=0;4>i;i++,n++)t[n]+=this.elements[i+0]*e[4*r+0]+this.elements[i+4]*e[4*r+1]+this.elements[i+8]*e[4*r+2]+this.elements[i+12]*e[4*r+3];this.elements=t.slice()},apply:function(){var e;1===arguments.length&&arguments[0]instanceof ki?e=arguments[0].array():16===arguments.length?e=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(e=arguments[0]);for(var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0,r=0;4>r;r++)for(var i=0;4>i;i++,n++)t[n]+=this.elements[4*r+0]*e[i+0]+this.elements[4*r+1]*e[i+4]+this.elements[4*r+2]*e[i+8]+this.elements[4*r+3]*e[i+12];this.elements=t.slice()},rotate:function(e,t,n,r){if(n){var i=Ct.cos(e),s=Ct.sin(e),o=1-i;this.apply(o*t*t+i,o*t*n-s*r,o*t*r+s*n,0,o*t*n+s*r,o*n*n+i,o*n*r-s*t,0,o*t*r-s*n,o*n*r+s*t,o*r*r+i,0,0,0,0,1)}else this.rotateZ(e)},invApply:function(){Tr===r&&(Tr=new ki);var e=arguments;return Tr.set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]),Tr.invert()?(this.preApply(Tr),!0):!1},rotateX:function(e){var t=Ct.cos(e),n=Ct.sin(e);this.apply([1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1])},rotateY:function(e){var t=Ct.cos(e),n=Ct.sin(e);this.apply([t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1])},rotateZ:function(e){var t=n.cos(e),r=n.sin(e);this.apply([t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1])},scale:function(e,t,n){!e||t||n?e&&t&&!n&&(n=1):t=n=e,e&&t&&n&&(this.elements[0]*=e,this.elements[1]*=t,this.elements[2]*=n,this.elements[4]*=e,this.elements[5]*=t,this.elements[6]*=n,this.elements[8]*=e,this.elements[9]*=t,this.elements[10]*=n,this.elements[12]*=e,this.elements[13]*=t,this.elements[14]*=n)},skewX:function(e){var t=n.tan(e);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},skewY:function(e){var t=n.tan(e);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},shearX:function(e){var t=n.tan(e);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},shearY:function(e){var t=n.tan(e);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},multX:function(e,t,n,r){return n?r?this.elements[0]*e+this.elements[1]*t+this.elements[2]*n+this.elements[3]*r:this.elements[0]*e+this.elements[1]*t+this.elements[2]*n+this.elements[3]:this.elements[0]*e+this.elements[1]*t+this.elements[3]},multY:function(e,t,n,r){return n?r?this.elements[4]*e+this.elements[5]*t+this.elements[6]*n+this.elements[7]*r:this.elements[4]*e+this.elements[5]*t+this.elements[6]*n+this.elements[7]:this.elements[4]*e+this.elements[5]*t+this.elements[7]},multZ:function(e,t,n,r){return r?this.elements[8]*e+this.elements[9]*t+this.elements[10]*n+this.elements[11]*r:this.elements[8]*e+this.elements[9]*t+this.elements[10]*n+this.elements[11]},multW:function(e,t,n,r){return r?this.elements[12]*e+this.elements[13]*t+this.elements[14]*n+this.elements[15]*r:this.elements[12]*e+this.elements[13]*t+this.elements[14]*n+this.elements[15]},invert:function(){var e=this.elements[0]*this.elements[5]-this.elements[1]*this.elements[4],t=this.elements[0]*this.elements[6]-this.elements[2]*this.elements[4],r=this.elements[0]*this.elements[7]-this.elements[3]*this.elements[4],i=this.elements[1]*this.elements[6]-this.elements[2]*this.elements[5],s=this.elements[1]*this.elements[7]-this.elements[3]*this.elements[5],o=this.elements[2]*this.elements[7]-this.elements[3]*this.elements[6],u=this.elements[8]*this.elements[13]-this.elements[9]*this.elements[12],a=this.elements[8]*this.elements[14]-this.elements[10]*this.elements[12],f=this.elements[8]*this.elements[15]-this.elements[11]*this.elements[12],l=this.elements[9]*this.elements[14]-this.elements[10]*this.elements[13],c=this.elements[9]*this.elements[15]-this.elements[11]*this.elements[13],h=this.elements[10]*this.elements[15]-this.elements[11]*this.elements[14],p=e*h-t*c+r*l+i*f-s*a+o*u;if(n.abs(p)<=1e-9)return!1;var d=[];d[0]=+this.elements[5]*h-this.elements[6]*c+this.elements[7]*l,d[4]=-this.elements[4]*h+this.elements[6]*f-this.elements[7]*a,d[8]=+this.elements[4]*c-this.elements[5]*f+this.elements[7]*u,d[12]=-this.elements[4]*l+this.elements[5]*a-this.elements[6]*u,d[1]=-this.elements[1]*h+this.elements[2]*c-this.elements[3]*l,d[5]=+this.elements[0]*h-this.elements[2]*f+this.elements[3]*a,d[9]=-this.elements[0]*c+this.elements[1]*f-this.elements[3]*u,d[13]=+this.elements[0]*l-this.elements[1]*a+this.elements[2]*u,d[2]=+this.elements[13]*o-this.elements[14]*s+this.elements[15]*i,d[6]=-this.elements[12]*o+this.elements[14]*r-this.elements[15]*t,d[10]=+this.elements[12]*s-this.elements[13]*r+this.elements[15]*e,d[14]=-this.elements[12]*i+this.elements[13]*t-this.elements[14]*e,d[3]=-this.elements[9]*o+this.elements[10]*s-this.elements[11]*i,d[7]=+this.elements[8]*o-this.elements[10]*r+this.elements[11]*t,d[11]=-this.elements[8]*s+this.elements[9]*r-this.elements[11]*e,d[15]=+this.elements[8]*i-this.elements[9]*t+this.elements[10]*e;var v=1/p;return d[0]*=v,d[1]*=v,d[2]*=v,d[3]*=v,d[4]*=v,d[5]*=v,d[6]*=v,d[7]*=v,d[8]*=v,d[9]*=v,d[10]*=v,d[11]*=v,d[12]*=v,d[13]*=v,d[14]*=v,d[15]*=v,this.elements=d.slice(),!0},toString:function(){for(var e="",t=0;15>t;t++)e+=this.elements[t]+", ";return e+=this.elements[15]},print:function(){var e=Ni(this.elements),t=""+Ct.nfs(this.elements[0],e,4)+" "+Ct.nfs(this.elements[1],e,4)+" "+Ct.nfs(this.elements[2],e,4)+" "+Ct.nfs(this.elements[3],e,4)+"\n"+Ct.nfs(this.elements[4],e,4)+" "+Ct.nfs(this.elements[5],e,4)+" "+Ct.nfs(this.elements[6],e,4)+" "+Ct.nfs(this.elements[7],e,4)+"\n"+Ct.nfs(this.elements[8],e,4)+" "+Ct.nfs(this.elements[9],e,4)+" "+Ct.nfs(this.elements[10],e,4)+" "+Ct.nfs(this.elements[11],e,4)+"\n"+Ct.nfs(this.elements[12],e,4)+" "+Ct.nfs(this.elements[13],e,4)+" "+Ct.nfs(this.elements[14],e,4)+" "+Ct.nfs(this.elements[15],e,4)+"\n\n";Ct.println(t)},invTranslate:function(e,t,n){this.preApply(1,0,0,-e,0,1,0,-t,0,0,1,-n,0,0,0,1)},invRotateX:function(e){var t=n.cos(-e),r=n.sin(-e);this.preApply([1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1])},invRotateY:function(e){var t=n.cos(-e),r=n.sin(-e);this.preApply([t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1])},invRotateZ:function(e){var t=n.cos(-e),r=n.sin(-e);this.preApply([t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1])},invScale:function(e,t,n){this.preApply([1/e,0,0,0,0,1/t,0,0,0,0,1/n,0,0,0,0,1])}};var Li=Ct.PMatrixStack=function(){this.matrixStack=[]};Li.prototype.load=function(){var e=At.$newPMatrix();1===arguments.length?e.set(arguments[0]):e.set(arguments),this.matrixStack.push(e)},vi.prototype.$newPMatrix=function(){return new Ci},mi.prototype.$newPMatrix=function(){return new ki},Li.prototype.push=function(){this.matrixStack.push(this.peek())},Li.prototype.pop=function(){return this.matrixStack.pop()},Li.prototype.peek=function(){var e=At.$newPMatrix();return e.set(this.matrixStack[this.matrixStack.length-1]),e},Li.prototype.mult=function(e){this.matrixStack[this.matrixStack.length-1].apply(e)},Ct.split=function(e,t){return e.split(t)},Ct.splitTokens=function(e,t){if(t===r)return e.split(/\s+/g);var n,i,s=t.split(/()/g),o="",u=e.length,a=[];for(n=0;u>n;n++)i=e[n],s.indexOf(i)>-1?(""!==o&&a.push(o),o=""):o+=i;return""!==o&&a.push(o),a},Ct.append=function(e,t){return e[e.length]=t,e},Ct.concat=function(e,t){return e.concat(t)},Ct.sort=function(e,t){var n=[];if(e.length>0){for(var r=t>0?t:e.length,i=0;r>i;i++)n.push(e[i]);if("string"==typeof e[0]?n.sort():n.sort(function(e,t){return e-t}),t>0)for(var s=n.length;s<e.length;s++)n.push(e[s])}return n},Ct.splice=function(e,t,n){if(0===t.length)return e;if(t instanceof Array)for(var r=0,i=n;r<t.length;i++,r++)e.splice(i,0,t[r]);else e.splice(n,0,t);return e},Ct.subset=function(e,t,n){var i=n!==r?t+n:e.length;return e.slice(t,i)},Ct.join=function(e,t){return e.join(t)},Ct.shorten=function(e){for(var t=[],n=e.length,r=0;n>r;r++)t[r]=e[r];return t.pop(),t},Ct.expand=function(e,t){var n=e.slice(0),r=t||2*e.length;return n.length=r,n},Ct.arrayCopy=function(){var e,t,n,i=0,s=0;2===arguments.length?(e=arguments[0],t=arguments[1],n=e.length):3===arguments.length?(e=arguments[0],t=arguments[1],n=arguments[2]):5===arguments.length&&(e=arguments[0],i=arguments[1],t=arguments[2],s=arguments[3],n=arguments[4]);for(var o=i,u=s;n+i>o;o++,u++){if(t[u]===r)throw"array index out of bounds exception";t[u]=e[o]}},Ct.reverse=function(e){return e.reverse()},Ct.mix=function(e,t,n){return e+((t-e)*n>>8)},Ct.peg=function(e){return 0>e?0:e>255?255:e},Ct.modes=function(){function e(e,t,n,r,i,s,u,a,f,l,c){var h=o(((4278190080&e)>>>24)+t,255)<<24,p=n+((f-n)*t>>8);p=(0>p?0:p>255?255:p)<<16;var d=r+((l-r)*t>>8);d=(0>d?0:d>255?255:d)<<8;var v=i+((c-i)*t>>8);return v=0>v?0:v>255?255:v,h|p|d|v}var t=4278190080,r=16711680,i=65280,s=255,o=n.min,u=n.max;return{replace:function(e,t){return t},blend:function(e,n){var u=(n&t)>>>24,a=e&r,f=e&i,l=e&s,c=n&r,h=n&i,p=n&s;return o(((e&t)>>>24)+u,255)<<24|a+((c-a)*u>>8)&r|f+((h-f)*u>>8)&i|l+((p-l)*u>>8)&s},add:function(e,n){var u=(n&t)>>>24;return o(((e&t)>>>24)+u,255)<<24|o((e&r)+((n&r)>>8)*u,r)&r|o((e&i)+((n&i)>>8)*u,i)&i|o((e&s)+((n&s)*u>>8),s)},subtract:function(e,n){var a=(n&t)>>>24;return o(((e&t)>>>24)+a,255)<<24|u((e&r)-((n&r)>>8)*a,i)&r|u((e&i)-((n&i)>>8)*a,s)&i|u((e&s)-((n&s)*a>>8),0)},lightest:function(e,n){var a=(n&t)>>>24;return o(((e&t)>>>24)+a,255)<<24|u(e&r,((n&r)>>8)*a)&r|u(e&i,((n&i)>>8)*a)&i|u(e&s,(n&s)*a>>8)},darkest:function(e,n){var u=(n&t)>>>24,a=e&r,f=e&i,l=e&s,c=o(e&r,((n&r)>>8)*u),h=o(e&i,((n&i)>>8)*u),p=o(e&s,(n&s)*u>>8);return o(((e&t)>>>24)+u,255)<<24|a+((c-a)*u>>8)&r|f+((h-f)*u>>8)&i|l+((p-l)*u>>8)&s},difference:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=a>c?a-c:c-a,v=f>h?f-h:h-f,m=l>p?l-p:p-l;return e(n,u,a,f,l,c,h,p,d,v,m)},exclusion:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=a+c-(a*c>>7),v=f+h-(f*h>>7),m=l+p-(l*p>>7);return e(n,u,a,f,l,c,h,p,d,v,m)},multiply:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=a*c>>8,v=f*h>>8,m=l*p>>8;return e(n,u,a,f,l,c,h,p,d,v,m)},screen:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=255-((255-a)*(255-c)>>8),v=255-((255-f)*(255-h)>>8),m=255-((255-l)*(255-p)>>8);return e(n,u,a,f,l,c,h,p,d,v,m)},hard_light:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=128>c?a*c>>7:255-((255-a)*(255-c)>>7),v=128>h?f*h>>7:255-((255-f)*(255-h)>>7),m=128>p?l*p>>7:255-((255-l)*(255-p)>>7);return e(n,u,a,f,l,c,h,p,d,v,m)},soft_light:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=(a*c>>7)+(a*a>>8)-(a*a*c>>15),v=(f*h>>7)+(f*f>>8)-(f*f*h>>15),m=(l*p>>7)+(l*l>>8)-(l*l*p>>15);return e(n,u,a,f,l,c,h,p,d,v,m)},overlay:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=128>a?a*c>>7:255-((255-a)*(255-c)>>7),v=128>f?f*h>>7:255-((255-f)*(255-h)>>7),m=128>l?l*p>>7:255-((255-l)*(255-p)>>7);return e(n,u,a,f,l,c,h,p,d,v,m)},dodge:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=255;255!==c&&(d=(a<<8)/(255-c),d=0>d?0:d>255?255:d);var v=255;255!==h&&(v=(f<<8)/(255-h),v=0>v?0:v>255?255:v);var m=255;return 255!==p&&(m=(l<<8)/(255-p),m=0>m?0:m>255?255:m),e(n,u,a,f,l,c,h,p,d,v,m)},burn:function(n,o){var u=(o&t)>>>24,a=(n&r)>>16,f=(n&i)>>8,l=n&s,c=(o&r)>>16,h=(o&i)>>8,p=o&s,d=0;0!==c&&(d=(255-a<<8)/c,d=255-(0>d?0:d>255?255:d));var v=0;0!==h&&(v=(255-f<<8)/h,v=255-(0>v?0:v>255?255:v));var m=0;return 0!==p&&(m=(255-l<<8)/p,m=255-(0>m?0:m>255?255:m)),e(n,u,a,f,l,c,h,p,d,v,m)}}}(),Ct.color=function(e,t,n,i){return e!==r&&t!==r&&n!==r&&i!==r?d(e,t,n,i):e!==r&&t!==r&&n!==r?d(e,t,n,qn):e!==r&&t!==r?v(e,t):"number"==typeof e?g(e):d(Rn,Un,zn,qn)},Ct.color.toString=function(e){return"rgba("+(255&e>>16)+","+(255&e>>8)+","+(255&e)+","+(255&e>>24)/255+")"},Ct.color.toInt=function(e,t,n,r){return 4278190080&r<<24|16711680&e<<16|65280&t<<8|255&n},Ct.color.toArray=function(e){return[255&e>>16,255&e>>8,255&e,255&e>>24]},Ct.color.toGLArray=function(e){return[((16711680&e)>>>16)/255,(255&e>>8)/255,(255&e)/255,(255&e>>24)/255]},Ct.color.toRGB=function(e,t,r){e=e>Rn?Rn:e,t=t>Un?Un:t,r=r>zn?zn:r,e=360*(e/Rn),t=100*(t/Un),r=100*(r/zn);var i=n.round(255*(r/100));if(0===t)return[i,i,i];var s=e%360,o=s%60,u=n.round(255*(r*(100-t)/1e4)),a=n.round(255*(r*(6e3-t*o)/6e5)),f=n.round(255*(r*(6e3-t*(60-o))/6e5));switch(n.floor(s/60)){case 0:return[i,f,u];case 1:return[a,i,u];case 2:return[u,i,f];case 3:return[u,a,i];case 4:return[f,u,i];case 5:return[i,u,a]}},Ct.brightness=function(e){return b(e)[2]},Ct.saturation=function(e){return b(e)[1]},Ct.hue=function(e){return b(e)[0]},Ct.red=function(e){return(255&e>>16)/255*Rn},Ct.green=function(e){return((65280&e)>>>8)/255*Un},Ct.blue=function(e){return(255&e)/255*zn},Ct.alpha=function(e){return(255&e>>24)/255*qn},Ct.lerpColor=function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,w,E=Ct.color(e),S=Ct.color(t);return 3===Vn?(v=b(E),l=(255&E>>24)/qn,m=b(S),d=((4278190080&S)>>>24)/qn,y=Ct.lerp(v[0],m[0],n),w=Ct.lerp(v[1],m[1],n),s=Ct.lerp(v[2],m[2],n),g=Ct.color.toRGB(y,w,s),o=Ct.lerp(l,d,n)*qn,4278190080&o<<24|(255&g[0])<<16|(255&g[1])<<8|255&g[2]):(u=255&E>>16,a=255&E>>8,f=255&E,l=(255&E>>24)/qn,c=(16711680&S)>>>16,h=255&S>>8,p=255&S,d=(255&S>>24)/qn,r=0|Ct.lerp(u,c,n),i=0|Ct.lerp(a,h,n),s=0|Ct.lerp(f,p,n),o=Ct.lerp(l,d,n)*qn,4278190080&o<<24|16711680&r<<16|65280&i<<8|255&s)},Ct.colorMode=function(){Vn=arguments[0],arguments.length>1&&(Rn=arguments[1],Un=arguments[2]||arguments[1],zn=arguments[3]||arguments[1],qn=arguments[4]||arguments[1])},Ct.blendColor=function(e,t,n){return 0===n?Ct.modes.replace(e,t):1===n?Ct.modes.blend(e,t):2===n?Ct.modes.add(e,t):4===n?Ct.modes.subtract(e,t):8===n?Ct.modes.lightest(e,t):16===n?Ct.modes.darkest(e,t):32===n?Ct.modes.difference(e,t):64===n?Ct.modes.exclusion(e,t):128===n?Ct.modes.multiply(e,t):256===n?Ct.modes.screen(e,t):1024===n?Ct.modes.hard_light(e,t):2048===n?Ct.modes.soft_light(e,t):512===n?Ct.modes.overlay(e,t):4096===n?Ct.modes.dodge(e,t):8192===n?Ct.modes.burn(e,t):void 0},Ct.printMatrix=function(){wr.print()},vi.prototype.translate=function(e,t){wr.translate(e,t),Er.invTranslate(e,t),kt.translate(e,t)},mi.prototype.translate=function(e,t,n){wr.translate(e,t,n),Er.invTranslate(e,t,n)},vi.prototype.scale=function(e,t){wr.scale(e,t),Er.invScale(e,t),kt.scale(e,t||e)},mi.prototype.scale=function(e,t,n){wr.scale(e,t,n),Er.invScale(e,t,n)},vi.prototype.transform=function(e){var t=e.array();kt.transform(t[0],t[3],t[1],t[4],t[2],t[5])},mi.prototype.transformm=function(){throw"p.transform is currently not supported in 3D mode"},vi.prototype.pushMatrix=function(){Sr.load(wr),xr.load(Er),N()},mi.prototype.pushMatrix=function(){Sr.load(wr),xr.load(Er)},vi.prototype.popMatrix=function(){wr.set(Sr.pop()),Er.set(xr.pop()),C()},mi.prototype.popMatrix=function(){wr.set(Sr.pop()),Er.set(xr.pop())},vi.prototype.resetMatrix=function(){wr.reset(),Er.reset(),kt.setTransform(1,0,0,1,0,0)},mi.prototype.resetMatrix=function(){wr.reset(),Er.reset()},di.prototype.applyMatrix=function(){var e=arguments;wr.apply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]),Er.invApply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},vi.prototype.applyMatrix=function(){for(var e=arguments,t=e.length;16>t;t++)e[t]=0;e[10]=e[15]=1,di.prototype.applyMatrix.apply(this,e)},Ct.rotateX=function(e){wr.rotateX(e),Er.invRotateX(e)},vi.prototype.rotateZ=function(){throw"rotateZ() is not supported in 2D mode. Use rotate(float) instead."},mi.prototype.rotateZ=function(e){wr.rotateZ(e),Er.invRotateZ(e)},Ct.rotateY=function(e){wr.rotateY(e),Er.invRotateY(e)},vi.prototype.rotate=function(e){wr.rotateZ(e),Er.invRotateZ(e),kt.rotate(e)},mi.prototype.rotate=function(e){Ct.rotateZ(e)},vi.prototype.shearX=function(e){wr.shearX(e),kt.transform(1,0,e,1,0,0)},mi.prototype.shearX=function(e){wr.shearX(e)},vi.prototype.shearY=function(e){wr.shearY(e),kt.transform(1,e,0,1,0,0)},mi.prototype.shearY=function(e){wr.shearY(e)},Ct.pushStyle=function(){N(),Ct.pushMatrix();var e={doFill:ln,currentFillColor:hn,doStroke:dn,currentStrokeColor:mn,curTint:$n,curRectMode:xn,curColorMode:Vn,colorModeX:Rn,colorModeZ:zn,colorModeY:Un,colorModeA:qn,curTextFont:lr,horizontalTextAlignment:nr,verticalTextAlignment:rr,textMode:ir,curFontName:sr,curTextSize:or,curTextAscent:ur,curTextDescent:ar,curTextLeading:fr};Qr.push(e)},Ct.popStyle=function(){var e=Qr.pop();if(!e)throw"Too many popStyle() without enough pushStyle()";C(),Ct.popMatrix(),ln=e.doFill,hn=e.currentFillColor,dn=e.doStroke,mn=e.currentStrokeColor,$n=e.curTint,xn=e.curRectMode,Vn=e.curColorMode,Rn=e.colorModeX,zn=e.colorModeZ,Un=e.colorModeY,qn=e.colorModeA,lr=e.curTextFont,sr=e.curFontName,or=e.curTextSize,nr=e.horizontalTextAlignment,rr=e.verticalTextAlignment,ir=e.textMode,ur=e.curTextAscent,ar=e.curTextDescent,fr=e.curTextLeading},Ct.year=function(){return(new Date).getFullYear()},Ct.month=function(){return(new Date).getMonth()+1},Ct.day=function(){return(new Date).getDate()},Ct.hour=function(){return(new Date).getHours()},Ct.minute=function(){return(new Date).getMinutes()},Ct.second=function(){return(new Date).getSeconds()},Ct.millis=function(){return Date.now()-Kn},vi.prototype.redraw=function(){k(),kt.lineWidth=yn;var e=Ct.pmouseX,t=Ct.pmouseY;Ct.pmouseX=Wn,Ct.pmouseY=Xn,N(),Ct.draw(),C(),Wn=Ct.mouseX,Xn=Ct.mouseY,Ct.pmouseX=e,Ct.pmouseY=t},mi.prototype.redraw=function(){k();var e=Ct.pmouseX,t=Ct.pmouseY;Ct.pmouseX=Wn,Ct.pmouseY=Xn,kt.clear(kt.DEPTH_BUFFER_BIT),Yn={attributes:{},locations:{}},Ct.noLights(),Ct.lightFalloff(1,0,0),Ct.shininess(1),Ct.ambient(255,255,255),Ct.specular(0,0,0),Ct.emissive(0,0,0),Ct.camera(),Ct.draw(),Wn=Ct.mouseX,Xn=Ct.mouseY,Ct.pmouseX=e,Ct.pmouseY=t},Ct.noLoop=function(){En=!1,bn=!1,clearInterval(Sn),Lt.onPause()},Ct.loop=function(){bn||(Qn=Date.now(),Gn=0,Sn=e.setInterval(function(){try{Lt.onFrameStart(),Ct.redraw(),Lt.onFrameEnd()}catch(t){throw e.clearInterval(Sn),t}},On),En=!0,bn=!0,Lt.onLoop())},Ct.frameRate=function(e){An=e,On=1e3/An,En&&(Ct.noLoop(),Ct.loop())};var Ai=[];Ct.exit=function(){e.clearInterval(Sn),D(Ct.externals.canvas.id),delete Tt.onmousedown;for(var t in H.lib)H.lib.hasOwnProperty(t)&&H.lib[t].hasOwnProperty("detach")&&H.lib[t].detach(Ct);for(var n=Ai.length;n--;)_(Ai[n]);Lt.onExit()},Ct.cursor=function(){if(arguments.length>1||1===arguments.length&&arguments[0]instanceof Ct.PImage){var e,t,n=arguments[0];if(arguments.length>=3){if(e=arguments[1],t=arguments[2],0>e||0>t||t>=n.height||e>=n.width)throw"x and y must be non-negative and less than the dimensions of the image"}else e=n.width>>>1,t=n.height>>>1;var r=n.toDataURL(),i='url("'+r+'") '+e+" "+t+", default";Mn=Tt.style.cursor=i}else if(1===arguments.length){var s=arguments[0];Mn=Tt.style.cursor=s}else Mn=Tt.style.cursor=_n},Ct.noCursor=function(){Mn=Tt.style.cursor=T.NOCURSOR},Ct.link=function(t,n){n!==r?e.open(t,n):e.location=t},Ct.beginDraw=m,Ct.endDraw=m,vi.prototype.toImageData=function(e,t,n,i){return e=e!==r?e:0,t=t!==r?t:0,n=n!==r?n:Ct.width,i=i!==r?i:Ct.height,kt.getImageData(e,t,n,i)},mi.prototype.toImageData=function(e,i,s,o){e=e!==r?e:0,i=i!==r?i:0,s=s!==r?s:Ct.width,o=o!==r?o:Ct.height;var u=t.createElement("canvas"),a=u.getContext("2d"),f=a.createImageData(s,o),l=new x(4*s*o);kt.readPixels(e,i,s,o,kt.RGBA,kt.UNSIGNED_BYTE,l);for(var c=0,h=l.length,p=f.data;h>c;c++)p[c]=l[4*(o-1-n.floor(c/4/s))*s+c%(4*s)];return f},Ct.status=function(t){e.status=t},Ct.binary=function(e,t){var n;if(t>0)n=t;else if(e instanceof bi)n=16,e|=0;else for(n=32;n>1&&!(1&e>>>n-1);)n--;for(var r="";n>0;)r+=1&e>>>--n?"1":"0";return r},Ct.unbinary=function(e){for(var t=e.length-1,n=1,r=0;t>=0;){var i=e[t--];if("0"!==i&&"1"!==i)throw"the value passed into unbinary was not an 8 bit binary number";"1"===i&&(r+=n),n<<=1}return r},Ct.nf=function(e,t,n){return j(e,"","-",t,n)},Ct.nfs=function(e,t,n){return j(e," ","-",t,n)},Ct.nfp=function(e,t,n){return j(e,"+","-",t,n)},Ct.nfc=function(e,t,n){return j(e,"","-",t,n,",")};var Oi=function(e,t){t=t===r||null===t?t=8:t,0>e&&(e=4294967295+e+1);for(var n=Number(e).toString(16).toUpperCase();n.length<t;)n="0"+n;return n.length>=t&&(n=n.substring(n.length-t,n.length)),n};Ct.hex=function(e,t){return 1===arguments.length&&(t=e instanceof bi?4:8),Oi(e,t)},Ct.unhex=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(F(e[n]));return t}return F(e)},Ct.loadStrings=function(e){if(localStorage[e])return localStorage[e].split("\n");var t=y(e);return"string"!=typeof t||""===t?[]:(t=t.replace(/(\r\n?)/g,"\n").replace(/\n$/,""),t.split("\n"))},Ct.saveStrings=function(e,t){localStorage[e]=t.join("\n")},Ct.loadBytes=function(e){for(var t=y(e),n=[],r=0;r<t.length;r++)n.push(t.charCodeAt(r));return n},Ct.matchAll=function(e,t){for(var n,r=[],i=new RegExp(t,"g");null!==(n=i.exec(e));)r.push(n),0===n[0].length&&++i.lastIndex;return r.length>0?r:null},Ct.__contains=function(e,t){return"string"!=typeof e?e.contains.apply(e,I(arguments)):null!==e&&null!==t&&"string"==typeof t&&e.indexOf(t)>-1},Ct.__replaceAll=function(e,t,n){return"string"!=typeof e?e.replaceAll.apply(e,I(arguments)):e.replace(new RegExp(t,"g"),n)},Ct.__replaceFirst=function(e,t,n){return"string"!=typeof e?e.replaceFirst.apply(e,I(arguments)):e.replace(new RegExp(t,""),n)},Ct.__replace=function(e,t,n){if("string"!=typeof e)return e.replace.apply(e,I(arguments));if(t instanceof RegExp)return e.replace(t,n);if("string"!=typeof t&&(t=t.toString()),""===t)return e;var r=e.indexOf(t);if(0>r)return e;var i=0,s="";do s+=e.substring(i,r)+n,i=r+t.length;while((r=e.indexOf(t,i))>=0);return s+e.substring(i)},Ct.__equals=function(e,t){return e.equals instanceof Function?e.equals.apply(e,I(arguments)):e.valueOf()===t.valueOf()},Ct.__equalsIgnoreCase=function(e,t){return"string"!=typeof e?e.equalsIgnoreCase.apply(e,I(arguments)):e.toLowerCase()===t.toLowerCase()},Ct.__toCharArray=function(e){if("string"!=typeof e)return e.toCharArray.apply(e,I(arguments));for(var t=[],n=0,r=e.length;r>n;++n)t[n]=new bi(e.charAt(n));return t},Ct.__split=function(e,t,n){if("string"!=typeof e)return e.split.apply(e,I(arguments));var i=new RegExp(t);if(n===r||1>n)return e.split(i);for(var s,o=[],u=e;-1!==(s=u.search(i))&&o.length<n-1;){var a=i.exec(u).toString();o.push(u.substring(0,s)),u=u.substring(s+a.length)}return(-1!==s||""!==u)&&o.push(u),o},Ct.__codePointAt=function(e,t){var n,r,i=e.charCodeAt(t);return i>=55296&&56319>=i?(n=i,r=e.charCodeAt(t+1),1024*(n-55296)+(r-56320)+65536):i},Ct.match=function(e,t){return e.match(t)},Ct.__matches=function(e,t){return(new RegExp(t)).test(e)},Ct.__startsWith=function(e,t,n){return"string"!=typeof e?e.startsWith.apply(e,I(arguments)):(n=n||0,0>n||n>e.length?!1:""===t||t===e?!0:e.indexOf(t)===n)},Ct.__endsWith=function(e,t){if("string"!=typeof e)return e.endsWith.apply(e,I(arguments));var n=t?t.length:0;return""===t||t===e?!0:e.indexOf(t)===e.length-n},Ct.__hashCode=function(e){return e.hashCode instanceof Function?e.hashCode.apply(e,I(arguments)):s(e)},Ct.__printStackTrace=function(e){Ct.println("Exception: "+e.toString())};var Mi=[];Ct.println=function(e){var t=Mi.length;t&&(H.logger.log(Mi.join("")),Mi.length=0),0===arguments.length&&0===t?H.logger.log(""):0!==arguments.length&&H.logger.log(e)},Ct.print=function(e){Mi.push(e)},Ct.str=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString()+"");return t}return e.toString()+""},Ct.trim=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(e[n].replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,""));return t}return e.replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,"")},Ct.parseBoolean=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(q(e[n]));return t}return q(e)},Ct.parseByte=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(0-(128&e[n])|127&e[n]);return t}return 0-(128&e)|127&e},Ct.parseChar=function(e){if("number"==typeof e)return new bi(String.fromCharCode(65535&e));if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(new bi(String.fromCharCode(65535&e[n])));return t}throw"char() may receive only one argument of type int, byte, int[], or byte[]."},Ct.parseFloat=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(R(e[n]));return t}return R(e)},Ct.parseInt=function(e,t){if(e instanceof Array){for(var n=[],r=0;r<e.length;r++)"string"!=typeof e[r]||/^\s*[+\-]?\d+\s*$/.test(e[r])?n.push(U(e[r],t)):n.push(0);return n}return U(e,t)},Ct.__int_cast=function(e){return 0|e},Ct.__instanceof=function(e,t){if("function"!=typeof t)throw"Function is expected as type argument for instanceof operator";if("string"==typeof e)return t===Object||t===String;if(e instanceof t)return!0;if("object"!=typeof e||null===e)return!1;var n=e.constructor;if(t.$isInterface){for(var r=[];n;)n.$interfaces&&(r=r.concat(n.$interfaces)),n=n.$base;for(;r.length>0;){var i=r.shift();if(i===t)return!0;i.$interfaces&&(r=r.concat(i.$interfaces))}return!1}for(;n.hasOwnProperty("$base");)if(n=n.$base,n===t)return!0;return!1},Ct.abs=n.abs,Ct.ceil=n.ceil,Ct.constrain=function(e,t,n){return e>n?n:t>e?t:e},Ct.dist=function(){var e,t,r;return 4===arguments.length?(e=arguments[0]-arguments[2],t=arguments[1]-arguments[3],n.sqrt(e*e+t*t)):6===arguments.length?(e=arguments[0]-arguments[3],t=arguments[1]-arguments[4],r=arguments[2]-arguments[5],n.sqrt(e*e+t*t+r*r)):void 0},Ct.exp=n.exp,Ct.floor=n.floor,Ct.lerp=function(e,t,n){return(t-e)*n+e},Ct.log=n.log,Ct.mag=function(e,t,r){return r?n.sqrt(e*e+t*t+r*r):n.sqrt(e*e+t*t)},Ct.map=function(e,t,n,r,i){return r+(i-r)*((e-t)/(n-t))},Ct.max=function(){if(2===arguments.length)return arguments[0]<arguments[1]?arguments[1]:arguments[0];var e=1===arguments.length?arguments[0]:arguments;if("length"in e&&e.length>0){for(var t=e[0],n=e.length,r=1;n>r;++r)t<e[r]&&(t=e[r]);return t}throw"Non-empty array is expected"},Ct.min=function(){if(2===arguments.length)return arguments[0]<arguments[1]?arguments[0]:arguments[1];var e=1===arguments.length?arguments[0]:arguments;if("length"in e&&e.length>0){for(var t=e[0],n=e.length,r=1;n>r;++r)t>e[r]&&(t=e[r]);return t}throw"Non-empty array is expected"},Ct.norm=function(e,t,n){return(e-t)/(n-t)},Ct.pow=n.pow,Ct.round=n.round,Ct.sq=function(e){return e*e},Ct.sqrt=n.sqrt,Ct.acos=n.acos,Ct.asin=n.asin,Ct.atan=n.atan,Ct.atan2=n.atan2,Ct.cos=n.cos,Ct.degrees=function(e){return 180*e/n.PI},Ct.radians=function(e){return e/180*n.PI},Ct.sin=n.sin,Ct.tan=n.tan;var _i=n.random;Ct.random=function(){if(0===arguments.length)return _i();if(1===arguments.length)return _i()*arguments[0];var e=arguments[0],t=arguments[1];return _i()*(t-e)+e},W.createRandomized=function(){var e=new Date;return new W(4294967295&e/6e4,4294967295&e)},Ct.randomSeed=function(e){_i=(new W(e)).nextDouble},Ct.Random=function(e){var t,i,s=!1;this.nextGaussian=function(){if(s)return s=!1,t;var e,r,o;do e=2*i()-1,r=2*i()-1,o=e*e+r*r;while(o>=1||0===o);var u=n.sqrt(-2*n.log(o)/o);return t=r*u,s=!0,e*u},i=e===r?n.random:(new W(e)).nextDouble};var Di={generator:r,octaves:4,fallout:.5,seed:r};Ct.noise=function(e,t,n){Di.generator===r&&(Di.generator=new X(Di.seed));for(var i=Di.generator,s=1,o=1,u=0,a=0;a<Di.octaves;++a){switch(s*=Di.fallout,arguments.length){case 1:u+=s*(1+i.noise1d(o*e))/2;break;case 2:u+=s*(1+i.noise2d(o*e,o*t))/2;break;case 3:u+=s*(1+i.noise3d(o*e,o*t,o*n))/2}o*=2}return u},Ct.noiseDetail=function(e,t){Di.octaves=e,t!==r&&(Di.fallout=t)},Ct.noiseSeed=function(e){Di.seed=e,Di.generator=r},di.prototype.size=function(e,t){dn&&Ct.stroke(0),ln&&Ct.fill(255);var r={fillStyle:kt.fillStyle,strokeStyle:kt.strokeStyle,lineCap:kt.lineCap,lineJoin:kt.lineJoin};Tt.style.length>0&&(Tt.style.removeProperty("width"),Tt.style.removeProperty("height")),Tt.width=Ct.width=e||100,Tt.height=Ct.height=t||100;for(var i in r)r.hasOwnProperty(i)&&(kt[i]=r[i]);Ct.textFont(lr),Ct.background(),pr=n.max(1e3,.05*e*t),Ct.externals.context=kt;for(var s=0;720>s;s++)_r[s]=Ct.sin(.5*s*(n.PI/180)),Dr[s]=Ct.cos(.5*s*(n.PI/180))},vi.prototype.size=function(){kt===r&&(kt=Tt.getContext("2d"),Sr=new Li,xr=new Li,wr=new Ci,Er=new Ci),di.prototype.size.apply(this,arguments)},mi.prototype.size=function(){var e=!1;return function(t,n){function r(e){for(var t,n=["experimental-webgl","webgl","webkit-3d"],r=0,i=n.length;i>r&&!(t=e.getContext(n[r],{antialias:!1,preserveDrawingBuffer:!0}));r++);return t}if(e)throw"Multiple calls to size() for 3D renders are not allowed.";e=!0;try{Tt.width=Ct.width=t||100,Tt.height=Ct.height=n||100,kt=r(Tt),Yt=kt.createTexture(),Zt=kt.createTexture()}catch(i){H.debug(i)}if(!kt)throw"WebGL context is not supported on this browser.";kt.viewport(0,0,Tt.width,Tt.height),kt.enable(kt.DEPTH_TEST),kt.enable(kt.BLEND),kt.blendFunc(kt.SRC_ALPHA,kt.ONE_MINUS_SRC_ALPHA),Ft=fi(kt,ii,si),It=fi(kt,ni,ri),Ct.strokeWeight(1),jt=fi(kt,ui,ai),kt.useProgram(jt),f("usingTexture3d",jt,"usingTexture",tr),Ct.lightFalloff(1,0,0),Ct.shininess(1),Ct.ambient(255,255,255),Ct.specular(0,0,0),Ct.emissive(0,0,0),qt=kt.createBuffer(),kt.bindBuffer(kt.ARRAY_BUFFER,qt),kt.bufferData(kt.ARRAY_BUFFER,Gr,kt.STATIC_DRAW),Rt=kt.createBuffer(),kt.bindBuffer(kt.ARRAY_BUFFER,Rt),kt.bufferData(kt.ARRAY_BUFFER,Zr,kt.STATIC_DRAW),Ut=kt.createBuffer(),kt.bindBuffer(kt.ARRAY_BUFFER,Ut),kt.bufferData(kt.ARRAY_BUFFER,Yr,kt.STATIC_DRAW),zt=kt.createBuffer(),kt.bindBuffer(kt.ARRAY_BUFFER,zt),kt.bufferData(kt.ARRAY_BUFFER,ei,kt.STATIC_DRAW),Wt=kt.createBuffer(),kt.bindBuffer(kt.ARRAY_BUFFER,Wt),kt.bufferData(kt.ARRAY_BUFFER,ti,kt.STATIC_DRAW),Xt=kt.createBuffer(),Vt=kt.createBuffer(),$t=kt.createBuffer(),Jt=kt.createBuffer(),Kt=kt.createBuffer(),Gt=kt.createBuffer(),Qt=kt.createBuffer(),kt.bindBuffer(kt.ARRAY_BUFFER,Qt),kt.bufferData(kt.ARRAY_BUFFER,new w([0,0,0]),kt.STATIC_DRAW),en=kt.createBuffer(),kt.bindBuffer(kt.ARRAY_BUFFER,en),kt.bufferData(kt.ARRAY_BUFFER,new w([1,1,0,-1,1,0,-1,-1,0,1,-1,0]),kt.STATIC_DRAW),tn=kt.createBuffer(),kt.bindBuffer(kt.ARRAY_BUFFER,tn),kt.bufferData(kt.ARRAY_BUFFER,new w([0,0,1,0,1,1,0,1]),kt.STATIC_DRAW),nn=kt.createBuffer(),kt.bindBuffer(kt.ELEMENT_ARRAY_BUFFER,nn),kt.bufferData(kt.ELEMENT_ARRAY_BUFFER,new S([0,1,2,2,3,0]),kt.STATIC_DRAW),yr=new ki,br=new ki,wr=new ki,Er=new ki,Nr=new ki,Ct.camera(),Ct.perspective(),Sr=new Li,xr=new Li,Mt=new ki,_t=new ki,Dt=new ki,Pt=new ki,Ht=new ki,Bt=new ki,Bt.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0),di.prototype.size.apply(this,arguments)}}(),vi.prototype.ambientLight=di.prototype.a3DOnlyFunction,mi.prototype.ambientLight=function(e,t,n,r,i,s){if(8===Cr)throw"can only create 8 lights";var o=new L(r,i,s),u=new ki;u.scale(1,-1,1),u.apply(wr.array()),u.mult(o,o);var l=d(e,t,n,0),c=[(255&l>>16)/255,(255&l>>8)/255,(255&l)/255];kt.useProgram(jt),a("uLights.color.3d."+Cr,jt,"uLights"+Cr+".color",c),a("uLights.position.3d."+Cr,jt,"uLights"+Cr+".position",o.array()),f("uLights.type.3d."+Cr,jt,"uLights"+Cr+".type",0),f("uLightCount3d",jt,"uLightCount",++Cr)},vi.prototype.directionalLight=di.prototype.a3DOnlyFunction,mi.prototype.directionalLight=function(e,t,n,r,i,s){if(8===Cr)throw"can only create 8 lights";kt.useProgram(jt);var o=new ki;o.scale(1,-1,1),o.apply(wr.array()),o=o.array();var u=[o[0]*r+o[4]*i+o[8]*s,o[1]*r+o[5]*i+o[9]*s,o[2]*r+o[6]*i+o[10]*s],l=d(e,t,n,0),c=[(255&l>>16)/255,(255&l>>8)/255,(255&l)/255];a("uLights.color.3d."+Cr,jt,"uLights"+Cr+".color",c),a("uLights.position.3d."+Cr,jt,"uLights"+Cr+".position",u),f("uLights.type.3d."+Cr,jt,"uLights"+Cr+".type",1),f("uLightCount3d",jt,"uLightCount",++Cr)},vi.prototype.lightFalloff=di.prototype.a3DOnlyFunction,mi.prototype.lightFalloff=function(e,t,n){kt.useProgram(jt),a("uFalloff3d",jt,"uFalloff",[e,t,n])},vi.prototype.lightSpecular=di.prototype.a3DOnlyFunction,mi.prototype.lightSpecular=function(e,t,n){var r=d(e,t,n,0),i=[(255&r>>16)/255,(255&r>>8)/255,(255&r)/255];kt.useProgram(jt),a("uSpecular3d",jt,"uSpecular",i)},Ct.lights=function(){Ct.ambientLight(128,128,128),Ct.directionalLight(128,128,128,0,0,-1),Ct.lightFalloff(1,0,0),Ct.lightSpecular(0,0,0)},vi.prototype.pointLight=di.prototype.a3DOnlyFunction,mi.prototype.pointLight=function(e,t,n,r,i,s){if(8===Cr)throw"can only create 8 lights";var o=new L(r,i,s),u=new ki;u.scale(1,-1,1),u.apply(wr.array()),u.mult(o,o);var l=d(e,t,n,0),c=[(255&l>>16)/255,(255&l>>8)/255,(255&l)/255];kt.useProgram(jt),a("uLights.color.3d."+Cr,jt,"uLights"+Cr+".color",c),a("uLights.position.3d."+Cr,jt,"uLights"+Cr+".position",o.array()),f("uLights.type.3d."+Cr,jt,"uLights"+Cr+".type",2),f("uLightCount3d",jt,"uLightCount",++Cr)},vi.prototype.noLights=di.prototype.a3DOnlyFunction,mi.prototype.noLights=function(){Cr=0,kt.useProgram(jt),f("uLightCount3d",jt,"uLightCount",Cr)},vi.prototype.spotLight=di.prototype.a3DOnlyFunction,mi.prototype.spotLight=function(e,t,n,r,i,s,o,u,l,c,h){if(8===Cr)throw"can only create 8 lights";kt.useProgram(jt);var p=new L(r,i,s),v=new ki;v.scale(1,-1,1),v.apply(wr.array()),v.mult(p,p),v=v.array();var m=[v[0]*o+v[4]*u+v[8]*l,v[1]*o+v[5]*u+v[9]*l,v[2]*o+v[6]*u+v[10]*l],g=d(e,t,n,0),y=[(255&g>>16)/255,(255&g>>8)/255,(255&g)/255];a("uLights.color.3d."+Cr,jt,"uLights"+Cr+".color",y),a("uLights.position.3d."+Cr,jt,"uLights"+Cr+".position",p.array()),a("uLights.direction.3d."+Cr,jt,"uLights"+Cr+".direction",m),a("uLights.concentration.3d."+Cr,jt,"uLights"+Cr+".concentration",h),a("uLights.angle.3d."+Cr,jt,"uLights"+Cr+".angle",c),f("uLights.type.3d."+Cr,jt,"uLights"+Cr+".type",3),f("uLightCount3d",jt,"uLightCount",++Cr)},vi.prototype.beginCamera=function(){throw"beginCamera() is not available in 2D mode"},mi.prototype.beginCamera=function(){if(Pr)throw"You cannot call beginCamera() again before calling endCamera()";Pr=!0,wr=br,Er=yr},vi.prototype.endCamera=function(){throw"endCamera() is not available in 2D mode"},mi.prototype.endCamera=function(){if(!Pr)throw"You cannot call endCamera() before calling beginCamera()";wr.set(yr),Er.set(br),Pr=!1},Ct.camera=function(e,t,i,s,o,u,a,f,l){e===r&&(jr=Ct.width/2,Fr=Ct.height/2,Ir=Fr/n.tan(Br/2),e=jr,t=Fr,i=Ir,s=jr,o=Fr,u=0,a=0,f=1,l=0);var c=new L(e-s,t-o,i-u),h=new L(a,f,l);c.normalize();var p=L.cross(h,c);h=L.cross(c,p),p.normalize(),h.normalize();var d=p.x,v=p.y,m=p.z,g=h.x,y=h.y,b=h.z,w=c.x,E=c.y,S=c.z;yr.set(d,v,m,0,g,y,b,0,w,E,S,0,0,0,0,1),yr.translate(-e,-t,-i),br.reset(),br.invApply(d,v,m,0,g,y,b,0,w,E,S,0,0,0,0,1),br.translate(e,t,i),wr.set(yr),Er.set(br)},Ct.perspective=function(e,t,r,i){0===arguments.length&&(Fr=Tt.height/2,Ir=Fr/n.tan(Br/2),qr=Ir/10,Rr=10*Ir,Ur=Ct.width/Ct.height,e=Br,t=Ur,r=qr,i=Rr);var s,o,u,a;s=r*n.tan(e/2),o=-s,u=s*t,a=o*t,Ct.frustum(a,u,o,s,r,i)},vi.prototype.frustum=function(){throw"Processing.js: frustum() is not supported in 2D mode"},mi.prototype.frustum=function(e,t,n,r,i,s){Hr=!0,Nr=new ki,Nr.set(2*i/(t-e),0,(t+e)/(t-e),0,0,2*i/(r-n),(r+n)/(r-n),0,0,0,-(s+i)/(s-i),-(2*s*i)/(s-i),0,0,-1,0);var o=new ki;o.set(Nr),o.transpose(),kt.useProgram(Ft),l("projection2d",Ft,"uProjection",!1,o.array()),kt.useProgram(jt),l("projection3d",jt,"uProjection",!1,o.array()),kt.useProgram(It),l("uProjectionUS",It,"uProjection",!1,o.array())},Ct.ortho=function(e,t,n,r,i,s){0===arguments.length&&(e=0,t=Ct.width,n=0,r=Ct.height,i=-10,s=10);var o=2/(t-e),u=2/(r-n),a=-2/(s-i),f=-(t+e)/(t-e),c=-(r+n)/(r-n),h=-(s+i)/(s-i);Nr=new ki,Nr.set(o,0,0,f,0,u,0,c,0,0,a,h,0,0,0,1);var p=new ki;p.set(Nr),p.transpose(),kt.useProgram(Ft),l("projection2d",Ft,"uProjection",!1,p.array()),kt.useProgram(jt),l("projection3d",jt,"uProjection",!1,p.array()),kt.useProgram(It),l("uProjectionUS",It,"uProjection",!1,p.array()),Hr=!1},Ct.printProjection=function(){Nr.print()},Ct.printCamera=function(){yr.print()},vi.prototype.box=di.prototype.a3DOnlyFunction,mi.prototype.box=function(e,t,n){t&&n||(t=n=e);var r=new ki;r.scale(e,t,n);var i=new ki;if(i.scale(1,-1,1),i.apply(wr.array()),i.transpose(),ln){if(kt.useProgram(jt),l("model3d",jt,"uModel",!1,r.array()),l("view3d",jt,"uView",!1,i.array()),kt.enable(kt.POLYGON_OFFSET_FILL),kt.polygonOffset(1,1),a("color3d",jt,"uColor",cn),Cr>0){var s=new ki;s.set(i);var o=new ki;o.set(r),s.mult(o);var u=new ki;u.set(s),u.invert(),u.transpose(),l("uNormalTransform3d",jt,"uNormalTransform",!1,u.array()),c("aNormal3d",jt,"aNormal",3,Rt)}else p("aNormal3d",jt,"aNormal");c("aVertex3d",jt,"aVertex",3,qt),p("aColor3d",jt,"aColor"),p("aTexture3d",jt,"aTexture"),kt.drawArrays(kt.TRIANGLES,0,Gr.length/3),kt.disable(kt.POLYGON_OFFSET_FILL)}yn>0&&dn&&(kt.useProgram(Ft),l("uModel2d",Ft,"uModel",!1,r.array()),l("uView2d",Ft,"uView",!1,i.array()),a("uColor2d",Ft,"uColor",vn),f("uIsDrawingText2d",Ft,"uIsDrawingText",!1),c("vertex2d",Ft,"aVertex",3,Ut),p("aTextureCoord2d",Ft,"aTextureCoord"),kt.drawArrays(kt.LINES,0,Yr.length/3))};var Pi=function(){var e;for(gr=[],e=0;Lr>e;e++)gr.push(0),gr.push(-1),gr.push(0),gr.push(Ar[e]),gr.push(Or[e]),gr.push(Mr[e]);gr.push(0),gr.push(-1),gr.push(0),gr.push(Ar[0]),gr.push(Or[0]),gr.push(Mr[0]);var t,n,r,i=0;for(e=2;kr>e;e++){t=n=i,i+=Lr,r=i;for(var s=0;Lr>s;s++)gr.push(Ar[t]),gr.push(Or[t]),gr.push(Mr[t++]),gr.push(Ar[r]),gr.push(Or[r]),gr.push(Mr[r++]);t=n,r=i,gr.push(Ar[t]),gr.push(Or[t]),gr.push(Mr[t]),gr.push(Ar[r]),gr.push(Or[r]),gr.push(Mr[r])}for(e=0;Lr>e;e++)r=i+e,gr.push(Ar[r]),gr.push(Or[r]),gr.push(Mr[r]),gr.push(0),gr.push(1),gr.push(0);gr.push(Ar[i]),gr.push(Or[i]),gr.push(Mr[i]),gr.push(0),gr.push(1),gr.push(0),kt.bindBuffer(kt.ARRAY_BUFFER,Xt),kt.bufferData(kt.ARRAY_BUFFER,new w(gr),kt.STATIC_DRAW)};Ct.sphereDetail=function(e,t){var n;if(1===arguments.length&&(e=t=arguments[0]),3>e&&(e=3),2>t&&(t=2),e!==Lr||t!==kr){var r=720/e,i=new w(e),s=new w(e);for(n=0;e>n;n++)i[n]=Dr[0|n*r%720],s[n]=_r[0|n*r%720];var o=e*(t-1)+2,u=0;Ar=new w(o),Or=new w(o),Mr=new w(o);var a=360/t,f=a;for(n=1;t>n;n++){for(var l=_r[0|f%720],c=-Dr[0|f%720],h=0;e>h;h++)Ar[u]=i[h]*l,Or[u]=c,Mr[u++]=s[h]*l;f+=a}Lr=e,kr=t,Pi()}},vi.prototype.sphere=di.prototype.a3DOnlyFunction,mi.prototype.sphere=function(){var e=arguments[0];(3>Lr||2>kr)&&Ct.sphereDetail(30);var t=new ki;t.scale(e,e,e);var n=new ki;if(n.scale(1,-1,1),n.apply(wr.array()),n.transpose(),ln){if(Cr>0){var r=new ki;r.set(n);var i=new ki;i.set(t),r.mult(i);var s=new ki;s.set(r),s.invert(),s.transpose(),l("uNormalTransform3d",jt,"uNormalTransform",!1,s.array()),c("aNormal3d",jt,"aNormal",3,Xt)}else p("aNormal3d",jt,"aNormal");kt.useProgram(jt),p("aTexture3d",jt,"aTexture"),l("uModel3d",jt,"uModel",!1,t.array()),l("uView3d",jt,"uView",!1,n.array()),c("aVertex3d",jt,"aVertex",3,Xt),p("aColor3d",jt,"aColor"),kt.enable(kt.POLYGON_OFFSET_FILL),kt.polygonOffset(1,1),a("uColor3d",jt,"uColor",cn),kt.drawArrays(kt.TRIANGLE_STRIP,0,gr.length/3),kt.disable(kt.POLYGON_OFFSET_FILL)}yn>0&&dn&&(kt.useProgram(Ft),l("uModel2d",Ft,"uModel",!1,t.array()),l("uView2d",Ft,"uView",!1,n.array()),c("aVertex2d",Ft,"aVertex",3,Xt),p("aTextureCoord2d",Ft,"aTextureCoord"),a("uColor2d",Ft,"uColor",vn),f("uIsDrawingText",Ft,"uIsDrawingText",!1),kt.drawArrays(kt.LINE_STRIP,0,gr.length/3))},Ct.modelX=function(e,t,n){var r=wr.array(),i=br.array(),s=r[0]*e+r[1]*t+r[2]*n+r[3],o=r[4]*e+r[5]*t+r[6]*n+r[7],u=r[8]*e+r[9]*t+r[10]*n+r[11],a=r[12]*e+r[13]*t+r[14]*n+r[15],f=i[0]*s+i[1]*o+i[2]*u+i[3]*a,l=i[12]*s+i[13]*o+i[14]*u+i[15]*a;return 0!==l?f/l:f},Ct.modelY=function(e,t,n){var r=wr.array(),i=br.array(),s=r[0]*e+r[1]*t+r[2]*n+r[3],o=r[4]*e+r[5]*t+r[6]*n+r[7],u=r[8]*e+r[9]*t+r[10]*n+r[11],a=r[12]*e+r[13]*t+r[14]*n+r[15],f=i[4]*s+i[5]*o+i[6]*u+i[7]*a,l=i[12]*s+i[13]*o+i[14]*u+i[15]*a;return 0!==l?f/l:f},Ct.modelZ=function(e,t,n){var r=wr.array(),i=br.array(),s=r[0]*e+r[1]*t+r[2]*n+r[3],o=r[4]*e+r[5]*t+r[6]*n+r[7],u=r[8]*e+r[9]*t+r[10]*n+r[11],a=r[12]*e+r[13]*t+r[14]*n+r[15],f=i[8]*s+i[9]*o+i[10]*u+i[11]*a,l=i[12]*s+i[13]*o+i[14]*u+i[15]*a;return 0!==l?f/l:f},vi.prototype.ambient=di.prototype.a3DOnlyFunction,mi.prototype.ambient=function(e,t,n){kt.useProgram(jt),f("uUsingMat3d",jt,"uUsingMat",!0);var r=Ct.color(e,t,n);a("uMaterialAmbient3d",jt,"uMaterialAmbient",Ct.color.toGLArray(r).slice(0,3))},vi.prototype.emissive=di.prototype.a3DOnlyFunction,mi.prototype.emissive=function(e,t,n){kt.useProgram(jt),f("uUsingMat3d",jt,"uUsingMat",!0);var r=Ct.color(e,t,n);a("uMaterialEmissive3d",jt,"uMaterialEmissive",Ct.color.toGLArray(r).slice(0,3))},vi.prototype.shininess=di.prototype.a3DOnlyFunction,mi.prototype.shininess=function(e){kt.useProgram(jt),f("uUsingMat3d",jt,"uUsingMat",!0),a("uShininess3d",jt,"uShininess",e)},vi.prototype.specular=di.prototype.a3DOnlyFunction,mi.prototype.specular=function(e,t,n){kt.useProgram(jt),f("uUsingMat3d",jt,"uUsingMat",!0);var r=Ct.color(e,t,n);a("uMaterialSpecular3d",jt,"uMaterialSpecular",Ct.color.toGLArray(r).slice(0,3))},Ct.screenX=function(e,t,n){var r=wr.array();if(16===r.length){var i=r[0]*e+r[1]*t+r[2]*n+r[3],s=r[4]*e+r[5]*t+r[6]*n+r[7],o=r[8]*e+r[9]*t+r[10]*n+r[11],u=r[12]*e+r[13]*t+r[14]*n+r[15],a=Nr.array(),f=a[0]*i+a[1]*s+a[2]*o+a[3]*u,l=a[12]*i+a[13]*s+a[14]*o+a[15]*u;return 0!==l&&(f/=l),Ct.width*(1+f)/2}return wr.multX(e,t)},Ct.screenY=function(e,t,n){var r=wr.array();if(16===r.length){var i=r[0]*e+r[1]*t+r[2]*n+r[3],s=r[4]*e+r[5]*t+r[6]*n+r[7],o=r[8]*e+r[9]*t+r[10]*n+r[11],u=r[12]*e+r[13]*t+r[14]*n+r[15],a=Nr.array(),f=a[4]*i+a[5]*s+a[6]*o+a[7]*u,l=a[12]*i+a[13]*s+a[14]*o+a[15]*u;return 0!==l&&(f/=l),Ct.height*(1+f)/2}return wr.multY(e,t)},Ct.screenZ=function(e,t,n){var r=wr.array();if(16!==r.length)return 0;var i=Nr.array(),s=r[0]*e+r[1]*t+r[2]*n+r[3],o=r[4]*e+r[5]*t+r[6]*n+r[7],u=r[8]*e+r[9]*t+r[10]*n+r[11],a=r[12]*e+r[13]*t+r[14]*n+r[15],f=i[8]*s+i[9]*o+i[10]*u+i[11]*a,l=i[12]*s+i[13]*o+i[14]*u+i[15]*a;return 0!==l&&(f/=l),(f+1)/2},di.prototype.fill=function(){var e=Ct.color(arguments[0],arguments[1],arguments[2],arguments[3]);e===hn&&ln||(ln=!0,hn=e)},vi.prototype.fill=function(){di.prototype.fill.apply(this,arguments),pn=!0},mi.prototype.fill=function(){di.prototype.fill.apply(this,arguments),cn=Ct.color.toGLArray(hn)},Ct.noFill=function(){ln=!1},di.prototype.stroke=function(){var e=Ct.color(arguments[0],arguments[1],arguments[2],arguments[3]);e===mn&&dn||(dn=!0,mn=e)},vi.prototype.stroke=function(){di.prototype.stroke.apply(this,arguments),gn=!0},mi.prototype.stroke=function(){di.prototype.stroke.apply(this,arguments),vn=Ct.color.toGLArray(mn)},Ct.noStroke=function(){dn=!1},di.prototype.strokeWeight=function(e){yn=e},vi.prototype.strokeWeight=function(e){di.prototype.strokeWeight.apply(this,arguments),kt.lineWidth=e},mi.prototype.strokeWeight=function(e){di.prototype.strokeWeight.apply(this,arguments),kt.useProgram(Ft),a("pointSize2d",Ft,"uPointSize",e),kt.useProgram(It),a("pointSizeUnlitShape",It,"uPointSize",e),kt.lineWidth(e)},Ct.strokeCap=function(e){At.$ensureContext().lineCap=e},Ct.strokeJoin=function(e){At.$ensureContext().lineJoin=e},vi.prototype.smooth=function(){wn=!0;var e=Tt.style;e.setProperty("image-rendering","optimizeQuality","important"),e.setProperty("-ms-interpolation-mode","bicubic","important"),kt.hasOwnProperty("mozImageSmoothingEnabled")&&(kt.mozImageSmoothingEnabled=!0)},mi.prototype.smooth=function(){wn=!0},vi.prototype.noSmooth=function(){wn=!1;var e=Tt.style;e.setProperty("image-rendering","optimizeSpeed","important"),e.setProperty("image-rendering","-moz-crisp-edges","important"),e.setProperty("image-rendering","-webkit-optimize-contrast","important"),e.setProperty("image-rendering","optimize-contrast","important"),e.setProperty("-ms-interpolation-mode","nearest-neighbor","important"),kt.hasOwnProperty("mozImageSmoothingEnabled")&&(kt.mozImageSmoothingEnabled=!1)},mi.prototype.noSmooth=function(){wn=!1},vi.prototype.point=function(e,t){dn&&(e=n.round(e),t=n.round(t),kt.fillStyle=Ct.color.toString(mn),pn=!0,yn>1?(kt.beginPath(),kt.arc(e,t,yn/2,0,6.283185307179586,!1),kt.fill()):kt.fillRect(e,t,1,1))},mi.prototype.point=function(e,t,n){var r=new ki;r.translate(e,t,n||0),r.transpose();var i=new ki;i.scale(1,-1,1),i.apply(wr.array()),i.transpose(),kt.useProgram(Ft),l("uModel2d",Ft,"uModel",!1,r.array()),l("uView2d",Ft,"uView",!1,i.array()),yn>0&&dn&&(a("uColor2d",Ft,"uColor",vn),f("uIsDrawingText2d",Ft,"uIsDrawingText",!1),f("uSmooth2d",Ft,"uSmooth",wn),c("aVertex2d",Ft,"aVertex",3,Qt),p("aTextureCoord2d",Ft,"aTextureCoord"),kt.drawArrays(kt.POINTS,0,1))},Ct.beginShape=function(e){Dn=e,Pn=[],zr=[]},vi.prototype.vertex=function(e,t,n){var r=[];Jr&&(Jr=!1),r.isVert=!0,r[0]=e,r[1]=t,r[2]=0,r[3]=0,r[4]=0,r[5]=hn,r[6]=mn,zr.push(r),n&&(zr[zr.length-1].moveTo=n)},mi.prototype.vertex=function(e,t,n,i,s){var o=[];Jr&&(Jr=!1),o.isVert=!0,s===r&&tr&&(s=i,i=n,n=0),i!==r&&s!==r&&(2===er&&(i/=Zn.width,s/=Zn.height),i=i>1?1:i,i=0>i?0:i,s=s>1?1:s,s=0>s?0:s),o[0]=e,o[1]=t,o[2]=n||0,o[3]=i||0,o[4]=s||0,o[5]=cn[0],o[6]=cn[1],o[7]=cn[2],o[8]=cn[3],o[9]=vn[0],o[10]=vn[1],o[11]=vn[2],o[12]=vn[3],o[13]=Nn,o[14]=Cn,o[15]=kn,zr.push(o)};var Hi=function(e,t){var n=new ki;n.scale(1,-1,1),n.apply(wr.array()),n.transpose(),kt.useProgram(It),l("uViewUS",It,"uView",!1,n.array()),f("uSmoothUS",It,"uSmooth",wn),c("aVertexUS",It,"aVertex",3,Qt),kt.bufferData(kt.ARRAY_BUFFER,new w(e),kt.STREAM_DRAW),c("aColorUS",It,"aColor",4,Jt),kt.bufferData(kt.ARRAY_BUFFER,new w(t),kt.STREAM_DRAW),kt.drawArrays(kt.POINTS,0,e.length/3)},Bi=function(e,t,n){var r;r="LINES"===t?kt.LINES:"LINE_LOOP"===t?kt.LINE_LOOP:kt.LINE_STRIP;var i=new ki;i.scale(1,-1,1),i.apply(wr.array()),i.transpose(),kt.useProgram(It),l("uViewUS",It,"uView",!1,i.array()),c("aVertexUS",It,"aVertex",3,Vt),kt.bufferData(kt.ARRAY_BUFFER,new w(e),kt.STREAM_DRAW),c("aColorUS",It,"aColor",4,Kt),kt.bufferData(kt.ARRAY_BUFFER,new w(n),kt.STREAM_DRAW),kt.drawArrays(r,0,e.length/3)},ji=function(e,t,n,r){var i;i="TRIANGLES"===t?kt.TRIANGLES:"TRIANGLE_FAN"===t?kt.TRIANGLE_FAN:kt.TRIANGLE_STRIP;var s=new ki;s.scale(1,-1,1),s.apply(wr.array()),s.transpose(),kt.useProgram(jt),l("model3d",jt,"uModel",!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),l("view3d",jt,"uView",!1,s.array()),kt.enable(kt.POLYGON_OFFSET_FILL),kt.polygonOffset(1,1),a("color3d",jt,"uColor",[-1,0,0,0]),c("vertex3d",jt,"aVertex",3,$t),kt.bufferData(kt.ARRAY_BUFFER,new w(e),kt.STREAM_DRAW),tr&&null!==$n&&Jn(n),c("aColor3d",jt,"aColor",4,Jt),kt.bufferData(kt.ARRAY_BUFFER,new w(n),kt.STREAM_DRAW),p("aNormal3d",jt,"aNormal"),tr&&(f("uUsingTexture3d",jt,"uUsingTexture",tr),c("aTexture3d",jt,"aTexture",2,Gt),kt.bufferData(kt.ARRAY_BUFFER,new w(r),kt.STREAM_DRAW)),kt.drawArrays(i,0,e.length/3),kt.disable(kt.POLYGON_OFFSET_FILL)};vi.prototype.endShape=function(e){if(0!==zr.length){var t=2===e;t&&zr.push(zr[0]);var n,i=[],s=[],o=[],u=[];Jr=!0;var a,f,l=zr.length;for(a=0;l>a;a++)for(n=zr[a],f=0;3>f;f++)i.push(n[f]);for(a=0;l>a;a++)for(n=zr[a],f=5;9>f;f++)s.push(n[f]);for(a=0;l>a;a++)for(n=zr[a],f=9;13>f;f++)o.push(n[f]);for(a=0;l>a;a++)n=zr[a],u.push(n[3]),u.push(n[4]);if(!Vr||20!==Dn&&Dn!==r)if(!$r||20!==Dn&&Dn!==r)if(2===Dn)for(a=0;l>a;a++)n=zr[a],dn&&Ct.stroke(n[6]),Ct.point(n[0],n[1]);else if(4===Dn)for(a=0;l>a+1;a+=2)n=zr[a],dn&&Ct.stroke(zr[a+1][6]),Ct.line(n[0],n[1],zr[a+1][0],zr[a+1][1]);else if(9===Dn)for(a=0;l>a+2;a+=3)n=zr[a],kt.beginPath(),kt.moveTo(n[0],n[1]),kt.lineTo(zr[a+1][0],zr[a+1][1]),kt.lineTo(zr[a+2][0],zr[a+2][1]),kt.lineTo(n[0],n[1]),ln&&(Ct.fill(zr[a+2][5]),V()),dn&&(Ct.stroke(zr[a+2][6]),$()),kt.closePath();else if(10===Dn)for(a=0;l>a+1;a++)n=zr[a],kt.beginPath(),kt.moveTo(zr[a+1][0],zr[a+1][1]),kt.lineTo(n[0],n[1]),dn&&Ct.stroke(zr[a+1][6]),ln&&Ct.fill(zr[a+1][5]),l>a+2&&(kt.lineTo(zr[a+2][0],zr[a+2][1]),dn&&Ct.stroke(zr[a+2][6]),ln&&Ct.fill(zr[a+2][5])),J();else if(11===Dn){if(l>2)for(kt.beginPath(),kt.moveTo(zr[0][0],zr[0][1]),kt.lineTo(zr[1][0],zr[1][1]),kt.lineTo(zr[2][0],zr[2][1]),ln&&(Ct.fill(zr[2][5]),V()),dn&&(Ct.stroke(zr[2][6]),$()),kt.closePath(),a=3;l>a;a++)n=zr[a],kt.beginPath(),kt.moveTo(zr[0][0],zr[0][1]),kt.lineTo(zr[a-1][0],zr[a-1][1]),kt.lineTo(n[0],n[1]),ln&&(Ct.fill(n[5]),V()),dn&&(Ct.stroke(n[6]),$()),kt.closePath()}else if(16===Dn)for(a=0;l>a+3;a+=4){for(n=zr[a],kt.beginPath(),kt.moveTo(n[0],n[1]),f=1;4>f;f++)kt.lineTo(zr[a+f][0],zr[a+f][1]);kt.lineTo(n[0],n[1]),ln&&(Ct.fill(zr[a+3][5]),V()),dn&&(Ct.stroke(zr[a+3][6]),$()),kt.closePath()}else if(17===Dn){if(l>3)for(a=0;l>a+1;a+=2)n=zr[a],kt.beginPath(),l>a+3?(kt.moveTo(zr[a+2][0],zr[a+2][1]),kt.lineTo(n[0],n[1]),kt.lineTo(zr[a+1][0],zr[a+1][1]),kt.lineTo(zr[a+3][0],zr[a+3][1]),ln&&Ct.fill(zr[a+3][5]),dn&&Ct.stroke(zr[a+3][6])):(kt.moveTo(n[0],n[1]),kt.lineTo(zr[a+1][0],zr[a+1][1])),J()}else{for(kt.beginPath(),kt.moveTo(zr[0][0],zr[0][1]),a=1;l>a;a++)n=zr[a],n.isVert&&(n.moveTo?kt.moveTo(n[0],n[1]):kt.lineTo(n[0],n[1]));J()}else{for(kt.beginPath(),a=0;l>a;a++)n=zr[a],zr[a].isVert?zr[a].moveTo?kt.moveTo(n[0],n[1]):kt.lineTo(n[0],n[1]):kt.bezierCurveTo(zr[a][0],zr[a][1],zr[a][2],zr[a][3],zr[a][4],zr[a][5]);J()}else if(l>3){var c=[],h=1-Hn;for(kt.beginPath(),kt.moveTo(zr[1][0],zr[1][1]),a=1;l>a+2;a++)n=zr[a],c[0]=[n[0],n[1]],c[1]=[n[0]+(h*zr[a+1][0]-h*zr[a-1][0])/6,n[1]+(h*zr[a+1][1]-h*zr[a-1][1])/6],c[2]=[zr[a+1][0]+(h*zr[a][0]-h*zr[a+2][0])/6,zr[a+1][1]+(h*zr[a][1]-h*zr[a+2][1])/6],c[3]=[zr[a+1][0],zr[a+1][1]],kt.bezierCurveTo(c[1][0],c[1][1],c[2][0],c[2][1],c[3][0],c[3][1]);J()}Vr=!1,$r=!1,Wr=[],Xr=0,t&&zr.pop()}},mi.prototype.endShape=function(e){if(0!==zr.length){var t,n=2===e,i=[],s=[],o=[],u=[],a=[];Jr=!0;var l,c,h,p=zr.length;for(l=0;p>l;l++)for(t=zr[l],c=0;3>c;c++)s.push(t[c]);for(l=0;p>l;l++)for(t=zr[l],c=5;9>c;c++)o.push(t[c]);for(l=0;p>l;l++)for(t=zr[l],c=9;13>c;c++)u.push(t[c]);for(l=0;p>l;l++)t=zr[l],a.push(t[3]),a.push(t[4]);if(n){for(s.push(zr[0][0]),s.push(zr[0][1]),s.push(zr[0][2]),l=5;9>l;l++)o.push(zr[0][l]);for(l=9;13>l;l++)u.push(zr[0][l]);a.push(zr[0][3]),a.push(zr[0][4])}if(!Vr||20!==Dn&&Dn!==r)if(!$r||20!==Dn&&Dn!==r){if(2===Dn){for(l=0;p>l;l++)for(t=zr[l],c=0;3>c;c++)i.push(t[c]);Hi(i,u)}else if(4===Dn){for(l=0;p>l;l++)for(t=zr[l],c=0;3>c;c++)i.push(t[c]);for(l=0;p>l;l++)for(t=zr[l],c=5;9>c;c++)o.push(t[c]);Bi(i,"LINES",u)}else if(9===Dn){if(p>2)for(l=0;p>l+2;l+=3){for(s=[],a=[],i=[],o=[],u=[],c=0;3>c;c++)for(h=0;3>h;h++)i.push(zr[l+c][h]),s.push(zr[l+c][h]);for(c=0;3>c;c++)for(h=3;5>h;h++)a.push(zr[l+c][h]);for(c=0;3>c;c++)for(h=5;9>h;h++)o.push(zr[l+c][h]),u.push(zr[l+c][h+4]);dn&&Bi(i,"LINE_LOOP",u),(ln||tr)&&ji(s,"TRIANGLES",o,a)}}else if(10===Dn){if(p>2)for(l=0;p>l+2;l++){for(i=[],s=[],u=[],o=[],a=[],c=0;3>c;c++)for(h=0;3>h;h++)i.push(zr[l+c][h]),s.push(zr[l+c][h]);for(c=0;3>c;c++)for(h=3;5>h;h++)a.push(zr[l+c][h]);for(c=0;3>c;c++)for(h=5;9>h;h++)u.push(zr[l+c][h+4]),o.push(zr[l+c][h]);(ln||tr)&&ji(s,"TRIANGLE_STRIP",o,a),dn&&Bi(i,"LINE_LOOP",u)}}else if(11===Dn){if(p>2){for(l=0;3>l;l++)for(t=zr[l],c=0;3>c;c++)i.push(t[c]);for(l=0;3>l;l++)for(t=zr[l],c=9;13>c;c++)u.push(t[c]);for(dn&&Bi(i,"LINE_LOOP",u),l=2;p>l+1;l++){for(i=[],u=[],i.push(zr[0][0]),i.push(zr[0][1]),i.push(zr[0][2]),u.push(zr[0][9]),u.push(zr[0][10]),u.push(zr[0][11]),u.push(zr[0][12]),c=0;2>c;c++)for(h=0;3>h;h++)i.push(zr[l+c][h]);for(c=0;2>c;c++)for(h=9;13>h;h++)u.push(zr[l+c][h]);dn&&Bi(i,"LINE_STRIP",u)}(ln||tr)&&ji(s,"TRIANGLE_FAN",o,a)}}else if(16===Dn)for(l=0;p>l+3;l+=4){for(i=[],c=0;4>c;c++)for(t=zr[l+c],h=0;3>h;h++)i.push(t[h]);if(dn&&Bi(i,"LINE_LOOP",u),ln){for(s=[],o=[],a=[],c=0;3>c;c++)s.push(zr[l][c]);for(c=5;9>c;c++)o.push(zr[l][c]);for(c=0;3>c;c++)s.push(zr[l+1][c]);for(c=5;9>c;c++)o.push(zr[l+1][c]);for(c=0;3>c;c++)s.push(zr[l+3][c]);for(c=5;9>c;c++)o.push(zr[l+3][c]);for(c=0;3>c;c++)s.push(zr[l+2][c]);for(c=5;9>c;c++)o.push(zr[l+2][c]);tr&&(a.push(zr[l+0][3]),a.push(zr[l+0][4]),a.push(zr[l+1][3]),a.push(zr[l+1][4]),a.push(zr[l+3][3]),a.push(zr[l+3][4]),a.push(zr[l+2][3]),a.push(zr[l+2][4])),ji(s,"TRIANGLE_STRIP",o,a)}}else if(17===Dn){var d=[];if(p>3){for(l=0;2>l;l++)for(t=zr[l],c=0;3>c;c++)i.push(t[c]);for(l=0;2>l;l++)for(t=zr[l],c=9;13>c;c++)u.push(t[c]);for(Bi(i,"LINE_STRIP",u),p>4&&p%2>0&&(d=s.splice(s.length-3),zr.pop()),l=0;p>l+3;l+=2){for(i=[],u=[],c=0;3>c;c++)i.push(zr[l+1][c]);for(c=0;3>c;c++)i.push(zr[l+3][c]);for(c=0;3>c;c++)i.push(zr[l+2][c]);for(c=0;3>c;c++)i.push(zr[l+0][c]);for(c=9;13>c;c++)u.push(zr[l+1][c]);for(c=9;13>c;c++)u.push(zr[l+3][c]);for(c=9;13>c;c++)u.push(zr[l+2][c]);for(c=9;13>c;c++)u.push(zr[l+0][c]);dn&&Bi(i,"LINE_STRIP",u)}(ln||tr)&&ji(s,"TRIANGLE_LIST",o,a)}}else if(1===p){for(c=0;3>c;c++)i.push(zr[0][c]);for(c=9;13>c;c++)u.push(zr[0][c]);Hi(i,u)}else{for(l=0;p>l;l++){for(t=zr[l],c=0;3>c;c++)i.push(t[c]);for(c=5;9>c;c++)u.push(t[c])}dn&&n?Bi(i,"LINE_LOOP",u):dn&&!n&&Bi(i,"LINE_STRIP",u),(ln||tr)&&ji(s,"TRIANGLE_FAN",o,a)}tr=!1,kt.useProgram(jt),f("usingTexture3d",jt,"uUsingTexture",tr)}else i=s,i.splice(i.length-3),u.splice(u.length-4),dn&&Bi(i,null,u),ln&&ji(s,"TRIANGLES",o);else i=s,dn&&Bi(i,null,u),ln&&ji(s,null,o);Vr=!1,$r=!1,Wr=[],Xr=0}};var Fi=function(e,t){var n=1/e,r=n*n,i=r*n;t.set(0,0,0,1,i,r,n,0,6*i,2*r,0,0,6*i,0,0,0)},Ii=function(){Dt||(Mt=new ki,Dt=new ki,jn=!0);var e=Hn;Mt.set((e-1)/2,(e+3)/2,(-3-e)/2,(1-e)/2,1-e,(-5-e)/2,e+2,(e-1)/2,(e-1)/2,0,(1-e)/2,0,0,1,0,0),Fi(Bn,Dt),Ht||(_t=new ki),_t.set(Mt),_t.preApply(Ht),Dt.apply(Mt)};vi.prototype.bezierVertex=function(){$r=!0;var e=[];if(Jr)throw"vertex() must be used at least once before calling bezierVertex()";for(var t=0;t<arguments.length;t++)e[t]=arguments[t];zr.push(e),zr[zr.length-1].isVert=!1},mi.prototype.bezierVertex=function(){if($r=!0,Jr)throw"vertex() must be used at least once before calling bezierVertex()";if(9===arguments.length){Pt===r&&(Pt=new ki);var e=zr.length-1;Fi(In,Pt),Pt.apply(Bt);for(var t=Pt.array(),n=zr[e][0],i=zr[e][1],s=zr[e][2],o=t[4]*n+t[5]*arguments[0]+t[6]*arguments[3]+t[7]*arguments[6],u=t[8]*n+t[9]*arguments[0]+t[10]*arguments[3]+t[11]*arguments[6],a=t[12]*n+t[13]*arguments[0]+t[14]*arguments[3]+t[15]*arguments[6],f=t[4]*i+t[5]*arguments[1]+t[6]*arguments[4]+t[7]*arguments[7],l=t[8]*i+t[9]*arguments[1]+t[10]*arguments[4]+t[11]*arguments[7],c=t[12]*i+t[13]*arguments[1]+t[14]*arguments[4]+t[15]*arguments[7],h=t[4]*s+t[5]*arguments[2]+t[6]*arguments[5]+t[7]*arguments[8],p=t[8]*s+t[9]*arguments[2]+t[10]*arguments[5]+t[11]*arguments[8],d=t[12]*s+t[13]*arguments[2]+t[14]*arguments[5]+t[15]*arguments[8],v=0;In>v;v++)n+=o,o+=u,u+=a,i+=f,f+=l,l+=c,s+=h,h+=p,p+=d,Ct.vertex(n,i,s);Ct.vertex(arguments[6],arguments[7],arguments[8])}},Ct.texture=function(e){var n=At.$ensureContext();if(e.__texture)n.bindTexture(n.TEXTURE_2D,e.__texture);else if("canvas"===e.localName)n.bindTexture(n.TEXTURE_2D,Yt),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.generateMipmap(n.TEXTURE_2D),Zn.width=e.width,Zn.height=e.height;else{var r,i=n.createTexture(),s=t.createElement("canvas"),o=s.getContext("2d");if(e.width&0===e.width-1)s.width=e.width;else{for(r=1;r<e.width;)r*=2;s.width=r}if(e.height&0===e.height-1)s.height=e.height;else{for(r=1;r<e.height;)r*=2;s.height=r}o.drawImage(e.sourceImg,0,0,e.width,e.height,0,0,s.width,s.height),n.bindTexture(n.TEXTURE_2D,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,s),n.generateMipmap(n.TEXTURE_2D),e.__texture=i,Zn.width=e.width,Zn.height=e.height}tr=!0,n.useProgram(jt),f("usingTexture3d",jt,"uUsingTexture",tr)},Ct.textureMode=function(e){er=e};var qi=function(e,t,n,r,i,s,o,u,a,f,l,c){var h=r,p=i,d=s,v=Dt.array(),m=v[4]*e+v[5]*r+v[6]*o+v[7]*f,g=v[8]*e+v[9]*r+v[10]*o+v[11]*f,y=v[12]*e+v[13]*r+v[14]*o+v[15]*f,b=v[4]*t+v[5]*i+v[6]*u+v[7]*l,w=v[8]*t+v[9]*i+v[10]*u+v[11]*l,E=v[12]*t+v[13]*i+v[14]*u+v[15]*l,S=v[4]*n+v[5]*s+v[6]*a+v[7]*c,x=v[8]*n+v[9]*s+v[10]*a+v[11]*c,T=v[12]*n+v[13]*s+v[14]*a+v[15]*c;Ct.vertex(h,p,d);for(var N=0;Bn>N;N++)h+=m,m+=g,g+=y,p+=b,b+=w,w+=E,d+=S,S+=x,x+=T,Ct.vertex(h,p,d)};vi.prototype.curveVertex=function(e,t){Vr=!0,Ct.vertex(e,t)},mi.prototype.curveVertex=function(e,t,n){Vr=!0,jn||Ii();var r=[];r[0]=e,r[1]=t,r[2]=n,Wr.push(r),Xr++,Xr>3&&qi(Wr[Xr-4][0],Wr[Xr-4][1],Wr[Xr-4][2],Wr[Xr-3][0],Wr[Xr-3][1],Wr[Xr-3][2],Wr[Xr-2][0],Wr[Xr-2][1],Wr[Xr-2][2],Wr[Xr-1][0],Wr[Xr-1][1],Wr[Xr-1][2])},vi.prototype.curve=function(e,t,n,r,i,s,o,u){Ct.beginShape(),Ct.curveVertex(e,t),Ct.curveVertex(n,r),Ct.curveVertex(i,s),Ct.curveVertex(o,u),Ct.endShape()},mi.prototype.curve=function(e,t,n,i,s,o,u,a,f,l,c,h){return h!==r?(Ct.beginShape(),Ct.curveVertex(e,t,n),Ct.curveVertex(i,s,o),Ct.curveVertex(u,a,f),Ct.curveVertex(l,c,h),Ct.endShape(),void 0):(Ct.beginShape(),Ct.curveVertex(e,t),Ct.curveVertex(n,i),Ct.curveVertex(s,o),Ct.curveVertex(u,a),Ct.endShape(),void 0)},Ct.curveTightness=function(e){Hn=e},Ct.curveDetail=function(e){Bn=e,Ii()},Ct.rectMode=function(e){xn=e},Ct.imageMode=function(e){switch(e){case 0:ci=li;break;case 1:ci=hi;break;case 3:ci=pi;break;default:throw"Invalid imageMode"}},Ct.ellipseMode=function(e){Tn=e},Ct.arc=function(e,t,n,r,i,s){if(!(0>=n||i>s)){for(1===Tn?(n-=e,r-=t):2===Tn?(e-=n,t-=r,n=2*n,r=2*r):3===Tn&&(e-=n/2,t-=r/2);0>i;)i+=6.283185307179586,s+=6.283185307179586;s-i>6.283185307179586&&(i=0,s=6.283185307179586);var o,u,a=n/2,f=r/2,l=e+a,c=t+f,h=0|.5+2*i*Ct.RAD_TO_DEG,p=0|.5+2*s*Ct.RAD_TO_DEG;if(ln){var d=dn;for(dn=!1,Ct.beginShape(),Ct.vertex(l,c),o=h;p>=o;o++)u=o%720,Ct.vertex(l+Dr[u]*a,c+_r[u]*f);Ct.endShape(2),dn=d}if(dn){var v=ln;for(ln=!1,Ct.beginShape(),o=h;p>=o;o++)u=o%720,Ct.vertex(l+Dr[u]*a,c+_r[u]*f);Ct.endShape(),ln=v}}},vi.prototype.line=function(e,t,i,s){if(dn){if(e=n.round(e),i=n.round(i),t=n.round(t),s=n.round(s),e===i&&t===s)return Ct.point(e,t),void 0;for(var o=r,u=r,a=!0,f=wr.array(),l=[1,0,0,0,1,0],c=0;6>c&&a;c++)a=f[c]===l[c];a&&(e===i?(t>s&&(o=t,t=s,s=o),s++,1===yn%2&&kt.translate(.5,0)):t===s&&(e>i&&(o=e,e=i,i=o),i++,1===yn%2&&kt.translate(0,.5)),1===yn&&(u=kt.lineCap,kt.lineCap="butt")),kt.beginPath(),kt.moveTo(e||0,t||0),kt.lineTo(i||0,s||0),$(),a&&(e===i&&1===yn%2?kt.translate(-0.5,0):t===s&&1===yn%2&&kt.translate(0,-0.5),1===yn&&(kt.lineCap=u))}},mi.prototype.line=function(e,t,n,i,s,o){if((s===r||o===r)&&(o=0,s=i,i=n,n=0),e===i&&t===s&&n===o)return Ct.point(e,t,n),void 0;var u=[e,t,n,i,s,o],h=new ki;h.scale(1,-1,1),h.apply(wr.array()),h.transpose(),yn>0&&dn&&(kt.useProgram(Ft),l("uModel2d",Ft,"uModel",!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),l("uView2d",Ft,"uView",!1,h.array()),a("uColor2d",Ft,"uColor",vn),f("uIsDrawingText",Ft,"uIsDrawingText",!1),c("aVertex2d",Ft,"aVertex",3,Vt),p("aTextureCoord2d",Ft,"aTextureCoord"),kt.bufferData(kt.ARRAY_BUFFER,new w(u),kt.STREAM_DRAW),kt.drawArrays(kt.LINES,0,2))},vi.prototype.bezier=function(){if(8!==arguments.length)throw"You must use 8 parameters for bezier() in 2D mode";Ct.beginShape(),Ct.vertex(arguments[0],arguments[1]),Ct.bezierVertex(arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]),Ct.endShape()},mi.prototype.bezier=function(){if(12!==arguments.length)throw"You must use 12 parameters for bezier() in 3D mode";Ct.beginShape(),Ct.vertex(arguments[0],arguments[1],arguments[2]),Ct.bezierVertex(arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11]),Ct.endShape()},Ct.bezierDetail=function(e){In=e},Ct.bezierPoint=function(e,t,n,r,i){return(1-i)*(1-i)*(1-i)*e+3*(1-i)*(1-i)*i*t+3*(1-i)*i*i*n+i*i*i*r},Ct.bezierTangent=function(e,t,n,r,i){return 3*i*i*(-e+3*t-3*n+r)+6*i*(e-2*t+n)+3*(-e+t)},Ct.curvePoint=function(e,t,n,r,i){return.5*(2*t+(-e+n)*i+(2*e-5*t+4*n-r)*i*i+(-e+3*t-3*n+r)*i*i*i)},Ct.curveTangent=function(e,t,n,r,i){return.5*(-e+n+2*(2*e-5*t+4*n-r)*i+3*(-e+3*t-3*n+r)*i*i)},Ct.triangle=function(e,t,n,r,i,s){Ct.beginShape(9),Ct.vertex(e,t,0),Ct.vertex(n,r,0),Ct.vertex(i,s,0),Ct.endShape()},Ct.quad=function(e,t,n,r,i,s,o,u){Ct.beginShape(16),Ct.vertex(e,t,0),Ct.vertex(n,r,0),Ct.vertex(i,s,0),Ct.vertex(o,u,0),Ct.endShape()};var Ri=function(e,t,i,s,o,u,a,f){f===r&&(u=o,a=o,f=o);var l=i/2,c=s/2;(o>l||o>c)&&(o=n.min(l,c)),(u>l||u>c)&&(u=n.min(l,c)),(a>l||a>c)&&(a=n.min(l,c)),(f>l||f>c)&&(f=n.min(l,c)),(!ln||dn)&&kt.translate(.5,.5),kt.beginPath(),kt.moveTo(e+o,t),kt.lineTo(e+i-u,t),kt.quadraticCurveTo(e+i,t,e+i,t+u),kt.lineTo(e+i,t+s-a),kt.quadraticCurveTo(e+i,t+s,e+i-a,t+s),kt.lineTo(e+f,t+s),kt.quadraticCurveTo(e,t+s,e,t+s-f),kt.lineTo(e,t+o),kt.quadraticCurveTo(e,t,e+o,t),(!ln||dn)&&kt.translate(-0.5,-0.5),V(),$()};vi.prototype.rect=function(e,t,i,s,o,u,a,f){if(i||s){if(1===xn?(i-=e,s-=t):2===xn?(i*=2,s*=2,e-=i/2,t-=s/2):3===xn&&(e-=i/2,t-=s/2),e=n.round(e),t=n.round(t),i=n.round(i),s=n.round(s),o!==r)return Ri(e,t,i,s,o,u,a,f),void 0;dn&&1===yn%2&&kt.translate(.5,.5),kt.beginPath(),kt.rect(e,t,i,s),V(),$(),dn&&1===yn%2&&kt.translate(-0.5,-0.5)}},mi.prototype.rect=function(e,t,n,i,s){if(s!==r)throw"rect() with rounded corners is not supported in 3D mode";1===xn?(n-=e,i-=t):2===xn?(n*=2,i*=2,e-=n/2,t-=i/2):3===xn&&(e-=n/2,t-=i/2);var o=new ki;o.translate(e,t,0),o.scale(n,i,1),o.transpose();var u=new ki;if(u.scale(1,-1,1),u.apply(wr.array()),u.transpose(),yn>0&&dn&&(kt.useProgram(Ft),l("uModel2d",Ft,"uModel",!1,o.array()),l("uView2d",Ft,"uView",!1,u.array()),a("uColor2d",Ft,"uColor",vn),f("uIsDrawingText2d",Ft,"uIsDrawingText",!1),c("aVertex2d",Ft,"aVertex",3,zt),p("aTextureCoord2d",Ft,"aTextureCoord"),kt.drawArrays(kt.LINE_LOOP,0,ei.length/3)),ln){if(kt.useProgram(jt),l("uModel3d",jt,"uModel",!1,o.array()),l("uView3d",jt,"uView",!1,u.array()),kt.enable(kt.POLYGON_OFFSET_FILL),kt.polygonOffset(1,1),a("color3d",jt,"uColor",cn),Cr>0){var h=new ki;h.set(u);var d=new ki;d.set(o),h.mult(d);var v=new ki;v.set(h),v.invert(),v.transpose(),l("uNormalTransform3d",jt,"uNormalTransform",!1,v.array()),c("aNormal3d",jt,"aNormal",3,Wt)}else p("normal3d",jt,"aNormal");c("vertex3d",jt,"aVertex",3,zt),kt.drawArrays(kt.TRIANGLE_FAN,0,ei.length/3),kt.disable(kt.POLYGON_OFFSET_FILL)}},vi.prototype.ellipse=function(e,t,n,r){if(e=e||0,t=t||0,!(0>=n&&0>=r))if(2===Tn?(n*=2,r*=2):1===Tn?(n-=e,r-=t,e+=n/2,t+=r/2):0===Tn&&(e+=n/2,t+=r/2),n===r)kt.beginPath(),kt.arc(e,t,n/2,0,6.283185307179586,!1),V(),$();else{var i=n/2,s=r/2,o=.5522847498307933,u=o*i,a=o*s;Ct.beginShape(),Ct.vertex(e+i,t),Ct.bezierVertex(e+i,t-a,e+u,t-s,e,t-s),Ct.bezierVertex(e-u,t-s,e-i,t-a,e-i,t),Ct.bezierVertex(e-i,t+a,e-u,t+s,e,t+s),Ct.bezierVertex(e+u,t+s,e+i,t+a,e+i,t),Ct.endShape()}},mi.prototype.ellipse=function(e,t,n,r){if(e=e||0,t=t||0,!(0>=n&&0>=r)){2===Tn?(n*=2,r*=2):1===Tn?(n-=e,r-=t,e+=n/2,t+=r/2):0===Tn&&(e+=n/2,t+=r/2);var i=n/2,s=r/2,o=.5522847498307933,u=o*i,a=o*s;if(Ct.beginShape(),Ct.vertex(e+i,t),Ct.bezierVertex(e+i,t-a,0,e+u,t-s,0,e,t-s,0),Ct.bezierVertex(e-u,t-s,0,e-i,t-a,0,e-i,t,0),Ct.bezierVertex(e-i,t+a,0,e-u,t+s,0,e,t+s,0),Ct.bezierVertex(e+u,t+s,0,e+i,t+a,0,e+i,t,0),Ct.endShape(),ln){var f,l,c=0,h=0;for(f=0;f<zr.length;f++)c+=zr[f][0],h+=zr[f][1];c/=zr.length,h/=zr.length;var p=[],d=[],v=[];for(p[0]=c,p[1]=h,p[2]=0,p[3]=0,p[4]=0,p[5]=cn[0],p[6]=cn[1],p[7]=cn[2],p[8]=cn[3],p[9]=vn[0],p[10]=vn[1],p[11]=vn[2],p[12]=vn[3],p[13]=Nn,p[14]=Cn,p[15]=kn,zr.unshift(p),f=0;f<zr.length;f++){for(l=0;3>l;l++)d.push(zr[f][l]);for(l=5;9>l;l++)v.push(zr[f][l])}ji(d,"TRIANGLE_FAN",v)}}},Ct.normal=function(e,t,n){if(3!==arguments.length||"number"!=typeof e||"number"!=typeof t||"number"!=typeof n)throw"normal() requires three numeric arguments.";Nn=e,Cn=t,kn=n,0!==Dn&&(0===Ln?Ln=1:1===Ln&&(Ln=2))},Ct.save=function(t,n){return n!==r?e.open(n.toDataURL(),"_blank"):e.open(Ct.externals.canvas.toDataURL(),"_blank")};var Ui=0;Ct.saveFrame=function(e){e===r&&(e="screen-####.png");var t=e.replace(/#+/,function(e){for(var t=""+Ui++;t.length<e.length;)t="0"+t;return t});Ct.save(t)};var zi=t.createElement("canvas").getContext("2d"),Wi=[r,r,r],Xi=function(e,n,r){if(this.__isDirty=!1,e instanceof HTMLImageElement)this.fromHTMLImageData(e);else if(n||r){this.width=e||1,this.height=n||1;var i=this.sourceImg=t.createElement("canvas");if(i.width=this.width,i.height=this.height,this.imageData=i.getContext("2d").createImageData(this.width,this.height),this.format=2===r||4===r?r:1,1===this.format)for(var s=3,o=this.imageData.data,u=o.length;u>s;s+=4)o[s]=255;this.__isDirty=!0,this.updatePixels()}else this.width=0,this.height=0,this.imageData=zi.createImageData(1,1),this.format=2;this.pixels=Q(this)};Xi.prototype={__isPImage:!0,updatePixels:function(){var e=this.sourceImg;e&&e instanceof HTMLCanvasElement&&this.__isDirty&&e.getContext("2d").putImageData(this.imageData,0,0),this.__isDirty=!1},fromHTMLImageData:function(e){var t=K(e);try{var n=t.context.getImageData(0,0,e.width,e.height);this.fromImageData(n)}catch(r){e.width&&e.height&&(this.isRemote=!0,this.width=e.width,this.height=e.height)}this.sourceImg=e},get:function(e,t,n,r){return arguments.length?2===arguments.length?Ct.get(e,t,this):4===arguments.length?Ct.get(e,t,n,r,this):void 0:Ct.get(this)},set:function(e,t,n){Ct.set(e,t,n,this),this.__isDirty=!0},blend:function(e,t,n,r,i,s,o,u,a,f){9===arguments.length?Ct.blend(this,e,t,n,r,i,s,o,u,a,this):10===arguments.length&&Ct.blend(e,t,n,r,i,s,o,u,a,f,this),delete this.sourceImg},copy:function(e,t,n,r,i,s,o,u,a){8===arguments.length?Ct.blend(this,e,t,n,r,i,s,o,u,0,this):9===arguments.length&&Ct.blend(e,t,n,r,i,s,o,u,a,0,this),delete this.sourceImg},filter:function(e,t){2===arguments.length?Ct.filter(e,t,this):1===arguments.length&&Ct.filter(e,null,this),delete this.sourceImg},save:function(e){Ct.save(e,this)},resize:function(e,t){if(this.isRemote)throw"Image is loaded remotely. Cannot resize.";if(0!==this.width||0!==this.height){0===e&&0!==t?e=n.floor(this.width/this.height*t):0===t&&0!==e&&(t=n.floor(this.height/this.width*e));var r=K(this.imageData).canvas,i=K(r,e,t).context.getImageData(0,0,e,t);this.fromImageData(i)}},mask:function(e){var t,n,r=this.toImageData();if(e instanceof Xi||e.__isPImage){if(e.width!==this.width||e.height!==this.height)throw"mask must have the same dimensions as PImage.";for(e=e.toImageData(),t=2,n=4*this.width*this.height;n>t;t+=4)r.data[t+1]=e.data[t]}else if(e instanceof Array){if(this.width*this.height!==e.length)throw"mask array must be the same length as PImage pixels array.";for(t=0,n=e.length;n>t;++t)r.data[4*t+3]=e[t]}this.fromImageData(r)},loadPixels:m,toImageData:function(){if(this.isRemote)return this.sourceImg;if(!this.__isDirty)return this.imageData;var e=K(this.sourceImg);return e.context.getImageData(0,0,this.width,this.height)},toDataURL:function(){if(this.isRemote)throw"Image is loaded remotely. Cannot create dataURI.";var e=K(this.imageData);return e.canvas.toDataURL()},fromImageData:function(e){var n=e.width,r=e.height,i=t.createElement("canvas"),s=i.getContext("2d");this.width=i.width=n,this.height=i.height=r,s.putImageData(e,0,0),this.format=2,this.imageData=e,this.sourceImg=i}},Ct.PImage=Xi,Ct.createImage=function(e,t,n){return new Xi(e,t,n)},Ct.loadImage=function(e,n,r){n&&(e=e+"."+n);var i;if(Lt.imageCache.images[e])return i=new Xi(Lt.imageCache.images[e]),i.loaded=!0,i;i=new Xi;var s=t.createElement("img");return i.sourceImg=s,s.onload=function(e,t,n){var r=e,i=t,s=n;return function(){i.fromHTMLImageData(r),i.loaded=!0,s&&s()}}(s,i,r),s.src=e,i},Ct.requestImage=Ct.loadImage,Ct.get=function(e,t,n,r,i){return void 0!==i?tt(e,t,n,r,i):void 0!==r?et(e,t,n,r):void 0!==n?Z(e,t,n):void 0!==t?Y(e,t):void 0!==e?tt(0,0,e.width,e.height,e):et(0,0,Ct.width,Ct.height)},Ct.createGraphics=function(e,t,n){var r=new H;return r.size(e,t,n),r.background(0,0),r},Ct.set=function(e,t,n,r){3===arguments.length?"number"==typeof n?st(e,t,n):(n instanceof Xi||n.__isPImage)&&Ct.image(n,e,t):4===arguments.length&&ot(e,t,n,r)},Ct.imageData={},Ct.pixels={getLength:function(){return Ct.imageData.data.length?Ct.imageData.data.length/4:0},getPixel:function(e){var t=4*e,n=Ct.imageData.data;return 4278190080&n[t+3]<<24|16711680&n[t+0]<<16|65280&n[t+1]<<8|255&n[t+2]},setPixel:function(e,t){var n=4*e,r=Ct.imageData.data;r[n+0]=(16711680&t)>>>16,r[n+1]=(65280&t)>>>8,r[n+2]=255&t,r[n+3]=(4278190080&t)>>>24},toArray:function(){for(var e=[],t=Ct.imageData.width*Ct.imageData.height,n=Ct.imageData.data,r=0,i=0;t>r;r++,i+=4)e.push(4278190080&n[i+3]<<24|16711680&n[i+0]<<16|65280&n[i+1]<<8|255&n[i+2]);return e},set:function(e){for(var t=0,n=e.length;n>t;t++)this.setPixel(t,e[t])}},Ct.loadPixels=function(){Ct.imageData=At.$ensureContext().getImageData(0,0,Ct.width,Ct.height)},Ct.updatePixels=function(){Ct.imageData&&At.$ensureContext().putImageData(Ct.imageData,0,0)},Ct.hint=function(e){var t=At.$ensureContext();4===e?(t.disable(t.DEPTH_TEST),t.depthMask(!1),t.clear(t.DEPTH_BUFFER_BIT)):-4===e?(t.enable(t.DEPTH_TEST),t.depthMask(!0)):-1===e||2===e?wn=!0:1===e&&(wn=!1)};var Vi=function(e,t,n,r){var i;if(e instanceof Xi||e.__isPImage){if(i=e,!i.loaded)throw"Error using image in background(): PImage not loaded.";if(i.width!==Ct.width||i.height!==Ct.height)throw"Background image must be the same dimensions as the canvas."}else i=Ct.color(e,t,n,r);Fn=i};vi.prototype.background=function(e,t,n,i){e!==r&&Vi(e,t,n,i),Fn instanceof Xi||Fn.__isPImage?(N(),kt.setTransform(1,0,0,1,0,0),Ct.image(Fn,0,0),C()):(N(),kt.setTransform(1,0,0,1,0,0),Ct.alpha(Fn)!==qn&&kt.clearRect(0,0,Ct.width,Ct.height),kt.fillStyle=Ct.color.toString(Fn),kt.fillRect(0,0,Ct.width,Ct.height),pn=!0,C())},mi.prototype.background=function(e,t,n,r){arguments.length>0&&Vi(e,t,n,r);var i=Ct.color.toGLArray(Fn);kt.clearColor(i[0],i[1],i[2],i[3]),kt.clear(kt.COLOR_BUFFER_BIT|kt.DEPTH_BUFFER_BIT)},vi.prototype.image=function(e,t,r,i,s){if(t=n.round(t),r=n.round(r),e.width>0){i||e.width,s||e.height;var o=ci(t||0,r||0,i||e.width,s||e.height,arguments.length<4),u=!!e.sourceImg&&null===$n;if(u){var a=e.sourceImg;e.__isDirty&&e.updatePixels(),kt.drawImage(a,0,0,a.width,a.height,o.x,o.y,o.w,o.h)}else{var f=e.toImageData();null!==$n&&($n(f),e.__isDirty=!0),kt.drawImage(K(f).canvas,0,0,e.width,e.height,o.x,o.y,o.w,o.h)}}},mi.prototype.image=function(e,t,r,i,s){e.width>0&&(t=n.round(t),r=n.round(r),i=i||e.width,s=s||e.height,Ct.beginShape(Ct.QUADS),Ct.texture(e),Ct.vertex(t,r,0,0,0),Ct.vertex(t,r+s,0,0,s),Ct.vertex(t+i,r+s,0,i,s),Ct.vertex(t+i,r,0,i,0),Ct.endShape())},Ct.tint=function(e,t,n,r){var i=Ct.color(e,t,n,r),s=Ct.red(i)/Rn,o=Ct.green(i)/Un,u=Ct.blue(i)/zn,a=Ct.alpha(i)/qn;$n=function(e){for(var t=e.data,n=4*e.width*e.height,r=0;n>r;)t[r++]*=s,t[r++]*=o,t[r++]*=u,t[r++]*=a},Jn=function(e){for(var t=0;t<e.length;)e[t++]=s,e[t++]=o,e[t++]=u,e[t++]=a}},Ct.noTint=function(){$n=null,Jn=null},Ct.copy=function(e,t,n,i,s,o,u,a,f){f===r&&(f=a,a=u,u=o,o=s,s=i,i=n,n=t,t=e,e=Ct),Ct.blend(e,t,n,i,s,o,u,a,f,0)},Ct.blend=function(e,t,n,i,s,o,u,a,f,l,c){if(e.isRemote)throw"Image is loaded remotely. Cannot blend image.";l===r&&(l=f,f=a,a=u,u=o,o=s,s=i,i=n,n=t,t=e,e=Ct);var h=t+i,p=n+s,d=o+a,v=u+f,m=c||Ct;(c===r||l===r)&&Ct.loadPixels(),e.loadPixels(),e===Ct&&Ct.intersect(t,n,h,p,o,u,d,v)?Ct.blit_resize(Ct.get(t,n,h-t,p-n),0,0,h-t-1,p-n-1,m.imageData.data,m.width,m.height,o,u,d,v,l):Ct.blit_resize(e,t,n,h,p,m.imageData.data,m.width,m.height,o,u,d,v,l),c===r&&Ct.updatePixels()};var $i=function(e){var t,n,r=Ct.floor(3.5*e);if(r=1>r?1:248>r?r:248,Ct.shared.blurRadius!==r){Ct.shared.blurRadius=r,Ct.shared.blurKernelSize=1+(Ct.shared.blurRadius<<1),Ct.shared.blurKernel=new w(Ct.shared.blurKernelSize);var i=Ct.shared.blurKernel,s=Ct.shared.blurKernelSize;for(Ct.shared.blurRadius,t=0;s>t;t++)i[t]=0;var o=(r-1)*(r-1);for(t=1;r>t;t++)i[r+t]=i[n]=o;i[r]=r*r}},Ji=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g=t.pixels.getLength(),y=new w(g),b=new w(g),E=new w(g),S=new w(g),x=0;$i(e);var T=t.height,N=t.width,C=Ct.shared.blurKernelSize,k=Ct.shared.blurRadius,L=Ct.shared.blurKernel,A=t.imageData.data;for(d=0;T>d;d++){for(p=0;N>p;p++){if(s=i=r=o=n=0,a=p-k,0>a)h=-a,a=0;else{if(a>=N)break;h=0}for(v=h;C>v&&!(a>=N);v++)m=4*(a+x),u=L[v],o+=u*A[m+3],r+=u*A[m],i+=u*A[m+1],s+=u*A[m+2],n+=u,a++;f=x+p,S[f]=o/n,y[f]=r/n,b[f]=i/n,E[f]=s/n}x+=N}for(x=0,l=-k,c=l*N,d=0;T>d;d++){for(p=0;N>p;p++){if(s=i=r=o=n=0,0>l)h=f=-l,a=p;else{if(l>=T)break;h=0,f=l,a=p+c}for(v=h;C>v&&!(f>=T);v++)u=L[v],o+=u*S[a],r+=u*y[a],i+=u*b[a],s+=u*E[a],n+=u,f++,a+=N;m=4*(p+x),A[m]=r/n,A[m+1]=i/n,A[m+2]=s/n,A[m+3]=o/n}x+=N,c+=N,l++}},Ki=function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=0,w=t.pixels.getLength(),S=new E(w);if(e)for(;w>b;)for(n=b,r=b+t.width;r>b;)i=s=t.pixels.getPixel(b),a=b-1,u=b+1,f=b-t.width,l=b+t.width,n>a&&(a=b),u>=r&&(u=b),0>f&&(f=0),l>=w&&(l=b),p=t.pixels.getPixel(f),h=t.pixels.getPixel(a),d=t.pixels.getPixel(l),c=t.pixels.getPixel(u),o=77*(255&i>>16)+151*(255&i>>8)+28*(255&i),m=77*(255&h>>16)+151*(255&h>>8)+28*(255&h),v=77*(255&c>>16)+151*(255&c>>8)+28*(255&c),g=77*(255&p>>16)+151*(255&p>>8)+28*(255&p),y=77*(255&d>>16)+151*(255&d>>8)+28*(255&d),o>m&&(s=h,o=m),o>v&&(s=c,o=v),o>g&&(s=p,o=g),o>y&&(s=d,o=y),S[b++]=s;else for(;w>b;)for(n=b,r=b+t.width;r>b;)i=s=t.pixels.getPixel(b),a=b-1,u=b+1,f=b-t.width,l=b+t.width,n>a&&(a=b),u>=r&&(u=b),0>f&&(f=0),l>=w&&(l=b),p=t.pixels.getPixel(f),h=t.pixels.getPixel(a),d=t.pixels.getPixel(l),c=t.pixels.getPixel(u),o=77*(255&i>>16)+151*(255&i>>8)+28*(255&i),m=77*(255&h>>16)+151*(255&h>>8)+28*(255&h),v=77*(255&c>>16)+151*(255&c>>8)+28*(255&c),g=77*(255&p>>16)+151*(255&p>>8)+28*(255&p),y=77*(255&d>>16)+151*(255&d>>8)+28*(255&d),m>o&&(s=h,o=m),v>o&&(s=c,o=v),g>o&&(s=p,o=g),y>o&&(s=d,o=y),S[b++]=s;t.pixels.set(S)};Ct.filter=function(e,t,n){var i,s,o,u;if(3===arguments.length?(n.loadPixels(),i=n):(Ct.loadPixels(),i=Ct),t===r&&(t=null),i.isRemote)throw"Image is loaded remotely. Cannot filter image.";var a=i.pixels.getLength();switch(e){case 11:var f=t||1;Ji(f,i);break;case 12:if(4===i.format){for(u=0;a>u;u++)s=255-i.pixels.getPixel(u),i.pixels.setPixel(u,4278190080|s<<16|s<<8|s);i.format=1}else for(u=0;a>u;u++)s=i.pixels.getPixel(u),o=77*(255&s>>16)+151*(255&s>>8)+28*(255&s)>>8,i.pixels.setPixel(u,4278190080&s|o<<16|o<<8|o);break;case 13:for(u=0;a>u;u++)i.pixels.setPixel(u,16777215^i.pixels.getPixel(u));break;case 15:if(null===t)throw"Use filter(POSTERIZE, int levels) instead of filter(POSTERIZE)";var l=Ct.floor(t);if(2>l||l>255)throw"Levels must be between 2 and 255 for filter(POSTERIZE, levels)";var c=l-1;for(u=0;a>u;u++){var h=255&i.pixels.getPixel(u)>>16,p=255&i.pixels.getPixel(u)>>8,d=255&i.pixels.getPixel(u);h=255*(h*l>>8)/c,p=255*(p*l>>8)/c,d=255*(d*l>>8)/c,i.pixels.setPixel(u,4278190080&i.pixels.getPixel(u)|h<<16|p<<8|d)}break;case 14:for(u=0;a>u;u++)i.pixels.setPixel(u,4278190080|i.pixels.getPixel(u));i.format=1;break;case 16:if(null===t&&(t=.5),0>t||t>1)throw"Level must be between 0 and 1 for filter(THRESHOLD, level)";var v=Ct.floor(255*t);for(u=0;a>u;u++){var m=Ct.max((16711680&i.pixels.getPixel(u))>>16,Ct.max((65280&i.pixels.getPixel(u))>>8,255&i.pixels.getPixel(u)));i.pixels.setPixel(u,4278190080&i.pixels.getPixel(u)|(v>m?0:16777215))}break;case 17:Ki(!0,i);break;case 18:Ki(!1,i)}i.updatePixels()},Ct.shared={fracU:0,ifU:0,fracV:0,ifV:0,u1:0,u2:0,v1:0,v2:0,sX:0,sY:0,iw:0,iw1:0,ih1:0,ul:0,ll:0,ur:0,lr:0,cUL:0,cLL:0,cUR:0,cLR:0,srcXOffset:0,srcYOffset:0,r:0,g:0,b:0,a:0,srcBuffer:null,blurRadius:0,blurKernelSize:0,blurKernel:null},Ct.intersect=function(e,t,n,r,i,s,o,u){var a=n-e+1,f=r-t+1,l=o-i+1,c=u-s+1;if(e>i)l+=i-e,l>a&&(l=a);else{var h=a+e-i;l>h&&(l=h)}if(t>s)c+=s-t,c>f&&(c=f);else{var p=f+t-s;c>p&&(c=p)}return!(0>=l||0>=c)};var Qi={};Qi[1]=Ct.modes.blend,Qi[2]=Ct.modes.add,Qi[4]=Ct.modes.subtract,Qi[8]=Ct.modes.lightest,Qi[16]=Ct.modes.darkest,Qi[0]=Ct.modes.replace,Qi[32]=Ct.modes.difference,Qi[64]=Ct.modes.exclusion,Qi[128]=Ct.modes.multiply,Qi[256]=Ct.modes.screen,Qi[512]=Ct.modes.overlay,Qi[1024]=Ct.modes.hard_light,Qi[2048]=Ct.modes.soft_light,Qi[4096]=Ct.modes.dodge,Qi[8192]=Ct.modes.burn,Ct.blit_resize=function(e,t,r,i,s,o,u,a,f,l,c,h,p){var d,v;0>t&&(t=0),0>r&&(r=0),i>=e.width&&(i=e.width-1),s>=e.height&&(s=e.height-1);var m=i-t,g=s-r,y=c-f,b=h-l;if(!(0>=y||0>=b||0>=m||0>=g||f>=u||l>=a||t>=e.width||r>=e.height)){var w=n.floor(32768*(m/y)),E=n.floor(32768*(g/b)),S=Ct.shared;S.srcXOffset=n.floor(0>f?-f*w:32768*t),S.srcYOffset=n.floor(0>l?-l*E:32768*r),0>f&&(y+=f,f=0),0>l&&(b+=l,l=0),y=n.min(y,u-f),b=n.min(b,a-l);var x,T=l*u+f;S.srcBuffer=e.imageData.data,S.iw=e.width,S.iw1=e.width-1,S.ih1=e.height-1;var N,C,k,L,A,O,M=(Ct.filter_bilinear,Ct.filter_new_scanline,Qi[p]),_=4278190080,D=16711680,P=65280,H=255,B=32767,j=15,F=1,I=9,q=S.srcBuffer,R=n.min;for(v=0;b>v;v++){for(S.sX=S.srcXOffset,S.fracV=S.srcYOffset&B,S.ifV=B-S.fracV,S.v1=(S.srcYOffset>>j)*S.iw,S.v2=R((S.srcYOffset>>j)+1,S.ih1)*S.iw,d=0;y>d;d++)C=4*(T+d),x=o[C+3]<<24&_|o[C]<<16&D|o[C+1]<<8&P|o[C+2]&H,S.fracU=S.sX&B,S.ifU=B-S.fracU,S.ul=S.ifU*S.ifV>>j,S.ll=S.ifU*S.fracV>>j,S.ur=S.fracU*S.ifV>>j,S.lr=S.fracU*S.fracV>>j,S.u1=S.sX>>j,S.u2=R(S.u1+1,S.iw1),k=4*(S.v1+S.u1),L=4*(S.v1+S.u2),A=4*(S.v2+S.u1),O=4*(S.v2+S.u2),S.cUL=q[k+3]<<24&_|q[k]<<16&D|q[k+1]<<8&P|q[k+2]&H,S.cUR=q[L+3]<<24&_|q[L]<<16&D|q[L+1]<<8&P|q[L+2]&H,S.cLL=q[A+3]<<24&_|q[A]<<16&D|q[A+1]<<8&P|q[A+2]&H,S.cLR=q[O+3]<<24&_|q[O]<<16&D|q[O+1]<<8&P|q[O+2]&H,S.r=S.ul*((S.cUL&D)>>16)+S.ll*((S.cLL&D)>>16)+S.ur*((S.cUR&D)>>16)+S.lr*((S.cLR&D)>>16)<<F&D,S.g=S.ul*(S.cUL&P)+S.ll*(S.cLL&P)+S.ur*(S.cUR&P)+S.lr*(S.cLR&P)>>>j&P,S.b=S.ul*(S.cUL&H)+S.ll*(S.cLL&H)+S.ur*(S.cUR&H)+S.lr*(S.cLR&H)>>>j,S.a=S.ul*((S.cUL&_)>>>24)+S.ll*((S.cLL&_)>>>24)+S.ur*((S.cUR&_)>>>24)+S.lr*((S.cLR&_)>>>24)<<I&_,N=M(x,S.a|S.r|S.g|S.b),o[C]=(N&D)>>>16,o[C+1]=(N&P)>>>8,o[C+2]=N&H,o[C+3]=(N&_)>>>24,S.sX+=w;T+=u,S.srcYOffset+=E}}},Ct.loadFont=function(e,t){if(e===r)throw"font name required in loadFont.";if(-1===e.indexOf(".svg"))return t===r&&(t=lr.size),h.get(e,t);var n=Ct.loadGlyphs(e);return{name:e,css:"12px sans-serif",glyph:!0,units_per_em:n.units_per_em,horiz_adv_x:1/n.units_per_em*n.horiz_adv_x,ascent:n.ascent,descent:n.descent,width:function(t){for(var n=0,r=t.length,i=0;r>i;i++)try{n+=parseFloat(Ct.glyphLook(Ct.glyphTable[e],t[i]).horiz_adv_x)}catch(s){H.debug(s)}return n/Ct.glyphTable[e].units_per_em}}},Ct.createFont=function(e,t){return Ct.loadFont(e,t)},Ct.textFont=function(e,t){t!==r&&(e.glyph||(e=h.get(e.name,t)),or=t),lr=e,sr=lr.name,ur=lr.ascent,ar=lr.descent,fr=lr.leading;var n=At.$ensureContext();n.font=lr.css},Ct.textSize=function(e){lr=h.get(sr,e),or=e,ur=lr.ascent,ar=lr.descent,fr=lr.leading;var t=At.$ensureContext();t.font=lr.css},Ct.textAscent=function(){return ur},Ct.textDescent=function(){return ar},Ct.textLeading=function(e){fr=e},Ct.textAlign=function(e,t){nr=e,rr=t||0},vi.prototype.textWidth=function(e){var t,r=ut(e).split(/\r?\n/g),i=0,s=r.length;for(kt.font=lr.css,t=0;s>t;++t)i=n.max(i,lr.measureTextWidth(r[t]));return 0|i},mi.prototype.textWidth=function(e){var i,s=ut(e).split(/\r?\n/g),o=0,u=s.length;Ot===r&&(Ot=t.createElement("canvas"));var a=Ot.getContext("2d");for(a.font=lr.css,i=0;u>i;++i)o=n.max(o,a.measureText(s[i]).width);return 0|o},Ct.glyphLook=function(e,t){try{switch(t){case"1":return e.one;case"2":return e.two;case"3":return e.three;case"4":return e.four;case"5":return e.five;case"6":return e.six;case"7":return e.seven;case"8":return e.eight;case"9":return e.nine;case"0":return e.zero;case" ":return e.space;case"$":return e.dollar;case"!":return e.exclam;case'"':return e.quotedbl;case"#":return e.numbersign;case"%":return e.percent;case"&":return e.ampersand;case"'":return e.quotesingle;case"(":return e.parenleft;case")":return e.parenright;case"*":return e.asterisk;case"+":return e.plus;case",":return e.comma;case"-":return e.hyphen;case".":return e.period;case"/":return e.slash;case"_":return e.underscore;case":":return e.colon;case";":return e.semicolon;case"<":return e.less;case"=":return e.equal;case">":return e.greater;case"?":return e.question;case"@":return e.at;case"[":return e.bracketleft;case"\\":return e.backslash;case"]":return e.bracketright;case"^":return e.asciicircum;case"`":return e.grave;case"{":return e.braceleft;case"|":return e.bar;case"}":return e.braceright;case"~":return e.asciitilde;default:return e[t]}}catch(n){H.debug(n)}},vi.prototype.text$line=function(e,t,n,r,i){var s=0,o=0;if(lr.glyph){var u=Ct.glyphTable[sr];N(),kt.translate(t,n+or),(39===i||3===i)&&(s=u.width(e),o=39===i?-s:-s/2);var a=u.units_per_em,f=1/a*or;kt.scale(f,f);for(var l=0,c=e.length;c>l;l++)try{Ct.glyphLook(u,e[l]).draw()}catch(h){H.debug(h)}C()}else e&&"fillText"in kt&&(pn&&(kt.fillStyle=Ct.color.toString(hn),pn=!1),(39===i||3===i)&&(s=lr.measureTextWidth(e),o=39===i?-s:-s/2),kt.fillText(e,t+o,n))},mi.prototype.text$line=function(e,n,i,s,o){Ot===r&&(Ot=t.createElement("canvas"));var u=kt;kt=Ot.getContext("2d"),kt.font=lr.css;var h=lr.measureTextWidth(e);Ot.width=h,Ot.height=or,kt=Ot.getContext("2d"),kt.font=lr.css,kt.textBaseline="top",vi.prototype.text$line(e,0,0,0,37);var p=Ot.width/Ot.height;kt=u,kt.bindTexture(kt.TEXTURE_2D,Zt),kt.texImage2D(kt.TEXTURE_2D,0,kt.RGBA,kt.RGBA,kt.UNSIGNED_BYTE,Ot),kt.texParameteri(kt.TEXTURE_2D,kt.TEXTURE_MAG_FILTER,kt.LINEAR),kt.texParameteri(kt.TEXTURE_2D,kt.TEXTURE_MIN_FILTER,kt.LINEAR),kt.texParameteri(kt.TEXTURE_2D,kt.TEXTURE_WRAP_T,kt.CLAMP_TO_EDGE),kt.texParameteri(kt.TEXTURE_2D,kt.TEXTURE_WRAP_S,kt.CLAMP_TO_EDGE);var d=0;39===o?d=-h:3===o&&(d=-h/2);var v=new ki,m=.5*or;v.translate(n+d-m/2,i-m,s),v.scale(-p*m,-m,m),v.translate(-1,-1,-1),v.transpose();var g=new ki;g.scale(1,-1,1),g.apply(wr.array()),g.transpose(),kt.useProgram(Ft),c("aVertex2d",Ft,"aVertex",3,en),c("aTextureCoord2d",Ft,"aTextureCoord",2,tn),f("uSampler2d",Ft,"uSampler",[0]),f("uIsDrawingText2d",Ft,"uIsDrawingText",!0),l("uModel2d",Ft,"uModel",!1,v.array()),l("uView2d",Ft,"uView",!1,g.array()),a("uColor2d",Ft,"uColor",cn),kt.bindBuffer(kt.ELEMENT_ARRAY_BUFFER,nn),kt.drawElements(kt.TRIANGLES,6,kt.UNSIGNED_SHORT,0)},Ct.text=function(){5!==ir&&(3===arguments.length?at(ut(arguments[0]),arguments[1],arguments[2],0):4===arguments.length?at(ut(arguments[0]),arguments[1],arguments[2],arguments[3]):5===arguments.length?ft(ut(arguments[0]),arguments[1],arguments[2],arguments[3],arguments[4],0):6===arguments.length&&ft(ut(arguments[0]),arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]))},Ct.textMode=function(e){ir=e},Ct.loadGlyphs=function(i){var s,o,u,a,f,l,c,h,p,d,v,m,g="[0-9\\-]+",y=function(e,t){var n,r=0,i=[],s=new RegExp(e,"g");for(n=i[r]=s.exec(t);n;)r++,n=i[r]=s.exec(t);return i},b=function(e){var t=y("[A-Za-z][0-9\\- ]+|Z",e),r=function(){return N(),At.$ensureContext()},i=function(){V(),$(),C()};m="return {draw:function(){var curContext=beforePathDraw();curContext.beginPath();",s=0,o=0,u=0,a=0,f=0,l=0,e=0,h=0,p="",d=t.length-1;for(var c=0;d>c;c++){var b=t[c][0],w=y(g,b);switch(b[0]){case"M":s=parseFloat(w[0][0]),o=parseFloat(w[1][0]),m+="curContext.moveTo("+s+","+ -o+");";break;case"L":s=parseFloat(w[0][0]),o=parseFloat(w[1][0]),m+="curContext.lineTo("+s+","+ -o+");";break;case"H":s=parseFloat(w[0][0]),m+="curContext.lineTo("+s+","+ -o+");";break;case"V":o=parseFloat(w[0][0]),m+="curContext.lineTo("+s+","+ -o+");";break;case"T":f=parseFloat(w[0][0]),l=parseFloat(w[1][0]),"Q"===p||"T"===p?(e=n.sqrt(n.pow(s-u,2)+n.pow(a-o,2)),h=n.PI+n.atan2(u-s,a-o),u=s+n.sin(h)*e,a=o+n.cos(h)*e):(u=s,a=o),m+="curContext.quadraticCurveTo("+u+","+ -a+","+f+","+ -l+");",s=f,o=l;break;case"Q":u=parseFloat(w[0][0]),a=parseFloat(w[1][0]),f=parseFloat(w[2][0]),l=parseFloat(w[3][0]),m+="curContext.quadraticCurveTo("+u+","+ -a+","+f+","+ -l+");",s=f,o=l;break;case"Z":m+="curContext.closePath();"}p=b[0]}return m+="afterPathDraw();",m+="curContext.translate("+v+",0);",m+="}}",(new Function("beforePathDraw","afterPathDraw",m))(r,i)},w=function(e){var t=e.getElementsByTagName("font");Ct.glyphTable[i].horiz_adv_x=t[0].getAttribute("horiz-adv-x");var n=e.getElementsByTagName("font-face")[0];Ct.glyphTable[i].units_per_em=parseFloat(n.getAttribute("units-per-em")),Ct.glyphTable[i].ascent=parseFloat(n.getAttribute("ascent")),Ct.glyphTable[i].descent=parseFloat(n.getAttribute("descent"));for(var s=e.getElementsByTagName("glyph"),o=s.length,u=0;o>u;u++){var a=s[u].getAttribute("unicode"),f=s[u].getAttribute("glyph-name");v=s[u].getAttribute("horiz-adv-x"),null===v&&(v=Ct.glyphTable[i].horiz_adv_x),c=s[u].getAttribute("d"),c!==r&&(m=b(c),Ct.glyphTable[i][f]={name:f,unicode:a,horiz_adv_x:v,draw:m.draw})}},E=function(){var n;try{n=t.implementation.createDocument("","",null)}catch(r){return H.debug(r.message),void 0}try{n.async=!1,n.load(i),w(n.getElementsByTagName("svg")[0])}catch(s){H.debug(s);try{var o=new e.XMLHttpRequest;o.open("GET",i,!1),o.send(null),w(o.responseXML.documentElement)}catch(u){H.debug(s)}}};return Ct.glyphTable[i]={},E(i),Ct.glyphTable[i]},Ct.param=function(e){var t="data-processing-"+e;if(Tt.hasAttribute(t))return Tt.getAttribute(t);for(var n=0,r=Tt.childNodes.length;r>n;++n){var i=Tt.childNodes.item(n);if(1===i.nodeType&&"param"===i.tagName.toLowerCase()&&i.getAttribute("name")===e)return i.getAttribute("value")}return Lt.params.hasOwnProperty(e)?Lt.params[e]:null},gi.prototype.translate=ct("translate"),gi.prototype.transform=ct("transform"),gi.prototype.scale=ct("scale"),gi.prototype.pushMatrix=ct("pushMatrix"),gi.prototype.popMatrix=ct("popMatrix"),gi.prototype.resetMatrix=ct("resetMatrix"),gi.prototype.applyMatrix=ct("applyMatrix"),gi.prototype.rotate=ct("rotate"),gi.prototype.rotateZ=ct("rotateZ"),gi.prototype.shearX=ct("shearX"),gi.prototype.shearY=ct("shearY"),gi.prototype.redraw=ct("redraw"),gi.prototype.toImageData=ct("toImageData"),gi.prototype.ambientLight=ct("ambientLight"),gi.prototype.directionalLight=ct("directionalLight"),gi.prototype.lightFalloff=ct("lightFalloff"),gi.prototype.lightSpecular=ct("lightSpecular"),gi.prototype.pointLight=ct("pointLight"),gi.prototype.noLights=ct("noLights"),gi.prototype.spotLight=ct("spotLight"),gi.prototype.beginCamera=ct("beginCamera"),gi.prototype.endCamera=ct("endCamera"),gi.prototype.frustum=ct("frustum"),gi.prototype.box=ct("box"),gi.prototype.sphere=ct("sphere"),gi.prototype.ambient=ct("ambient"),gi.prototype.emissive=ct("emissive"),gi.prototype.shininess=ct("shininess"),gi.prototype.specular=ct("specular"),gi.prototype.fill=ct("fill"),gi.prototype.stroke=ct("stroke"),gi.prototype.strokeWeight=ct("strokeWeight"),gi.prototype.smooth=ct("smooth"),gi.prototype.noSmooth=ct("noSmooth"),gi.prototype.point=ct("point"),gi.prototype.vertex=ct("vertex"),gi.prototype.endShape=ct("endShape"),gi.prototype.bezierVertex=ct("bezierVertex"),gi.prototype.curveVertex=ct("curveVertex"),gi.prototype.curve=ct("curve"),gi.prototype.line=ct("line"),gi.prototype.bezier=ct("bezier"),gi.prototype.rect=ct("rect"),gi.prototype.ellipse=ct("ellipse"),gi.prototype.background=ct("background"),gi.prototype.image=ct("image"),gi.prototype.textWidth=ct("textWidth"),gi.prototype.text$line=ct("text$line"),gi.prototype.$ensureContext=ct("$ensureContext"),gi.prototype.$newPMatrix=ct("$newPMatrix"),gi.prototype.size=function(e,t,n){lt(2===n?"3D":"2D"),Ct.size(e,t,n)},gi.prototype.$init=m,vi.prototype.$init=function(){Ct.size(Ct.width,Ct.height),kt.lineCap="round",Ct.noSmooth(),Ct.disableContextMenu()},mi.prototype.$init=function(){Ct.use3DContext=!0,Ct.disableContextMenu()},di.prototype.$ensureContext=function(){return kt},M(Tt,"touchstart",function(e){Tt.setAttribute("style","-webkit-user-select: none"),Tt.setAttribute("onclick","void(0)"),Tt.setAttribute("style","-webkit-tap-highlight-color:rgba(0,0,0,0)");for(var t=0,n=Ai.length;n>t;t++){var i=Ai[t].type;("mouseout"===i||"mousemove"===i||"mousedown"===i||"mouseup"===i||"DOMMouseScroll"===i||"mousewheel"===i||"touchstart"===i)&&_(Ai[t])}Ct.touchStart!==r||Ct.touchMove!==r||Ct.touchEnd!==r||Ct.touchCancel!==r?(M(Tt,"touchstart",function(e){Ct.touchStart!==r&&(e=dt(e),Ct.touchStart(e))}),M(Tt,"touchmove",function(e){Ct.touchMove!==r&&(e.preventDefault(),e=dt(e),Ct.touchMove(e))}),M(Tt,"touchend",function(e){Ct.touchEnd!==r&&(e=dt(e),Ct.touchEnd(e))}),M(Tt,"touchcancel",function(e){Ct.touchCancel!==r&&(e=dt(e),Ct.touchCancel(e))})):(M(Tt,"touchstart",function(e){pt(Tt,e.touches[0]),Ct.__mousePressed=!0,Ct.mouseDragging=!1,Ct.mouseButton=37,"function"==typeof Ct.mousePressed&&Ct.mousePressed()}),M(Tt,"touchmove",function(e){e.preventDefault(),pt(Tt,e.touches[0]),"function"!=typeof Ct.mouseMoved||Ct.__mousePressed||Ct.mouseMoved(),"function"==typeof Ct.mouseDragged&&Ct.__mousePressed&&(Ct.mouseDragged(),Ct.mouseDragging=!0)}),M(Tt,"touchend",function(){Ct.__mousePressed=!1,"function"!=typeof Ct.mouseClicked||Ct.mouseDragging||Ct.mouseClicked(),"function"==typeof Ct.mouseReleased&&Ct.mouseReleased()})),Tt.dispatchEvent(e)}),function(){var e=!0,t=function(e){e.preventDefault(),e.stopPropagation()};Ct.disableContextMenu=function(){e&&(M(Tt,"contextmenu",t),e=!1)},Ct.enableContextMenu=function(){e||(_({elem:Tt,type:"contextmenu",fn:t}),e=!0)}}(),M(Tt,"mousemove",function(e){pt(Tt,e),"function"!=typeof Ct.mouseMoved||Ct.__mousePressed||Ct.mouseMoved(),"function"==typeof Ct.mouseDragged&&Ct.__mousePressed&&(Ct.mouseDragged(),Ct.mouseDragging=!0)}),M(Tt,"mouseout",function(){"function"==typeof Ct.mouseOut&&Ct.mouseOut()}),M(Tt,"mouseover",function(e){pt(Tt,e),"function"==typeof Ct.mouseOver&&Ct.mouseOver()}),Tt.onmousedown=function(){return Tt.focus(),!1},M(Tt,"mousedown",function(e){switch(Ct.__mousePressed=!0,Ct.mouseDragging=!1,e.which){case 1:Ct.mouseButton=37;break;case 2:Ct.mouseButton=3;break;case 3:Ct.mouseButton=39}"function"==typeof Ct.mousePressed&&Ct.mousePressed()}),M(Tt,"mouseup",function(){Ct.__mousePressed=!1,"function"!=typeof Ct.mouseClicked||Ct.mouseDragging||Ct.mouseClicked(),"function"==typeof Ct.mouseReleased&&Ct.mouseReleased()});var Gi=function(t){var n=0;t.wheelDelta?(n=t.wheelDelta/120,e.opera&&(n=-n)):t.detail&&(n=-t.detail/3),Ct.mouseScroll=n,n&&"function"==typeof Ct.mouseScrolled&&Ct.mouseScrolled()};if(M(t,"DOMMouseScroll",Gi),M(t,"mousewheel",Gi),Tt.getAttribute("tabindex")||Tt.setAttribute("tabindex",0),Nt)Lt=new H.Sketch,lt(),Ct.size=function(e,t,n){n&&2===n?lt("3D"):lt("2D"),Ct.size(e,t,n)};else{Lt=o instanceof H.Sketch?o:"function"==typeof o?new H.Sketch(o):o?H.compile(o):new H.Sketch(function(){}),Ct.externals.sketch=Lt,lt(),Tt.onfocus=function(){Ct.focused=!0},Tt.onblur=function(){Ct.focused=!1,Lt.options.globalKeyEvents||bt()},Lt.options.pauseOnBlur&&(M(e,"focus",function(){En&&Ct.loop()}),M(e,"blur",function(){En&&bn&&(Ct.noLoop(),En=!0),bt()}));var Yi=Lt.options.globalKeyEvents?e:Tt;M(Yi,"keydown",Et),M(Yi,"keypress",St),M(Yi,"keyup",xt);for(var Zi in H.lib)H.lib.hasOwnProperty(Zi)&&(H.lib[Zi].hasOwnProperty("attach")?H.lib[Zi].attach(Ct):H.lib[Zi]instanceof Function&&H.lib[Zi].call(this));var es=100,ts=function(n){if(Lt.imageCache.pending||h.preloading.pending(es))e.setTimeout(function(){ts(n)},es);else{if(e.opera){var r,i,s=Lt.imageCache.operaCache;for(r in s)s.hasOwnProperty(r)&&(i=s[r],null!==i&&t.body.removeChild(i),delete s[r])}Lt.attach(n,A),Lt.onLoad(n),n.setup&&(n.setup(),n.resetMatrix(),Lt.onSetup()),nt(),n.draw&&(En?n.loop():n.redraw())}};P(this),ts(Ct)}};H.debug=g,H.prototype=A,H.compile=function(e){var t=new H.Sketch,n=v(e,t),r=d(n);return t.sourceCode=r,t};var B=function(){var e={},n="undefined",r="function",i=!1,s=!0,o=512,u="log";return typeof tinylog!==n&&typeof tinylog[u]===r?e[u]=tinylog[u]:typeof t===n||t.fake?typeof print===r&&(e[u]=print):function(){var n=t,r="div",a="style",f="title",l={zIndex:1e4,position:"fixed",bottom:"0px",width:"100%",height:"15%",fontFamily:"sans-serif",color:"#ccc",backgroundColor:"black"},c={position:"relative",fontFamily:"monospace",overflow:"auto",height:"100%",paddingTop:"5px"},h={height:"5px",marginTop:"-5px",cursor:"n-resize",backgroundColor:"darkgrey"},p={position:"absolute",top:"5px",right:"20px",color:"#111",MozBorderRadius:"4px",webkitBorderRadius:"4px",borderRadius:"4px",cursor:"pointer",fontWeight:"normal",textAlign:"center",padding:"3px 5px",backgroundColor:"#333",fontSize:"12px"},d={minHeight:"16px"},v={fontSize:"12px",margin:"0 8px 0 8px",maxWidth:"100%",whiteSpace:"pre-wrap",overflow:"auto"},m=n.defaultView,g=n.documentElement,y=g[a],b=function(){for(var e,t,n,r=arguments.length;r--;){t=arguments[r--],e=arguments[r][a];for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}},w=function(e,t,n){return e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n),[e,t,n]},E=function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on"+t,n)},S=function(e){for(var t=e.childNodes,n=t.length;n--;)e.removeChild(t.item(0))},x=function(e,t){return e.appendChild(t)},T=function(e){return n.createElement(e)},N=function(e){return n.createTextNode(e)},C=e[u]=function(t){var k,L=y.paddingBottom,A=T(r),O=A[a],M=x(A,T(r)),_=x(A,T(r)),D=x(A,T(r)),P=i,H=i,B=i,j=0,F=function(){y.paddingBottom=A.clientHeight+"px"},I=function(e){var t=m.innerHeight,n=M.clientHeight;0>e?e=0:e+n>t&&(e=t-n),O.height=100*(e/t)+"%",F()},R=[w(n,"mousemove",function(e){P&&(I(m.innerHeight-e.clientY),_.scrollTop=B)}),w(n,"mouseup",function(){P&&(P=B=i)}),w(M,"dblclick",function(e){e.preventDefault(),H?(I(H),H=i):(H=A.clientHeight,O.height="0px")}),w(M,"mousedown",function(e){e.preventDefault(),P=s,B=_.scrollTop}),w(M,"contextmenu",function(){P=i}),w(D,"click",function(){k()})];k=function(){for(var t=R.length;t--;)E.apply(e,R[t]);g.removeChild(A),y.paddingBottom=L,S(_),S(A),e[u]=C},b(A,l,_,c,M,h,D,p),D[f]="Close Log",x(D,N("✖")),M[f]="Double-click to toggle log minimization",g.insertBefore(A,g.firstChild),e[u]=function(e){j===o?_.removeChild(_.firstChild):j++;var t=x(_,T(r)),n=x(t,T(r));t[f]=(new Date).toLocaleTimeString(),b(t,d,n,v),x(n,N(e)),_.scrollTop=_.scrollHeight},e[u](t),F()}}(),e}();H.logger=B,H.version="1.4.1",H.lib={},H.registerLibrary=function(e,t){H.lib[e]=t,t.hasOwnProperty("init")&&t.init(A)},H.instances=M,H.getInstanceById=function(e){return M[_[e]]},H.Sketch=function(n){this.attachFunction=n,this.options={pauseOnBlur:!1,globalKeyEvents:!1},this.onLoad=m,this.onSetup=m,this.onPause=m,this.onLoop=m,this.onFrameStart=m,this.onFrameEnd=m,this.onExit=m,this.params={},this.imageCache={pending:0,images:{},operaCache:{},add:function(n,r){if(!this.images[n]&&(b||(this.images[n]=null),r||(r=new Image,r.onload=function(e){return function(){e.pending--}}(this),this.pending++,r.src=n),this.images[n]=r,e.opera)){var i=t.createElement("div");i.appendChild(r),i.style.position="absolute",i.style.opacity=0,i.style.width="1px",i.style.height="1px",this.operaCache[n]||(t.body.appendChild(i),this.operaCache[n]=i)}}},this.sourceCode=void 0,this.attach=function(e){if("function"==typeof this.attachFunction)this.attachFunction(e);else{if(!this.sourceCode)throw"Unable to attach sketch to the processing instance";var t=(new Function("return ("+this.sourceCode+");"))();t(e),this.attachFunction=t}},this.toString=function(){var e,t="((function(Sketch) {\n";t+="var sketch = new Sketch(\n"+this.sourceCode+");\n";for(e in this.options)if(this.options.hasOwnProperty(e)){var n=this.options[e];t+="sketch.options."+e+" = "+("string"==typeof n?'"'+n+'"':""+n)+";\n"}for(e in this.imageCache)this.options.hasOwnProperty(e)&&(t+='sketch.imageCache.add("'+e+'");\n');return t+="return sketch;\n})(Processing.Sketch))"}};var j=function(n,r){function i(t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){var t;200!==r.status&&0!==r.status?t="Invalid XHR status "+r.status:""===r.responseText&&(t="withCredentials"in new XMLHttpRequest&&(new XMLHttpRequest).withCredentials===!1&&"file:"===e.location.protocol?"XMLHttpRequest failure, possibly due to a same-origin policy violation. You can try loading this page in another browser, or load it from http://localhost using a local webserver. See the Processing.js README for a more detailed explanation of this problem and solutions.":"File is empty."),n(r.responseText,t)}},r.open("GET",t,!0),r.overrideMimeType&&r.overrideMimeType("application/json"),r.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT"),r.send(null)}function s(e,r){function s(t,i){if(o[e]=t,++f,i&&u.push(r+" ==> "+i),f===a){if(0!==u.length)throw"Processing.js: Unable to load pjs sketch files: "+u.join("\n");try{return new H(n,o.join("\n"))}catch(s){throw"Processing.js: Unable to execute pjs sketch: "+s}}}if("#"===r.charAt(0)){var l=t.getElementById(r.substring(1));return l?s(l.text||l.textContent):s("","Unable to load pjs sketch: element with id '"+r.substring(1)+"' was not found"),void 0}i(r,s)}for(var o=[],u=[],a=r.length,f=0,l=0;a>l;++l)s(l,r[l])},F=function(){t.removeEventListener("DOMContentLoaded",F,!1),M=[];for(var e,n=t.getElementsByTagName("canvas"),i=0,s=n.length;s>i;i++){var o=n[i].getAttribute("data-processing-sources");if(null===o&&(o=n[i].getAttribute("data-src"),null===o&&(o=n[i].getAttribute("datasrc"))),o){e=o.split(/\s+/g);for(var u=0;u<e.length;)e[u]?u++:e.splice(u,1);j(n[i],e)}}var a,f,l,c,h=t.getElementsByTagName("script"),p=[];for(a=h.length-1;a>=0;a--)p.push(h[a]);for(a=0,f=p.length;f>a;a++){var d=p[a];if(d.getAttribute){var v=d.getAttribute("type");if(v&&("text/processing"===v.toLowerCase()||"application/processing"===v.toLowerCase())){var m=d.getAttribute("data-processing-target");if(n=r,m)n=t.getElementById(m);else{for(var g=d.nextSibling;g&&1!==g.nodeType;)g=g.nextSibling;g&&"canvas"===g.nodeName.toLowerCase()&&(n=g)}if(n){if(d.getAttribute("src")){e=d.getAttribute("src").split(/\s+/),j(n,e);continue}l=d.textContent||d.text,c=new H(n,l)}}}}};H.reload=function(){if(M.length>0)for(var e=M.length-1;e>=0;e--)M[e]&&M[e].exit();F()},H.loadSketchFromSources=j,H.disableInit=function(){b&&t.removeEventListener("DOMContentLoaded",F,!1)},b?(e.Processing=H,t.addEventListener("DOMContentLoaded",F,!1)):this.Processing=H}(window,window.document,Math),window.Raphael||(!function(e){var t,n,r="0.4.2",i="hasOwnProperty",s=/[\.\/]/,o="*",u=function(){},a=function(e,t){return e-t},f={n:{}},l=function(e,r){e=String(e);var i,s=n,o=Array.prototype.slice.call(arguments,2),u=l.listeners(e),f=0,c=[],p={},d=[],v=t;t=e,n=0;for(var m=0,y=u.length;y>m;m++)"zIndex"in u[m]&&(c.push(u[m].zIndex),u[m].zIndex<0&&(p[u[m].zIndex]=u[m]));for(c.sort(a);c[f]<0;)if(i=p[c[f++]],d.push(i.apply(r,o)),n)return n=s,d;for(m=0;y>m;m++)if(i=u[m],"zIndex"in i)if(i.zIndex==c[f]){if(d.push(i.apply(r,o)),n)break;do if(f++,i=p[c[f]],i&&d.push(i.apply(r,o)),n)break;while(i)}else p[i.zIndex]=i;else if(d.push(i.apply(r,o)),n)break;return n=s,t=v,d.length?d:null};l._events=f,l.listeners=function(e){var t,n,r,i,u,a,l,c,h=e.split(s),p=f,v=[p],m=[];for(i=0,u=h.length;u>i;i++){for(c=[],a=0,l=v.length;l>a;a++)for(p=v[a].n,n=[p[h[i]],p[o]],r=2;r--;)t=n[r],t&&(c.push(t),m=m.concat(t.f||[]));v=c}return m},l.on=function(e,t){if(e=String(e),"function"!=typeof t)return function(){};for(var n=e.split(s),r=f,i=0,o=n.length;o>i;i++)r=r.n,r=r.hasOwnProperty(n[i])&&r[n[i]]||(r[n[i]]={n:{}});for(r.f=r.f||[],i=0,o=r.f.length;o>i;i++)if(r.f[i]==t)return u;return r.f.push(t),function(e){+e==+e&&(t.zIndex=+e)}},l.f=function(e){var t=[].slice.call(arguments,1);return function(){l.apply(null,[e,null].concat(t).concat([].slice.call(arguments,0)))}},l.stop=function(){n=1},l.nt=function(e){return e?(new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)")).test(t):t},l.nts=function(){return t.split(s)},l.off=l.unbind=function(e,t){if(!e)return l._events=f={n:{}},void 0;var n,r,u,a,h,p,v,m=e.split(s),g=[f];for(a=0,h=m.length;h>a;a++)for(p=0;p<g.length;p+=u.length-2){if(u=[p,1],n=g[p].n,m[a]!=o)n[m[a]]&&u.push(n[m[a]]);else for(r in n)n[i](r)&&u.push(n[r]);g.splice.apply(g,u)}for(a=0,h=g.length;h>a;a++)for(n=g[a];n.n;){if(t){if(n.f){for(p=0,v=n.f.length;v>p;p++)if(n.f[p]==t){n.f.splice(p,1);break}!n.f.length&&delete n.f}for(r in n.n)if(n.n[i](r)&&n.n[r].f){var y=n.n[r].f;for(p=0,v=y.length;v>p;p++)if(y[p]==t){y.splice(p,1);break}!y.length&&delete n.n[r].f}}else{delete n.f;for(r in n.n)n.n[i](r)&&n.n[r].f&&delete n.n[r].f}n=n.n}},l.once=function(e,t){var n=function(){return l.unbind(e,n),t.apply(this,arguments)};return l.on(e,n)},l.version=r,l.toString=function(){return"You are running Eve "+r},e.eve=l}(this),function(e,t){t(e,e.eve)}(this,function(e,t){function n(e){if(n.is(e,"function"))return w?e():t.on("raphael.DOMload",e);if(n.is(e,$))return n._engine.create[A](n,e.splice(0,3+n.is(e[0],X))).add(e);var r=Array.prototype.slice.call(arguments,0);if(n.is(r[r.length-1],"function")){var i=r.pop();return w?i.call(n._engine.create[A](n,r)):t.on("raphael.DOMload",function(){i.call(n._engine.create[A](n,r))})}return n._engine.create[A](n,arguments)}function r(e){if("function"==typeof e||Object(e)!==e)return e;var t=new e.constructor;for(var n in e)e[N](n)&&(t[n]=r(e[n]));return t}function i(e,t){for(var n=0,r=e.length;r>n;n++)if(e[n]===t)return e.push(e.splice(n,1)[0])}function s(e,t,n){function r(){var s=Array.prototype.slice.call(arguments,0),o=s.join("␀"),u=r.cache=r.cache||{},a=r.count=r.count||[];return u[N](o)?(i(a,o),n?n(u[o]):u[o]):(a.length>=1e3&&delete u[a.shift()],a.push(o),u[o]=e[A](t,s),n?n(u[o]):u[o])}return r}function o(){return this.hex}function u(e,t){for(var n=[],r=0,i=e.length;i-2*!t>r;r+=2){var s=[{x:+e[r-2],y:+e[r-1]},{x:+e[r],y:+e[r+1]},{x:+e[r+2],y:+e[r+3]},{x:+e[r+4],y:+e[r+5]}];t?r?i-4==r?s[3]={x:+e[0],y:+e[1]}:i-2==r&&(s[2]={x:+e[0],y:+e[1]},s[3]={x:+e[2],y:+e[3]}):s[0]={x:+e[i-2],y:+e[i-1]}:i-4==r?s[3]=s[2]:r||(s[0]={x:+e[r],y:+e[r+1]}),n.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return n}function a(e,t,n,r,i){var s=-3*t+9*n-9*r+3*i,o=e*s+6*t-12*n+6*r;return e*o-3*t+3*n}function f(e,t,n,r,i,s,o,u,f){null==f&&(f=1),f=f>1?1:0>f?0:f;for(var l=f/2,c=12,h=[-0.1252,.1252,-0.3678,.3678,-0.5873,.5873,-0.7699,.7699,-0.9041,.9041,-0.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,v=0;c>v;v++){var m=l*h[v]+l,g=a(m,e,n,i,o),y=a(m,t,r,s,u),b=g*g+y*y;d+=p[v]*I.sqrt(b)}return l*d}function l(e,t,n,r,i,s,o,u,a){if(!(0>a||f(e,t,n,r,i,s,o,u)<a)){var l,c=1,h=c/2,p=c-h,d=.01;for(l=f(e,t,n,r,i,s,o,u,p);U(l-a)>d;)h/=2,p+=(a>l?1:-1)*h,l=f(e,t,n,r,i,s,o,u,p);return p}}function c(e,t,n,r,i,s,o,u){if(!(q(e,n)<R(i,o)||R(e,n)>q(i,o)||q(t,r)<R(s,u)||R(t,r)>q(s,u))){var a=(e*r-t*n)*(i-o)-(e-n)*(i*u-s*o),f=(e*r-t*n)*(s-u)-(t-r)*(i*u-s*o),l=(e-n)*(s-u)-(t-r)*(i-o);if(l){var c=a/l,h=f/l,p=+c.toFixed(2),d=+h.toFixed(2);if(!(p<+R(e,n).toFixed(2)||p>+q(e,n).toFixed(2)||p<+R(i,o).toFixed(2)||p>+q(i,o).toFixed(2)||d<+R(t,r).toFixed(2)||d>+q(t,r).toFixed(2)||d<+R(s,u).toFixed(2)||d>+q(s,u).toFixed(2)))return{x:c,y:h}}}}function h(e,t,r){var i=n.bezierBBox(e),s=n.bezierBBox(t);if(!n.isBBoxIntersect(i,s))return r?0:[];for(var o=f.apply(0,e),u=f.apply(0,t),a=q(~~(o/5),1),l=q(~~(u/5),1),h=[],p=[],d={},v=r?0:[],m=0;a+1>m;m++){var g=n.findDotsAtSegment.apply(n,e.concat(m/a));h.push({x:g.x,y:g.y,t:m/a})}for(m=0;l+1>m;m++)g=n.findDotsAtSegment.apply(n,t.concat(m/l)),p.push({x:g.x,y:g.y,t:m/l});for(m=0;a>m;m++)for(var y=0;l>y;y++){var b=h[m],w=h[m+1],E=p[y],S=p[y+1],x=U(w.x-b.x)<.001?"y":"x",T=U(S.x-E.x)<.001?"y":"x",N=c(b.x,b.y,w.x,w.y,E.x,E.y,S.x,S.y);if(N){if(d[N.x.toFixed(4)]==N.y.toFixed(4))continue;d[N.x.toFixed(4)]=N.y.toFixed(4);var C=b.t+U((N[x]-b[x])/(w[x]-b[x]))*(w.t-b.t),k=E.t+U((N[T]-E[T])/(S[T]-E[T]))*(S.t-E.t);C>=0&&1.001>=C&&k>=0&&1.001>=k&&(r?v++:v.push({x:N.x,y:N.y,t1:R(C,1),t2:R(k,1)}))}}return v}function p(e,t,r){e=n._path2curve(e),t=n._path2curve(t);for(var i,s,o,u,a,f,l,c,p,d,v=r?0:[],m=0,g=e.length;g>m;m++){var y=e[m];if("M"==y[0])i=a=y[1],s=f=y[2];else{"C"==y[0]?(p=[i,s].concat(y.slice(1)),i=p[6],s=p[7]):(p=[i,s,i,s,a,f,a,f],i=a,s=f);for(var b=0,w=t.length;w>b;b++){var E=t[b];if("M"==E[0])o=l=E[1],u=c=E[2];else{"C"==E[0]?(d=[o,u].concat(E.slice(1)),o=d[6],u=d[7]):(d=[o,u,o,u,l,c,l,c],o=l,u=c);var S=h(p,d,r);if(r)v+=S;else{for(var x=0,T=S.length;T>x;x++)S[x].segment1=m,S[x].segment2=b,S[x].bez1=p,S[x].bez2=d;v=v.concat(S)}}}}}return v}function d(e,t,n,r,i,s){null!=e?(this.a=+e,this.b=+t,this.c=+n,this.d=+r,this.e=+i,this.f=+s):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function v(){return this.x+D+this.y+D+this.width+" × "+this.height}function m(e,t,n,r,i,s){function o(e){return((c*e+l)*e+f)*e}function u(e,t){var n=a(e,t);return((d*n+p)*n+h)*n}function a(e,t){var n,r,i,s,u,a;for(i=e,a=0;8>a;a++){if(s=o(i)-e,U(s)<t)return i;if(u=(3*c*i+2*l)*i+f,U(u)<1e-6)break;i-=s/u}if(n=0,r=1,i=e,n>i)return n;if(i>r)return r;for(;r>n;){if(s=o(i),U(s-e)<t)return i;e>s?n=i:r=i,i=(r-n)/2+n}return i}var f=3*t,l=3*(r-t)-f,c=1-f-l,h=3*n,p=3*(i-n)-h,d=1-h-p;return u(e,1/(200*s))}function g(e,t){var n=[],r={};if(this.ms=t,this.times=1,e){for(var i in e)e[N](i)&&(r[Z(i)]=e[i],n.push(Z(i)));n.sort(ct)}this.anim=r,this.top=n[n.length-1],this.percents=n}function y(e,r,i,s,o,u){i=Z(i);var a,f,l,c,h,p,v=e.ms,g={},y={},b={};if(s)for(E=0,x=fn.length;x>E;E++){var w=fn[E];if(w.el.id==r.id&&w.anim==e){w.percent!=i?(fn.splice(E,1),l=1):f=w,r.attr(w.totalOrigin);break}}else s=+y;for(var E=0,x=e.percents.length;x>E;E++){if(e.percents[E]==i||e.percents[E]>s*e.top){i=e.percents[E],h=e.percents[E-1]||0,v=v/e.top*(i-h),c=e.percents[E+1],a=e.anim[i];break}s&&r.attr(e.anim[e.percents[E]])}if(a){if(f)f.initstatus=s,f.start=new Date-f.ms*s;else{for(var T in a)if(a[N](T)&&(rt[N](T)||r.paper.customAttributes[N](T)))switch(g[T]=r.attr(T),null==g[T]&&(g[T]=nt[T]),y[T]=a[T],rt[T]){case X:b[T]=(y[T]-g[T])/v;break;case"colour":g[T]=n.getRGB(g[T]);var C=n.getRGB(y[T]);b[T]={r:(C.r-g[T].r)/v,g:(C.g-g[T].g)/v,b:(C.b-g[T].b)/v};break;case"path":var k=Bt(g[T],y[T]),L=k[1];for(g[T]=k[0],b[T]=[],E=0,x=g[T].length;x>E;E++){b[T][E]=[0];for(var A=1,M=g[T][E].length;M>A;A++)b[T][E][A]=(L[E][A]-g[T][E][A])/v}break;case"transform":var _=r._,D=Rt(_[T],y[T]);if(D)for(g[T]=D.from,y[T]=D.to,b[T]=[],b[T].real=!0,E=0,x=g[T].length;x>E;E++)for(b[T][E]=[g[T][E][0]],A=1,M=g[T][E].length;M>A;A++)b[T][E][A]=(y[T][E][A]-g[T][E][A])/v;else{var B=r.matrix||new d,j={_:{transform:_.transform},getBBox:function(){return r.getBBox(1)}};g[T]=[B.a,B.b,B.c,B.d,B.e,B.f],It(j,y[T]),y[T]=j._.transform,b[T]=[(j.matrix.a-B.a)/v,(j.matrix.b-B.b)/v,(j.matrix.c-B.c)/v,(j.matrix.d-B.d)/v,(j.matrix.e-B.e)/v,(j.matrix.f-B.f)/v]}break;case"csv":var F=P(a[T])[H](S),I=P(g[T])[H](S);if("clip-rect"==T)for(g[T]=I,b[T]=[],E=I.length;E--;)b[T][E]=(F[E]-g[T][E])/v;y[T]=F;break;default:for(F=[][O](a[T]),I=[][O](g[T]),b[T]=[],E=r.paper.customAttributes[T].length;E--;)b[T][E]=((F[E]||0)-(I[E]||0))/v}var q=a.easing,R=n.easing_formulas[q];if(!R)if(R=P(q).match(G),R&&5==R.length){var U=R;R=function(e){return m(e,+U[1],+U[2],+U[3],+U[4],v)}}else R=pt;if(p=a.start||e.start||+(new Date),w={anim:e,percent:i,timestamp:p,start:p+(e.del||0),status:0,initstatus:s||0,stop:!1,ms:v,easing:R,from:g,diff:b,to:y,el:r,callback:a.callback,prev:h,next:c,repeat:u||e.times,origin:r.attr(),totalOrigin:o},fn.push(w),s&&!f&&!l&&(w.stop=!0,w.start=new Date-v*s,1==fn.length))return cn();l&&(w.start=new Date-w.ms*s),1==fn.length&&ln(cn)}t("raphael.anim.start."+r.id,r,e)}}function b(e){for(var t=0;t<fn.length;t++)fn[t].el.paper==e&&fn.splice(t--,1)}n.version="2.1.2",n.eve=t;var w,E,S=/[, ]+/,x={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},T=/\{(\d+)\}/g,N="hasOwnProperty",C={doc:document,win:e},k={was:Object.prototype[N].call(C.win,"Raphael"),is:C.win.Raphael},L=function(){this.ca=this.customAttributes={}},A="apply",O="concat",M="ontouchstart"in C.win||C.win.DocumentTouch&&C.doc instanceof DocumentTouch,_="",D=" ",P=String,H="split",B="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[H](D),j={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},F=P.prototype.toLowerCase,I=Math,q=I.max,R=I.min,U=I.abs,z=I.pow,W=I.PI,X="number",V="string",$="array",J=Object.prototype.toString,K=(n._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),Q={NaN:1,Infinity:1,"-Infinity":1},G=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Y=I.round,Z=parseFloat,et=parseInt,tt=P.prototype.toUpperCase,nt=n._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},rt=n._availableAnimAttrs={blur:X,"clip-rect":"csv",cx:X,cy:X,fill:"colour","fill-opacity":X,"font-size":X,height:X,opacity:X,path:"path",r:X,rx:X,ry:X,stroke:"colour","stroke-opacity":X,"stroke-width":X,transform:"transform",width:X,x:X,y:X},it=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,st={hs:1,rg:1},ot=/,?([achlmqrstvxz]),?/gi,ut=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,at=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,ft=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,lt=(n._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),ct=function(e,t){return Z(e)-Z(t)},ht=function(){},pt=function(e){return e},dt=n._rectPath=function(e,t,n,r,i){return i?[["M",e+i,t],["l",n-2*i,0],["a",i,i,0,0,1,i,i],["l",0,r-2*i],["a",i,i,0,0,1,-i,i],["l",2*i-n,0],["a",i,i,0,0,1,-i,-i],["l",0,2*i-r],["a",i,i,0,0,1,i,-i],["z"]]:[["M",e,t],["l",n,0],["l",0,r],["l",-n,0],["z"]]},vt=function(e,t,n,r){return null==r&&(r=n),[["M",e,t],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]]},mt=n._getPath={path:function(e){return e.attr("path")},circle:function(e){var t=e.attrs;return vt(t.cx,t.cy,t.r)},ellipse:function(e){var t=e.attrs;return vt(t.cx,t.cy,t.rx,t.ry)},rect:function(e){var t=e.attrs;return dt(t.x,t.y,t.width,t.height,t.r)},image:function(e){var t=e.attrs;return dt(t.x,t.y,t.width,t.height)},text:function(e){var t=e._getBBox();return dt(t.x,t.y,t.width,t.height)},set:function(e){var t=e._getBBox();return dt(t.x,t.y,t.width,t.height)}},gt=n.mapPath=function(e,t){if(!t)return e;var n,r,i,s,o,u,a;for(e=Bt(e),i=0,o=e.length;o>i;i++)for(a=e[i],s=1,u=a.length;u>s;s+=2)n=t.x(a[s],a[s+1]),r=t.y(a[s],a[s+1]),a[s]=n,a[s+1]=r;return e};if(n._g=C,n.type=C.win.SVGAngle||C.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==n.type){var yt,bt=C.doc.createElement("div");if(bt.innerHTML='<v:shape adj="1"/>',yt=bt.firstChild,yt.style.behavior="url(#default#VML)",!yt||"object"!=typeof yt.adj)return n.type=_;bt=null}n.svg=!(n.vml="VML"==n.type),n._Paper=L,n.fn=E=L.prototype=n.prototype,n._id=0,n._oid=0,n.is=function(e,t){return t=F.call(t),"finite"==t?!Q[N](+e):"array"==t?e instanceof Array:"null"==t&&null===e||t==typeof e&&null!==e||"object"==t&&e===Object(e)||"array"==t&&Array.isArray&&Array.isArray(e)||J.call(e).slice(8,-1).toLowerCase()==t},n.angle=function(e,t,r,i,s,o){if(null==s){var u=e-r,a=t-i;return u||a?(180+180*I.atan2(-a,-u)/W+360)%360:0}return n.angle(e,t,s,o)-n.angle(r,i,s,o)},n.rad=function(e){return e%360*W/180},n.deg=function(e){return 180*e/W%360},n.snapTo=function(e,t,r){if(r=n.is(r,"finite")?r:10,n.is(e,$)){for(var i=e.length;i--;)if(U(e[i]-t)<=r)return e[i]}else{e=+e;var s=t%e;if(r>s)return t-s;if(s>e-r)return t-s+e}return t},n.createUUID=function(e,t){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(e,t).toUpperCase()}}(/[xy]/g,function(e){var t=0|16*I.random(),n="x"==e?t:8|3&t;return n.toString(16)}),n.setWindow=function(e){t("raphael.setWindow",n,C.win,e),C.win=e,C.doc=C.win.document,n._engine.initWin&&n._engine.initWin(C.win)};var wt=function(e){if(n.vml){var t,r=/^\s+|\s+$/g;try{var i=new ActiveXObject("htmlfile");i.write("<body>"),i.close(),t=i.body}catch(o){t=createPopup().document.body}var u=t.createTextRange();wt=s(function(e){try{t.style.color=P(e).replace(r,_);var n=u.queryCommandValue("ForeColor");return n=(255&n)<<16|65280&n|(16711680&n)>>>16,"#"+("000000"+n.toString(16)).slice(-6)}catch(i){return"none"}})}else{var a=C.doc.createElement("i");a.title="Raphaël Colour Picker",a.style.display="none",C.doc.body.appendChild(a),wt=s(function(e){return a.style.color=e,C.doc.defaultView.getComputedStyle(a,_).getPropertyValue("color")})}return wt(e)},Et=function(){return"hsb("+[this.h,this.s,this.b]+")"},St=function(){return"hsl("+[this.h,this.s,this.l]+")"},xt=function(){return this.hex},Tt=function(e,t,r){if(null==t&&n.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,t=e.g,e=e.r),null==t&&n.is(e,V)){var i=n.getRGB(e);e=i.r,t=i.g,r=i.b}return(e>1||t>1||r>1)&&(e/=255,t/=255,r/=255),[e,t,r]},Nt=function(e,t,r,i){e*=255,t*=255,r*=255;var s={r:e,g:t,b:r,hex:n.rgb(e,t,r),toString:xt};return n.is(i,"finite")&&(s.opacity=i),s};n.color=function(e){var t;return n.is(e,"object")&&"h"in e&&"s"in e&&"b"in e?(t=n.hsb2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.hex=t.hex):n.is(e,"object")&&"h"in e&&"s"in e&&"l"in e?(t=n.hsl2rgb(e),e.r=t.r,e.g=t.g,e.b=t.b,e.hex=t.hex):(n.is(e,"string")&&(e=n.getRGB(e)),n.is(e,"object")&&"r"in e&&"g"in e&&"b"in e?(t=n.rgb2hsl(e),e.h=t.h,e.s=t.s,e.l=t.l,t=n.rgb2hsb(e),e.v=t.b):(e={hex:"none"},e.r=e.g=e.b=e.h=e.s=e.v=e.l=-1)),e.toString=xt,e},n.hsb2rgb=function(e,t,n,r){this.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(n=e.b,t=e.s,e=e.h,r=e.o),e*=360;var i,s,o,u,a;return e=e%360/60,a=n*t,u=a*(1-U(e%2-1)),i=s=o=n-a,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],Nt(i,s,o,r)},n.hsl2rgb=function(e,t,n,r){this.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(n=e.l,t=e.s,e=e.h),(e>1||t>1||n>1)&&(e/=360,t/=100,n/=100),e*=360;var i,s,o,u,a;return e=e%360/60,a=2*t*(.5>n?n:1-n),u=a*(1-U(e%2-1)),i=s=o=n-a/2,e=~~e,i+=[a,u,0,0,u,a][e],s+=[u,a,a,u,0,0][e],o+=[0,0,u,a,a,u][e],Nt(i,s,o,r)},n.rgb2hsb=function(e,t,n){n=Tt(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o;return s=q(e,t,n),o=s-R(e,t,n),r=0==o?null:s==e?(t-n)/o:s==t?(n-e)/o+2:(e-t)/o+4,r=60*((r+360)%6)/360,i=0==o?0:o/s,{h:r,s:i,b:s,toString:Et}},n.rgb2hsl=function(e,t,n){n=Tt(e,t,n),e=n[0],t=n[1],n=n[2];var r,i,s,o,u,a;return o=q(e,t,n),u=R(e,t,n),a=o-u,r=0==a?null:o==e?(t-n)/a:o==t?(n-e)/a+2:(e-t)/a+4,r=60*((r+360)%6)/360,s=(o+u)/2,i=0==a?0:.5>s?a/(2*s):a/(2-2*s),{h:r,s:i,l:s,toString:St}},n._path2string=function(){return this.join(",").replace(ot,"$1")},n._preload=function(e,t){var n=C.doc.createElement("img");n.style.cssText="position:absolute;left:-9999em;top:-9999em",n.onload=function(){t.call(this),this.onload=null,C.doc.body.removeChild(this)},n.onerror=function(){C.doc.body.removeChild(this)},C.doc.body.appendChild(n),n.src=e},n.getRGB=s(function(e){if(!e||(e=P(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:o};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none",toString:o};!st[N](e.toLowerCase().substring(0,2))&&"#"!=e.charAt()&&(e=wt(e));var t,r,i,s,u,a,f=e.match(K);return f?(f[2]&&(i=et(f[2].substring(5),16),r=et(f[2].substring(3,5),16),t=et(f[2].substring(1,3),16)),f[3]&&(i=et((u=f[3].charAt(3))+u,16),r=et((u=f[3].charAt(2))+u,16),t=et((u=f[3].charAt(1))+u,16)),f[4]&&(a=f[4][H](it),t=Z(a[0]),"%"==a[0].slice(-1)&&(t*=2.55),r=Z(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),i=Z(a[2]),"%"==a[2].slice(-1)&&(i*=2.55),"rgba"==f[1].toLowerCase().slice(0,4)&&(s=Z(a[3])),a[3]&&"%"==a[3].slice(-1)&&(s/=100)),f[5]?(a=f[5][H](it),t=Z(a[0]),"%"==a[0].slice(-1)&&(t*=2.55),r=Z(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),i=Z(a[2]),"%"==a[2].slice(-1)&&(i*=2.55),("deg"==a[0].slice(-3)||"°"==a[0].slice(-1))&&(t/=360),"hsba"==f[1].toLowerCase().slice(0,4)&&(s=Z(a[3])),a[3]&&"%"==a[3].slice(-1)&&(s/=100),n.hsb2rgb(t,r,i,s)):f[6]?(a=f[6][H](it),t=Z(a[0]),"%"==a[0].slice(-1)&&(t*=2.55),r=Z(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),i=Z(a[2]),"%"==a[2].slice(-1)&&(i*=2.55),("deg"==a[0].slice(-3)||"°"==a[0].slice(-1))&&(t/=360),"hsla"==f[1].toLowerCase().slice(0,4)&&(s=Z(a[3])),a[3]&&"%"==a[3].slice(-1)&&(s/=100),n.hsl2rgb(t,r,i,s)):(f={r:t,g:r,b:i,toString:o},f.hex="#"+(16777216|i|r<<8|t<<16).toString(16).slice(1),n.is(s,"finite")&&(f.opacity=s),f)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:o}},n),n.hsb=s(function(e,t,r){return n.hsb2rgb(e,t,r).hex}),n.hsl=s(function(e,t,r){return n.hsl2rgb(e,t,r).hex}),n.rgb=s(function(e,t,n){return"#"+(16777216|n|t<<8|e<<16).toString(16).slice(1)}),n.getColor=function(e){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||.75},n=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,t.h>1&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),n.hex},n.getColor.reset=function(){delete this.start},n.parsePathString=function(e){if(!e)return null;var t=Ct(e);if(t.arr)return Lt(t.arr);var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},i=[];return n.is(e,$)&&n.is(e[0],$)&&(i=Lt(e)),i.length||P(e).replace(ut,function(e,t,n){var s=[],o=t.toLowerCase();if(n.replace(ft,function(e,t){t&&s.push(+t)}),"m"==o&&s.length>2&&(i.push([t][O](s.splice(0,2))),o="l",t="m"==t?"l":"L"),"r"==o)i.push([t][O](s));else for(;s.length>=r[o]&&(i.push([t][O](s.splice(0,r[o]))),r[o]););}),i.toString=n._path2string,t.arr=Lt(i),i},n.parseTransformString=s(function(e){if(!e)return null;var t=[];return n.is(e,$)&&n.is(e[0],$)&&(t=Lt(e)),t.length||P(e).replace(at,function(e,n,r){var i=[];F.call(n),r.replace(ft,function(e,t){t&&i.push(+t)}),t.push([n][O](i))}),t.toString=n._path2string,t});var Ct=function(e){var t=Ct.ps=Ct.ps||{};return t[e]?t[e].sleep=100:t[e]={sleep:100},setTimeout(function(){for(var n in t)t[N](n)&&n!=e&&(t[n].sleep--,!t[n].sleep&&delete t[n])}),t[e]};n.findDotsAtSegment=function(e,t,n,r,i,s,o,u,a){var f=1-a,l=z(f,3),c=z(f,2),h=a*a,p=h*a,d=l*e+3*c*a*n+3*f*a*a*i+p*o,v=l*t+3*c*a*r+3*f*a*a*s+p*u,m=e+2*a*(n-e)+h*(i-2*n+e),g=t+2*a*(r-t)+h*(s-2*r+t),y=n+2*a*(i-n)+h*(o-2*i+n),b=r+2*a*(s-r)+h*(u-2*s+r),w=f*e+a*n,E=f*t+a*r,S=f*i+a*o,x=f*s+a*u,T=90-180*I.atan2(m-y,g-b)/W;return(m>y||b>g)&&(T+=180),{x:d,y:v,m:{x:m,y:g},n:{x:y,y:b},start:{x:w,y:E},end:{x:S,y:x},alpha:T}},n.bezierBBox=function(e,t,r,i,s,o,u,a){n.is(e,"array")||(e=[e,t,r,i,s,o,u,a]);var f=Ht.apply(null,e);return{x:f.min.x,y:f.min.y,x2:f.max.x,y2:f.max.y,width:f.max.x-f.min.x,height:f.max.y-f.min.y}},n.isPointInsideBBox=function(e,t,n){return t>=e.x&&t<=e.x2&&n>=e.y&&n<=e.y2},n.isBBoxIntersect=function(e,t){var r=n.isPointInsideBBox;return r(t,e.x,e.y)||r(t,e.x2,e.y)||r(t,e.x,e.y2)||r(t,e.x2,e.y2)||r(e,t.x,t.y)||r(e,t.x2,t.y)||r(e,t.x,t.y2)||r(e,t.x2,t.y2)||(e.x<t.x2&&e.x>t.x||t.x<e.x2&&t.x>e.x)&&(e.y<t.y2&&e.y>t.y||t.y<e.y2&&t.y>e.y)},n.pathIntersection=function(e,t){return p(e,t)},n.pathIntersectionNumber=function(e,t){return p(e,t,1)},n.isPointInsidePath=function(e,t,r){var i=n.pathBBox(e);return n.isPointInsideBBox(i,t,r)&&1==p(e,[["M",t,r],["H",i.x2+10]],1)%2},n._removedFactory=function(e){return function(){t("raphael.log",null,"Raphaël: you are calling to method “"+e+"” of removed object",e)}};var kt=n.pathBBox=function(e){var t=Ct(e);if(t.bbox)return r(t.bbox);if(!e)return{x:0,y:0,width:0,height:0,x2:0,y2:0};e=Bt(e);for(var n,i=0,s=0,o=[],u=[],a=0,f=e.length;f>a;a++)if(n=e[a],"M"==n[0])i=n[1],s=n[2],o.push(i),u.push(s);else{var l=Ht(i,s,n[1],n[2],n[3],n[4],n[5],n[6]);o=o[O](l.min.x,l.max.x),u=u[O](l.min.y,l.max.y),i=n[5],s=n[6]}var c=R[A](0,o),h=R[A](0,u),p=q[A](0,o),d=q[A](0,u),v=p-c,m=d-h,g={x:c,y:h,x2:p,y2:d,width:v,height:m,cx:c+v/2,cy:h+m/2};return t.bbox=r(g),g},Lt=function(e){var t=r(e);return t.toString=n._path2string,t},At=n._pathToRelative=function(e){var t=Ct(e);if(t.rel)return Lt(t.rel);n.is(e,$)&&n.is(e&&e[0],$)||(e=n.parsePathString(e));var r=[],i=0,s=0,o=0,u=0,a=0;"M"==e[0][0]&&(i=e[0][1],s=e[0][2],o=i,u=s,a++,r.push(["M",i,s]));for(var f=a,l=e.length;l>f;f++){var c=r[f]=[],h=e[f];if(h[0]!=F.call(h[0]))switch(c[0]=F.call(h[0]),c[0]){case"a":c[1]=h[1],c[2]=h[2],c[3]=h[3],c[4]=h[4],c[5]=h[5],c[6]=+(h[6]-i).toFixed(3),c[7]=+(h[7]-s).toFixed(3);break;case"v":c[1]=+(h[1]-s).toFixed(3);break;case"m":o=h[1],u=h[2];default:for(var p=1,d=h.length;d>p;p++)c[p]=+(h[p]-(p%2?i:s)).toFixed(3)}else{c=r[f]=[],"m"==h[0]&&(o=h[1]+i,u=h[2]+s);for(var v=0,m=h.length;m>v;v++)r[f][v]=h[v]}var g=r[f].length;switch(r[f][0]){case"z":i=o,s=u;break;case"h":i+=+r[f][g-1];break;case"v":s+=+r[f][g-1];break;default:i+=+r[f][g-2],s+=+r[f][g-1]}}return r.toString=n._path2string,t.rel=Lt(r),r},Ot=n._pathToAbsolute=function(e){var t=Ct(e);if(t.abs)return Lt(t.abs);if(n.is(e,$)&&n.is(e&&e[0],$)||(e=n.parsePathString(e)),!e||!e.length)return[["M",0,0]];var r=[],i=0,s=0,o=0,a=0,f=0;"M"==e[0][0]&&(i=+e[0][1],s=+e[0][2],o=i,a=s,f++,r[0]=["M",i,s]);for(var l,c,h=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),p=f,d=e.length;d>p;p++){if(r.push(l=[]),c=e[p],c[0]!=tt.call(c[0]))switch(l[0]=tt.call(c[0]),l[0]){case"A":l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5],l[6]=+(c[6]+i),l[7]=+(c[7]+s);break;case"V":l[1]=+c[1]+s;break;case"H":l[1]=+c[1]+i;break;case"R":for(var v=[i,s][O](c.slice(1)),m=2,g=v.length;g>m;m++)v[m]=+v[m]+i,v[++m]=+v[m]+s;r.pop(),r=r[O](u(v,h));break;case"M":o=+c[1]+i,a=+c[2]+s;default:for(m=1,g=c.length;g>m;m++)l[m]=+c[m]+(m%2?i:s)}else if("R"==c[0])v=[i,s][O](c.slice(1)),r.pop(),r=r[O](u(v,h)),l=["R"][O](c.slice(-2));else for(var y=0,b=c.length;b>y;y++)l[y]=c[y];switch(l[0]){case"Z":i=o,s=a;break;case"H":i=l[1];break;case"V":s=l[1];break;case"M":o=l[l.length-2],a=l[l.length-1];default:i=l[l.length-2],s=l[l.length-1]}}return r.toString=n._path2string,t.abs=Lt(r),r},Mt=function(e,t,n,r){return[e,t,n,r,n,r]},_t=function(e,t,n,r,i,s){var o=1/3,u=2/3;return[o*e+u*n,o*t+u*r,o*i+u*n,o*s+u*r,i,s]},Dt=function(e,t,n,r,i,o,u,a,f,l){var c,h=120*W/180,p=W/180*(+i||0),d=[],v=s(function(e,t,n){var r=e*I.cos(n)-t*I.sin(n),i=e*I.sin(n)+t*I.cos(n);return{x:r,y:i}});if(l)T=l[0],N=l[1],S=l[2],x=l[3];else{c=v(e,t,-p),e=c.x,t=c.y,c=v(a,f,-p),a=c.x,f=c.y;var m=(I.cos(W/180*i),I.sin(W/180*i),(e-a)/2),g=(t-f)/2,y=m*m/(n*n)+g*g/(r*r);y>1&&(y=I.sqrt(y),n=y*n,r=y*r);var b=n*n,w=r*r,E=(o==u?-1:1)*I.sqrt(U((b*w-b*g*g-w*m*m)/(b*g*g+w*m*m))),S=E*n*g/r+(e+a)/2,x=E*-r*m/n+(t+f)/2,T=I.asin(((t-x)/r).toFixed(9)),N=I.asin(((f-x)/r).toFixed(9));T=S>e?W-T:T,N=S>a?W-N:N,0>T&&(T=2*W+T),0>N&&(N=2*W+N),u&&T>N&&(T-=2*W),!u&&N>T&&(N-=2*W)}var C=N-T;if(U(C)>h){var k=N,L=a,A=f;N=T+h*(u&&N>T?1:-1),a=S+n*I.cos(N),f=x+r*I.sin(N),d=Dt(a,f,n,r,i,0,u,L,A,[N,k,S,x])}C=N-T;var M=I.cos(T),_=I.sin(T),D=I.cos(N),P=I.sin(N),B=I.tan(C/4),j=4/3*n*B,F=4/3*r*B,q=[e,t],R=[e+j*_,t-F*M],z=[a+j*P,f-F*D],X=[a,f];if(R[0]=2*q[0]-R[0],R[1]=2*q[1]-R[1],l)return[R,z,X][O](d);d=[R,z,X][O](d).join()[H](",");for(var V=[],$=0,J=d.length;J>$;$++)V[$]=$%2?v(d[$-1],d[$],p).y:v(d[$],d[$+1],p).x;return V},Pt=function(e,t,n,r,i,s,o,u,a){var f=1-a;return{x:z(f,3)*e+3*z(f,2)*a*n+3*f*a*a*i+z(a,3)*o,y:z(f,3)*t+3*z(f,2)*a*r+3*f*a*a*s+z(a,3)*u}},Ht=s(function(e,t,n,r,i,s,o,u){var a,f=i-2*n+e-(o-2*i+n),l=2*(n-e)-2*(i-n),c=e-n,h=(-l+I.sqrt(l*l-4*f*c))/2/f,p=(-l-I.sqrt(l*l-4*f*c))/2/f,d=[t,u],v=[e,o];return U(h)>"1e12"&&(h=.5),U(p)>"1e12"&&(p=.5),h>0&&1>h&&(a=Pt(e,t,n,r,i,s,o,u,h),v.push(a.x),d.push(a.y)),p>0&&1>p&&(a=Pt(e,t,n,r,i,s,o,u,p),v.push(a.x),d.push(a.y)),f=s-2*r+t-(u-2*s+r),l=2*(r-t)-2*(s-r),c=t-r,h=(-l+I.sqrt(l*l-4*f*c))/2/f,p=(-l-I.sqrt(l*l-4*f*c))/2/f,U(h)>"1e12"&&(h=.5),U(p)>"1e12"&&(p=.5),h>0&&1>h&&(a=Pt(e,t,n,r,i,s,o,u,h),v.push(a.x),d.push(a.y)),p>0&&1>p&&(a=Pt(e,t,n,r,i,s,o,u,p),v.push(a.x),d.push(a.y)),{min:{x:R[A](0,v),y:R[A](0,d)},max:{x:q[A](0,v),y:q[A](0,d)}}}),Bt=n._path2curve=s(function(e,t){var n=!t&&Ct(e);if(!t&&n.curve)return Lt(n.curve);for(var r=Ot(e),i=t&&Ot(t),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u=function(e,t,n){var r,i;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"][O](Dt[A](0,[t.x,t.y][O](e.slice(1))));break;case"S":"C"==n||"S"==n?(r=2*t.x-t.bx,i=2*t.y-t.by):(r=t.x,i=t.y),e=["C",r,i][O](e.slice(1));break;case"T":"Q"==n||"T"==n?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"][O](_t(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"][O](_t(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"][O](Mt(t.x,t.y,e[1],e[2]));break;case"H":e=["C"][O](Mt(t.x,t.y,e[1],t.y));break;case"V":e=["C"][O](Mt(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"][O](Mt(t.x,t.y,t.X,t.Y))}return e},a=function(e,t){if(e[t].length>7){e[t].shift();for(var n=e[t];n.length;)e.splice(t++,0,["C"][O](n.splice(0,6)));e.splice(t,1),c=q(r.length,i&&i.length||0)}},f=function(e,t,n,s,o){e&&t&&"M"==e[o][0]&&"M"!=t[o][0]&&(t.splice(o,0,["M",s.x,s.y]),n.bx=0,n.by=0,n.x=e[o][1],n.y=e[o][2],c=q(r.length,i&&i.length||0))},l=0,c=q(r.length,i&&i.length||0);c>l;l++){r[l]=u(r[l],s),a(r,l),i&&(i[l]=u(i[l],o)),i&&a(i,l),f(r,i,s,o,l),f(i,r,o,s,l);var h=r[l],p=i&&i[l],d=h.length,v=i&&p.length;s.x=h[d-2],s.y=h[d-1],s.bx=Z(h[d-4])||s.x,s.by=Z(h[d-3])||s.y,o.bx=i&&(Z(p[v-4])||o.x),o.by=i&&(Z(p[v-3])||o.y),o.x=i&&p[v-2],o.y=i&&p[v-1]}return i||(n.curve=Lt(r)),i?[r,i]:r},null,Lt),jt=(n._parseDots=s(function(e){for(var t=[],r=0,i=e.length;i>r;r++){var s={},o=e[r].match(/^([^:]*):?([\d\.]*)/);if(s.color=n.getRGB(o[1]),s.color.error)return null;s.color=s.color.hex,o[2]&&(s.offset=o[2]+"%"),t.push(s)}for(r=1,i=t.length-1;i>r;r++)if(!t[r].offset){for(var u=Z(t[r-1].offset||0),a=0,f=r+1;i>f;f++)if(t[f].offset){a=t[f].offset;break}a||(a=100,f=i),a=Z(a);for(var l=(a-u)/(f-r+1);f>r;r++)u+=l,t[r].offset=u+"%"}return t}),n._tear=function(e,t){e==t.top&&(t.top=e.prev),e==t.bottom&&(t.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)}),Ft=(n._tofront=function(e,t){t.top!==e&&(jt(e,t),e.next=null,e.prev=t.top,t.top.next=e,t.top=e)},n._toback=function(e,t){t.bottom!==e&&(jt(e,t),e.next=t.bottom,e.prev=null,t.bottom.prev=e,t.bottom=e)},n._insertafter=function(e,t,n){jt(e,n),t==n.top&&(n.top=e),t.next&&(t.next.prev=e),e.next=t.next,e.prev=t,t.next=e},n._insertbefore=function(e,t,n){jt(e,n),t==n.bottom&&(n.bottom=e),t.prev&&(t.prev.next=e),e.prev=t.prev,t.prev=e,e.next=t},n.toMatrix=function(e,t){var n=kt(e),r={_:{transform:_},getBBox:function(){return n}};return It(r,t),r.matrix}),It=(n.transformPath=function(e,t){return gt(e,Ft(e,t))},n._extractTransform=function(e,t){if(null==t)return e._.transform;t=P(t).replace(/\.{3}|\u2026/g,e._.transform||_);var r=n.parseTransformString(t),i=0,s=0,o=0,u=1,a=1,f=e._,l=new d;if(f.transform=r||[],r)for(var c=0,h=r.length;h>c;c++){var p,v,m,g,y,b=r[c],w=b.length,E=P(b[0]).toLowerCase(),S=b[0]!=E,x=S?l.invert():0;"t"==E&&3==w?S?(p=x.x(0,0),v=x.y(0,0),m=x.x(b[1],b[2]),g=x.y(b[1],b[2]),l.translate(m-p,g-v)):l.translate(b[1],b[2]):"r"==E?2==w?(y=y||e.getBBox(1),l.rotate(b[1],y.x+y.width/2,y.y+y.height/2),i+=b[1]):4==w&&(S?(m=x.x(b[2],b[3]),g=x.y(b[2],b[3]),l.rotate(b[1],m,g)):l.rotate(b[1],b[2],b[3]),i+=b[1]):"s"==E?2==w||3==w?(y=y||e.getBBox(1),l.scale(b[1],b[w-1],y.x+y.width/2,y.y+y.height/2),u*=b[1],a*=b[w-1]):5==w&&(S?(m=x.x(b[3],b[4]),g=x.y(b[3],b[4]),l.scale(b[1],b[2],m,g)):l.scale(b[1],b[2],b[3],b[4]),u*=b[1],a*=b[2]):"m"==E&&7==w&&l.add(b[1],b[2],b[3],b[4],b[5],b[6]),f.dirtyT=1,e.matrix=l}e.matrix=l,f.sx=u,f.sy=a,f.deg=i,f.dx=s=l.e,f.dy=o=l.f,1==u&&1==a&&!i&&f.bbox?(f.bbox.x+=+s,f.bbox.y+=+o):f.dirtyT=1}),qt=function(e){var t=e[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return 4==e.length?[t,0,e[2],e[3]]:[t,0];case"s":return 5==e.length?[t,1,1,e[3],e[4]]:3==e.length?[t,1,1]:[t,1]}},Rt=n._equaliseTransform=function(e,t){t=P(t).replace(/\.{3}|\u2026/g,e),e=n.parseTransformString(e)||[],t=n.parseTransformString(t)||[];for(var r,i,s,o,u=q(e.length,t.length),a=[],f=[],l=0;u>l;l++){if(s=e[l]||qt(t[l]),o=t[l]||qt(s),s[0]!=o[0]||"r"==s[0].toLowerCase()&&(s[2]!=o[2]||s[3]!=o[3])||"s"==s[0].toLowerCase()&&(s[3]!=o[3]||s[4]!=o[4]))return;for(a[l]=[],f[l]=[],r=0,i=q(s.length,o.length);i>r;r++)r in s&&(a[l][r]=s[r]),r in o&&(f[l][r]=o[r])}return{from:a,to:f}};n._getContainer=function(e,t,r,i){var s;return s=null!=i||n.is(e,"object")?e:C.doc.getElementById(e),null!=s?s.tagName?null==t?{container:s,width:s.style.pixelWidth||s.offsetWidth,height:s.style.pixelHeight||s.offsetHeight}:{container:s,width:t,height:r}:{container:1,x:e,y:t,width:r,height:i}:void 0},n.pathToRelative=At,n._engine={},n.path2curve=Bt,n.matrix=function(e,t,n,r,i,s){return new d(e,t,n,r,i,s)},function(e){function t(e){return e[0]*e[0]+e[1]*e[1]}function r(e){var n=I.sqrt(t(e));e[0]&&(e[0]/=n),e[1]&&(e[1]/=n)}e.add=function(e,t,n,r,i,s){var o,u,a,f,l=[[],[],[]],c=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],h=[[e,n,i],[t,r,s],[0,0,1]];for(e&&e instanceof d&&(h=[[e.a,e.c,e.e],[e.b,e.d,e.f],[0,0,1]]),o=0;3>o;o++)for(u=0;3>u;u++){for(f=0,a=0;3>a;a++)f+=c[o][a]*h[a][u];l[o][u]=f}this.a=l[0][0],this.b=l[1][0],this.c=l[0][1],this.d=l[1][1],this.e=l[0][2],this.f=l[1][2]},e.invert=function(){var e=this,t=e.a*e.d-e.b*e.c;return new d(e.d/t,-e.b/t,-e.c/t,e.a/t,(e.c*e.f-e.d*e.e)/t,(e.b*e.e-e.a*e.f)/t)},e.clone=function(){return new d(this.a,this.b,this.c,this.d,this.e,this.f)},e.translate=function(e,t){this.add(1,0,0,1,e,t)},e.scale=function(e,t,n,r){null==t&&(t=e),(n||r)&&this.add(1,0,0,1,n,r),this.add(e,0,0,t,0,0),(n||r)&&this.add(1,0,0,1,-n,-r)},e.rotate=function(e,t,r){e=n.rad(e),t=t||0,r=r||0;var i=+I.cos(e).toFixed(9),s=+I.sin(e).toFixed(9);this.add(i,s,-s,i,t,r),this.add(1,0,0,1,-t,-r)},e.x=function(e,t){return e*this.a+t*this.c+this.e},e.y=function(e,t){return e*this.b+t*this.d+this.f},e.get=function(e){return+this[P.fromCharCode(97+e)].toFixed(4)},e.toString=function(){return n.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},e.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},e.split=function(){var e={};e.dx=this.e,e.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];e.scalex=I.sqrt(t(i[0])),r(i[0]),e.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*e.shear,i[1][1]-i[0][1]*e.shear],e.scaley=I.sqrt(t(i[1])),r(i[1]),e.shear/=e.scaley;var s=-i[0][1],o=i[1][1];return 0>o?(e.rotate=n.deg(I.acos(o)),0>s&&(e.rotate=360-e.rotate)):e.rotate=n.deg(I.asin(s)),e.isSimple=!(+e.shear.toFixed(9)||e.scalex.toFixed(9)!=e.scaley.toFixed(9)&&e.rotate),e.isSuperSimple=!+e.shear.toFixed(9)&&e.scalex.toFixed(9)==e.scaley.toFixed(9)&&!e.rotate,e.noRotation=!+e.shear.toFixed(9)&&!e.rotate,e},e.toTransformString=function(e){var t=e||this[H]();return t.isSimple?(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx||t.dy?"t"+[t.dx,t.dy]:_)+(1!=t.scalex||1!=t.scaley?"s"+[t.scalex,t.scaley,0,0]:_)+(t.rotate?"r"+[t.rotate,0,0]:_)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(d.prototype);var Ut=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);E.safari="Apple Computer, Inc."==navigator.vendor&&(Ut&&Ut[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&Ut&&Ut[1]<8?function(){var e=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){e.remove()})}:ht;for(var zt=function(){this.returnValue=!1},Wt=function(){return this.originalEvent.preventDefault()},Xt=function(){this.cancelBubble=!0},Vt=function(){return this.originalEvent.stopPropagation()},$t=function(e){var t=C.doc.documentElement.scrollTop||C.doc.body.scrollTop,n=C.doc.documentElement.scrollLeft||C.doc.body.scrollLeft;return{x:e.clientX+n,y:e.clientY+t}},Jt=function(){return C.doc.addEventListener?function(e,t,n,r){var i=function(e){var t=$t(e);return n.call(r,e,t.x,t.y)};if(e.addEventListener(t,i,!1),M&&j[t]){var s=function(t){for(var i=$t(t),s=t,o=0,u=t.targetTouches&&t.targetTouches.length;u>o;o++)if(t.targetTouches[o].target==e){t=t.targetTouches[o],t.originalEvent=s,t.preventDefault=Wt,t.stopPropagation=Vt;break}return n.call(r,t,i.x,i.y)};e.addEventListener(j[t],s,!1)}return function(){return e.removeEventListener(t,i,!1),M&&j[t]&&e.removeEventListener(j[t],i,!1),!0}}:C.doc.attachEvent?function(e,t,n,r){var i=function(e){e=e||C.win.event;var t=C.doc.documentElement.scrollTop||C.doc.body.scrollTop,i=C.doc.documentElement.scrollLeft||C.doc.body.scrollLeft,s=e.clientX+i,o=e.clientY+t;return e.preventDefault=e.preventDefault||zt,e.stopPropagation=e.stopPropagation||Xt,n.call(r,e,s,o)};e.attachEvent("on"+t,i);var s=function(){return e.detachEvent("on"+t,i),!0};return s}:void 0}(),Kt=[],Qt=function(e){for(var n,r=e.clientX,i=e.clientY,s=C.doc.documentElement.scrollTop||C.doc.body.scrollTop,o=C.doc.documentElement.scrollLeft||C.doc.body.scrollLeft,u=Kt.length;u--;){if(n=Kt[u],M&&e.touches){for(var a,f=e.touches.length;f--;)if(a=e.touches[f],a.identifier==n.el._drag.id){r=a.clientX,i=a.clientY,(e.originalEvent?e.originalEvent:e).preventDefault();break}}else e.preventDefault();var l,c=n.el.node,h=c.nextSibling,p=c.parentNode,d=c.style.display;C.win.opera&&p.removeChild(c),c.style.display="none",l=n.el.paper.getElementByPoint(r,i),c.style.display=d,C.win.opera&&(h?p.insertBefore(c,h):p.appendChild(c)),l&&t("raphael.drag.over."+n.el.id,n.el,l),r+=o,i+=s,t("raphael.drag.move."+n.el.id,n.move_scope||n.el,r-n.el._drag.x,i-n.el._drag.y,r,i,e)}},Gt=function(e){n.unmousemove(Qt).unmouseup(Gt);for(var r,i=Kt.length;i--;)r=Kt[i],r.el._drag={},t("raphael.drag.end."+r.el.id,r.end_scope||r.start_scope||r.move_scope||r.el,e);Kt=[]},Yt=n.el={},Zt=B.length;Zt--;)!function(e){n[e]=Yt[e]=function(t,r){return n.is(t,"function")&&(this.events=this.events||[],this.events.push({name:e,f:t,unbind:Jt(this.shape||this.node||C.doc,e,t,r||this)})),this},n["un"+e]=Yt["un"+e]=function(t){for(var r=this.events||[],i=r.length;i--;)r[i].name!=e||!n.is(t,"undefined")&&r[i].f!=t||(r[i].unbind(),r.splice(i,1),!r.length&&delete this.events);return this}}(B[Zt]);Yt.data=function(e,r){var i=lt[this.id]=lt[this.id]||{};if(0==arguments.length)return i;if(1==arguments.length){if(n.is(e,"object")){for(var s in e)e[N](s)&&this.data(s,e[s]);return this}return t("raphael.data.get."+this.id,this,i[e],e),i[e]}return i[e]=r,t("raphael.data.set."+this.id,this,r,e),this},Yt.removeData=function(e){return null==e?lt[this.id]={}:lt[this.id]&&delete lt[this.id][e],this},Yt.getData=function(){return r(lt[this.id]||{})},Yt.hover=function(e,t,n,r){return this.mouseover(e,n).mouseout(t,r||n)},Yt.unhover=function(e,t){return this.unmouseover(e).unmouseout(t)};var en=[];Yt.drag=function(e,r,i,s,o,u){function a(a){(a.originalEvent||a).preventDefault();var f=a.clientX,l=a.clientY,c=C.doc.documentElement.scrollTop||C.doc.body.scrollTop,h=C.doc.documentElement.scrollLeft||C.doc.body.scrollLeft;if(this._drag.id=a.identifier,M&&a.touches)for(var p,d=a.touches.length;d--;)if(p=a.touches[d],this._drag.id=p.identifier,p.identifier==this._drag.id){f=p.clientX,l=p.clientY;break}this._drag.x=f+h,this._drag.y=l+c,!Kt.length&&n.mousemove(Qt).mouseup(Gt),Kt.push({el:this,move_scope:s,start_scope:o,end_scope:u}),r&&t.on("raphael.drag.start."+this.id,r),e&&t.on("raphael.drag.move."+this.id,e),i&&t.on("raphael.drag.end."+this.id,i),t("raphael.drag.start."+this.id,o||s||this,a.clientX+h,a.clientY+c,a)}return this._drag={},en.push({el:this,start:a}),this.mousedown(a),this},Yt.onDragOver=function(e){e?t.on("raphael.drag.over."+this.id,e):t.unbind("raphael.drag.over."+this.id)},Yt.undrag=function(){for(var e=en.length;e--;)en[e].el==this&&(this.unmousedown(en[e].start),en.splice(e,1),t.unbind("raphael.drag.*."+this.id));!en.length&&n.unmousemove(Qt).unmouseup(Gt),Kt=[]},E.circle=function(e,t,r){var i=n._engine.circle(this,e||0,t||0,r||0);return this.__set__&&this.__set__.push(i),i},E.rect=function(e,t,r,i,s){var o=n._engine.rect(this,e||0,t||0,r||0,i||0,s||0);return this.__set__&&this.__set__.push(o),o},E.ellipse=function(e,t,r,i){var s=n._engine.ellipse(this,e||0,t||0,r||0,i||0);return this.__set__&&this.__set__.push(s),s},E.path=function(e){e&&!n.is(e,V)&&!n.is(e[0],$)&&(e+=_);var t=n._engine.path(n.format[A](n,arguments),this);return this.__set__&&this.__set__.push(t),t},E.image=function(e,t,r,i,s){var o=n._engine.image(this,e||"about:blank",t||0,r||0,i||0,s||0);return this.__set__&&this.__set__.push(o),o},E.text=function(e,t,r){var i=n._engine.text(this,e||0,t||0,P(r));return this.__set__&&this.__set__.push(i),i},E.set=function(e){!n.is(e,"array")&&(e=Array.prototype.splice.call(arguments,0,arguments.length));var t=new pn(e);return this.__set__&&this.__set__.push(t),t.paper=this,t.type="set",t},E.setStart=function(e){this.__set__=e||this.set()},E.setFinish=function(){var e=this.__set__;return delete this.__set__,e},E.setSize=function(e,t){return n._engine.setSize.call(this,e,t)},E.setViewBox=function(e,t,r,i,s){return n._engine.setViewBox.call(this,e,t,r,i,s)},E.top=E.bottom=null,E.raphael=n;var tn=function(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.body,i=n.documentElement,s=i.clientTop||r.clientTop||0,o=i.clientLeft||r.clientLeft||0,u=t.top+(C.win.pageYOffset||i.scrollTop||r.scrollTop)-s,a=t.left+(C.win.pageXOffset||i.scrollLeft||r.scrollLeft)-o;return{y:u,x:a}};E.getElementByPoint=function(e,t){var n=this,r=n.canvas,i=C.doc.elementFromPoint(e,t);if(C.win.opera&&"svg"==i.tagName){var s=tn(r),o=r.createSVGRect();o.x=e-s.x,o.y=t-s.y,o.width=o.height=1;var u=r.getIntersectionList(o,null);u.length&&(i=u[u.length-1])}if(!i)return null;for(;i.parentNode&&i!=r.parentNode&&!i.raphael;)i=i.parentNode;return i==n.canvas.parentNode&&(i=r),i=i&&i.raphael?n.getById(i.raphaelid):null},E.getElementsByBBox=function(e){var t=this.set();return this.forEach(function(r){n.isBBoxIntersect(r.getBBox(),e)&&t.push(r)}),t},E.getById=function(e){for(var t=this.bottom;t;){if(t.id==e)return t;t=t.next}return null},E.forEach=function(e,t){for(var n=this.bottom;n;){if(e.call(t,n)===!1)return this;n=n.next}return this},E.getElementsByPoint=function(e,t){var n=this.set();return this.forEach(function(r){r.isPointInside(e,t)&&n.push(r)}),n},Yt.isPointInside=function(e,t){var r=this.realPath=mt[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(r=n.transformPath(r,this.attr("transform"))),n.isPointInsidePath(r,e,t)},Yt.getBBox=function(e){if(this.removed)return{};var t=this._;return e?((t.dirty||!t.bboxwt)&&(this.realPath=mt[this.type](this),t.bboxwt=kt(this.realPath),t.bboxwt.toString=v,t.dirty=0),t.bboxwt):((t.dirty||t.dirtyT||!t.bbox)&&((t.dirty||!this.realPath)&&(t.bboxwt=0,this.realPath=mt[this.type](this)),t.bbox=kt(gt(this.realPath,this.matrix)),t.bbox.toString=v,t.dirty=t.dirtyT=0),t.bbox)},Yt.clone=function(){if(this.removed)return null;var e=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(e),e},Yt.glow=function(e){if("text"==this.type)return null;e=e||{};var t={width:(e.width||10)+(+this.attr("stroke-width")||1),fill:e.fill||!1,opacity:e.opacity||.5,offsetx:e.offsetx||0,offsety:e.offsety||0,color:e.color||"#000"},n=t.width/2,r=this.paper,i=r.set(),s=this.realPath||mt[this.type](this);s=this.matrix?gt(s,this.matrix):s;for(var o=1;n+1>o;o++)i.push(r.path(s).attr({stroke:t.color,fill:t.fill?t.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(t.width/n*o).toFixed(3),opacity:+(t.opacity/n).toFixed(3)}));return i.insertBefore(this).translate(t.offsetx,t.offsety)};var nn=function(e,t,r,i,s,o,u,a,c){return null==c?f(e,t,r,i,s,o,u,a):n.findDotsAtSegment(e,t,r,i,s,o,u,a,l(e,t,r,i,s,o,u,a,c))},rn=function(e,t){return function(r,i,s){r=Bt(r);for(var o,u,a,f,l,c="",h={},p=0,d=0,v=r.length;v>d;d++){if(a=r[d],"M"==a[0])o=+a[1],u=+a[2];else{if(f=nn(o,u,a[1],a[2],a[3],a[4],a[5],a[6]),p+f>i){if(t&&!h.start){if(l=nn(o,u,a[1],a[2],a[3],a[4],a[5],a[6],i-p),c+=["C"+l.start.x,l.start.y,l.m.x,l.m.y,l.x,l.y],s)return c;h.start=c,c=["M"+l.x,l.y+"C"+l.n.x,l.n.y,l.end.x,l.end.y,a[5],a[6]].join(),p+=f,o=+a[5],u=+a[6];continue}if(!e&&!t)return l=nn(o,u,a[1],a[2],a[3],a[4],a[5],a[6],i-p),{x:l.x,y:l.y,alpha:l.alpha}}p+=f,o=+a[5],u=+a[6]}c+=a.shift()+a}return h.end=c,l=e?p:t?h:n.findDotsAtSegment(o,u,a[0],a[1],a[2],a[3],a[4],a[5],1),l.alpha&&(l={x:l.x,y:l.y,alpha:l.alpha}),l}},sn=rn(1),on=rn(),un=rn(0,1);n.getTotalLength=sn,n.getPointAtLength=on,n.getSubpath=function(e,t,n){if(this.getTotalLength(e)-n<1e-6)return un(e,t).end;var r=un(e,n,1);return t?un(r,t).end:r},Yt.getTotalLength=function(){var e=this.getPath();if(e)return this.node.getTotalLength?this.node.getTotalLength():sn(e)},Yt.getPointAtLength=function(e){var t=this.getPath();if(t)return on(t,e)},Yt.getPath=function(){var e,t=n._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return t&&(e=t(this)),e},Yt.getSubpath=function(e,t){var r=this.getPath();if(r)return n.getSubpath(r,e,t)};var an=n.easing_formulas={linear:function(e){return e},"<":function(e){return z(e,1.7)},">":function(e){return z(e,.48)},"<>":function(e){var t=.48-e/1.04,n=I.sqrt(.1734+t*t),r=n-t,i=z(U(r),1/3)*(0>r?-1:1),s=-n-t,o=z(U(s),1/3)*(0>s?-1:1),u=i+o+.5;return 3*(1-u)*u*u+u*u*u},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){e-=1;var t=1.70158;return e*e*((t+1)*e+t)+1},elastic:function(e){return e==!!e?e:z(2,-10*e)*I.sin((e-.075)*2*W/.3)+1},bounce:function(e){var t,n=7.5625,r=2.75;return 1/r>e?t=n*e*e:2/r>e?(e-=1.5/r,t=n*e*e+.75):2.5/r>e?(e-=2.25/r,t=n*e*e+.9375):(e-=2.625/r,t=n*e*e+.984375),t}};an.easeIn=an["ease-in"]=an["<"],an.easeOut=an["ease-out"]=an[">"],an.easeInOut=an["ease-in-out"]=an["<>"],an["back-in"]=an.backIn,an["back-out"]=an.backOut;var fn=[],ln=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){setTimeout(e,16)},cn=function(){for(var e=+(new Date),r=0;r<fn.length;r++){var i=fn[r];if(!i.el.removed&&!i.paused){var s,o,u=e-i.start,a=i.ms,f=i.easing,l=i.from,c=i.diff,h=i.to,p=(i.t,i.el),d={},v={};if(i.initstatus?(u=(i.initstatus*i.anim.top-i.prev)/(i.percent-i.prev)*a,i.status=i.initstatus,delete i.initstatus,i.stop&&fn.splice(r--,1)):i.status=(i.prev+(i.percent-i.prev)*(u/a))/i.anim.top,!(0>u))if(a>u){var m=f(u/a);for(var g in l)if(l[N](g)){switch(rt[g]){case X:s=+l[g]+m*a*c[g];break;case"colour":s="rgb("+[hn(Y(l[g].r+m*a*c[g].r)),hn(Y(l[g].g+m*a*c[g].g)),hn(Y(l[g].b+m*a*c[g].b))].join(",")+")";break;case"path":s=[];for(var b=0,w=l[g].length;w>b;b++){s[b]=[l[g][b][0]];for(var E=1,S=l[g][b].length;S>E;E++)s[b][E]=+l[g][b][E]+m*a*c[g][b][E];s[b]=s[b].join(D)}s=s.join(D);break;case"transform":if(c[g].real)for(s=[],b=0,w=l[g].length;w>b;b++)for(s[b]=[l[g][b][0]],E=1,S=l[g][b].length;S>E;E++)s[b][E]=l[g][b][E]+m*a*c[g][b][E];else{var x=function(e){return+l[g][e]+m*a*c[g][e]};s=[["m",x(0),x(1),x(2),x(3),x(4),x(5)]]}break;case"csv":if("clip-rect"==g)for(s=[],b=4;b--;)s[b]=+l[g][b]+m*a*c[g][b];break;default:var T=[][O](l[g]);for(s=[],b=p.paper.customAttributes[g].length;b--;)s[b]=+T[b]+m*a*c[g][b]}d[g]=s}p.attr(d),function(e,n,r){setTimeout(function(){t("raphael.anim.frame."+e,n,r)})}(p.id,p,i.anim)}else{if(function(e,r,i){setTimeout(function(){t("raphael.anim.frame."+r.id,r,i),t("raphael.anim.finish."+r.id,r,i),n.is(e,"function")&&e.call(r)})}(i.callback,p,i.anim),p.attr(h),fn.splice(r--,1),i.repeat>1&&!i.next){for(o in h)h[N](o)&&(v[o]=i.totalOrigin[o]);i.el.attr(v),y(i.anim,i.el,i.anim.percents[0],null,i.totalOrigin,i.repeat-1)}i.next&&!i.stop&&y(i.anim,i.el,i.next,null,i.totalOrigin,i.repeat)}}}n.svg&&p&&p.paper&&p.paper.safari(),fn.length&&ln(cn)},hn=function(e){return e>255?255:0>e?0:e};Yt.animateWith=function(e,t,r,i,s,o){var u=this;if(u.removed)return o&&o.call(u),u;var a=r instanceof g?r:n.animation(r,i,s,o);y(a,u,a.percents[0],null,u.attr());for(var f=0,l=fn.length;l>f;f++)if(fn[f].anim==t&&fn[f].el==e){fn[l-1].start=fn[f].start;break}return u},Yt.onAnimation=function(e){return e?t.on("raphael.anim.frame."+this.id,e):t.unbind("raphael.anim.frame."+this.id),this},g.prototype.delay=function(e){var t=new g(this.anim,this.ms);return t.times=this.times,t.del=+e||0,t},g.prototype.repeat=function(e){var t=new g(this.anim,this.ms);return t.del=this.del,t.times=I.floor(q(e,0))||1,t},n.animation=function(e,t,r,i){if(e instanceof g)return e;(n.is(r,"function")||!r)&&(i=i||r||null,r=null),e=Object(e),t=+t||0;var s,o,u={};for(o in e)e[N](o)&&Z(o)!=o&&Z(o)+"%"!=o&&(s=!0,u[o]=e[o]);return s?(r&&(u.easing=r),i&&(u.callback=i),new g({100:u},t)):new g(e,t)},Yt.animate=function(e,t,r,i){var s=this;if(s.removed)return i&&i.call(s),s;var o=e instanceof g?e:n.animation(e,t,r,i);return y(o,s,o.percents[0],null,s.attr()),s},Yt.setTime=function(e,t){return e&&null!=t&&this.status(e,R(t,e.ms)/e.ms),this},Yt.status=function(e,t){var n,r,i=[],s=0;if(null!=t)return y(e,this,-1,R(t,1)),this;for(n=fn.length;n>s;s++)if(r=fn[s],r.el.id==this.id&&(!e||r.anim==e)){if(e)return r.status;i.push({anim:r.anim,status:r.status})}return e?0:i},Yt.pause=function(e){for(var n=0;n<fn.length;n++)fn[n].el.id!=this.id||e&&fn[n].anim!=e||t("raphael.anim.pause."+this.id,this,fn[n].anim)!==!1&&(fn[n].paused=!0);return this},Yt.resume=function(e){for(var n=0;n<fn.length;n++)if(fn[n].el.id==this.id&&(!e||fn[n].anim==e)){var r=fn[n];t("raphael.anim.resume."+this.id,this,r.anim)!==!1&&(delete r.paused,this.status(r.anim,r.status))}return this},Yt.stop=function(e){for(var n=0;n<fn.length;n++)fn[n].el.id!=this.id||e&&fn[n].anim!=e||t("raphael.anim.stop."+this.id,this,fn[n].anim)!==!1&&fn.splice(n--,1);return this},t.on("raphael.remove",b),t.on("raphael.clear",b),Yt.toString=function(){return"Raphaël’s object"};var pn=function(e){if(this.items=[],this.length=0,this.type="set",e)for(var t=0,n=e.length;n>t;t++)!e[t]||e[t].constructor!=Yt.constructor&&e[t].constructor!=pn||(this[this.items.length]=this.items[this.items.length]=e[t],this.length++)},dn=pn.prototype;dn.push=function(){for(var e,t,n=0,r=arguments.length;r>n;n++)e=arguments[n],!e||e.constructor!=Yt.constructor&&e.constructor!=pn||(t=this.items.length,this[t]=this.items[t]=e,this.length++);return this},dn.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},dn.forEach=function(e,t){for(var n=0,r=this.items.length;r>n;n++)if(e.call(t,this.items[n],n)===!1)return this;return this};for(var vn in Yt)Yt[N](vn)&&(dn[vn]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e][A](n,t)})}}(vn));return dn.attr=function(e,t){if(e&&n.is(e,$)&&n.is(e[0],"object"))for(var r=0,i=e.length;i>r;r++)this.items[r].attr(e[r]);else for(var s=0,o=this.items.length;o>s;s++)this.items[s].attr(e,t);return this},dn.clear=function(){for(;this.length;)this.pop()},dn.splice=function(e,t){e=0>e?q(this.length+e,0):e,t=q(0,R(this.length-e,t));var n,r=[],i=[],s=[];for(n=2;n<arguments.length;n++)s.push(arguments[n]);for(n=0;t>n;n++)i.push(this[e+n]);for(;n<this.length-e;n++)r.push(this[e+n]);var o=s.length;for(n=0;n<o+r.length;n++)this.items[e+n]=this[e+n]=o>n?s[n]:r[n-o];for(n=this.items.length=this.length-=t-o;this[n];)delete this[n++];return new pn(i)},dn.exclude=function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]==e)return this.splice(t,1),!0},dn.animate=function(e,t,r,i){(n.is(r,"function")||!r)&&(i=r||null);var s,o,u=this.items.length,a=u,f=this;if(!u)return this;i&&(o=function(){!--u&&i.call(f)}),r=n.is(r,V)?r:o;var l=n.animation(e,t,r,o);for(s=this.items[--a].animate(l);a--;)this.items[a]&&!this.items[a].removed&&this.items[a].animateWith(s,l,l),this.items[a]&&!this.items[a].removed||u--;return this},dn.insertAfter=function(e){for(var t=this.items.length;t--;)this.items[t].insertAfter(e);return this},dn.getBBox=function(){for(var e=[],t=[],n=[],r=[],i=this.items.length;i--;)if(!this.items[i].removed){var s=this.items[i].getBBox();e.push(s.x),t.push(s.y),n.push(s.x+s.width),r.push(s.y+s.height)}return e=R[A](0,e),t=R[A](0,t),n=q[A](0,n),r=q[A](0,r),{x:e,y:t,x2:n,y2:r,width:n-e,height:r-t}},dn.clone=function(e){e=this.paper.set();for(var t=0,n=this.items.length;n>t;t++)e.push(this.items[t].clone());return e},dn.toString=function(){return"Raphaël‘s set"},dn.glow=function(e){var t=this.paper.set();return this.forEach(function(n){var r=n.glow(e);null!=r&&r.forEach(function(e){t.push(e)})}),t},dn.isPointInside=function(e,t){var n=!1;return this.forEach(function(r){return r.isPointInside(e,t)?(console.log("runned"),n=!0,!1):void 0}),n},n.registerFont=function(e){if(!e.face)return e;this.fonts=this.fonts||{};var t={w:e.w,face:{},glyphs:{}},n=e.face["font-family"];for(var r in e.face)e.face[N](r)&&(t.face[r]=e.face[r]);if(this.fonts[n]?this.fonts[n].push(t):this.fonts[n]=[t],!e.svg){t.face["units-per-em"]=et(e.face["units-per-em"],10);for(var i in e.glyphs)if(e.glyphs[N](i)){var s=e.glyphs[i];if(t.glyphs[i]={w:s.w,k:{},d:s.d&&"M"+s.d.replace(/[mlcxtrv]/g,function(e){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[e]||"M"})+"z"},s.k)for(var o in s.k)s[N](o)&&(t.glyphs[i].k[o]=s.k[o])}}return e},E.getFont=function(e,t,r,i){if(i=i||"normal",r=r||"normal",t=+t||{normal:400,bold:700,lighter:300,bolder:800}[t]||400,n.fonts){var s=n.fonts[e];if(!s){var o=new RegExp("(^|\\s)"+e.replace(/[^\w\d\s+!~.:_-]/g,_)+"(\\s|$)","i");for(var u in n.fonts)if(n.fonts[N](u)&&o.test(u)){s=n.fonts[u];break}}var a;if(s)for(var f=0,l=s.length;l>f&&(a=s[f],a.face["font-weight"]!=t||a.face["font-style"]!=r&&a.face["font-style"]||a.face["font-stretch"]!=i);f++);return a}},E.print=function(e,t,r,i,s,o,u,a){o=o||"middle",u=q(R(u||0,1),-1),a=q(R(a||1,3),1);var f,l=P(r)[H](_),c=0,h=0,p=_;if(n.is(i,"string")&&(i=this.getFont(i)),i){f=(s||16)/i.face["units-per-em"];for(var d=i.face.bbox[H](S),v=+d[0],m=d[3]-d[1],g=0,y=+d[1]+("baseline"==o?m+ +i.face.descent:m/2),b=0,w=l.length;w>b;b++){if("\n"==l[b])c=0,x=0,h=0,g+=m*a;else{var E=h&&i.glyphs[l[b-1]]||{},x=i.glyphs[l[b]];c+=h?(E.w||i.w)+(E.k&&E.k[l[b]]||0)+i.w*u:0,h=1}x&&x.d&&(p+=n.transformPath(x.d,["t",c*f,g*f,"s",f,f,v,y,"t",(e-v)/f,(t-y)/f]))}}return this.path(p).attr({fill:"#000",stroke:"none"})},E.add=function(e){if(n.is(e,"array"))for(var t,r=this.set(),i=0,s=e.length;s>i;i++)t=e[i]||{},x[N](t.type)&&r.push(this[t.type]().attr(t));return r},n.format=function(e,t){var r=n.is(t,$)?[0][O](t):arguments;return e&&n.is(e,V)&&r.length-1&&(e=e.replace(T,function(e,t){return null==r[++t]?_:r[t]})),e||_},n.fullfill=function(){var e=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(e,n,r){var i=r;return n.replace(t,function(e,t,n,r,s){t=t||r,i&&(t in i&&(i=i[t]),"function"==typeof i&&s&&(i=i()))}),i=(null==i||i==r?e:i)+""};return function(t,r){return String(t).replace(e,function(e,t){return n(e,t,r)})}}(),n.ninja=function(){return k.was?C.win.Raphael=k.is:delete Raphael,n},n.st=dn,function(e,t,r){function i(){/in/.test(e.readyState)?setTimeout(i,9):n.eve("raphael.DOMload")}null==e.readyState&&e.addEventListener&&(e.addEventListener(t,r=function(){e.removeEventListener(t,r,!1),e.readyState="complete"},!1),e.readyState="loading"),i()}(document,"DOMContentLoaded"),t.on("raphael.DOMload",function(){w=!0}),function(){if(n.svg){var e="hasOwnProperty",t=String,r=parseFloat,i=parseInt,s=Math,o=s.max,u=s.abs,a=s.pow,f=/[, ]+/,l=n.eve,c="",h=" ",p="http://www.w3.org/1999/xlink",d={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},v={};n.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var m=function(r,i){if(i){"string"==typeof r&&(r=m(r));for(var s in i)i[e](s)&&("xlink:"==s.substring(0,6)?r.setAttributeNS(p,s.substring(6),t(i[s])):r.setAttribute(s,t(i[s])))}else r=n._g.doc.createElementNS("http://www.w3.org/2000/svg",r),r.style&&(r.style.webkitTapHighlightColor="rgba(0,0,0,0)");return r},g=function(e,i){var f="linear",l=e.id+i,h=.5,p=.5,d=e.node,v=e.paper,g=d.style,y=n._g.doc.getElementById(l);if(!y){if(i=t(i).replace(n._radial_gradient,function(e,t,n){if(f="radial",t&&n){h=r(t),p=r(n);var i=2*(p>.5)-1;a(h-.5,2)+a(p-.5,2)>.25&&(p=s.sqrt(.25-a(h-.5,2))*i+.5)&&.5!=p&&(p=p.toFixed(5)-1e-5*i)}return c}),i=i.split(/\s*\-\s*/),"linear"==f){var b=i.shift();if(b=-r(b),isNaN(b))return null;var w=[0,0,s.cos(n.rad(b)),s.sin(n.rad(b))],E=1/(o(u(w[2]),u(w[3]))||1);w[2]*=E,w[3]*=E,w[2]<0&&(w[0]=-w[2],w[2]=0),w[3]<0&&(w[1]=-w[3],w[3]=0)}var S=n._parseDots(i);if(!S)return null;if(l=l.replace(/[\(\)\s,\xb0#]/g,"_"),e.gradient&&l!=e.gradient.id&&(v.defs.removeChild(e.gradient),delete e.gradient),!e.gradient){y=m(f+"Gradient",{id:l}),e.gradient=y,m(y,"radial"==f?{fx:h,fy:p}:{x1:w[0],y1:w[1],x2:w[2],y2:w[3],gradientTransform:e.matrix.invert()}),v.defs.appendChild(y);for(var x=0,T=S.length;T>x;x++)y.appendChild(m("stop",{offset:S[x].offset?S[x].offset:x?"100%":"0%","stop-color":S[x].color||"#fff"}))}}return m(d,{fill:"url(#"+l+")",opacity:1,"fill-opacity":1}),g.fill=c,g.opacity=1,g.fillOpacity=1,1},y=function(e){var t=e.getBBox(1);m(e.pattern,{patternTransform:e.matrix.invert()+" translate("+t.x+","+t.y+")"})},b=function(r,i,s){if("path"==r.type){for(var o,u,a,f,l,h=t(i).toLowerCase().split("-"),p=r.paper,g=s?"end":"start",y=r.node,b=r.attrs,w=b["stroke-width"],E=h.length,S="classic",x=3,T=3,N=5;E--;)switch(h[E]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":S=h[E];break;case"wide":T=5;break;case"narrow":T=2;break;case"long":x=5;break;case"short":x=2}if("open"==S?(x+=2,T+=2,N+=2,a=1,f=s?4:1,l={fill:"none",stroke:b.stroke}):(f=a=x/2,l={fill:b.stroke,stroke:"none"}),r._.arrows?s?(r._.arrows.endPath&&v[r._.arrows.endPath]--,r._.arrows.endMarker&&v[r._.arrows.endMarker]--):(r._.arrows.startPath&&v[r._.arrows.startPath]--,r._.arrows.startMarker&&v[r._.arrows.startMarker]--):r._.arrows={},"none"!=S){var C="raphael-marker-"+S,k="raphael-marker-"+g+S+x+T;n._g.doc.getElementById(C)?v[C]++:(p.defs.appendChild(m(m("path"),{"stroke-linecap":"round",d:d[S],id:C})),v[C]=1);var L,A=n._g.doc.getElementById(k);A?(v[k]++,L=A.getElementsByTagName("use")[0]):(A=m(m("marker"),{id:k,markerHeight:T,markerWidth:x,orient:"auto",refX:f,refY:T/2}),L=m(m("use"),{"xlink:href":"#"+C,transform:(s?"rotate(180 "+x/2+" "+T/2+") ":c)+"scale("+x/N+","+T/N+")","stroke-width":(1/((x/N+T/N)/2)).toFixed(4)}),A.appendChild(L),p.defs.appendChild(A),v[k]=1),m(L,l);var O=a*("diamond"!=S&&"oval"!=S);s?(o=r._.arrows.startdx*w||0,u=n.getTotalLength(b.path)-O*w):(o=O*w,u=n.getTotalLength(b.path)-(r._.arrows.enddx*w||0)),l={},l["marker-"+g]="url(#"+k+")",(u||o)&&(l.d=n.getSubpath(b.path,o,u)),m(y,l),r._.arrows[g+"Path"]=C,r._.arrows[g+"Marker"]=k,r._.arrows[g+"dx"]=O,r._.arrows[g+"Type"]=S,r._.arrows[g+"String"]=i}else s?(o=r._.arrows.startdx*w||0,u=n.getTotalLength(b.path)-o):(o=0,u=n.getTotalLength(b.path)-(r._.arrows.enddx*w||0)),r._.arrows[g+"Path"]&&m(y,{d:n.getSubpath(b.path,o,u)}),delete r._.arrows[g+"Path"],delete r._.arrows[g+"Marker"],delete r._.arrows[g+"dx"],delete r._.arrows[g+"Type"],delete r._.arrows[g+"String"];for(l in v)if(v[e](l)&&!v[l]){var M=n._g.doc.getElementById(l);M&&M.parentNode.removeChild(M)}}},w={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},E=function(e,n,r){if(n=w[t(n).toLowerCase()]){for(var i=e.attrs["stroke-width"]||"1",s={round:i,square:i,butt:0}[e.attrs["stroke-linecap"]||r["stroke-linecap"]]||0,o=[],u=n.length;u--;)o[u]=n[u]*i+(u%2?1:-1)*s;m(e.node,{"stroke-dasharray":o.join(",")})}},S=function(r,s){var a=r.node,l=r.attrs,h=a.style.visibility;a.style.visibility="hidden";for(var d in s)if(s[e](d)){if(!n._availableAttrs[e](d))continue;var v=s[d];switch(l[d]=v,d){case"blur":r.blur(v);break;case"href":case"title":var w=m("title"),S=n._g.doc.createTextNode(v);w.appendChild(S),a.appendChild(w);break;case"target":var x=a.parentNode;if("a"!=x.tagName.toLowerCase()){var w=m("a");x.insertBefore(w,a),w.appendChild(a),x=w}"target"==d?x.setAttributeNS(p,"show","blank"==v?"new":v):x.setAttributeNS(p,d,v);break;case"cursor":a.style.cursor=v;break;case"transform":r.transform(v);break;case"arrow-start":b(r,v);break;case"arrow-end":b(r,v,1);break;case"clip-rect":var N=t(v).split(f);if(4==N.length){r.clip&&r.clip.parentNode.parentNode.removeChild(r.clip.parentNode);var C=m("clipPath"),k=m("rect");C.id=n.createUUID(),m(k,{x:N[0],y:N[1],width:N[2],height:N[3]}),C.appendChild(k),r.paper.defs.appendChild(C),m(a,{"clip-path":"url(#"+C.id+")"}),r.clip=k}if(!v){var L=a.getAttribute("clip-path");if(L){var A=n._g.doc.getElementById(L.replace(/(^url\(#|\)$)/g,c));A&&A.parentNode.removeChild(A),m(a,{"clip-path":c}),delete r.clip}}break;case"path":"path"==r.type&&(m(a,{d:v?l.path=n._pathToAbsolute(v):"M0,0"}),r._.dirty=1,r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1)));break;case"width":if(a.setAttribute(d,v),r._.dirty=1,!l.fx)break;d="x",v=l.x;case"x":l.fx&&(v=-l.x-(l.width||0));case"rx":if("rx"==d&&"rect"==r.type)break;case"cx":a.setAttribute(d,v),r.pattern&&y(r),r._.dirty=1;break;case"height":if(a.setAttribute(d,v),r._.dirty=1,!l.fy)break;d="y",v=l.y;case"y":l.fy&&(v=-l.y-(l.height||0));case"ry":if("ry"==d&&"rect"==r.type)break;case"cy":a.setAttribute(d,v),r.pattern&&y(r),r._.dirty=1;break;case"r":"rect"==r.type?m(a,{rx:v,ry:v}):a.setAttribute(d,v),r._.dirty=1;break;case"src":"image"==r.type&&a.setAttributeNS(p,"href",v);break;case"stroke-width":(1!=r._.sx||1!=r._.sy)&&(v/=o(u(r._.sx),u(r._.sy))||1),r.paper._vbSize&&(v*=r.paper._vbSize),a.setAttribute(d,v),l["stroke-dasharray"]&&E(r,l["stroke-dasharray"],s),r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1));break;case"stroke-dasharray":E(r,v,s);break;case"fill":var O=t(v).match(n._ISURL);if(O){C=m("pattern");var M=m("image");C.id=n.createUUID(),m(C,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),m(M,{x:0,y:0,"xlink:href":O[1]}),C.appendChild(M),function(e){n._preload(O[1],function(){var t=this.offsetWidth,n=this.offsetHeight;m(e,{width:t,height:n}),m(M,{width:t,height:n}),r.paper.safari()})}(C),r.paper.defs.appendChild(C),m(a,{fill:"url(#"+C.id+")"}),r.pattern=C,r.pattern&&y(r);break}var _=n.getRGB(v);if(_.error){if(("circle"==r.type||"ellipse"==r.type||"r"!=t(v).charAt())&&g(r,v)){if("opacity"in l||"fill-opacity"in l){var D=n._g.doc.getElementById(a.getAttribute("fill").replace(/^url\(#|\)$/g,c));if(D){var P=D.getElementsByTagName("stop");m(P[P.length-1],{"stop-opacity":("opacity"in l?l.opacity:1)*("fill-opacity"in l?l["fill-opacity"]:1)})}}l.gradient=v,l.fill="none";break}}else delete s.gradient,delete l.gradient,!n.is(l.opacity,"undefined")&&n.is(s.opacity,"undefined")&&m(a,{opacity:l.opacity}),!n.is(l["fill-opacity"],"undefined")&&n.is(s["fill-opacity"],"undefined")&&m(a,{"fill-opacity":l["fill-opacity"]});_[e]("opacity")&&m(a,{"fill-opacity":_.opacity>1?_.opacity/100:_.opacity});case"stroke":_=n.getRGB(v),a.setAttribute(d,_.hex),"stroke"==d&&_[e]("opacity")&&m(a,{"stroke-opacity":_.opacity>1?_.opacity/100:_.opacity}),"stroke"==d&&r._.arrows&&("startString"in r._.arrows&&b(r,r._.arrows.startString),"endString"in r._.arrows&&b(r,r._.arrows.endString,1));break;case"gradient":("circle"==r.type||"ellipse"==r.type||"r"!=t(v).charAt())&&g(r,v);break;case"opacity":l.gradient&&!l[e]("stroke-opacity")&&m(a,{"stroke-opacity":v>1?v/100:v});case"fill-opacity":if(l.gradient){D=n._g.doc.getElementById(a.getAttribute("fill").replace(/^url\(#|\)$/g,c)),D&&(P=D.getElementsByTagName("stop"),m(P[P.length-1],{"stop-opacity":v}));break};default:"font-size"==d&&(v=i(v,10)+"px");var H=d.replace(/(\-.)/g,function(e){return e.substring(1).toUpperCase()});a.style[H]=v,r._.dirty=1,a.setAttribute(d,v)}}T(r,s),a.style.visibility=h},x=1.2,T=function(r,s){if("text"==r.type&&(s[e]("text")||s[e]("font")||s[e]("font-size")||s[e]("x")||s[e]("y"))){var o=r.attrs,u=r.node,a=u.firstChild?i(n._g.doc.defaultView.getComputedStyle(u.firstChild,c).getPropertyValue("font-size"),10):10;if(s[e]("text")){for(o.text=s.text;u.firstChild;)u.removeChild(u.firstChild);for(var f,l=t(s.text).split("\n"),h=[],p=0,d=l.length;d>p;p++)f=m("tspan"),p&&m(f,{dy:a*x,x:o.x}),f.appendChild(n._g.doc.createTextNode(l[p])),u.appendChild(f),h[p]=f}else for(h=u.getElementsByTagName("tspan"),p=0,d=h.length;d>p;p++)p?m(h[p],{dy:a*x,x:o.x}):m(h[0],{dy:0});m(u,{x:o.x,y:o.y}),r._.dirty=1;var v=r._getBBox(),g=o.y-(v.y+v.height/2);g&&n.is(g,"finite")&&m(h[0],{dy:g})}},N=function(e,t){this[0]=this.node=e,e.raphael=!0,this.id=n._oid++,e.raphaelid=this.id,this.matrix=n.matrix(),this.realPath=null,this.paper=t,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!t.bottom&&(t.bottom=this),this.prev=t.top,t.top&&(t.top.next=this),t.top=this,this.next=null},C=n.el;N.prototype=C,C.constructor=N,n._engine.path=function(e,t){var n=m("path");t.canvas&&t.canvas.appendChild(n);var r=new N(n,t);return r.type="path",S(r,{fill:"none",stroke:"#000",path:e}),r},C.rotate=function(e,n,i){if(this.removed)return this;if(e=t(e).split(f),e.length-1&&(n=r(e[1]),i=r(e[2])),e=r(e[0]),null==i&&(n=i),null==n||null==i){var s=this.getBBox(1);n=s.x+s.width/2,i=s.y+s.height/2}return this.transform(this._.transform.concat([["r",e,n,i]])),this},C.scale=function(e,n,i,s){if(this.removed)return this;if(e=t(e).split(f),e.length-1&&(n=r(e[1]),i=r(e[2]),s=r(e[3])),e=r(e[0]),null==n&&(n=e),null==s&&(i=s),null==i||null==s)var o=this.getBBox(1);return i=null==i?o.x+o.width/2:i,s=null==s?o.y+o.height/2:s,this.transform(this._.transform.concat([["s",e,n,i,s]])),this},C.translate=function(e,n){return this.removed?this:(e=t(e).split(f),e.length-1&&(n=r(e[1])),e=r(e[0])||0,n=+n||0,this.transform(this._.transform.concat([["t",e,n]])),this)},C.transform=function(t){var r=this._;if(null==t)return r.transform;if(n._extractTransform(this,t),this.clip&&m(this.clip,{transform:this.matrix.invert()}),this.pattern&&y(this),this.node&&m(this.node,{transform:this.matrix}),1!=r.sx||1!=r.sy){var i=this.attrs[e]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":i})}return this},C.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},C.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},C.remove=function(){if(!this.removed&&this.node.parentNode){var e=this.paper;e.__set__&&e.__set__.exclude(this),l.unbind("raphael.*.*."+this.id),this.gradient&&e.defs.removeChild(this.gradient),n._tear(this,e),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var t in this)this[t]="function"==typeof this[t]?n._removedFactory(t):null;this.removed=!0}},C._getBBox=function(){if("none"==this.node.style.display){this.show();var e=!0}var t={};try{t=this.node.getBBox()}catch(n){}finally{t=t||{}}return e&&this.hide(),t},C.attr=function(t,r){if(this.removed)return this;if(null==t){var i={};for(var s in this.attrs)this.attrs[e](s)&&(i[s]=this.attrs[s]);return i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(null==r&&n.is(t,"string")){if("fill"==t&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==t)return this._.transform;for(var o=t.split(f),u={},a=0,c=o.length;c>a;a++)t=o[a],u[t]=t in this.attrs?this.attrs[t]:n.is(this.paper.customAttributes[t],"function")?this.paper.customAttributes[t].def:n._availableAttrs[t];return c-1?u:u[o[0]]}if(null==r&&n.is(t,"array")){for(u={},a=0,c=t.length;c>a;a++)u[t[a]]=this.attr(t[a]);return u}if(null!=r){var h={};h[t]=r}else null!=t&&n.is(t,"object")&&(h=t);for(var p in h)l("raphael.attr."+p+"."+this.id,this,h[p]);for(p in this.paper.customAttributes)if(this.paper.customAttributes[e](p)&&h[e](p)&&n.is(this.paper.customAttributes[p],"function")){var d=this.paper.customAttributes[p].apply(this,[].concat(h[p]));this.attrs[p]=h[p];for(var v in d)d[e](v)&&(h[v]=d[v])}return S(this,h),this},C.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var e=this.paper;return e.top!=this&&n._tofront(this,e),this},C.toBack=function(){if(this.removed)return this;var e=this.node.parentNode;return"a"==e.tagName.toLowerCase()?e.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):e.firstChild!=this.node&&e.insertBefore(this.node,this.node.parentNode.firstChild),n._toback(this,this.paper),this.paper,this},C.insertAfter=function(e){if(this.removed)return this;var t=e.node||e[e.length-1].node;return t.nextSibling?t.parentNode.insertBefore(this.node,t.nextSibling):t.parentNode.appendChild(this.node),n._insertafter(this,e,this.paper),this},C.insertBefore=function(e){if(this.removed)return this;var t=e.node||e[0].node;return t.parentNode.insertBefore(this.node,t),n._insertbefore(this,e,this.paper),this},C.blur=function(e){var t=this;if(0!==+e){var r=m("filter"),i=m("feGaussianBlur");t.attrs.blur=e,r.id=n.createUUID(),m(i,{stdDeviation:+e||1.5}),r.appendChild(i),t.paper.defs.appendChild(r),t._blur=r,m(t.node,{filter:"url(#"+r.id+")"})}else t._blur&&(t._blur.parentNode.removeChild(t._blur),delete t._blur,delete t.attrs.blur),t.node.removeAttribute("filter");return t},n._engine.circle=function(e,t,n,r){var i=m("circle");e.canvas&&e.canvas.appendChild(i);var s=new N(i,e);return s.attrs={cx:t,cy:n,r:r,fill:"none",stroke:"#000"},s.type="circle",m(i,s.attrs),s},n._engine.rect=function(e,t,n,r,i,s){var o=m("rect");e.canvas&&e.canvas.appendChild(o);var u=new N(o,e);return u.attrs={x:t,y:n,width:r,height:i,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},u.type="rect",m(o,u.attrs),u},n._engine.ellipse=function(e,t,n,r,i){var s=m("ellipse");e.canvas&&e.canvas.appendChild(s);var o=new N(s,e);return o.attrs={cx:t,cy:n,rx:r,ry:i,fill:"none",stroke:"#000"},o.type="ellipse",m(s,o.attrs),o},n._engine.image=function(e,t,n,r,i,s){var o=m("image");m(o,{x:n,y:r,width:i,height:s,preserveAspectRatio:"none"}),o.setAttributeNS(p,"href",t),e.canvas&&e.canvas.appendChild(o);var u=new N(o,e);return u.attrs={x:n,y:r,width:i,height:s,src:t},u.type="image",u},n._engine.text=function(e,t,r,i){var s=m("text");e.canvas&&e.canvas.appendChild(s);var o=new N(s,e);return o.attrs={x:t,y:r,"text-anchor":"middle",text:i,font:n._availableAttrs.font,stroke:"none",fill:"#000"},o.type="text",S(o,o.attrs),o},n._engine.setSize=function(e,t){return this.width=e||this.width,this.height=t||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},n._engine.create=function(){var e=n._getContainer.apply(0,arguments),t=e&&e.container,r=e.x,i=e.y,s=e.width,o=e.height;if(!t)throw new Error("SVG container not found.");var u,a=m("svg"),f="overflow:hidden;";return r=r||0,i=i||0,s=s||512,o=o||342,m(a,{height:o,version:1.1,width:s,xmlns:"http://www.w3.org/2000/svg"}),1==t?(a.style.cssText=f+"position:absolute;left:"+r+"px;top:"+i+"px",n._g.doc.body.appendChild(a),u=1):(a.style.cssText=f+"position:relative",t.firstChild?t.insertBefore(a,t.firstChild):t.appendChild(a)),t=new n._Paper,t.width=s,t.height=o,t.canvas=a,t.clear(),t._left=t._top=0,u&&(t.renderfix=function(){}),t.renderfix(),t},n._engine.setViewBox=function(e,t,n,r,i){l("raphael.setViewBox",this,this._viewBox,[e,t,n,r,i]);var s,u,a=o(n/this.width,r/this.height),f=this.top,c=i?"meet":"xMinYMin";for(null==e?(this._vbSize&&(a=1),delete this._vbSize,s="0 0 "+this.width+h+this.height):(this._vbSize=a,s=e+h+t+h+n+h+r),m(this.canvas,{viewBox:s,preserveAspectRatio:c});a&&f;)u="stroke-width"in f.attrs?f.attrs["stroke-width"]:1,f.attr({"stroke-width":u}),f._.dirty=1,f._.dirtyT=1,f=f.prev;return this._viewBox=[e,t,n,r,!!i],this},n.prototype.renderfix=function(){var e,t=this.canvas,n=t.style;try{e=t.getScreenCTM()||t.createSVGMatrix()}catch(r){e=t.createSVGMatrix()}var i=-e.e%1,s=-e.f%1;(i||s)&&(i&&(this._left=(this._left+i)%1,n.left=this._left+"px"),s&&(this._top=(this._top+s)%1,n.top=this._top+"px"))},n.prototype.clear=function(){n.eve("raphael.clear",this);for(var e=this.canvas;e.firstChild;)e.removeChild(e.firstChild);this.bottom=this.top=null,(this.desc=m("desc")).appendChild(n._g.doc.createTextNode("Created with Raphaël "+n.version)),e.appendChild(this.desc),e.appendChild(this.defs=m("defs"))},n.prototype.remove=function(){l("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?n._removedFactory(e):null};var k=n.st;for(var L in C)C[e](L)&&!k[e](L)&&(k[L]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e].apply(n,t)})}}(L))}}(),function(){if(n.vml){var e="hasOwnProperty",t=String,r=parseFloat,i=Math,s=i.round,o=i.max,u=i.min,a=i.abs,f="fill",l=/[, ]+/,c=n.eve,h=" progid:DXImageTransform.Microsoft",p=" ",d="",v={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},m=/([clmz]),?([^clmz]*)/gi,g=/ progid:\S+Blur\([^\)]+\)/g,y=/-?[^,\s-]+/g,b="position:absolute;left:0;top:0;width:1px;height:1px",w=21600,E={path:1,rect:1,image:1},S={circle:1,ellipse:1},x=function(e){var r=/[ahqstv]/gi,i=n._pathToAbsolute;if(t(e).match(r)&&(i=n._path2curve),r=/[clmz]/g,i==n._pathToAbsolute&&!t(e).match(r)){var o=t(e).replace(m,function(e,t,n){var r=[],i="m"==t.toLowerCase(),o=v[t];return n.replace(y,function(e){i&&2==r.length&&(o+=r+v["m"==t?"l":"L"],r=[]),r.push(s(e*w))}),o+r});return o}var u,a,f=i(e);o=[];for(var l=0,c=f.length;c>l;l++){u=f[l],a=f[l][0].toLowerCase(),"z"==a&&(a="x");for(var h=1,g=u.length;g>h;h++)a+=s(u[h]*w)+(h!=g-1?",":d);o.push(a)}return o.join(p)},T=function(e,t,r){var i=n.matrix();return i.rotate(-e,.5,.5),{dx:i.x(t,r),dy:i.y(t,r)}},N=function(e,t,n,r,i,s){var o=e._,u=e.matrix,l=o.fillpos,c=e.node,h=c.style,d=1,v="",m=w/t,g=w/n;if(h.visibility="hidden",t&&n){if(c.coordsize=a(m)+p+a(g),h.rotation=s*(0>t*n?-1:1),s){var y=T(s,r,i);r=y.dx,i=y.dy}if(0>t&&(v+="x"),0>n&&(v+=" y")&&(d=-1),h.flip=v,c.coordorigin=r*-m+p+i*-g,l||o.fillsize){var b=c.getElementsByTagName(f);b=b&&b[0],c.removeChild(b),l&&(y=T(s,u.x(l[0],l[1]),u.y(l[0],l[1])),b.position=y.dx*d+p+y.dy*d),o.fillsize&&(b.size=o.fillsize[0]*a(t)+p+o.fillsize[1]*a(n)),c.appendChild(b)}h.visibility="visible"}};n.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var C=function(e,n,r){for(var i=t(n).toLowerCase().split("-"),s=r?"end":"start",o=i.length,u="classic",a="medium",f="medium";o--;)switch(i[o]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":u=i[o];break;case"wide":case"narrow":f=i[o];break;case"long":case"short":a=i[o]}var l=e.node.getElementsByTagName("stroke")[0];l[s+"arrow"]=u,l[s+"arrowlength"]=a,l[s+"arrowwidth"]=f},k=function(i,a){i.attrs=i.attrs||{};var c=i.node,h=i.attrs,v=c.style,m=E[i.type]&&(a.x!=h.x||a.y!=h.y||a.width!=h.width||a.height!=h.height||a.cx!=h.cx||a.cy!=h.cy||a.rx!=h.rx||a.ry!=h.ry||a.r!=h.r),g=S[i.type]&&(h.cx!=a.cx||h.cy!=a.cy||h.r!=a.r||h.rx!=a.rx||h.ry!=a.ry),y=i;for(var b in a)a[e](b)&&(h[b]=a[b]);if(m&&(h.path=n._getPath[i.type](i),i._.dirty=1),a.href&&(c.href=a.href),a.title&&(c.title=a.title),a.target&&(c.target=a.target),a.cursor&&(v.cursor=a.cursor),"blur"in a&&i.blur(a.blur),(a.path&&"path"==i.type||m)&&(c.path=x(~t(h.path).toLowerCase().indexOf("r")?n._pathToAbsolute(h.path):h.path),"image"==i.type&&(i._.fillpos=[h.x,h.y],i._.fillsize=[h.width,h.height],N(i,1,1,0,0,0))),"transform"in a&&i.transform(a.transform),g){var T=+h.cx,k=+h.cy,A=+h.rx||+h.r||0,O=+h.ry||+h.r||0;c.path=n.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",s((T-A)*w),s((k-O)*w),s((T+A)*w),s((k+O)*w),s(T*w)),i._.dirty=1}if("clip-rect"in a){var _=t(a["clip-rect"]).split(l);if(4==_.length){_[2]=+_[2]+ +_[0],_[3]=+_[3]+ +_[1];var D=c.clipRect||n._g.doc.createElement("div"),P=D.style;P.clip=n.format("rect({1}px {2}px {3}px {0}px)",_),c.clipRect||(P.position="absolute",P.top=0,P.left=0,P.width=i.paper.width+"px",P.height=i.paper.height+"px",c.parentNode.insertBefore(D,c),D.appendChild(c),c.clipRect=D)}a["clip-rect"]||c.clipRect&&(c.clipRect.style.clip="auto")}if(i.textpath){var H=i.textpath.style;a.font&&(H.font=a.font),a["font-family"]&&(H.fontFamily='"'+a["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,d)+'"'),a["font-size"]&&(H.fontSize=a["font-size"]),a["font-weight"]&&(H.fontWeight=a["font-weight"]),a["font-style"]&&(H.fontStyle=a["font-style"])}if("arrow-start"in a&&C(y,a["arrow-start"]),"arrow-end"in a&&C(y,a["arrow-end"],1),null!=a.opacity||null!=a["stroke-width"]||null!=a.fill||null!=a.src||null!=a.stroke||null!=a["stroke-width"]||null!=a["stroke-opacity"]||null!=a["fill-opacity"]||null!=a["stroke-dasharray"]||null!=a["stroke-miterlimit"]||null!=a["stroke-linejoin"]||null!=a["stroke-linecap"]){var B=c.getElementsByTagName(f),j=!1;if(B=B&&B[0],!B&&(j=B=M(f)),"image"==i.type&&a.src&&(B.src=a.src),a.fill&&(B.on=!0),(null==B.on||"none"==a.fill||null===a.fill)&&(B.on=!1),B.on&&a.fill){var F=t(a.fill).match(n._ISURL);if(F){B.parentNode==c&&c.removeChild(B),B.rotate=!0,B.src=F[1],B.type="tile";var I=i.getBBox(1);B.position=I.x+p+I.y,i._.fillpos=[I.x,I.y],n._preload(F[1],function(){i._.fillsize=[this.offsetWidth,this.offsetHeight]})}else B.color=n.getRGB(a.fill).hex,B.src=d,B.type="solid",n.getRGB(a.fill).error&&(y.type in{circle:1,ellipse:1}||"r"!=t(a.fill).charAt())&&L(y,a.fill,B)&&(h.fill="none",h.gradient=a.fill,B.rotate=!1)}if("fill-opacity"in a||"opacity"in a){var q=((+h["fill-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+n.getRGB(a.fill).o+1||2)-1);q=u(o(q,0),1),B.opacity=q,B.src&&(B.color="none")}c.appendChild(B);var R=c.getElementsByTagName("stroke")&&c.getElementsByTagName("stroke")[0],U=!1;!R&&(U=R=M("stroke")),(a.stroke&&"none"!=a.stroke||a["stroke-width"]||null!=a["stroke-opacity"]||a["stroke-dasharray"]||a["stroke-miterlimit"]||a["stroke-linejoin"]||a["stroke-linecap"])&&(R.on=!0),("none"==a.stroke||null===a.stroke||null==R.on||0==a.stroke||0==a["stroke-width"])&&(R.on=!1);var z=n.getRGB(a.stroke);R.on&&a.stroke&&(R.color=z.hex),q=((+h["stroke-opacity"]+1||2)-1)*((+h.opacity+1||2)-1)*((+z.o+1||2)-1);var W=.75*(r(a["stroke-width"])||1);if(q=u(o(q,0),1),null==a["stroke-width"]&&(W=h["stroke-width"]),a["stroke-width"]&&(R.weight=W),W&&1>W&&(q*=W)&&(R.weight=1),R.opacity=q,a["stroke-linejoin"]&&(R.joinstyle=a["stroke-linejoin"]||"miter"),R.miterlimit=a["stroke-miterlimit"]||8,a["stroke-linecap"]&&(R.endcap="butt"==a["stroke-linecap"]?"flat":"square"==a["stroke-linecap"]?"square":"round"),a["stroke-dasharray"]){var X={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};R.dashstyle=X[e](a["stroke-dasharray"])?X[a["stroke-dasharray"]]:d}U&&c.appendChild(R)}if("text"==y.type){y.paper.canvas.style.display=d;var V=y.paper.span,$=100,J=h.font&&h.font.match(/\d+(?:\.\d*)?(?=px)/);v=V.style,h.font&&(v.font=h.font),h["font-family"]&&(v.fontFamily=h["font-family"]),h["font-weight"]&&(v.fontWeight=h["font-weight"]),h["font-style"]&&(v.fontStyle=h["font-style"]),J=r(h["font-size"]||J&&J[0])||10,v.fontSize=J*$+"px",y.textpath.string&&(V.innerHTML=t(y.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var K=V.getBoundingClientRect();y.W=h.w=(K.right-K.left)/$,y.H=h.h=(K.bottom-K.top)/$,y.X=h.x,y.Y=h.y+y.H/2,("x"in a||"y"in a)&&(y.path.v=n.format("m{0},{1}l{2},{1}",s(h.x*w),s(h.y*w),s(h.x*w)+1));for(var Q=["x","y","text","font","font-family","font-weight","font-style","font-size"],G=0,Y=Q.length;Y>G;G++)if(Q[G]in a){y._.dirty=1;break}switch(h["text-anchor"]){case"start":y.textpath.style["v-text-align"]="left",y.bbx=y.W/2;break;case"end":y.textpath.style["v-text-align"]="right",y.bbx=-y.W/2;break;default:y.textpath.style["v-text-align"]="center",y.bbx=0}y.textpath.style["v-text-kern"]=!0}},L=function(e,s,o){e.attrs=e.attrs||{};var u=(e.attrs,Math.pow),a="linear",f=".5 .5";if(e.attrs.gradient=s,s=t(s).replace(n._radial_gradient,function(e,t,n){return a="radial",t&&n&&(t=r(t),n=r(n),u(t-.5,2)+u(n-.5,2)>.25&&(n=i.sqrt(.25-u(t-.5,2))*(2*(n>.5)-1)+.5),f=t+p+n),d}),s=s.split(/\s*\-\s*/),"linear"==a){var l=s.shift();if(l=-r(l),isNaN(l))return null}var c=n._parseDots(s);if(!c)return null;if(e=e.shape||e.node,c.length){e.removeChild(o),o.on=!0,o.method="none",o.color=c[0].color,o.color2=c[c.length-1].color;for(var h=[],v=0,m=c.length;m>v;v++)c[v].offset&&h.push(c[v].offset+p+c[v].color);o.colors=h.length?h.join():"0% "+o.color,"radial"==a?(o.type="gradientTitle",o.focus="100%",o.focussize="0 0",o.focusposition=f,o.angle=0):(o.type="gradient",o.angle=(270-l)%360),e.appendChild(o)}return 1},A=function(e,t){this[0]=this.node=e,e.raphael=!0,this.id=n._oid++,e.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=t,this.matrix=n.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!t.bottom&&(t.bottom=this),this.prev=t.top,t.top&&(t.top.next=this),t.top=this,this.next=null},O=n.el;A.prototype=O,O.constructor=A,O.transform=function(e){if(null==e)return this._.transform;var r,i=this.paper._viewBoxShift,s=i?"s"+[i.scale,i.scale]+"-1-1t"+[i.dx,i.dy]:d;i&&(r=e=t(e).replace(/\.{3}|\u2026/g,this._.transform||d)),n._extractTransform(this,s+e);var o,u=this.matrix.clone(),a=this.skew,f=this.node,l=~t(this.attrs.fill).indexOf("-"),c=!t(this.attrs.fill).indexOf("url(");if(u.translate(1,1),c||l||"image"==this.type)if(a.matrix="1 0 0 1",a.offset="0 0",o=u.split(),l&&o.noRotation||!o.isSimple){f.style.filter=u.toFilter();var h=this.getBBox(),v=this.getBBox(1),m=h.x-v.x,g=h.y-v.y;f.coordorigin=m*-w+p+g*-w,N(this,1,1,m,g,0)}else f.style.filter=d,N(this,o.scalex,o.scaley,o.dx,o.dy,o.rotate);else f.style.filter=d,a.matrix=t(u),a.offset=u.offset();return r&&(this._.transform=r),this},O.rotate=function(e,n,i){if(this.removed)return this;if(null!=e){if(e=t(e).split(l),e.length-1&&(n=r(e[1]),i=r(e[2])),e=r(e[0]),null==i&&(n=i),null==n||null==i){var s=this.getBBox(1);n=s.x+s.width/2,i=s.y+s.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",e,n,i]])),this}},O.translate=function(e,n){return this.removed?this:(e=t(e).split(l),e.length-1&&(n=r(e[1])),e=r(e[0])||0,n=+n||0,this._.bbox&&(this._.bbox.x+=e,this._.bbox.y+=n),this.transform(this._.transform.concat([["t",e,n]])),this)},O.scale=function(e,n,i,s){if(this.removed)return this;if(e=t(e).split(l),e.length-1&&(n=r(e[1]),i=r(e[2]),s=r(e[3]),isNaN(i)&&(i=null),isNaN(s)&&(s=null)),e=r(e[0]),null==n&&(n=e),null==s&&(i=s),null==i||null==s)var o=this.getBBox(1);return i=null==i?o.x+o.width/2:i,s=null==s?o.y+o.height/2:s,this.transform(this._.transform.concat([["s",e,n,i,s]])),this._.dirtyT=1,this},O.hide=function(){return!this.removed&&(this.node.style.display="none"),this},O.show=function(){return!this.removed&&(this.node.style.display=d),this},O._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},O.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),n.eve.unbind("raphael.*.*."+this.id),n._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var e in this)this[e]="function"==typeof this[e]?n._removedFactory(e):null;this.removed=!0}},O.attr=function(t,r){if(this.removed)return this;if(null==t){var i={};for(var s in this.attrs)this.attrs[e](s)&&(i[s]=this.attrs[s]);return i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i.transform=this._.transform,i}if(null==r&&n.is(t,"string")){if(t==f&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var o=t.split(l),u={},a=0,h=o.length;h>a;a++)t=o[a],u[t]=t in this.attrs?this.attrs[t]:n.is(this.paper.customAttributes[t],"function")?this.paper.customAttributes[t].def:n._availableAttrs[t];return h-1?u:u[o[0]]}if(this.attrs&&null==r&&n.is(t,"array")){for(u={},a=0,h=t.length;h>a;a++)u[t[a]]=this.attr(t[a]);return u}var p;null!=r&&(p={},p[t]=r),null==r&&n.is(t,"object")&&(p=t);for(var d in p)c("raphael.attr."+d+"."+this.id,this,p[d]);if(p){for(d in this.paper.customAttributes)if(this.paper.customAttributes[e](d)&&p[e](d)&&n.is(this.paper.customAttributes[d],"function")){var v=this.paper.customAttributes[d].apply(this,[].concat(p[d]));this.attrs[d]=p[d];for(var m in v)v[e](m)&&(p[m]=v[m])}p.text&&"text"==this.type&&(this.textpath.string=p.text),k(this,p)}return this},O.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&n._tofront(this,this.paper),this},O.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),n._toback(this,this.paper)),this)},O.insertAfter=function(e){return this.removed?this:(e.constructor==n.st.constructor&&(e=e[e.length-1]),e.node.nextSibling?e.node.parentNode.insertBefore(this.node,e.node.nextSibling):e.node.parentNode.appendChild(this.node),n._insertafter(this,e,this.paper),this)},O.insertBefore=function(e){return this.removed?this:(e.constructor==n.st.constructor&&(e=e[0]),e.node.parentNode.insertBefore(this.node,e.node),n._insertbefore(this,e,this.paper),this)},O.blur=function(e){var t=this.node.runtimeStyle,r=t.filter;return r=r.replace(g,d),0!==+e?(this.attrs.blur=e,t.filter=r+p+h+".Blur(pixelradius="+(+e||1.5)+")",t.margin=n.format("-{0}px 0 0 -{0}px",s(+e||1.5))):(t.filter=r,t.margin=0,delete this.attrs.blur),this},n._engine.path=function(e,t){var n=M("shape");n.style.cssText=b,n.coordsize=w+p+w,n.coordorigin=t.coordorigin;var r=new A(n,t),i={fill:"none",stroke:"#000"};e&&(i.path=e),r.type="path",r.path=[],r.Path=d,k(r,i),t.canvas.appendChild(n);var s=M("skew");return s.on=!0,n.appendChild(s),r.skew=s,r.transform(d),r},n._engine.rect=function(e,t,r,i,s,o){var u=n._rectPath(t,r,i,s,o),a=e.path(u),f=a.attrs;return a.X=f.x=t,a.Y=f.y=r,a.W=f.width=i,a.H=f.height=s,f.r=o,f.path=u,a.type="rect",a},n._engine.ellipse=function(e,t,n,r,i){var s=e.path();return s.attrs,s.X=t-r,s.Y=n-i,s.W=2*r,s.H=2*i,s.type="ellipse",k(s,{cx:t,cy:n,rx:r,ry:i}),s},n._engine.circle=function(e,t,n,r){var i=e.path();return i.attrs,i.X=t-r,i.Y=n-r,i.W=i.H=2*r,i.type="circle",k(i,{cx:t,cy:n,r:r}),i},n._engine.image=function(e,t,r,i,s,o){var u=n._rectPath(r,i,s,o),a=e.path(u).attr({stroke:"none"}),l=a.attrs,c=a.node,h=c.getElementsByTagName(f)[0];return l.src=t,a.X=l.x=r,a.Y=l.y=i,a.W=l.width=s,a.H=l.height=o,l.path=u,a.type="image",h.parentNode==c&&c.removeChild(h),h.rotate=!0,h.src=t,h.type="tile",a._.fillpos=[r,i],a._.fillsize=[s,o],c.appendChild(h),N(a,1,1,0,0,0),a},n._engine.text=function(e,r,i,o){var u=M("shape"),a=M("path"),f=M("textpath");r=r||0,i=i||0,o=o||"",a.v=n.format("m{0},{1}l{2},{1}",s(r*w),s(i*w),s(r*w)+1),a.textpathok=!0,f.string=t(o),f.on=!0,u.style.cssText=b,u.coordsize=w+p+w,u.coordorigin="0 0";var l=new A(u,e),c={fill:"#000",stroke:"none",font:n._availableAttrs.font,text:o};l.shape=u,l.path=a,l.textpath=f,l.type="text",l.attrs.text=t(o),l.attrs.x=r,l.attrs.y=i,l.attrs.w=1,l.attrs.h=1,k(l,c),u.appendChild(f),u.appendChild(a),e.canvas.appendChild(u);var h=M("skew");return h.on=!0,u.appendChild(h),l.skew=h,l.transform(d),l},n._engine.setSize=function(e,t){var r=this.canvas.style;return this.width=e,this.height=t,e==+e&&(e+="px"),t==+t&&(t+="px"),r.width=e,r.height=t,r.clip="rect(0 "+e+" "+t+" 0)",this._viewBox&&n._engine.setViewBox.apply(this,this._viewBox),this},n._engine.setViewBox=function(e,t,r,i,s){n.eve("raphael.setViewBox",this,this._viewBox,[e,t,r,i,s]);var u,a,f=this.width,l=this.height,c=1/o(r/f,i/l);return s&&(u=l/i,a=f/r,f>r*u&&(e-=(f-r*u)/2/u),l>i*a&&(t-=(l-i*a)/2/a)),this._viewBox=[e,t,r,i,!!s],this._viewBoxShift={dx:-e,dy:-t,scale:c},this.forEach(function(e){e.transform("...")}),this};var M;n._engine.initWin=function(e){var t=e.document;t.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!t.namespaces.rvml&&t.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),M=function(e){return t.createElement("<rvml:"+e+' class="rvml">')}}catch(n){M=function(e){return t.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},n._engine.initWin(n._g.win),n._engine.create=function(){var e=n._getContainer.apply(0,arguments),t=e.container,r=e.height,i=e.width,s=e.x,o=e.y;if(!t)throw new Error("VML container not found.");var u=new n._Paper,a=u.canvas=n._g.doc.createElement("div"),f=a.style;return s=s||0,o=o||0,i=i||512,r=r||342,u.width=i,u.height=r,i==+i&&(i+="px"),r==+r&&(r+="px"),u.coordsize=1e3*w+p+1e3*w,u.coordorigin="0 0",u.span=n._g.doc.createElement("span"),u.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",a.appendChild(u.span),f.cssText=n.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",i,r),1==t?(n._g.doc.body.appendChild(a),f.left=s+"px",f.top=o+"px",f.position="absolute"):t.firstChild?t.insertBefore(a,t.firstChild):t.appendChild(a),u.renderfix=function(){},u},n.prototype.clear=function(){n.eve("raphael.clear",this),this.canvas.innerHTML=d,this.span=n._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},n.prototype.remove=function(){n.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var e in this)this[e]="function"==typeof this[e]?n._removedFactory(e):null;return!0};var _=n.st;for(var D in O)O[e](D)&&!_[e](D)&&(_[D]=function(e){return function(){var t=arguments;return this.forEach(function(n){n[e].apply(n,t)})}}(D))}}(),k.was?C.win.Raphael=n:Raphael=n,n})),window.jQuery.ui||(!function(e,t){function n(t,n){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,t.href&&s&&"map"===i.nodeName.toLowerCase()?(o=e("img[usemap=#"+s+"]")[0],!!o&&r(o)):!1):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,r){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t=this.css("position"),n="absolute"===t,r=this.parents().filter(function(){var t=e(this);return n&&"static"===t.css("position")?!1:/(auto|scroll)/.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==t&&r.length?r:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function i(t,n,r,i){return e.each(s,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),i&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var s="Width"===r?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return"number"!=typeof t?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var r,i,s=e(this[0]);s.length&&s[0]!==document;){if(r=s.css("position"),("absolute"===r||"relative"===r||"fixed"===r)&&(i=parseInt(s.css("zIndex"),10),!isNaN(i)&&0!==i))return i;s=s.parent()}return 0}}),e.ui.plugin={add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n,r){var i,s=e.plugins[t];if(s&&(r||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(i=0;i<s.length;i++)e.options[s[i][0]]&&s[i][1].apply(e.element,n)}}}(jQuery),function(e,t){var n=0,r=Array.prototype.slice;e.cleanData=function(t){return function(n){for(var r,i=0;null!=(r=n[i]);i++)try{e(r).triggerHandler("remove")}catch(s){}t(n)}}(e.cleanData),e.widget=function(t,n,r){var i,s,o,u,f={},l=t.split(".")[0];return t=t.split(".")[1],i=l+"-"+t,r||(r=n,n=e.Widget),e.expr[":"][i.toLowerCase()]=function(t){return!!e.data(t,i)},e[l]=e[l]||{},s=e[l][t],o=e[l][t]=function(e,t){return this._createWidget?(arguments.length&&this._createWidget(e,t),void 0):new o(e,t)},e.extend(o,s,{version:r.version,_proto:e.extend({},r),_childConstructors:[]}),u=new n,u.options=e.widget.extend({},u.options),e.each(r,function(t,r){return e.isFunction(r)?(f[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},i=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,s=this._superApply;return this._super=e,this._superApply=i,t=r.apply(this,arguments),this._super=n,this._superApply=s,t}}(),void 0):(f[t]=r,void 0)}),o.prototype=e.widget.extend(u,{widgetEventPrefix:s?u.widgetEventPrefix||t:t},f,{constructor:o,namespace:l,widgetName:t,widgetFullName:i}),s?(e.each(s._childConstructors,function(t,n){var r=n.prototype;e.widget(r.namespace+"."+r.widgetName,o,n._proto)}),delete s._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o),o},e.widget.extend=function(n){for(var i,s,o=r.call(arguments,1),u=0,f=o.length;f>u;u++)for(i in o[u])s=o[u][i],o[u].hasOwnProperty(i)&&s!==t&&(n[i]=e.isPlainObject(s)?e.isPlainObject(n[i])?e.widget.extend({},n[i],s):e.widget.extend({},s):s);return n},e.widget.bridge=function(n,i){var s=i.prototype.widgetFullName||n;e.fn[n]=function(o){var u="string"==typeof o,l=r.call(arguments,1),h=this;return o=!u&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,u?this.each(function(){var r,i=e.data(this,s);return"instance"===o?(h=i,!1):i?e.isFunction(i[o])&&"_"!==o.charAt(0)?(r=i[o].apply(i,l),r!==i&&r!==t?(h=r&&r.jquery?h.pushStack(r.get()):r,!1):void 0):e.error("no such method '"+o+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; "+"attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,s);t?(t.option(o||{}),t._init&&t._init()):e.data(this,s,new i(o,this))}),h}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,r){r=e(r||this.defaultElement||this)[0],this.element=e(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),r!==this&&(e.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===r&&this.destroy()}}),this.document=e(r.style?r.ownerDocument:r.document||r),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,r){var i,s,o,u=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(u={},i=n.split("."),n=i.shift(),i.length){for(s=u[n]=e.widget.extend({},this.options[n]),o=0;o<i.length-1;o++)s[i[o]]=s[i[o]]||{},s=s[i[o]];if(n=i.pop(),1===arguments.length)return s[n]===t?null:s[n];s[n]=r}else{if(1===arguments.length)return this.options[n]===t?null:this.options[n];u[n]=r}return this._setOptions(u),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,n,r){var i,s=this;"boolean"!=typeof t&&(r=n,n=t,t=!1),r?(n=i=e(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),e.each(r,function(r,o){function u(){return t||s.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?s[o]:o).apply(s,arguments):void 0}"string"!=typeof o&&(u.guid=o.guid=o.guid||u.guid||e.guid++);var l=r.match(/^(\w+)\s*(.*)$/),h=l[1]+s.eventNamespace,p=l[2];p?i.delegate(p,h,u):n.bind(h,u)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?r[e]:e).apply(r,arguments)}var r=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,r){var i,s,o=this.options[t];if(r=r||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],s=n.originalEvent)for(i in s)i in n||(n[i]=s[i]);return this.element.trigger(n,r),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(r,i,s){"string"==typeof i&&(i={effect:i});var o,u=i?i===!0||"number"==typeof i?n:i.effect||n:t;i=i||{},"number"==typeof i&&(i={duration:i}),o=!e.isEmptyObject(i),i.complete=s,i.delay&&r.delay(i.delay),o&&e.effects&&e.effects.effect[u]?r[t](i):u!==t&&r[u]?r[u](i.duration,i.easing,s):r.queue(function(n){e(this)[t](),s&&s.call(r[0]),n()})}})}(jQuery),function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"@VERSION",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var r=this,i=1===n.which,s="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return i&&!s&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return r._mouseMove(e)},this._mouseUpDelegate=function(e){return r._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(n){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&e.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),t=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(e){e.widget("ui.draggable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?(this.destroyOnClear=!0,void 0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),void 0)},_mouseCapture:function(t){var n=this.document[0],r=this.options;try{n.activeElement&&"body"!==n.activeElement.nodeName.toLowerCase()&&e(n.activeElement).blur()}catch(i){}return this.helper||r.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(r.iframeFix===!0?"iframe":r.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,r=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(r=e.ui.ddmanager.drop(this,t)),this.dropped&&(r=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options,s=this.document[0];return i.containment?"window"===i.containment?(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===i.containment?(this.containment=[0,0,e(s).width()-this.helperProportions.width-this.margins.left,(e(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):i.containment.constructor===Array?(this.containment=i.containment,void 0):("parent"===i.containment&&(i.containment=this.helper[0].parentNode),n=e(i.containment),r=n[0],r&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n),void 0):(this.containment=null,void 0)},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,r=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,r,i,s,o=this.options,u=this._isRootNode(this.scrollParent[0]),a=e.pageX,f=e.pageY;return u&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(a=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(f=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(a=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(f=n[3]+this.offset.click.top)),o.grid&&(i=o.grid[1]?this.originalPageY+Math.round((f-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,f=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-o.grid[1]:i+o.grid[1]:i,s=o.grid[0]?this.originalPageX+Math.round((a-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,a=n?s-this.offset.click.left>=n[0]||s-this.offset.click.left>n[2]?s:s-this.offset.click.left>=n[0]?s-o.grid[0]:s+o.grid[0]:s),"y"===o.axis&&(a=this.originalPageX),"x"===o.axis&&(f=this.originalPageY)),{top:f-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:u?0:this.offset.scroll.top),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:u?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,n,r){return r=r||this._uiHash(),e.ui.plugin.call(this,t,[n,r,this],!0),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,r){var i=r.options,s=e.extend({},n,{item:r.element});r.sortables=[],e(i.connectToSortable).each(function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,s))})},stop:function(t,n,r){var i=e.extend({},n,{item:r.element});e.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===r.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,i))})},drag:function(t,n,r){var i=this;e.each(r.sortables,function(){var s=!1,o=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(s=!0,e.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==o&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(o.instance.element[0],this.instance.element[0])&&(s=!1),s})),s?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,r){var i=e("body"),s=r.options;i.css("cursor")&&(s._cursor=i.css("cursor")),i.css("cursor",s.cursor)},stop:function(t,n,r){var i=r.options;i._cursor&&e("body").css("cursor",i._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,r){var i=e(n.helper),s=r.options;i.css("opacity")&&(s._opacity=i.css("opacity")),i.css("opacity",s.opacity)},stop:function(t,n,r){var i=r.options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParent[0]!==n.document[0]&&"HTML"!==n.scrollParent[0].tagName&&(n.overflowOffset=n.scrollParent.offset())},drag:function(t,n,r){var i=r.options,s=!1,o=r.document[0];r.scrollParent[0]!==o&&"HTML"!==r.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(r.overflowOffset.top+r.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(r.scrollParent[0].scrollTop=s=r.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(r.overflowOffset.left+r.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(r.scrollParent[0].scrollLeft=s=r.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(o).scrollTop()<i.scrollSensitivity?s=e(o).scrollTop(e(o).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(o).scrollTop())<i.scrollSensitivity&&(s=e(o).scrollTop(e(o).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(o).scrollLeft()<i.scrollSensitivity?s=e(o).scrollLeft(e(o).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(o).scrollLeft())<i.scrollSensitivity&&(s=e(o).scrollLeft(e(o).scrollLeft()+i.scrollSpeed)))),s!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(r,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,r){var i=r.options;r.snapElements=[],e(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var t=e(this),n=t.offset();this!==r.element[0]&&r.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n,r){var i,s,o,u,f,l,c,h,p,d,v=r.options,m=v.snapTolerance,g=n.offset.left,y=g+r.helperProportions.width,b=n.offset.top,w=b+r.helperProportions.height;for(p=r.snapElements.length-1;p>=0;p--)f=r.snapElements[p].left,l=f+r.snapElements[p].width,c=r.snapElements[p].top,h=c+r.snapElements[p].height,f-m>y||g>l+m||c-m>w||b>h+m||!e.contains(r.snapElements[p].item.ownerDocument,r.snapElements[p].item)?(r.snapElements[p].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[p].item})),r.snapElements[p].snapping=!1):("inner"!==v.snapMode&&(i=Math.abs(c-w)<=m,s=Math.abs(h-b)<=m,o=Math.abs(f-y)<=m,u=Math.abs(l-g)<=m,i&&(n.position.top=r._convertPositionTo("relative",{top:c-r.helperProportions.height,left:0}).top-r.margins.top),s&&(n.position.top=r._convertPositionTo("relative",{top:h,left:0}).top-r.margins.top),o&&(n.position.left=r._convertPositionTo("relative",{top:0,left:f-r.helperProportions.width}).left-r.margins.left),u&&(n.position.left=r._convertPositionTo("relative",{top:0,left:l}).left-r.margins.left)),d=i||s||o||u,"outer"!==v.snapMode&&(i=Math.abs(c-b)<=m,s=Math.abs(h-w)<=m,o=Math.abs(f-g)<=m,u=Math.abs(l-y)<=m,i&&(n.position.top=r._convertPositionTo("relative",{top:c,left:0}).top-r.margins.top),s&&(n.position.top=r._convertPositionTo("relative",{top:h-r.helperProportions.height,left:0}).top-r.margins.top),o&&(n.position.left=r._convertPositionTo("relative",{top:0,left:f}).left-r.margins.left),u&&(n.position.left=r._convertPositionTo("relative",{top:0,left:l-r.helperProportions.width}).left-r.margins.left)),!r.snapElements[p].snapping&&(i||s||o||u||d)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,e.extend(r._uiHash(),{snapItem:r.snapElements[p].item})),r.snapElements[p].snapping=i||s||o||u||d)}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,r){var i,s=r.options,o=e.makeArray(e(s.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});o.length&&(i=parseInt(e(o[0]).css("zIndex"),10)||0,e(o).each(function(t){e(this).css("zIndex",i+t)}),this.css("zIndex",i+o.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,r){var i=e(n.helper),s=r.options;i.css("zIndex")&&(s._zIndex=i.css("zIndex")),i.css("zIndex",s.zIndex)},stop:function(t,n,r){var i=r.options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery),function(e){e.widget("ui.droppable",{version:"@VERSION",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,n=this.options,r=n.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(r)?r:function(e){return e.is(r)},this.proportions=function(){return arguments.length?(t=arguments[0],void 0):t?t:t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(n.scope),n.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,n){if("accept"===t)this.accept=e.isFunction(n)?n:function(e){return e.is(n)};else if("scope"===t){var r=e.ui.ddmanager.droppables[this.options.scope];this._splice(r),this._addToManager(n)}this._super(t,n)},_activate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",t,this.ui(n))},_deactivate:function(t){var n=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",t,this.ui(n))},_over:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(n)))},_out:function(t){var n=e.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(n)))},_drop:function(t,n){var r=n||e.ui.ddmanager.current,i=!1;return r&&(r.currentItem||r.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=e(this).droppable("instance");return t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&e.ui.intersect(r,e.extend(t,{offset:t.element.offset()}),t.options.tolerance)?(i=!0,!1):void 0}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,n){return e>=t&&t+n>e}return function(t,n,r){if(!n.offset)return!1;var i,s,o=(t.positionAbs||t.position.absolute).left,u=(t.positionAbs||t.position.absolute).top,f=o+t.helperProportions.width,l=u+t.helperProportions.height,c=n.offset.left,h=n.offset.top,p=c+n.proportions().width,d=h+n.proportions().height;switch(r){case"fit":return o>=c&&p>=f&&u>=h&&d>=l;case"intersect":return c<o+t.helperProportions.width/2&&f-t.helperProportions.width/2<p&&h<u+t.helperProportions.height/2&&l-t.helperProportions.height/2<d;case"pointer":return i=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,s=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,e(s,h,n.proportions().height)&&e(i,c,n.proportions().width);case"touch":return(u>=h&&d>=u||l>=h&&d>=l||h>u&&l>d)&&(o>=c&&p>=o||f>=c&&p>=f||c>o&&f>p);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,n){var r,i,s=e.ui.ddmanager.droppables[t.options.scope]||[],o=n?n.type:null,u=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(r=0;r<s.length;r++)if(!(s[r].options.disabled||t&&!s[r].accept.call(s[r].element[0],t.currentItem||t.element))){for(i=0;i<u.length;i++)if(u[i]===s[r].element[0]){s[r].proportions().height=0;continue e}s[r].visible="none"!==s[r].element.css("display"),s[r].visible&&("mousedown"===o&&s[r]._activate.call(s[r],n),s[r].offset=s[r].element.offset(),s[r].proportions({width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight}))}},drop:function(t,n){var r=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))}),r},dragStart:function(t,n){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)})},drag:function(t,n){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,n),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r,i,s,o=e.ui.intersect(t,this,this.options.tolerance),u=!o&&this.isover?"isout":o&&!this.isover?"isover":null;u&&(this.options.greedy&&(i=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===i}),s.length&&(r=e(s[0]).droppable("instance"),r.greedyChild="isover"===u)),r&&"isover"===u&&(r.isover=!1,r.isout=!0,r._out.call(r,n)),this[u]=!0,this["isout"===u?"isover":"isout"]=!1,this["isover"===u?"_over":"_out"].call(this,n),r&&"isout"===u&&(r.isout=!1,r.isover=!0,r._over.call(r,n)))}})},dragStop:function(t,n){t.element.parentsUntil("body").unbind("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,n)}}}(jQuery),function(e){e.widget("ui.resizable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseInt(e,10)||0},_isNumber:function(e){return!isNaN(parseInt(e,10))},_hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)},_create:function(){var t,n,r,i,s,o=this,u=this.options;if(this.element.addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!u.aspectRatio,aspectRatio:u.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:u.helper||u.ghost||u.animate?u.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=u.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),t=this.handles.split(","),this.handles={},n=0;n<t.length;n++)r=e.trim(t[n]),s="ui-resizable-"+r,i=e("<div class='ui-resizable-handle "+s+"'></div>"),i.css({zIndex:u.zIndex}),"se"===r&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(i);this._renderAxis=function(t){var n,r,i,s;t=t||this.element;for(n in this.handles)this.handles[n].constructor===String&&(this.handles[n]=e(this.handles[n],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(r=e(this.handles[n],this.element),s=/sw|ne|nw|se|n|s/.test(n)?r.outerHeight():r.outerWidth(),i=["padding",/ne|nw|n/.test(n)?"Top":/se|sw|s/.test(n)?"Bottom":/^e$/.test(n)?"Right":"Left"].join(""),t.css(i,s),this._proportionallyResize()),e(this.handles[n]).length},this._renderAxis(this.element),this._handles=e(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){o.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),o.axis=i&&i[1]?i[1]:"se")}),u.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").mouseenter(function(){u.disabled||(e(this).removeClass("ui-resizable-autohide"),o._handles.show())}).mouseleave(function(){u.disabled||o.resizing||(e(this).addClass("ui-resizable-autohide"),o._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,n=function(t){e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(n(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),n(this.originalElement),this},_mouseCapture:function(t){var n,r,i=!1;for(n in this.handles)r=e(this.handles[n])[0],(r===t.target||e.contains(r,t.target))&&(i=!0);return!this.options.disabled&&i},_mouseStart:function(t){var n,r,i,s=this.options,o=this.element.position(),u=this.element;return this.resizing=!0,/absolute/.test(u.css("position"))?u.css({position:"absolute",top:u.css("top"),left:u.css("left")}):u.is(".ui-draggable")&&u.css({position:"absolute",top:o.top,left:o.left}),this._renderProxy(),n=this._num(this.helper.css("left")),r=this._num(this.helper.css("top")),s.containment&&(n+=e(s.containment).scrollLeft()||0,r+=e(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:n,top:r},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:u.width(),height:u.height()},this.originalSize=this._helper?{width:u.outerWidth(),height:u.outerHeight()}:{width:u.width(),height:u.height()},this.originalPosition={left:n,top:r},this.sizeDiff={width:u.outerWidth()-u.width(),height:u.outerHeight()-u.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,i=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===i?this.axis+"-resize":i),u.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var n,r=this.helper,i={},s=this.originalMousePosition,o=this.axis,u=this.position.top,f=this.position.left,l=this.size.width,c=this.size.height,h=t.pageX-s.left||0,p=t.pageY-s.top||0,d=this._change[o];return d?(n=d.apply(this,[t,h,p]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(n=this._updateRatio(n,t)),n=this._respectSize(n,t),this._updateCache(n),this._propagate("resize",t),this.position.top!==u&&(i.top=this.position.top+"px"),this.position.left!==f&&(i.left=this.position.left+"px"),this.size.width!==l&&(i.width=this.size.width+"px"),this.size.height!==c&&(i.height=this.size.height+"px"),r.css(i),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(i)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var n,r,i,s,o,u,f,l=this.options,c=this;return this._helper&&(n=this._proportionallyResizeElements,r=n.length&&/textarea/i.test(n[0].nodeName),i=r&&this._hasScroll(n[0],"left")?0:c.sizeDiff.height,s=r?0:c.sizeDiff.width,o={width:c.helper.width()-s,height:c.helper.height()-i},u=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,f=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null,l.animate||this.element.css(e.extend(o,{top:f,left:u})),c.helper.height(c.size.height),c.helper.width(c.size.width),this._helper&&!l.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(e){var t,n,r,i,s,o=this.options;s={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||e)&&(t=s.minHeight*this.aspectRatio,r=s.minWidth/this.aspectRatio,n=s.maxHeight*this.aspectRatio,i=s.maxWidth/this.aspectRatio,t>s.minWidth&&(s.minWidth=t),r>s.minHeight&&(s.minHeight=r),n<s.maxWidth&&(s.maxWidth=n),i<s.maxHeight&&(s.maxHeight=i)),this._vBoundaries=s},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,n=this.size,r=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===r&&(e.left=t.left+(n.width-e.width),e.top=null),"nw"===r&&(e.top=t.top+(n.height-e.height),e.left=t.left+(n.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,n=this.axis,r=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,i=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,s=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,o=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,u=this.originalPosition.left+this.originalSize.width,a=this.position.top+this.size.height,f=/sw|nw|w/.test(n),l=/nw|ne|n/.test(n);return s&&(e.width=t.minWidth),o&&(e.height=t.minHeight),r&&(e.width=t.maxWidth),i&&(e.height=t.maxHeight),s&&f&&(e.left=u-t.minWidth),r&&f&&(e.left=u-t.maxWidth),o&&l&&(e.top=a-t.minHeight),i&&l&&(e.top=a-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var e,t,n,r,i,s=this.helper||this.element;for(e=0;e<this._proportionallyResizeElements.length;e++){if(i=this._proportionallyResizeElements[e],!this.borderDif)for(this.borderDif=[],n=[i.css("borderTopWidth"),i.css("borderRightWidth"),i.css("borderBottomWidth"),i.css("borderLeftWidth")],r=[i.css("paddingTop"),i.css("paddingRight"),i.css("paddingBottom"),i.css("paddingLeft")],t=0;t<n.length;t++)this.borderDif[t]=(parseInt(n[t],10)||0)+(parseInt(r[t],10)||0);i.css({height:s.height()-this.borderDif[0]-this.borderDif[2]||0,width:s.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var t=this.element,n=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++n.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var n=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:n.width-t}},n:function(e,t,n){var r=this.originalSize,i=this.originalPosition;return{top:i.top+n,height:r.height-n}},s:function(e,t,n){return{height:this.originalSize.height+n}},se:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},sw:function(t,n,r){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,n,r]))},ne:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,n,r]))},nw:function(t,n,r){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,n,r]))}},_propagate:function(t,n){e.ui.plugin.call(this,t,[n,this.ui()]),"resize"!==t&&this._trigger(t,n,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var n=e(this).resizable("instance"),r=n.options,i=n._proportionallyResizeElements,s=i.length&&/textarea/i.test(i[0].nodeName),o=s&&n._hasScroll(i[0],"left")?0:n.sizeDiff.height,u=s?0:n.sizeDiff.width,f={width:n.size.width-u,height:n.size.height-o},l=parseInt(n.element.css("left"),10)+(n.position.left-n.originalPosition.left)||null,c=parseInt(n.element.css("top"),10)+(n.position.top-n.originalPosition.top)||null;n.element.animate(e.extend(f,c&&l?{top:c,left:l}:{}),{duration:r.animateDuration,easing:r.animateEasing,step:function(){var r={width:parseInt(n.element.css("width"),10),height:parseInt(n.element.css("height"),10),top:parseInt(n.element.css("top"),10),left:parseInt(n.element.css("left"),10)};i&&i.length&&e(i[0]).css({width:r.width,height:r.height}),n._updateCache(r),n._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,n,r,i,s,o,u,f=e(this).resizable("instance"),l=f.options,c=f.element,h=l.containment,p=h instanceof e?h.get(0):/parent/.test(h)?c.parent().get(0):h;p&&(f.containerElement=e(p),/document/.test(h)||h===document?(f.containerOffset={left:0,top:0},f.containerPosition={left:0,top:0},f.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(p),n=[],e(["Top","Right","Left","Bottom"]).each(function(e,r){n[e]=f._num(t.css("padding"+r))}),f.containerOffset=t.offset(),f.containerPosition=t.position(),f.containerSize={height:t.innerHeight()-n[3],width:t.innerWidth()-n[1]},r=f.containerOffset,i=f.containerSize.height,s=f.containerSize.width,o=f._hasScroll(p,"left")?p.scrollWidth:s,u=f._hasScroll(p)?p.scrollHeight:i,f.parentData={element:p,left:r.left,top:r.top,width:o,height:u}))},resize:function(t){var n,r,i,s,o=e(this).resizable("instance"),u=o.options,f=o.containerOffset,l=o.position,c=o._aspectRatio||t.shiftKey,h={top:0,left:0},p=o.containerElement;p[0]!==document&&/static/.test(p.css("position"))&&(h=f),l.left<(o._helper?f.left:0)&&(o.size.width=o.size.width+(o._helper?o.position.left-f.left:o.position.left-h.left),c&&(o.size.height=o.size.width/o.aspectRatio),o.position.left=u.helper?f.left:0),l.top<(o._helper?f.top:0)&&(o.size.height=o.size.height+(o._helper?o.position.top-f.top:o.position.top),c&&(o.size.width=o.size.height*o.aspectRatio),o.position.top=o._helper?f.top:0),o.offset.left=o.parentData.left+o.position.left,o.offset.top=o.parentData.top+o.position.top,n=Math.abs((o._helper?o.offset.left-h.left:o.offset.left-h.left)+o.sizeDiff.width),r=Math.abs((o._helper?o.offset.top-h.top:o.offset.top-f.top)+o.sizeDiff.height),i=o.containerElement.get(0)===o.element.parent().get(0),s=/relative|absolute/.test(o.containerElement.css("position")),i&&s&&(n-=Math.abs(o.parentData.left)),n+o.size.width>=o.parentData.width&&(o.size.width=o.parentData.width-n,c&&(o.size.height=o.size.width/o.aspectRatio)),r+o.size.height>=o.parentData.height&&(o.size.height=o.parentData.height-r,c&&(o.size.width=o.size.height*o.aspectRatio))},stop:function(){var t=e(this).resizable("instance"),n=t.options,r=t.containerOffset,i=t.containerPosition,s=t.containerElement,o=e(t.helper),u=o.offset(),f=o.outerWidth()-t.sizeDiff.width,l=o.outerHeight()-t.sizeDiff.height;t._helper&&!n.animate&&/relative/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:f,height:l}),t._helper&&!n.animate&&/static/.test(s.css("position"))&&e(this).css({left:u.left-i.left-r.left,width:f,height:l})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance"),n=t.options,r=function(t){e(t).each(function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};"object"!=typeof n.alsoResize||n.alsoResize.parentNode?r(n.alsoResize):n.alsoResize.length?(n.alsoResize=n.alsoResize[0],r(n.alsoResize)):e.each(n.alsoResize,function(e){r(e)})},resize:function(t,n){var r=e(this).resizable("instance"),i=r.options,s=r.originalSize,o=r.originalPosition,u={height:r.size.height-s.height||0,width:r.size.width-s.width||0,top:r.position.top-o.top||0,left:r.position.left-o.left||0},f=function(t,r){e(t).each(function(){var t=e(this),i=e(this).data("ui-resizable-alsoresize"),s={},o=r&&r.length?r:t.parents(n.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(o,function(e,t){var n=(i[t]||0)+(u[t]||0);n&&n>=0&&(s[t]=n||null)}),t.css(s)})};"object"!=typeof i.alsoResize||i.alsoResize.nodeType?f(i.alsoResize):e.each(i.alsoResize,function(e,t){f(e,t)})},stop:function(){e(this).removeData("resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),n=t.options,r=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t=e(this).resizable("instance"),n=t.options,r=t.size,i=t.originalSize,s=t.originalPosition,o=t.axis,u="number"==typeof n.grid?[n.grid,n.grid]:n.grid,f=u[0]||1,l=u[1]||1,c=Math.round((r.width-i.width)/f)*f,h=Math.round((r.height-i.height)/l)*l,p=i.width+c,d=i.height+h,v=n.maxWidth&&n.maxWidth<p,m=n.maxHeight&&n.maxHeight<d,g=n.minWidth&&n.minWidth>p,y=n.minHeight&&n.minHeight>d;n.grid=u,g&&(p+=f),y&&(d+=l),v&&(p-=f),m&&(d-=l),/^(se|s|e)$/.test(o)?(t.size.width=p,t.size.height=d):/^(ne)$/.test(o)?(t.size.width=p,t.size.height=d,t.position.top=s.top-h):/^(sw)$/.test(o)?(t.size.width=p,t.size.height=d,t.position.left=s.left-c):(t.size.width=p,t.size.height=d,t.position.top=s.top-h,t.position.left=s.left-c)}})}(jQuery),function(e){e.widget("ui.sortable",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,n){return e>=t&&t+n>e},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){var e=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===e.axis||this._isFloating(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,n){var r=null,i=!1,s=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(t),e(t.target).parents().each(function(){return e.data(this,s.widgetName+"-item")===s?(r=e(this),!1):void 0}),e.data(t.target,s.widgetName+"-item")===s&&(r=e(t.target)),r?!this.options.handle||n||(e(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(i=!0)}),i)?(this.currentItem=r,this._removeCurrentsFromItems(),!0):!1:!1)},_mouseStart:function(t,n,r){var i,s,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",o.cursor),this.storedStylesheet=e("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(s)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var n,r,i,s,o=this.options,u=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=u=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=u=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(t.pageY-e(document).scrollTop()<o.scrollSensitivity?u=e(document).scrollTop(e(document).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<o.scrollSensitivity&&(u=e(document).scrollTop(e(document).scrollTop()+o.scrollSpeed)),t.pageX-e(document).scrollLeft()<o.scrollSensitivity?u=e(document).scrollLeft(e(document).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<o.scrollSensitivity&&(u=e(document).scrollLeft(e(document).scrollLeft()+o.scrollSpeed))),u!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(r=this.items[n],i=r.item[0],s=this._intersectsWithPointer(r),s&&r.instance===this.currentContainer&&i!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==i&&!e.contains(this.placeholder[0],i)&&("semi-dynamic"===this.options.type?!e.contains(this.element[0],i):!0)){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(t,r),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,n){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var r=this,i=this.placeholder.offset(),s=this.options.axis,o={};s&&"x"!==s||(o.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(o.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){r._clear(t)})}else this._clear(t,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},e(n).each(function(){var n=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);n&&r.push((t.key||n[1]+"[]")+"="+(t.key&&t.expression?n[1]:n[2]))}),!r.length&&t.key&&r.push(t.key+"="),r.join("&")},toArray:function(t){var n=this._getItemsAsjQuery(t&&t.connected),r=[];return t=t||{},n.each(function(){r.push(e(t.item||this).attr(t.attribute||"id")||"")}),r},_intersectsWith:function(e){var t=this.positionAbs.left,n=t+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,s=e.left,o=s+e.width,u=e.top,a=u+e.height,f=this.offset.click.top,l=this.offset.click.left,c="x"===this.options.axis||r+f>u&&a>r+f,h="y"===this.options.axis||t+l>s&&o>t+l,p=c&&h;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?p:s<t+this.helperProportions.width/2&&n-this.helperProportions.width/2<o&&u<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<a},_intersectsWithPointer:function(e){var t="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),n="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),r=t&&n,i=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return r?this.floating?s&&"right"===s||"down"===i?2:1:i&&("down"===i?2:1):!1},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),n=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),i=this._getDragHorizontalDirection();return this.floating&&i?"right"===i&&n||"left"===i&&!n:r&&("down"===r&&t||"up"===r&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){function n(){u.push(this)}var r,i,s,o,u=[],f=[],l=this._connectWith();if(l&&t)for(r=l.length-1;r>=0;r--)for(s=e(l[r]),i=s.length-1;i>=0;i--)o=e.data(s[i],this.widgetFullName),o&&o!==this&&!o.options.disabled&&f.push([e.isFunction(o.options.items)?o.options.items.call(o.element):e(o.options.items,o.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),o]);for(f.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),r=f.length-1;r>=0;r--)f[r][0].each(n);return e(u)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(e){for(var n=0;n<t.length;n++)if(t[n]===e.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=[this];var n,r,i,s,o,u,f,l,c=this.items,h=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],p=this._connectWith();if(p&&this.ready)for(n=p.length-1;n>=0;n--)for(i=e(p[n]),r=i.length-1;r>=0;r--)s=e.data(i[r],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(h.push([e.isFunction(s.options.items)?s.options.items.call(s.element[0],t,{item:this.currentItem}):e(s.options.items,s.element),s]),this.containers.push(s));for(n=h.length-1;n>=0;n--)for(o=h[n][1],u=h[n][0],r=0,l=u.length;l>r;r++)f=e(u[r]),f.data(this.widgetName+"-item",o),c.push({item:f,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,s;for(n=this.items.length-1;n>=0;n--)r=this.items[n],r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?e(this.options.toleranceElement,r.item):r.item,t||(r.width=i.outerWidth(),r.height=i.outerHeight()),s=i.offset(),r.left=s.left,r.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)s=this.containers[n].element.offset(),this.containers[n].containerCache.left=s.left,this.containers[n].containerCache.top=s.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var n,r=t.options;r.placeholder&&r.placeholder.constructor!==String||(n=r.placeholder,r.placeholder={element:function(){var r=t.currentItem[0].nodeName.toLowerCase(),i=e("<"+r+">",t.document[0]).addClass(n||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===r?t.currentItem.children().each(function(){e("<td>&#160;</td>",t.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(i)}):"img"===r&&i.attr("src",t.currentItem.attr("src")),n||i.css("visibility","hidden"),i},update:function(e,i){(!n||r.forcePlaceholderSize)&&(i.height()||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(r.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),r.placeholder.update(t,t.placeholder)},_contactContainers:function(t){var n,r,i,s,o,u,f,l,c,h,p=null,d=null;for(n=this.containers.length-1;n>=0;n--)if(!e.contains(this.currentItem[0],this.containers[n].element[0]))if(this._intersectsWith(this.containers[n].containerCache)){if(p&&e.contains(this.containers[n].element[0],p.element[0]))continue;p=this.containers[n],d=n}else this.containers[n].containerCache.over&&(this.containers[n]._trigger("out",t,this._uiHash(this)),this.containers[n].containerCache.over=0);if(p)if(1===this.containers.length)this.containers[d].containerCache.over||(this.containers[d]._trigger("over",t,this._uiHash(this)),this.containers[d].containerCache.over=1);else{for(i=1e4,s=null,c=p.floating||this._isFloating(this.currentItem),o=c?"left":"top",u=c?"width":"height",h=c?"clientX":"clientY",r=this.items.length-1;r>=0;r--)e.contains(this.containers[d].element[0],this.items[r].item[0])&&this.items[r].item[0]!==this.currentItem[0]&&(f=this.items[r].item.offset()[o],l=!1,t[h]-f>this.items[r][u]/2&&(l=!0),Math.abs(t[h]-f)<i&&(i=Math.abs(t[h]-f),s=this.items[r],this.direction=l?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[d])return;s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[d].element,!0),this._trigger("change",t,this._uiHash()),this.containers[d]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[d],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[d]._trigger("over",t,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(t){var n=this.options,r=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return r.parents("body").length||e("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,r,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e("document"===i.containment?document:window).width()-this.helperProportions.width-this.margins.left,(e("document"===i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(t=e(i.containment)[0],n=e(i.containment).offset(),r="hidden"!==e(t).css("overflow"),this.containment=[n.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,n){n||(n=this.position);var r="absolute"===t?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*r}},_generatePosition:function(t){var n,r,i=this.options,s=t.pageX,o=t.pageY,u="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(u[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((o-this.originalPageY)/i.grid[1])*i.grid[1],o=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((s-this.originalPageX)/i.grid[0])*i.grid[0],s=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:u.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:u.scrollLeft())}},_rearrange:function(e,t,n,r){n?n[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(e,t){function n(e,t,n){return function(r){n._trigger(e,r,t._uiHash(t))}}this.reverting=!1;var r,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(r in this._storedCSS)("auto"===this._storedCSS[r]||"static"===this._storedCSS[r])&&(this._storedCSS[r]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&i.push(function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||i.push(function(e){this._trigger("update",e,this._uiHash())}),this!==this.currentContainer&&(t||(i.push(function(e){this._trigger("remove",e,this._uiHash())}),i.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),r=this.containers.length-1;r>=0;r--)t||i.push(n("deactivate",this,this.containers[r])),this.containers[r].containerCache.over&&(i.push(n("out",this,this.containers[r])),this.containers[r].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",e,this._uiHash()),r=0;r<i.length;r++)i[r].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(r=0;r<i.length;r++)i[r].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var n=t||this;return{helper:n.helper,placeholder:n.placeholder||e([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:t?t.element:null}}})}(jQuery),function(e){e.widget("ui.accordion",{version:"@VERSION",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),t.collapsible||t.active!==!1&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t=this.options.icons;t&&(e("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){return"active"===e?(this._activate(t),void 0):("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||this.options.active!==!1||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons()),"disabled"===e&&(this.element.toggleClass("ui-state-disabled",!!t).attr("aria-disabled",t),this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)),void 0)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var n=e.ui.keyCode,r=this.headers.length,i=this.headers.index(t.target),s=!1;switch(t.keyCode){case n.RIGHT:case n.DOWN:s=this.headers[(i+1)%r];break;case n.LEFT:case n.UP:s=this.headers[(i-1+r)%r];break;case n.SPACE:case n.ENTER:this._eventHandler(t);break;case n.HOME:s=this.headers[0];break;case n.END:s=this.headers[r-1]}s&&(e(t.target).attr("tabIndex",-1),e(s).attr("tabIndex",0),s.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels(),t.active===!1&&t.collapsible===!0||!this.headers.length?(t.active=!1,this.active=e()):t.active===!1?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,n=this.options,r=n.heightStyle,i=this.element.parent();this.active=this._findActive(n.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(){var t=e(this),n=t.uniqueId().attr("id"),r=t.next(),i=r.uniqueId().attr("id");t.attr("aria-controls",i),r.attr("aria-labelledby",n)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(n.event),"fill"===r?(t=i.height(),this.element.siblings(":visible").each(function(){var n=e(this),r=n.css("position");"absolute"!==r&&"fixed"!==r&&(t-=n.outerHeight(!0))}),this.headers.each(function(){t-=e(this).outerHeight(!0)}),this.headers.next().each(function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))}).css("overflow","auto")):"auto"===r&&(t=0,this.headers.next().each(function(){t=Math.max(t,e(this).css("height","").height())}).height(t))},_activate:function(t){var n=this._findActive(t)[0];n!==this.active[0]&&(n=n||this.active[0],this._eventHandler({target:n,currentTarget:n,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var n={keydown:"_keydown"};t&&e.each(t.split(" "),function(e,t){n[t]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,n),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var n=this.options,r=this.active,i=e(t.currentTarget),s=i[0]===r[0],o=s&&n.collapsible,u=o?e():i.next(),f=r.next(),l={oldHeader:r,oldPanel:f,newHeader:o?e():i,newPanel:u};t.preventDefault(),s&&!n.collapsible||this._trigger("beforeActivate",t,l)===!1||(n.active=o?!1:this.headers.index(i),this.active=s?e():i,this._toggle(l),r.removeClass("ui-accordion-header-active ui-state-active"),n.icons&&r.children(".ui-accordion-header-icon").removeClass(n.icons.activeHeader).addClass(n.icons.header),s||(i.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),n.icons&&i.children(".ui-accordion-header-icon").removeClass(n.icons.header).addClass(n.icons.activeHeader),i.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var n=t.newPanel,r=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=n,this.prevHide=r,this.options.animate?this._animate(n,r,t):(r.hide(),n.show(),this._toggleComplete(t)),r.attr({"aria-hidden":"true"}),r.prev().attr("aria-selected","false"),n.length&&r.length?r.prev().attr({tabIndex:-1,"aria-expanded":"false"}):n.length&&this.headers.filter(function(){return 0===e(this).attr("tabIndex")}).attr("tabIndex",-1),n.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(e,t,n){var r,i,s,o=this,u=0,a=e.length&&(!t.length||e.index()<t.index()),f=this.options.animate||{},l=a&&f.down||f,c=function(){o._toggleComplete(n)};return"number"==typeof l&&(s=l),"string"==typeof l&&(i=l),i=i||l.easing||f.easing,s=s||l.duration||f.duration,t.length?e.length?(r=e.show().outerHeight(),t.animate(this.hideProps,{duration:s,easing:i,step:function(e,t){t.now=Math.round(e)}}),e.hide().animate(this.showProps,{duration:s,easing:i,complete:c,step:function(e,n){n.now=Math.round(e),"height"!==n.prop?u+=n.now:"content"!==o.options.heightStyle&&(n.now=Math.round(r-t.outerHeight()-u),u=0)}}),void 0):t.animate(this.hideProps,s,i,c):e.animate(this.showProps,s,i,c)},_toggleComplete:function(e){var t=e.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}})}(jQuery),function(e){e.widget("ui.slider",e.ui.mouse,{version:"@VERSION",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget"+" ui-widget-content"+" ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),s="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",o=[];for(n=r.values&&r.values.length||1,i.length>n&&(i.slice(n).remove(),i=i.slice(0,n)),t=i.length;n>t;t++)o.push(s);this.handles=i.add(e(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(t){e(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,n="";t.range?(t.range===!0&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:e.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=e("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(n+("min"===t.range||"max"===t.range?" ui-slider-range-"+t.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var e=this.handles.add(this.range).filter("a");this._off(e),this._on(e,this._handleEvents),this._hoverable(e),this._focusable(e)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(t){var n,r,i,s,o,u,f,l,c=this,h=this.options;return h.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:t.pageX,y:t.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var n=Math.abs(r-c.values(t));(i>n||i===n&&(t===c._lastChangedValue||c.values(t)===h.min))&&(i=n,s=e(this),o=t)}),u=this._start(t,o),u===!1?!1:(this._mouseSliding=!0,this._handleIndex=o,s.addClass("ui-state-active").focus(),f=s.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-f.left-s.width()/2,top:t.pageY-f.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,o,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,n),!1},_mouseStop:function(e){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,n,r,i,s;return"horizontal"===this.orientation?(t=this.elementSize.width,n=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,n=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/t,r>1&&(r=1),0>r&&(r=0),"vertical"===this.orientation&&(r=1-r),i=this._valueMax()-this._valueMin(),s=this._valueMin()+r*i,this._trimAlignValue(s)},_start:function(e,t){var n={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("start",e,n)},_slide:function(e,t,n){var r,i,s;this.options.values&&this.options.values.length?(r=this.values(t?0:1),2===this.options.values.length&&this.options.range===!0&&(0===t&&n>r||1===t&&r>n)&&(n=r),n!==this.values(t)&&(i=this.values(),i[t]=n,s=this._trigger("slide",e,{handle:this.handles[t],value:n,values:i}),r=this.values(t?0:1),s!==!1&&this.values(t,n))):n!==this.value()&&(s=this._trigger("slide",e,{handle:this.handles[t],value:n}),s!==!1&&this.value(n))},_stop:function(e,t){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._trigger("stop",e,n)},_change:function(e,t){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(t),n.values=this.values()),this._lastChangedValue=t,this._trigger("change",e,n)}},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),this._change(null,0),void 0):this._value()},values:function(t,n){var r,i,s;if(arguments.length>1)return this.options.values[t]=this._trimAlignValue(n),this._refreshValue(),this._change(null,t),void 0;if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(t):this.value();for(r=this.options.values,i=arguments[0],s=0;s<r.length;s+=1)r[s]=this._trimAlignValue(i[s]),this._change(null,s);this._refreshValue()},_setOption:function(t,n){var r,i=0;switch("range"===t&&this.options.range===!0&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),e.isArray(this.options.values)&&(i=this.options.values.length),"disabled"===t&&this.element.toggleClass("ui-state-disabled",!!n),this._super(t,n),t){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),r=0;i>r;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var e=this.options.value;return e=this._trimAlignValue(e)},_values:function(e){var t,n,r;if(arguments.length)return t=this.options.values[e],t=this._trimAlignValue(t);if(this.options.values&&this.options.values.length){for(n=this.options.values.slice(),r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,n=(e-this._valueMin())%t,r=e-n;return 2*Math.abs(n)>=t&&(r+=n>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var t,n,r,i,s,o=this.options.range,u=this.options,f=this,l=this._animateOff?!1:u.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=100*((f.values(r)-f._valueMin())/(f._valueMax()-f._valueMin())),c["horizontal"===f.orientation?"left":"bottom"]=n+"%",e(this).stop(1,1)[l?"animate":"css"](c,u.animate),f.options.range===!0&&("horizontal"===f.orientation?(0===r&&f.range.stop(1,1)[l?"animate":"css"]({left:n+"%"},u.animate),1===r&&f.range[l?"animate":"css"]({width:n-t+"%"},{queue:!1,duration:u.animate})):(0===r&&f.range.stop(1,1)[l?"animate":"css"]({bottom:n+"%"},u.animate),1===r&&f.range[l?"animate":"css"]({height:n-t+"%"},{queue:!1,duration:u.animate}))),t=n}):(r=this.value(),i=this._valueMin(),s=this._valueMax(),n=s!==i?100*((r-i)/(s-i)):0,c["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[l?"animate":"css"](c,u.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:n+"%"},u.animate),"max"===o&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:u.animate}),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:n+"%"},u.animate),"max"===o&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:u.animate}))},_handleEvents:{keydown:function(t){var n,r,i,s,o=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(t.target).addClass("ui-state-active"),n=this._start(t,o),n===!1))return}switch(s=this.options.step,r=i=this.options.values&&this.options.values.length?this.values(o):this.value(),t.keyCode){case e.ui.keyCode.HOME:i=this._valueMin();break;case e.ui.keyCode.END:i=this._valueMax();break;case e.ui.keyCode.PAGE_UP:i=this._trimAlignValue(r+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(r-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(r===this._valueMax())return;i=this._trimAlignValue(r+s);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(r===this._valueMin())return;i=this._trimAlignValue(r-s)}this._slide(t,o,i)},click:function(e){e.preventDefault()},keyup:function(t){var n=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,n),this._change(t,n),e(t.target).removeClass("ui-state-active"))}}})}(jQuery));if(!window.Hogan){var Hogan={};!function(e,t){function n(e){return String(null===e||void 0===e?"":e)}function r(e){return e=n(e),f.test(e)?e.replace(i,"&amp;").replace(s,"&lt;").replace(o,"&gt;").replace(u,"&#39;").replace(a,"&quot;"):e}e.Template=function(e,n,r,i){this.r=e||this.r,this.c=r,this.options=i,this.text=n||"",this.buf=t?[]:""},e.Template.prototype={r:function(){return""},v:r,t:n,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,r){var i=n[e];return i?(this.c&&"string"==typeof i&&(i=this.c.compile(i,this.options)),i.ri(t,n,r)):""},rs:function(e,t,n){var r=e[e.length-1];if(!l(r))return n(e,t,this),void 0;for(var i=0;i<r.length;i++)e.push(r[i]),n(e,t,this),e.pop()},s:function(e,t,n,r,i,s,o){var u;return l(e)&&0===e.length?!1:("function"==typeof e&&(e=this.ls(e,t,n,r,i,s,o)),u=""===e||!!e,!r&&u&&t&&t.push("object"==typeof e?e:t[t.length-1]),u)},d:function(e,t,n,r){var i=e.split("."),s=this.f(i[0],t,n,r),o=null;if("."===e&&l(t[t.length-2]))return t[t.length-1];for(var u=1;u<i.length;u++)s&&"object"==typeof s&&i[u]in s?(o=s,s=s[i[u]]):s="";return r&&!s?!1:(r||"function"!=typeof s||(t.push(o),s=this.lv(s,t,n),t.pop()),s)},f:function(e,t,n,r){for(var i=!1,s=null,o=!1,u=t.length-1;u>=0;u--)if(s=t[u],s&&"object"==typeof s&&e in s){i=s[e],o=!0;break}return o?(r||"function"!=typeof i||(i=this.lv(i,t,n)),i):r?!1:""},ho:function(e,t,n,r,i){var s=this.c,o=this.options;o.delimiters=i;var r=e.call(t,r);return r=null==r?String(r):r.toString(),this.b(s.compile(r,o).render(t,n)),!1},b:t?function(e){this.buf.push(e)}:function(e){this.buf+=e},fl:t?function(){var e=this.buf.join("");return this.buf=[],e}:function(){var e=this.buf;return this.buf="",e},ls:function(e,t,n,r,i,s,o){var u=t[t.length-1],a=null;if(!r&&this.c&&e.length>0)return this.ho(e,u,n,this.text.substring(i,s),o);if(a=e.call(u),"function"==typeof a){if(r)return!0;if(this.c)return this.ho(a,u,n,this.text.substring(i,s),o)}return a},lv:function(e,t,r){var i=t[t.length-1],s=e.call(i);return"function"==typeof s&&(s=n(s.call(i)),this.c&&~s.indexOf("{{"))?this.c.compile(s,this.options).render(i,r):n(s)}};var i=/&/g,s=/</g,o=/>/g,u=/\'/g,a=/\"/g,f=/[&<>\"\']/,l=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}("undefined"!=typeof exports?exports:Hogan),function(e){function t(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function n(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function r(e,t,n){if(t.charAt(n)!=e.charAt(0))return!1;for(var r=1,i=e.length;i>r;r++)if(t.charAt(n+r)!=e.charAt(r))return!1;return!0}function i(e,t,n,r){for(var u=[],a=null,f=null;e.length>0;)if(f=e.shift(),"#"==f.tag||"^"==f.tag||s(f,r))n.push(f),f.nodes=i(e,f.tag,n,r),u.push(f);else{if("/"==f.tag){if(0===n.length)throw new Error("Closing tag without opener: /"+f.n);if(a=n.pop(),f.n!=a.n&&!o(f.n,a.n,r))throw new Error("Nesting error: "+a.n+" vs. "+f.n);return a.end=f.i,u}u.push(f)}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return u}function s(e,t){for(var n=0,r=t.length;r>n;n++)if(t[n].o==e.n)return e.tag="#",!0}function o(e,t,n){for(var r=0,i=n.length;i>r;r++)if(n[r].c==e&&n[r].o==t)return!0}function u(e){return e.replace(w,"\\\\").replace(g,'\\"').replace(y,"\\n").replace(b,"\\r")}function a(e){return~e.indexOf(".")?"d":"f"}function f(e){for(var t="",n=0,r=e.length;r>n;n++){var i=e[n].tag;"#"==i?t+=l(e[n].nodes,e[n].n,a(e[n].n),e[n].i,e[n].end,e[n].otag+" "+e[n].ctag):"^"==i?t+=c(e[n].nodes,e[n].n,a(e[n].n)):"<"==i||">"==i?t+=h(e[n]):"{"==i||"&"==i?t+=p(e[n].n,a(e[n].n)):"\n"==i?t+=v('"\\n"'+(e.length-1==n?"":" + i")):"_v"==i?t+=d(e[n].n,a(e[n].n)):void 0===i&&(t+=v('"'+u(e[n])+'"'))}return t}function l(e,t,n,r,i,s){return"if(_.s(_."+n+'("'+u(t)+'",c,p,1),'+"c,p,0,"+r+","+i+',"'+s+'")){'+"_.rs(c,p,"+"function(c,p,_){"+f(e)+"});c.pop();}"}function c(e,t,n){return"if(!_.s(_."+n+'("'+u(t)+'",c,p,1),c,p,1,0,0,"")){'+f(e)+"};"}function h(e){return'_.b(_.rp("'+u(e.n)+'",c,p,"'+(e.indent||"")+'"));'}function p(e,t){return"_.b(_.t(_."+t+'("'+u(e)+'",c,p,0)));'}function d(e,t){return"_.b(_.v(_."+t+'("'+u(e)+'",c,p,0)));'}function v(e){return"_.b("+e+");"}var m=/\S/,g=/\"/g,y=/\n/g,b=/\r/g,w=/\\/g,E={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};e.scan=function(e,i){function s(){g.length>0&&(y.push(new String(g)),g="")}function o(){for(var e=!0,t=S;t<y.length;t++)if(e=y[t].tag&&E[y[t].tag]<E._v||!y[t].tag&&null===y[t].match(m),!e)return!1;return e}function u(e,t){if(s(),e&&o())for(var n,r=S;r<y.length;r++)y[r].tag||((n=y[r+1])&&">"==n.tag&&(n.indent=y[r].toString()),y.splice(r,1));else t||y.push({tag:"\n"});b=!1,S=y.length}function a(e,t){var r="="+T,i=e.indexOf(r,t),s=n(e.substring(e.indexOf("=",t)+1,i)).split(" ");return x=s[0],T=s[1],i+r.length-1}var f=e.length,l=0,c=1,h=2,p=l,d=null,v=null,g="",y=[],b=!1,w=0,S=0,x="{{",T="}}";for(i&&(i=i.split(" "),x=i[0],T=i[1]),w=0;f>w;w++)p==l?r(x,e,w)?(--w,s(),p=c):"\n"==e.charAt(w)?u(b):g+=e.charAt(w):p==c?(w+=x.length-1,v=E[e.charAt(w+1)],d=v?e.charAt(w+1):"_v","="==d?(w=a(e,w),p=l):(v&&w++,p=h),b=w):r(T,e,w)?(y.push({tag:d,n:n(g),otag:x,ctag:T,i:"/"==d?b-T.length:w+x.length}),g="",w+=T.length-1,p=l,"{"==d&&("}}"==T?w++:t(y[y.length-1]))):g+=e.charAt(w);return u(b,!0),y},e.generate=function(t,n,r){var i='var _=this;_.b(i=i||"");'+f(t)+"return _.fl();";return r.asString?"function(c,p,i){"+i+";}":new e.Template(new Function("c","p","i",i),n,e,r)},e.parse=function(e,t,n){return n=n||{},i(e,"",[],n.sectionTags||[])},e.cache={},e.compile=function(e,t){t=t||{};var n=e+"||"+!!t.asString,r=this.cache[n];return r?r:(r=this.generate(this.parse(this.scan(e,t.delimiters),e,t),e,t),this.cache[n]=r)}}("undefined"!=typeof exports?exports:Hogan)}define("cdn.jquery",[],function(){return jQuery}),define("cdn.jqueryui",[],function(){return jQuery}),define("cdn.underscore",[],function(){return _}),define("cdn.underscore.mixins",[],function(){return _}),define("cdn.lodash",[],function(){return _}),define("cdn.backbone",[],function(){return Backbone}),define("cdn.marionette",[],function(){return Backbone.Marionette}),define("cdn.processing",[],function(){return Processing}),define("cdn.raphael",[],function(){return Raphael}),define("cdn.hogan",[],function(){return Hogan}),define("cdn.mustache",[],function(){return Hogan}),define("cdn.mathjax",["https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_SVG&amp;delayStartupUntil=configured"],function(){return MathJax.Hub.Config({config:["MMLorHTML.js"],jax:["input/TeX","input/MathML","input/AsciiMath","output/HTML-CSS","output/NativeMML"],extensions:["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","Safe.js"],TeX:{extensions:["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]},SVG:{scale:110,blacker:2},skipStartupTypeset:!0,delayStartupUntil:"configured",messageStyle:"none"}),MathJax.Hub.Configured(),MathJax}),function(e,t){typeof define=="function"&&define.amd&&define("plugins/vs.api",t),e.vs||(e.vs={}),e.vs.api=t()}(this,function(){var e,t,n;return function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),w=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n.apply(a[e],g);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!w)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../src/build/almond",function(){}),n("pagination",["require","exports","module","underscore"],function(e,t,n){(function(){var t,r;r=e("underscore"),t=function(){function s(t){t==null&&(t={}),r.extend(this,e,i(t))}var e,t,n,i;return t=20,e={count:0,page:1,perPage:t,pageCount:1},n=s.pageParams=r.keys(e),i=function(e){return r.pick(e,n)},s.prototype.pageRequest=function(e,n){var s;return n==null&&(n={}),s=r.extend(i(this),i(n),{page:e}),s.perPage<1?s.perPage=1:s.perPage>t&&(s.perPage=t),0<e&&e<=s.pageCount?r.pick(s,"page","perPage"):!1},s}(),n.exports=t}).call(this)}),n("helpers/backbone_collection_move",["require","exports","module","backbone","underscore"],function(e,t,n){(function(){var t,n;t=e("backbone"),n=e("underscore"),t.Collection.prototype.move=function(e,t,n){var r;r=this.indexOf(e);if(r===-1)throw new Error("Can't move a model that's not in the collection");r!==t&&this.models.splice(t,0,this.models.splice(r,1)[0]),this.trigger("sort",this);if(n!=null?!n.silent:!void 0)return this.reorder(n)},t.Collection.prototype.getIndexes=function(){return n.map(this.models,function(e){return e.id})},t.Collection.prototype.reorder=function(e){var t;e==null&&(e={}),t=this.getIndexes();if(!t.length)return;return e.url==null&&(e.url=n.result(this,"url")+"/order"),e.attrs==null&&(e.attrs=t),this.sync("update",this,e)}}).call(this)}),n("models/asset_representation",["require","exports","module","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=e("backbone"),i=e("underscore"),t=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.isType=function(e){return this._isExactType(e)||this._isTypeWithWildcard(e)},t.prototype._isExactType=function(e){return e===this.get("contentType")},t.prototype._isTypeWithWildcard=function(e){var t,n,r;return r=e.split("/"),n=r[0],t=r[1],t==="*"&&n===i.first(this.get("contentType").split("/"))},t}(r.Model),n.exports=t}).call(this)}),n("collections/asset_representations",["require","exports","module","../models/asset_representation","backbone"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("../models/asset_representation"),i=e("backbone"),r=function(e){function n(){return s=n.__super__.constructor.apply(this,arguments),s}return u(n,e),n.prototype.model=t,n}(i.Collection),n.exports=r}).call(this)}),n("models/asset",["require","exports","module","backbone","../collections/asset_representations","underscore"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};i=e("backbone"),r=e("../collections/asset_representations"),s=e("underscore"),t=function(e){function t(e,n){e==null&&(e={}),n==null&&(n={}),this.representations=new r([],{asset:this}),n.parse=!0,t.__super__.constructor.call(this,e,n)}return u(t,e),t.prototype.urlRoot="/assets",t.prototype.defaults={tags:[]},t.prototype.sync=function(e,t,n){return n==null&&(n={}),n.parse=!0,i.sync.apply(this,[e,t,n])},t.prototype.parse=function(e){return e.representations&&(this._expandLocations(e),this.representations.set(e.representations),delete e.representations),e},t.prototype.toJSON=function(e){var t;return e==null&&(e={}),t=s.clone(this.attributes),e.upload||(t=s.omit(t,["content","contentType"])),e.representations&&s.extend(t,{representations:this.representations.toJSON()}),t},t.prototype.hasRepresentation=function(e){return this.representations.any(function(t){return t.isType(e)})},t.prototype.getRepresentation=function(e){var t;return t=this.representations.select(function(t){return t.isType(e)}),s.map(t,function(e){return e.get("location")})},t.prototype.validate=function(e,t){t==null&&(t={}),this.attributes&&(e=s.extend(this.attributes,e));if(t.upload){if(!e.content)return"content is required to upload an asset";if(!e.contentType)return"contentType is required to upload an asset"}if(!e.title)return"title is required"},t.prototype._expandLocations=function(e){var t=this;if(!this.baseUrl)return;return s.each(e.representations,function(e){if(!e.location.match(/^https?:\/\//))return e.location=t.baseUrl+e.location})},t}(i.Model),n.exports=t}).call(this)}),n("collections/assets",["require","exports","module","../models/asset","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("../models/asset"),i=e("backbone"),s=e("underscore"),r=function(e){function n(){return o=n.__super__.constructor.apply(this,arguments),o}return a(n,e),n.prototype.url=function(){return"/assets"},n.prototype.model=t,n.prototype.fetchByField=function(e,t,n){var r,i;return n==null&&(n={}),r=s.extend({},n.data),r[e]=t,i=s.extend({},n,{data:r}),this.fetch(i)},n.prototype.fetchByCreator=function(e,t){return this.fetchByField("creator",e,t)},n.prototype.fetchByTagLead=function(e,t){return this.fetchByField("tagLead",e,t)},n}(i.Collection),n.exports=r}).call(this)}),n("models/course_revision",["require","exports","module","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),i=e("underscore"),r=function(e){function n(e,n){n==null&&(n={});if(!n.course&&!n.catalog)throw new Error("Course or catalog reference is mandatory for CourseRevision");this.course=n.course,this.catalog=n.catalog,t.Model.apply(this,arguments)}return o(n,e),n.prototype.toJSON=function(){var e,t;return e={courseId:((t=this.course)!=null?t.id:void 0)||this.get("courseId")},e.revisionId=this.id||this.get("revisionId"),e},n}(t.Model),n.exports=r}).call(this)}),n("collections/course_revisions",["require","exports","module","backbone","underscore","../models/course_revision"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),s=e("underscore"),r=e("../models/course_revision"),i=function(e){function n(e,n){n==null&&(n={});if(!n.course&&!n.catalog)throw new Error("Course or catalog reference is mandatory for CourseRevisions");this.course=n.course,this.catalog=n.catalog,t.Collection.apply(this,arguments)}return u(n,e),n.prototype.model=r,n.prototype.create=function(e,t){return t==null&&(t={}),this.course&&(t.course=this.course),this.catalog&&(t.catalog=this.catalog),n.__super__.create.call(this,e,t)},n}(t.Collection),n.exports=i}).call(this)}),n("models/catalog",["require","exports","module","underscore","backbone","../collections/course_revisions"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=e("underscore"),t=e("backbone"),i=e("../collections/course_revisions"),r=function(e){function n(e,n){var r=this;e==null&&(e={}),n==null&&(n={}),this.courses=new i(n.courses,{catalog:this}),this.courses.url=function(){return s.result(r,"url")+"/courses"},n.parse=!0,t.Model.apply(this,arguments)}return u(n,e),n.prototype.urlRoot="/catalogs",n.prototype.parse=function(e){if(e.courses)return this.courses.set(e.courses)},n}(t.Model),n.exports=r}).call(this)}),n("collections/catalogs",["require","exports","module","backbone","../models/catalog"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),r=e("../models/catalog"),i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.url="/catalogs",t.prototype.model=r,t}(t.Collection),n.exports=i}).call(this)}),n("models/course_head",["require","exports","module","./course_revision","underscore"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=e("./course_revision"),i=e("underscore"),t=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.isNew=function(){return!1},t.prototype.discard=function(e){return this.id=null,this.save(this,e)},t}(r),n.exports=t}).call(this)}),n("models/course_progress",["require","exports","module","backbone"],function(e,t,n){(function(){var t,r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return o(t,e),t.prototype.isNew=function(){return!1},t}(t.Model),n.exports=r}).call(this)}),n("models/gadget_userstate",["require","exports","module","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),i=e("underscore"),r=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.isNew=function(){return!1},t.prototype.initialize=function(e,t){if(t!=null?!t.gadget:!void 0)throw new Error("gadget should be provided to create a gadget state");return this.gadget=t.gadget},t.prototype.setDefaults=function(e){return this.set(i.omit(e,i.keys(this.attributes)))},t}(t.Model),n.exports=r}).call(this)}),n("models/gadget_config",["require","exports","module","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),i=e("underscore"),r=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.isNew=function(){return!1},t.prototype.initialize=function(e,t){if(t!=null?!t.gadget:!void 0)throw new Error("gadget should be provided to create a gadget config");return this.gadget=t.gadget},t.prototype.setDefaults=function(e){return this.set(i.omit(e,i.keys(this.attributes)))},t.prototype.validate=function(){if(!this.gadget.id)return"Cannot save config before gadget has been given an ID"},t}(t.Model),n.exports=r}).call(this)}),n("models/gadget",["require","exports","module","backbone","underscore","./gadget_userstate","./gadget_config"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),o=e("underscore"),s=e("./gadget_userstate"),i=e("./gadget_config"),r=function(e){function t(e,n){var r=this;e==null&&(e={}),n==null&&(n={}),this.config=new i({},{gadget:this}),this.config.url=function(){return o.result(r,"url")+"/config"},this.userState=new s({},{gadget:this}),this.userState.url=function(){return o.result(r,"url")+"/userstate"},n.parse=!0,t.__super__.constructor.call(this,e,n)}return a(t,e),t.prototype._locals=["uploadPercent"],t.prototype.parse=function(e){if(!e)return;return e.config&&this.config.set(o.clone(e.config),{silent:!0}),e.userState&&this.userState.set(o.clone(e.userState),{silent:!0}),e.gadgetProject&&(this.gadgetProject=e.gadgetProject),o.omit(e,["config","userState","gadgetProject"])},t.prototype.toJSON=function(){var e;return e=o.clone(this.attributes),this.config&&(e.config=this.config.toJSON()),this.userState&&(e.userState=this.userState.toJSON()),o.omit(e,this._locals)},t.prototype.validate=function(e){if(!e.type)return"Type is required. Did you call parse:true when instantiated your gadget?"},t}(t.Model),n.exports=r}).call(this)}),n("models/gadget_project",["require","exports","module","underscore","backbone","jquery","./gadget"],function(e,t,n){(function(){var t,r,i,s,o,u,a={}.hasOwnProperty,f=function(e,t){function r(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};o=e("underscore"),r=e("backbone"),t=e("jquery"),i=e("./gadget"),n.exports=s=function(e){function t(){return u=t.__super__.constructor.apply(this,arguments),u}return f(t,e),t.prototype.urlRoot="/gadgets",t.prototype.url=function(){var e;return e=o.result(this.collection,"url")||this.urlRoot,o.flatten(o.compact([e,this.typeSegments()])).join("/")},t.prototype.path=function(e){var n;return n=this.urlRoot,t.prototype.apiUrl&&(n=t.prototype.apiUrl.replace(/\/$/,"")+n),o.flatten(o.compact([n,this.typeSegments(),e])).join("/")},t.prototype.manifest=function(){return this.path("manifest")},t.prototype.main=function(){return this.path("gadget.js")},t.prototype.css=function(){if(!this.has("noCss"))return this.path("gadget.css")},t.prototype.icon=function(){return this.path("assets/icon.png")},t.prototype.code=function(){return this.path("code.zip")},t.prototype.compiled=function(){return this.path("compiled.zip")},t.prototype.typeSegments=function(){var e;return e=this.get("version")||"latest",[this.get("username"),this.get("name"),e]},t.prototype.type=function(){var e;return e=""+this.get("username")+"/"+this.get("name"),this.get("version")&&(e+="@"+this.get("version")),e},t.prototype.shortType=function(){return""+this.get("username")+"/"+this.get("name")},t.prototype.cssClassName=function(){return("gadget-"+this.typeSegments().join("-")).replace(/[\.\s]+/g,"_")},t.prototype.fetch=function(e){return e==null&&(e={}),t.__super__.fetch.call(this,o.extend(e,{url:this.manifest()}))},t.prototype.isNew=function(){return!1},t.prototype.toJSON=function(e){return(e!=null?e.include:void 0)?o.pick.apply(this,this.attributes,e.include):o.clone(this.attributes)},t.prototype.buildInstance=function(e){var t,n;return n={config:this.get("defaultConfig"),userState:this.get("defaultUserState"),type:this.shortType()},o.extend(n,e),t=new i(n)},t}(r.Model)}).call(this)}),n("collections/gadget_projects",["require","exports","module","backbone","underscore","../models/gadget_project"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),s=e("underscore"),r=e("../models/gadget_project"),i=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments),o}return a(t,e),t.prototype.model=r,t.prototype.url=function(){return"/gadgets"},t.prototype.fetchFiltered=function(e,t){var n,r;return t==null&&(t={}),n=s.extend({},t.data,e),r=s.extend({},t,{data:n}),this.fetch(r)},t.prototype.fetchApproved=function(e){return this.fetchFiltered({catalog:"approved"},e)},t.prototype.fetchSandbox=function(e){return this.fetchFiltered({user:"me",catalog:"sandbox"},e)},t.prototype.fetchRejected=function(e){return this.fetchFiltered({user:"me",catalog:"rejected"},e)},t.prototype.findByType=function(e){var t,n,r,i,s,o,u;return o=e.split("@"),n=o[0],s=o[1],u=n.split("/"),i=u[0],r=u[1],t={username:i,name:r},s&&(t.version=s),this.findWhere(t)},t}(t.Collection),n.exports=i}).call(this)}),n("models/gadget_palette",["require","exports","module","underscore","backbone","../collections/gadget_projects"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=e("underscore"),t=e("backbone"),i=e("../collections/gadget_projects"),n.exports=r=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments),o}return a(t,e),t.prototype.initialize=function(e,t){t==null&&(t={});if(t!=null?t.course:void 0)return this.url=function(){return s.result(t.course,"url")+"/palette"}},t.prototype.upgrade=function(e,t){return this.changeVersion(e,null,t)},t.prototype.changeVersion=function(e,t,n){var r,i;return n==null&&(n={}),r=this.findByType(e),r?(i=r.url(),n.url||(n.url=i),t||(t=r.get("latestVersion")),r.save({version:t},n)):$.Deferred().reject("Gadget project not found")},t}(i)}).call(this)}),n("collections/gadgets",["require","exports","module","backbone","underscore","../models/gadget"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),s=e("underscore"),r=e("../models/gadget"),i=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments),o}return a(t,e),t.prototype.model=r,t.prototype.url=function(){if(this.lesson)return s.result(this.lesson,"url")+"/gadgets"},t.prototype.initialize=function(e,t){return this.lesson=t&&t.lesson?t.lesson:void 0},t}(t.Collection),n.exports=i}).call(this)}),n("models/lesson",["require","exports","module","backbone","underscore","../collections/gadgets"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),s=e("underscore"),r=e("../collections/gadgets"),i=function(e){function t(e,n){e==null&&(e={}),n==null&&(n={}),this.gadgets=new r([],{lesson:this}),n.parse=!0,t.__super__.constructor.call(this,e,n)}return u(t,e),t.prototype.defaults={title:"Untitled lesson",isActive:!1},t.prototype._locals=["isActive"],t.prototype.parse=function(e){if(!e)return;return e.gadgets&&this.gadgets.reset(e.gadgets,{parse:!0}),s.omit(e,"gadgets",this._locals)},t.prototype.validate=function(e,t){if(!e.title)return"Title must be not empty"},t.prototype.toJSON=function(e){var t;t=s.clone(this.attributes);if(e!=null?e.gadgets:void 0)t.gadgets=this.gadgets.toJSON();return s.omit(t,this._locals)},t}(t.Model),n.exports=i}).call(this)}),n("collections/lessons",["require","exports","module","backbone","underscore","../models/lesson"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),s=e("underscore"),r=e("../models/lesson"),i=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments),o}return a(t,e),t.prototype.model=r,t.prototype.url=function(){if(this.course)return s.result(this.course,"url")+"/lessons"},t.prototype.initialize=function(e,t){if(t!=null?!t.course:!void 0)throw new Error("Course reference is mandatory for the Lessons");return this.course=t.course},t}(t.Collection),n.exports=i}).call(this)}),n("models/subscription",["require","exports","module","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),i=e("underscore"),r=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.idAttribute="type",t.prototype.save=function(e,n){return e==null&&(e={}),n==null&&(n={}),n.type="post",n.url=i.result(this.collection,"url"),t.__super__.save.call(this,e,n)},t}(t.Model),n.exports=r}).call(this)}),n("collections/subscriptions",["require","exports","module","backbone","../models/subscription"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),r=e("../models/subscription"),i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.url="/subscriptions",t.prototype.model=r,t}(t.Collection),n.exports=i}).call(this)}),n("models/session",["require","exports","module","backbone"],function(e,t,n){(function(){var t,r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return o(t,e),t.prototype.defaults={expiresIn:0},t.prototype.urlRoot="/sessions",t}(t.Model),n.exports=r}).call(this)}),n("models/user",["require","exports","module","underscore","backbone","../collections/subscriptions","../models/session"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};o=e("underscore"),t=e("backbone"),i=e("../collections/subscriptions"),r=e("../models/session"),s=function(e){function n(e,n){var r=this;e==null&&(e={}),n==null&&(n={}),this.orgs=new t.Collection,this.subscriptions=new i,this.subscriptions.url=function(){return o.result(r,"url")+"/subscriptions"},n.parse=!0,t.Model.call(this,e,n)}return a(n,e),n.prototype.urlRoot="/users",n.prototype.parse=function(e){return e.orgs&&this.orgs.set(e.orgs,{parse:!0}),o.omit(e,"orgs")},n.prototype.signin=function(e){var t,n=this;return e==null&&(e={}),t=new r({userId:this.id}),e.useApiKey=!0,e.success=o.wrap(e.success,function(e,t,r,i){return n.set(r.user),e(r)}),t.save({},e)},n.prototype.signout=function(e){return e==null&&(e={}),e.url="/signout",this.sync("create",this,e)},n.current=function(e){var t;return e==null&&(e={}),t=new n,e.self=!0,t.fetch(e)},n.prototype.defaults=function(){return{fn:"Anonymous",location:"",shortDesc:"",longDesc:"",website:"",social:[],registered:!1}},n.prototype.fetch=function(e){return e==null&&(e={}),e.self&&(e.url="/user"),n.__super__.fetch.call(this,e)},n.prototype.toJSON=function(){return o.extend({},this.attributes,{orgs:this.orgs.toJSON()})},n}(t.Model),n.exports=s}).call(this)}),n("models/user_role",["require","exports","module","backbone","underscore","../models/user"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),s=e("underscore"),r=e("../models/user"),i=function(e){function n(e,n){e==null&&(e={}),n==null&&(n={}),this.user=new r,n.parse=!0,t.Model.call(this,e,n)}return u(n,e),n.prototype.idAttribute="userId",n.prototype.defaults={roles:[]},n.prototype.parse=function(e,t){return e.user&&(this.user.set(e.user),e.userId=this.user.id),s.omit(e,"user")},n.prototype.toJSON=function(e){var t;return t={roles:this.attributes.roles},this.get("userId")?t.userId=this.get("userId"):t.user=this.user.toJSON(),t},n.prototype.userId=function(){return this.get("userId")},n.prototype.destroy=function(e){return this.set({roles:[]}),this.sync("update",this,e)},n}(t.Model),n.exports=i}).call(this)}),n("collections/user_roles",["require","exports","module","backbone","../models/user_role"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),r=e("../models/user_role"),i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.model=r,t}(t.Collection),n.exports=i}).call(this)}),n("collections/users",["require","exports","module","../models/user","backbone"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=e("../models/user"),t=e("backbone"),i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.model=r,t.prototype.url=function(){return"/users"},t}(t.Collection),n.exports=i}).call(this)}),n("models/course",["require","exports","module","backbone","underscore","./catalog","./course_head","./course_progress","../collections/course_revisions","../models/gadget_palette","../collections/lessons","../collections/user_roles","../collections/users"],function(e,t,n){(function(){var t,r,i,s,o,u,a,f,l,c,h,p={}.hasOwnProperty,d=function(e,t){function r(){this.constructor=e}for(var n in t)p.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),h=e("underscore"),r=e("./catalog"),s=e("./course_head"),o=e("./course_progress"),u=e("../collections/course_revisions"),a=e("../models/gadget_palette"),f=e("../collections/lessons"),l=e("../collections/user_roles"),c=e("../collections/users"),i=function(e){function n(e,n){var r=this;e==null&&(e={}),n==null&&(n={}),this.authors=new c,this.authors.url=function(){return h.result(r,"url")+"/users"},this.lessons=new f([],{course:this}),this.progress=new o({},{course:this}),this.progress.url=function(){return h.result(r,"url")+"/progress"},this.users=new l,this.users.url=function(){return h.result(r,"url")+"/users"},this.head=new s({},{course:this}),this.head.url=function(){return h.result(r,"url")+"/head"},this.revisions=new u([],{course:this}),this.revisions.url=function(){return h.result(r,"url")+"/revisions"},this.palette=new a([],{course:this}),this.userdata=new t.Collection({},{url:function(){return h.result(r,"url")+"/userdata"}}),n.parse=!0,t.Model.call(this,e,n)}return d(n,e),n.prototype.urlRoot="/courses",n.prototype.defaults={title:"Untitled course",isEditable:!1,shortDesc:"",longDesc:"",authorBio:"",tags:[],catalogs:[]},n.prototype.parse=function(e){return e.authors&&this.authors.set(e.authors,{parse:!0}),e.lessons&&this.lessons.set(e.lessons,{parse:!0}),e.revisions&&this.revisions.set(e.revisions,{parse:!0}),e.head&&this.head.set(h.clone(e.head),{silent:!0}),e.palette&&this.palette.set(e.palette,{parse:!0}),e.currentPosition&&this.progress.set({lessonIndex:e.currentPosition.currentLesson}),h.omit(e,"lessons","authors","revisions","head","progress","palette")},n.prototype.toJSON=function(e){var t;return e==null&&(e={}),t=h.clone(this.attributes),e.lessons&&(t.lessons=this.lessons.toJSON(e)),e.palette&&(t.palette=this.palette.toJSON(e)),t},n.prototype.validate=function(e,t){if(!e.title)return"Title must be not empty"},n.prototype.stage=function(e){var t,n=this;return e==null&&(e={}),t=this.revisions.create({},{error:e.error,success:function(){var i;return i=new r({id:"staged"}),i.courses.create(t.toJSON(),{error:e.error,success:function(){var t;return(t=e.success)!=null?t.call(n,n):void 0}})}})},n.prototype.start=function(e){return e==null&&(e={}),e.attrs={},e.url=h.result(this,"url")+"/start",this.sync("create",this,e)},n.prototype.complete=function(e){return e==null&&(e={}),e.attrs={},e.url=h.result(this,"url")+"/completion",this.sync("update",this,e)},n.prototype.isStaged=function(){return h.contains(this.get("catalogs"),"staged")},n.prototype.isPublished=function(){return this.isStaged()||h.contains(this.get("catalogs"),"labs")},n}(t.Model),n.exports=i}).call(this)}),n("collections/courses",["require","exports","module","../models/course","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=e("../models/course"),t=e("backbone"),s=e("underscore"),i=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments),o}return a(t,e),t.prototype.model=r,t.prototype.url=function(){return"/courses"},t.prototype.fetchCatalog=function(e,t){var n,r;return t==null&&(t={}),n=s.extend({},t.data,{catalog:e}),r=s.extend({},t,{data:n}),this.fetch(r)},t.prototype.fetchUser=function(e){return this.fetchCatalog("user",e)},t.prototype.fetchLabs=function(e){return this.fetchCatalog("labs",e)},t}(t.Collection),n.exports=i}).call(this)}),n("models/organization",["require","exports","module","backbone","underscore","../collections/user_roles","../collections/courses"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),o=e("underscore"),s=e("../collections/user_roles"),r=e("../collections/courses"),i=function(e){function n(e,n){var i=this;e==null&&(e={}),n==null&&(n={}),this.users=new s,this.users.url=function(){return o.result(i,"url")+"/users"},this.courses=new r,this.courses.url=function(){return o.result(i,"url")+"/courses"},n.parse=!0,t.Model.call(this,e,n)}return a(n,e),n.prototype.urlRoot="/orgs",n.prototype.defaults={orgTitle:"Your team name"},n}(t.Model),n.exports=i}).call(this)}),n("models/partnerkey",["require","exports","module","backbone"],function(e,t,n){(function(){var t,r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return o(t,e),t.prototype.urlRoot="/partnerkeys",t.prototype.defaults={key:""},t}(t.Model),n.exports=r}).call(this)}),n("models/program_user",["require","exports","module","backbone"],function(e,t,n){(function(){var t,r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),r=function(e){function t(){return i=t.__super__.constructor.apply(this,arguments),i}return o(t,e),t}(t.Model),n.exports=r}).call(this)}),n("collections/program_users",["require","exports","module","backbone","../models/program_user"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),r=e("../models/program_user"),i=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.model=r,t}(t.Collection),n.exports=i}).call(this)}),n("models/program",["require","exports","module","underscore","backbone","../collections/program_users"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=e("underscore"),t=e("backbone"),i=e("../collections/program_users"),r=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments),o}return a(t,e),t.prototype.initialize=function(){var e=this;return this.users=new i,this.users.url=function(){return s.result(e,"url")+"/users"}},t.prototype.url=function(){return"/programs/"+this.id},t.prototype.isNew=function(){return!0},t}(t.Model),n.exports=r}).call(this)}),n("models/tag",["require","exports","module","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=e("backbone"),i=e("underscore"),r=function(e){function t(){return s=t.__super__.constructor.apply(this,arguments),s}return u(t,e),t.prototype.urlRoot=function(){return"/tag"},t.prototype.idAttribute="path",t.prototype.validate=function(e,t){t==null&&(t={});if(!e.path)return"path is required to upload a tag"},t}(t.Model),n.exports=r}).call(this)}),n("collections/tags",["require","exports","module","../models/tag","backbone","underscore"],function(e,t,n){(function(){var t,r,i,s,o,u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=e("../models/tag"),t=e("backbone"),s=e("underscore"),i=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments),o}return a(t,e),t.prototype.url=function(){return"/tags"},t.prototype.model=r,t.prototype.fetchByField=function(e,t,n){var r,i;return n==null&&(n={}),r=s.extend({},n.data),r[e]=t,i=s.extend({},n,{data:r}),this.fetch(i)},t.prototype.fetchByPath=function(e,t){return this.fetchByField("path",e,t)},t}(t.Collection),n.exports=i}).call(this)}),n("api_errors",["require","exports","module"],function(e,t,n){(function(){var e,t,r,i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t=function(e){function t(){this.name="NotFound",t.__super__.constructor.apply(this,arguments)}return s(t,e),t}(Error),r=function(e){function t(){this.name="PermissionDenied",t.__super__.constructor.apply(this,arguments)}return s(t,e),t}(Error),e=function(e){function t(){this.name="ApplicationError",t.__super__.constructor.apply(this,arguments)}return s(t,e),t}(Error),n.exports={NotFound:t,PermissionDenied:r,ApplicationError:e}}).call(this)}),n("adapters/browser",["require","exports","module","backbone","underscore"],function(e,t,n){(function(){var t,r,i;t=e("backbone"),i=e("underscore"),n.exports=r=function(){function e(){}return e.prototype.ajax=function(e){var t;return t=this.createRequestOptions(e),i.extend(t,{cache:!1,contentType:!1,processData:!1}),$.ajax(t)},e.prototype.createRequestOptions=function(e){return e},e.prototype.createFormData=function(e){var t,n,r,i;t=new FormData,i=e.toJSON({upload:!0});for(n in i)r=i[n],t.append(n,this.normalizeValue(r));return t},e.prototype.normalizeValue=function(e){return e instanceof File||e instanceof Blob?e:i.isArray(e)||i.isObject(e)?JSON.stringify(e):e},e.prototype.sendRequest=function(e){},e}()}).call(this)}),n("api",["require","exports","module","backbone","jquery","./pagination","underscore","./helpers/backbone_collection_move","./models/asset","./collections/assets","./models/asset_representation","./collections/asset_representations","./models/catalog","./collections/catalogs","./models/course","./collections/courses","./models/course_head","./models/course_progress","./models/course_revision","./collections/course_revisions","./models/gadget","./collections/gadgets","./models/gadget_palette","./models/gadget_project","./collections/gadget_projects","./models/lesson","./collections/lessons","./models/organization","./models/partnerkey","./models/program","./models/program_user","./models/subscription","./collections/subscriptions","./models/session","./models/tag","./collections/tags","./models/user","./collections/users","./models/user_role","./collections/user_roles","./models/gadget","./api_errors","./adapters/node","./adapters/browser"],function(e,t,n){(function(){var t,r,i,s,o=[].slice;t=e("backbone"),t.$=e("jquery"),r=e("./pagination"),s=e("underscore"),e("./helpers/backbone_collection_move"),n.exports=i={Backbone:t,Asset:e("./models/asset"),Assets:e("./collections/assets"),AssetRepresentation:e("./models/asset_representation"),AssetRepresentations:e("./collections/asset_representations"),Catalog:e("./models/catalog"),Catalogs:e("./collections/catalogs"),Course:e("./models/course"),Courses:e("./collections/courses"),CourseHead:e("./models/course_head"),CourseProgress:e("./models/course_progress"),CourseRevision:e("./models/course_revision"),CourseRevisions:e("./collections/course_revisions"),Gadget:e("./models/gadget"),Gadgets:e("./collections/gadgets"),GadgetPalette:e("./models/gadget_palette"),GadgetProject:e("./models/gadget_project"),GadgetProjects:e("./collections/gadget_projects"),Lesson:e("./models/lesson"),Lessons:e("./collections/lessons"),Organization:e("./models/organization"),PartnerKey:e("./models/partnerkey"),Program:e("./models/program"),ProgramUser:e("./models/program_user"),Subscription:e("./models/subscription"),Subscriptions:e("./collections/subscriptions"),Session:e("./models/session"),Tag:e("./models/tag"),Tags:e("./collections/tags"),User:e("./models/user"),Users:e("./collections/users"),UserRole:e("./models/user_role"),UserRoles:e("./collections/user_roles"),GadgetInstance:e("./models/gadget"),Pagination:r,errors:e("./api_errors"),errorHandler:function(e,t,n){var r,o;n==null&&(n={});if(e instanceof Error)return e;if(!t||!t.status)return new Error("Unexpected result to error handler: "+JSON.stringify(arguments));o=i.errors,r=[t.status,s.result(e,"url"),t.responseText].join(" ");switch(t.status){case 401:case 403:return new o.PermissionDenied(r);case 404:return new o.NotFound(r);default:return new o.ApplicationError(r)}},connect:function(e){if(!e.url)throw new Error("url is required to connect to the API");return this.apiUrl=e.url.replace(/\/$/,""),this.apiKey=e.apiKey,this.sessionIdKey=e.sessionIdKey||"SESSION_ID",this.sessionId=e.sessionId,this.Asset.prototype.baseUrl=this.apiUrl,this.GadgetProject.prototype.apiUrl=this.apiUrl},setSIDHeader:function(e,t){var n;n=(t!=null?t.useApiKey:void 0)?this.apiKey:this.sessionId;if(!this.sessionIdKey||!n)return;return e.setRequestHeader(this.sessionIdKey,n)},init:function(e){var n,u,a=this;e==null&&(e={}),s.extend(this,t.Events),this.uploadAdapter=(e!=null?e.uploadAdapter:void 0)||this.getUploadAdapter(),e.url||(e.url=e.apiUrl),e.url&&this.connect(e),this.GadgetProject.prototype.requirejs=e.requirejs;if(!this._backbonePatched)return this._backbonePatched=!0,n=t.ajax,t.ajax=function(e){return e.upload&&a.uploadAdapter?a.uploadAdapter.ajax.apply(a.uploadAdapter,arguments):n.apply(a,arguments)},u=t.sync,t.sync=function(e,t,n){var f,l,c,h;return n==null&&(n={}),n=s.clone(n),c=n.url||s.result(t,"url"),c.match(/^https?:\/\//)?n.url=c:n.url=a.apiUrl+c,f=n.beforeSend,n.beforeSend=function(e){a.setSIDHeader(e,n);if(f)return f.apply(a,arguments)},n.upload&&(n.data=a.uploadAdapter.createFormData(t)),l=n.success||s.identity,n.success=s.wrap(l,function(){var e,n,i;n=arguments[0],e=2<=arguments.length?o.call(arguments,1):[];if(i=typeof h.getResponseHeader=="function"?h.getResponseHeader("X-Pagination"):void 0)t.pagination=new r(JSON.parse(i));return n.apply(this,e)}),h=u.apply(a,arguments),h.requestUrl=n.url,s.isFunction(h.done)&&(i.trigger("xhr:start",h),h.done(s.bind(i.trigger,i,"xhr:success")),h.fail(s.bind(i.trigger,i,"xhr:error"))),h}},getUploadAdapter:function(){var t;return t=typeof Buffer!="undefined",t?new(e("./adapters/node")):new(e("./adapters/browser"))}}}).call(this)}),n("underscore",[],function(){return window._}),n("backbone",[],function(){return window.Backbone}),n("jquery",[],function(){return window.$}),n("adapters/node",[],function(){}),t("api")}),function(e,t){typeof define=="function"&&define.amd&&define("plugins/vs.collab",t),e.vs||(e.vs={}),e.vs.collab=t()}(this,function(){var e,t,n;return function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),w=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n.apply(a[e],g);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!w)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("../src/build/almond",function(){}),function(){n("vent",["underscore","backbone"],function(e,t){var n;return n=function(){function n(){}return e.extend(n.prototype,t.Events),n}(),new n})}.call(this),function(){n("handler",["vent"],function(e){var t;return t=function(){function t(e){this.conn=e,this.mediator=this.conn.mediator,this.conn.on("ws:open",this.listen,this),this.conn.on("ws:close",this.stopListening,this)}return t.prototype.listen=function(){var t,n,r,i,s,o;if(this.serverEvents){r=this.serverEvents;for(n in r)t=r[n],this.conn.on(n,this[t],this)}if(this.localEvents){i=this.localEvents;for(n in i)t=i[n],e.on(n,this[t],this)}if(this.playerEvents){s=this.playerEvents,o=[];for(n in s)t=s[n],o.push(this.mediator.on(n,this[t],this));return o}},t.prototype.stopListening=function(){var t,n,r,i,s,o;if(this.serverEvents){r=this.serverEvents;for(n in r)t=r[n],this.conn.off(n,this[t],this)}if(this.localEvents){i=this.localEvents;for(n in i)t=i[n],e.off(n,this[t],this)}if(this.playerEvents){s=this.playerEvents,o=[];for(n in s)t=s[n],o.push(this.mediator.off(n,this[t],this));return o}},t}()})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("models/user",["backbone"],function(e){var n,r;return n=function(e){function n(){return r=n.__super__.constructor.apply(this,arguments),r}return t(n,e),n}(e.Model)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("collections/users",["backbone","models/user"],function(e,n){var r,i;return r=function(e){function r(){return i=r.__super__.constructor.apply(this,arguments),i}return t(r,e),r.prototype.model=n,r}(e.Collection)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("handlers/users",["underscore","handler","collections/users","vent"],function(e,n,r,i){var s,o;return s=function(e){function n(){return o=n.__super__.constructor.apply(this,arguments),o}return t(n,e),n.prototype.playerEvents={"gadget:activity":"onGadgetActivity"},n.prototype.serverEvents={"user:me":"onUserIdentity","users:list":"onUsersList","user:add":"onUserAdd","user:remove":"onUserRemove"},n.prototype.onUserIdentity=function(e){return this.conn.me=e},n.prototype.onGadgetActivity=function(){return this.conn.resetLastActivity()},n.prototype.onUsersList=function(e){return this._activeUsers=new r(e),i.trigger("activeUsers:update",this._activeUsers)},n.prototype.onUserAdd=function(e){return this._activeUsers.add(e),i.trigger("activeUsers:update",this._activeUsers)},n.prototype.onUserRemove=function(e){return this._activeUsers.remove(this._activeUsers.get(e.id)),i.trigger("activeUsers:update",this._activeUsers)},n}(n)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("models/gadget_lock",["backbone"],function(e){var n,r;return n=function(e){function n(){return r=n.__super__.constructor.apply(this,arguments),r}return t(n,e),n.prototype.defaults=function(){return{createdAt:new Date}},n.prototype.isLockedByMe=function(){return!!this.get("editable")},n}(e.Model)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("handlers/locks",["underscore","handler","models/gadget_lock","vent"],function(e,n,r,i){var s,o;return s=function(e){function n(){return o=n.__super__.constructor.apply(this,arguments),o}return t(n,e),n.prototype.serverEvents={"locks:list":"onLocksList","lock:lock":"onLock","lock:unlock":"onUnlock"},n.prototype.playerEvents={"gadget:editing:start":"onGadgetEditing","gadget:editing:stop":"onGadgetStopEditing"},n.prototype.onLocksList=function(e){var t=this;return e.each(function(e){return i.trigger("lock:lock",e)}),this.conn.activeLocks.reset(e.models)},n.prototype.onGadgetEditing=function(e){var t;return this.conn.triggerEvent("lock:lock",{gadgetId:e.id}),t=new r({gadgetId:e.id,user:this.conn.me,editable:!0}),i.trigger("lock:lock",t)},n.prototype.onGadgetStopEditing=function(e){return this.conn.triggerEvent("lock:unlock",{gadgetId:e.id})},n.prototype.onLock=function(e){return this.conn.activeLocks.add(e),i.trigger("lock:lock",e)},n.prototype.onUnlock=function(e){return this.conn.activeLocks.remove(this.conn.activeLocks.findWhere({gadgetId:e.get("gadgetId")})),i.trigger("lock:unlock",e)},n}(n)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("models/gadget_comment",["backbone"],function(e){var n,r;return n=function(e){function n(){return r=n.__super__.constructor.apply(this,arguments),r}return t(n,e),n.prototype.editable=!1,n.prototype.defaults=function(){return{createdAt:new Date,deleted:!1}},n.prototype.isDeleted=function(){return!!this.get("deleted")},n}(e.Model)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("collections/gadget_comments",["backbone","models/gadget_comment"],function(e,n){var r,i;return r=function(e){function r(){return i=r.__super__.constructor.apply(this,arguments),i}return t(r,e),r.prototype.model=n,r}(e.Collection)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("collections/collapsible_gadget_comments",["backbone","collections/gadget_comments","models/gadget_comment"],function(e,n,r){var i,s;return i=function(i){function o(){return s=o.__super__.constructor.apply(this,arguments),s}return t(o,i),o.prototype.initialize=function(){return this._shadowedCollection=new n,this._shadowedCollection.listenTo(this,"all",this._onModelEvent),this.model=r},o.prototype.collapseDeletedComments=function(t){var n,r=this;if(!t||t instanceof e.Collection){this.models.forEach(function(e){return r.collapseDeletedComments(e)});return}n=this.models.indexOf(t);if(n===-1)return;if(!t.get("deleted"))return;return t._deletedStreak=[1,-1].reduce(function(e,t){var i;return i=r.at(n+t),i&&i.get("deleted")?(r.remove(i),i._deletedStreak!=null?e+i._deletedStreak:e+1):e},1),t.trigger("change")},o}(n)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("handlers/comments",["underscore","handler","vent","collections/collapsible_gadget_comments"],function(e,n,r,i){var s;return s=function(e){function n(){this._commentsListed=[],n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype._unresolvedIds={},n.prototype.serverEvents={"comments:list":"onCommentsList","comment:resolve":"onCommentResolve","comment:add":"onCommentAdd","comment:delete":"onCommentDelete"},n.prototype.localEvents={"comment:deleted":"onCommentDeleted","comment:added":"onCommentAdded","commentsView:ready":"replayCommentsList"},n.prototype.onCommentsList=function(e){var t=this;return r.trigger("comments:ready"),this._commentsListed=[],this._personalizeCollection(e).each(function(e){return t.onCommentAdd(e),t._commentsListed.push(e)})},n.prototype.replayCommentsList=function(){return this._commentsListed.forEach(function(e){return r.trigger("comment:add",e)})},n.prototype.onCommentResolve=function(e){var t,n;t=e.get("cid"),n=this._unresolvedIds[t];if(n)return n.set({id:e.id}),delete this._unresolvedIds[t]},n.prototype.onCommentAdd=function(e){return r.trigger("comment:add",e),this._commentsListed.push(e)},n.prototype.onCommentDelete=function(e){return r.trigger("comment:delete",e)},n.prototype.onCommentAdded=function(e){return this._commentsListed.push(e),this._pendComment(e),this.conn.triggerEvent("comment:add",{gadgetId:e.get("gadgetId"),body:e.get("body"),cid:e.cid})},n.prototype.onCommentDeleted=function(e){var t;return t={gadgetId:e.get("gadgetId"),commentId:e.id},this.conn.triggerEvent("comment:delete",t)},n.prototype._personalizeCollection=function(e){var t=this;return e.each(function(e){if(e.get("user").id===t.conn.me.id)return e.editable=!0}),e},n.prototype._pendComment=function(e){return this._unresolvedIds[e.cid]=e},n}(n)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("handlers/updates",["handler","vent"],function(e,n){var r,i;return r=function(e){function r(){return i=r.__super__.constructor.apply(this,arguments),i}return t(r,e),r.prototype.serverEvents={"course:update":"_onCourseUpdate"},r.prototype.playerEvents={"lesson:gadget:added":"_onLessonChanged","lesson:gadget:moved":"_onLessonChanged","lesson:gadget:deleted":"_onLessonChanged","gadget:changed":"_onGadgetChanged"},r.prototype._onLessonChanged=function(e,t){return t?this.conn.triggerEvent("course:update",{gadgetId:t.id}):this.conn.triggerEvent("course:update")},r.prototype._onGadgetChanged=function(e){return this.conn.triggerEvent("course:update",{gadgetId:e.id})},r.prototype._onCourseUpdate=function(e){return this.conn.updates.push(e),n.trigger("collab:update")},r}(e)})}.call(this),n("text",["module"],function(e){var n,r,i,s,o,u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,f=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l=typeof location!="undefined"&&location.href,c=l&&location.protocol&&location.protocol.replace(/\:/,""),h=l&&location.hostname,p=l&&(location.port||undefined),d={},v=e.config&&e.config()||{};n={version:"2.0.12",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(f);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:v.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=u[t];try{e=new ActiveXObject(n)}catch(r){}if(e){u=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,r,i){var s,o,u,a=n.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,t,r,i){r=t?n.strip(r):r,v.isBuild&&(d[e]=r),i(r)},load:function(e,t,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}v.isBuild=i&&i.isBuild;var s=n.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=t.toUrl(o),a=v.useXhr||n.useXhr;if(u.indexOf("empty:")===0){r();return}!l||a(u,c,h,p)?n.get(u,function(t){n.finishLoad(e,s.strip,t,r)},function(e){r.error&&r.error(e)}):t([o],function(e){n.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,t,r,i){if(d.hasOwnProperty(t)){var s=n.jsEscape(d[t]);r.asModule(e+"!"+t,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,t,r,i,s){var o=n.parseName(t),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";n.load(a,r,function(t){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},n.write(e,a,r,s)},s)}};if(v.env==="node"||!v.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])r=t.nodeRequire("fs"),n.get=function(e,t,n){try{var i=r.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){n&&n(s)}};else if(v.env==="xhr"||!v.env&&n.createXhr())n.get=function(e,t,r,i){var s=n.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);v.onXhr&&v.onXhr(s,e),s.onreadystatechange=function(n){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):t(s.responseText),v.onXhrComplete&&v.onXhrComplete(s,e))},s.send(null)};else if(v.env==="rhino"||!v.env&&typeof Packages!="undefined"&&typeof java!="undefined")n.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(v.env==="xpconnect"||!v.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)i=Components.classes,s=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,n.get=function(e,t){var n,r,u,a={};o&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream),n.init(u,1,0,!1),r=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream),r.init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(n.available(),a),r.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return n}),n("text!templates/contributor.html",[],function(){return'<a href="<%- userUrl %>" target="_blank">\n  <img src="<%- thumbnail %>" alt="<%- name() %>" class="contrib-icon" title="<%- name() %>">\n</a>\n'}),n("text!templates/contributors.html",[],function(){return'<h4>Contributors</h4>\n<div class="js-toggle-collapse">\n  <i class="collapse icon-double-angle-down"></i>\n  <i class="expand icon-double-angle-up"></i>\n</div>\n<ul class="icons js-icons"></ul>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,r=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};n("views/contributors",["backbone","backbone.marionette","text!templates/contributor.html","text!templates/contributors.html","vent"],function(t,n,i,s,o){var u,a,f,l;return u=function(t){function n(){return this.templateHelpers=e(this.templateHelpers,this),f=n.__super__.constructor.apply(this,arguments),f}return r(n,t),n.prototype.initialize=function(e){this.site=e.site},n.prototype.template=_.template(i),n.prototype.templateHelpers=function(){var e=this;return{thumbnail:this.getThumbnail(),name:function(){return e.model.get("firstname")||e.model.get("fn")||"Anonymous"},site:this.site,userUrl:""+this.site+"/u/"+this.model.id}},n.prototype.tagName="li",n.prototype.className="contributor",n.prototype.getThumbnail=function(){var e,t;return e=_.findWhere((t=this.model.get("image"))!=null?t.representations:void 0,{scale:"40x40"}),(e!=null?e.location:void 0)||""+this.site+"/assets/img/defaults/profile-retina.jpg"},n}(n.ItemView),a=function(n){function i(){return this.initialize=e(this.initialize,this),l=i.__super__.constructor.apply(this,arguments),l}return r(i,n),i.prototype.initialize=function(e){return this.mediator=e.mediator,this.conn=e.conn,this.site=e.site,this.collection=new t.Collection},i.prototype.onShow=function(){return this.conn.on("ws:open",this.render,this),this.conn.on("ws:close",this.render,this),this.listenTo(this,"composite:collection:rendered",this.onCollectionRender),o.on("activeUsers:update",this._onActiveUsersChange,this)},i.prototype.onClose=function(){return this.conn.off("ws:open",this.render,this),this.conn.off("ws:close",this.render,this),o.off("activeUsers:update",this._onActiveUsersChange,this)},i.prototype.itemView=u,i.prototype.itemViewOptions=function(){return{site:this.site}},i.prototype.itemViewContainer=".js-icons",i.prototype.template=_.template(s),i.prototype.className="contributors",i.prototype.onCollectionRender=function(){return this.$el.toggle(!!this.conn.enabled&&this.collection.length>0),this.trigger("sizeChanged")},i.prototype.events={"click .js-toggle-collapse":"onCollapseToggle"},i.prototype.onCollapseToggle=function(){return this.$el.toggleClass("collapsed"),this.trigger("toggleCollapse")},i.prototype._onActiveUsersChange=function(e){return this.collection.reset(e.models)},i}(n.CompositeView)})}.call(this),function(){n("plugins/time_since",[],function(){return function(e){var t,n,r,i,s,o,u,a,f,l;t=+(new Date)-e;if(t<=3e4)n="seconds";else if(3e4<t&&t<=6e4)n="less than a minute";else{f=[["minute",6e4,36e5],["hour",36e5,864e5],["day",864e5,Infinity]];for(u=0,a=f.length;u<a;u++)l=f[u],s=l[0],i=l[1],r=l[2],i<t&&t<=r&&(o=Math.floor(t/i),n=""+o+" "+s,o>1&&(n+="s"))}return n}})}.call(this),n("text!templates/gadget_comment.html",[],function(){return'<% if (deleted && deletedStreak() > 1) { %>\n  <div class="deleted_comment">\n    <p><%= deletedStreak() %> comments have been deleted</p>\n  </div>\n<% } else if (deleted) { %>\n  <div class="deleted_comment">\n    <p>Comment has been deleted</p>\n  </div>\n<% } else { %>\n  <div class="comment-inner">\n    <div class=\'js-delete-overlay delete-overlay\'>\n      <div class=\'delete-content\'>\n        Delete this comment?\n        <button class=\'js-cancel-delete\'>no</button>\n        <button class=\'js-confirm-delete action\'>yes</button>\n      </div>\n    </div>\n    <img src="<%- profileImage() %>"></img>\n    <div class="commentInfo">\n      <p class="commentAuthor"><%- name() %></p><br/>\n      <p class="commentDate"><span class="js-timestamp timestamp">seconds</span> ago</p>\n    </div>\n    <p class="js-comment-body comment-body"><%= body() %></p>\n    <div class="js-comment-actions comment-actions">\n      <span class="js-show comment-action show-more">show more</span>\n      <span class="js-show comment-action show-less">show less</span>\n      <% if (isDeletable()) { %>\n        <span class="js-delete-comment delete-comment comment-action pull-right">delete</span>\n      <% } %>\n    </div>\n  </div>\n<% } %>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,r=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};n("views/comment",["backbone.marionette","plugins/time_since","text!templates/gadget_comment.html","vent"],function(t,n,i,s){var o,u;return o=function(t){function o(){return this.updateTimeSince=e(this.updateTimeSince,this),this.profileImage=e(this.profileImage,this),this.sanitizeBody=e(this.sanitizeBody,this),u=o.__super__.constructor.apply(this,arguments),u}return r(o,t),o.prototype.updateTimeSinceEveryMs=1e4,o.prototype.className="comment",o.prototype.events={"click .js-delete-comment":"_onDeleteClick","click .js-show":"toggleShow","click .js-confirm-delete":"_onConfirmDelete","click .js-cancel-delete":"_onCancelDelete"},o.prototype.template=_.template(i),o.prototype.ui={createdAt:".js-timestamp",commentBody:".js-comment-body",deleteOverlay:".js-delete-overlay"},o.prototype.initialize=function(e){return this.site=e.site,this.mediator=e.mediator,this.listenTo(this.model,"change",this.render)},o.prototype.toggleShow=function(){return this.$el.toggleClass("expanded"),this.$el.toggleClass("compacted")},o.prototype.templateHelpers=function(){var e=this;return{profileImage:this.profileImage,name:function(){var t,n;return((t=e.model.get("user"))!=null?t.firstname:void 0)||((n=e.model.get("user"))!=null?n.fn:void 0)||"Anonymous"},body:this.sanitizeBody,deletedStreak:function(){return e.model._deletedStreak},isDeletable:function(){return e.model.editable&&!e.model.isNew()}}},o.prototype.sanitizeBody=function(){var e,t,n,r;n=_.escape(this.model.get("body")),t={http:{"in":/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,out:'<a href="$1" target="_blank">$1</a>'},www:{"in":/(^|[^\/])(www\.[\S]+(\b|$))/gim,out:'$1<a href="http://$2" target="_blank">$2</a>'},email:{"in":/(^\S+@\S+\.\S+$)/gi,out:'<a href="mailto:$1">$1</a>'},newlines:{"in":/\n/g,out:"<br>"}};for(r in t)e=t[r],n=n.replace(e["in"],e.out);return n},o.prototype.profileImage=function(){var e,t;return t=this.model.get("user"),(t!=null?t.image:void 0)?(e=_.find(t.image.representations,function(e){return e.scale==="140x140"}),e.location):""+this.site+"/assets/img/defaults/profile-retina.jpg"},o.prototype.onRender=function(){return this.updateTimeSince()},o.prototype.onShow=function(){return this.determineHeight()},o.prototype.onClose=function(){return this.stopUpdatingTimeSince()},o.prototype.startUpdatingTimeSince=function(){if(!this.timeSinceUpdater&&!this.model.get("deleted"))return this.timeSinceUpdater=setInterval(this.updateTimeSince,this.updateTimeSinceEveryMs)},o.prototype.stopUpdatingTimeSince=function(){return clearInterval(this.timeSinceUpdater)},o.prototype._onDeleteClick=function(){return this.ui.deleteOverlay.show()},o.prototype._onConfirmDelete=function(){return this.ui.deleteOverlay.hide(),this.model.set({deleted:!0}),s.trigger("comment:deleted",this.model)},o.prototype._onCancelDelete=function(){return this.ui.deleteOverlay.hide()},o.prototype.updateTimeSince=function(){var e;return e=new Date(this.model.get("createdAt")),this.ui.createdAt.text(n(e))},o.prototype.determineHeight=function(){if(this.ui.commentBody.height()>145)return this.$el.addClass("compacted")},o}(t.ItemView)})}.call(this),n("text!templates/gadget_comments.html",[],function(){return'<ul class="comments-toolbar">\n  <li class="actions">\n    <span class="comments js-comments">\n      <span class="js-comments-toggle comments-toggle icon-stack">\n        <i class="fv-bubble icon-stack-base"></i>\n        <i class="js-comments-count icon-inner-text"><%- commentCount %></i>\n      </span>\n      <div class="js-comments-box comments-box">\n        <div class="js-inner-comments inner-comments"></div>\n        <textarea class="js-submit-comment-text submit-comment-text" maxlength="800" placeholder="Write a message here..."></textarea>\n        <div class="submit-action-buttons js-submit-action-buttons">\n          <button class="cancel-button js-cancel-comment ">cancel</button>\n          <button class="action submit-button js-submit-comment pull-right">submit</button>\n        </div>\n      </div>\n    </span>\n  </li>\n</ul>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,r=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};n("views/comments",["backbone.marionette","views/comment","text!templates/gadget_comments.html","models/gadget_comment","collections/collapsible_gadget_comments","vent"],function(t,n,i,s,o,u){var a,f;return a=function(t){function a(){return this.stopCommenting=e(this.stopCommenting,this),this.startCommenting=e(this.startCommenting,this),this.onCommentsToggled=e(this.onCommentsToggled,this),this.onCommentToggleClicked=e(this.onCommentToggleClicked,this),this._onCommentsChange=e(this._onCommentsChange,this),this.enable=e(this.enable,this),this.disable=e(this.disable,this),f=a.__super__.constructor.apply(this,arguments),f}return r(a,t),a.prototype.className="comments-container",a.prototype.ui={commentText:".js-submit-comment-text",commentsCount:".js-comments-count",commentsDisplay:".js-comments-box",commentsSubmitButtons:".js-submit-action-buttons",commentsBox:".js-comments",innerCommentsBox:".js-inner-comments"},a.prototype.events={"click .js-comments-toggle":"onCommentToggleClicked","click .js-submit-comment":"onCommentSubmit","click .js-cancel-comment":"onCommentCancel",click:"onClick"},a.prototype.template=_.template(i),a.prototype.templateHelpers=function(){return{commentCount:this.commentCount()}},a.prototype.itemView=n,a.prototype.itemViewOptions=function(){return{site:this.site,mediator:this.mediator}},a.prototype.itemViewContainer=".inner-comments",a.prototype.initialize=function(e){return this.mediator=e.mediator,this.site=e.site,this.conn=e.conn,this.model=e.model,this.gadget=this.model,this.delegateEvents(),this.collection=new o,this.listenTo(this.collection,"add remove reset change:deleted",this._onCommentsChange)},a.prototype.onRender=function(){if(this.conn.subscribed)return this.enable()},a.prototype.onShow=function(){return u.on("comment:add",this.addComment,this),u.on("comment:delete",this.deleteComment,this),u.on("comments:toggle",this.onCommentsToggled,this),u.on("comments:ready",this.onReady,this),this.conn.on("ws:open",this.enable),this.conn.on("ws:close",this.disable),u.trigger("commentsView:ready",this.gadget.id)},a.prototype.onClose=function(){return u.off("comment:add",this.addComment,this),u.off("comment:delete",this.deleteComment,this),u.off("comments:toggle",this.onCommentsToggled,this),u.off("comments:ready",this.onReady,this),this.conn.off("ws:open",this.enable),this.conn.off("ws:close",this.disable)},a.prototype.onClick=function(e){},a.prototype.onReady=function(){return this.ready=!0,this.enable()},a.prototype.disable=function(){return this.$el.hide()},a.prototype.enable=function(){return this.$el.show()},a.prototype.addComment=function(e){var t;t=e.get("gadgetId");if(t===this.gadget.id)return this.collection.add(e)},a.prototype.deleteComment=function(e){var t;if(e.gadgetId===this.gadget.id)return(t=this.collection.get(e.commentId))!=null?t.set({deleted:!0}):void 0},a.prototype.onCommentSubmit=function(){var e;if(!this.ui.commentText.val())return;return e=new s({gadgetId:this.gadget.id,body:this.ui.commentText.val(),user:this.conn.me}),e.editable=!0,this.ui.commentText.val(""),this.addComment(e),u.trigger("comment:added",e),this.scrollToBottom()},a.prototype.commentCount=function(){var e,t;return e=this.collection.reject(function(e){return e.get("deleted")}),t=e.length,t>99?"99+":t<=0?"+":t},a.prototype._onCommentsChange=function(e){return this.collection.collapseDeletedComments(e),this.ui.commentsCount.text(this.commentCount()),this.children.each(function(e){return e.startUpdatingTimeSince()})},a.prototype.hideComments=function(){return this.ui.commentsDisplay.hide()},a.prototype.onCommentCancel=function(){return this.ui.commentText.val("")},a.prototype.checkForCollapsedComments=function(){return this.children.each(function(e){return e.determineHeight()})},a.prototype.scrollToBottom=function(){return this.ui.innerCommentsBox.scrollTop(this.ui.innerCommentsBox[0].scrollHeight)},a.prototype.show=function(){var e;return this.$el.addClass("comments-visible"),this.checkForCollapsedComments(),e=this.ui.commentsDisplay.height()+this.ui.commentsDisplay.offset().top,this.ui.commentsDisplay.toggleClass("above",e>$("body").height()),this.scrollToBottom(),this.ui.commentText.focus()},a.prototype.hide=function(){return this.$el.removeClass("comments-visible"),this.ui.commentsDisplay.removeClass("above"),this.children.each(function(e){return e.stopUpdatingTimeSince()})},a.prototype.onCommentToggleClicked=function(){return u.trigger("comments:toggle",this.gadget)},a.prototype.onCommentsToggled=function(e){return e.id===this.gadget.id?this.toggleCommenting():this.stopCommenting()},a.prototype.toggleCommenting=function(){return this.isCommenting()?this.stopCommenting():this.startCommenting()},a.prototype.isCommenting=function(){return!!this.gadget.get("isCommenting")},a.prototype.startCommenting=function(){return this.gadget.set({isCommenting:!0}),this.show(),$(window).one("click",this.stopCommenting),this.$el.on("click",this._prevent)},a.prototype.stopCommenting=function(){return this.gadget.set({isCommenting:!1}),this.hide(),$(window).off("click",this.stopCommenting),this.$el.off("click",this._prevent)},a.prototype._prevent=function(e){return e.stopPropagation()},a}(t.CompositeView)})}.call(this),n("text!templates/gadget_lock.html",[],function(){return'<i class="collab-lock-icon icon-lock"></i>\n<img class="collab-lock-avatar js-lock-avatar" src="<%- profileImage() %>"></img>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("views/lock",["backbone.marionette","text!templates/gadget_lock.html","vent"],function(e,n,r){var i,s,o;return i="gadget-locked",s=function(e){function s(){return o=s.__super__.constructor.apply(this,arguments),o}return t(s,e),s.prototype.template=_.template(n),s.prototype.initialize=function(e){return this.model=e.model,this.site=e.site,this.mediator=e.mediator,this.conn=e.conn,this.gadget=this.model},s.prototype.onShow=function(){var e=this;return r.on("lock:lock",this.onLockLocked,this),r.on("lock:unlock",this.onLockUnlocked,this),this.conn.on("ws:close",this._unlock,this),this.conn.activeLocks.each(function(t){return e.onLockLocked(t)})},s.prototype.onClose=function(){return r.off("lock:lock",this.onLockLocked,this),r.off("lock:unlock",this.onLockUnlocked,this),this.conn.off("ws:close",this._unlock,this)},s.prototype.ui={editor:".js-lock-avator",lock:".icon-lock"},s.prototype.templateHelpers=function(){var e=this;return{isLocked:function(){return!!e.gadget.lock},name:function(){if(!e.gadget.lock)return;return e.gadget.lock.get("user").firstname||e.gadget.lock.get("user").fn||"Anonymous"},profileImage:function(){var t,n,r;if(!e.gadget.lock)return;return n=(r=e.gadget.lock.get("user").image)!=null?r.representations:void 0,n?(t=_.find(n,function(e){return e.scale==="140x140"}),t.location):""+e.site+"/assets/img/defaults/profile-retina.jpg"}}},s.prototype.onLockLocked=function(e){if(e.get("gadgetId")===this.gadget.id)return this.updateLock(e)},s.prototype.updateLock=function(e){if(e.get("user").id===this.conn.me.id)return;return this.gadget.lock=e,e.user!==this.conn.me&&this.$el.closest(".gadget").toggleClass(i,!0),this.render()},s.prototype.onLockUnlocked=function(e){var t;t=e.get("gadgetId");if(this.conn.gadgetHasUpdates(t))return;if(this.gadget.lock&&t===this.gadget.id)return this._unlock()},s.prototype._unlock=function(){if(!this.gadget.lock)return;return this.gadget.lock.user!==this.conn.me&&this.$el.closest(".gadget").toggleClass(i,!1),delete this.gadget.lock,this.render()},s}(e.ItemView)})}.call(this),n("text!templates/update.html",[],function(){return'<div class="updateNotification">\n  <i class="icon-refresh"></i><span class="updateNotificationMsg">See new update<span>\n</div>'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,r=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};n("views/update",["underscore","backbone.marionette","text!templates/update.html","vent"],function(t,n,i,s){var o,u;return o=function(n){function o(){return this.onCollabUpdate=e(this.onCollabUpdate,this),this.onCourseRefetchFail=e(this.onCourseRefetchFail,this),this.onCourseRefetchSuccess=e(this.onCourseRefetchSuccess,this),this.onUpdateNotificationClick=e(this.onUpdateNotificationClick,this),this.onLessonOpened=e(this.onLessonOpened,this),u=o.__super__.constructor.apply(this,arguments),u}return r(o,n),o.prototype.initialize=function(e){return this.conn=e.conn,this.mediator=e.mediator,this._containerSlideTime=80},o.prototype.ui={collabErrorMsg:".collabErrorMsg",updateNotificationMsg:".updateNotificationMsg",updateNotification:".updateNotification"},o.prototype.events={"click .updateNotification":"onUpdateNotificationClick"},o.prototype.template=t.template(i),o.prototype.onShow=function(){return s.on("collab:update",this.onCollabUpdate),s.on("lesson:opened",this.onLessonOpened),this.conn.on("collab:ready",this.onEnableCollab),this.conn.on("collab:close",this.onDisableCollab)},o.prototype.onClose=function(){return s.off("collab:update",this.onCollabUpdate),s.off("lesson:opened",this.onLessonOpened),this.conn.off("collab:ready",this.onEnableCollab),this.conn.off("collab:close",this.onDisableCollab)},o.prototype.onLessonOpened=function(e){return this.lesson=e},o.prototype.onUpdateNotificationClick=function(){return this.conn.resetUpdates(),this.message("Fetching Updates..."),this.lesson.fetch().done(this.onCourseRefetchSuccess).fail(this.onCourseRefetchFail)},o.prototype.onCourseRefetchSuccess=function(){return this.conn.hasUpdates()?this.onCollabUpdate():this.slideUp()},o.prototype.onCourseRefetchFail=function(){return this.message("Failed to update lesson, please try again!")},o.prototype.onCollabUpdate=function(){var e;return e=this.conn.updateCount()===1?"See new update":"See "+this.conn.updateCount()+" new updates",this.conn.hasGadgetUpdates()&&(e+="; unlock updated gadgets"),this.message(e),this.slideDown()},o.prototype.slideUp=function(){return this.ui.updateNotification.slideUp(this._containerSlideTime)},o.prototype.slideDown=function(){return this.ui.updateNotification.slideDown(this._containerSlideTime)},o.prototype.message=function(e){return this.ui.updateNotificationMsg.text(e)},o}(n.Layout)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};n("collections/gadget_locks",["backbone","models/gadget_lock"],function(e,n){var r,i;return r=function(e){function r(){return i=r.__super__.constructor.apply(this,arguments),i}return t(r,e),r.prototype.model=n,r}(e.Collection)})}.call(this),n("text!styles/collab-client-bundle.css",[],function(){return".collab-lock-icon{font-size:24px;text-indent:7px;margin-top:5px;color:#e4e3e0}.collab-lock-avatar{width:32px;height:32px;position:absolute;right:5px;top:5px}.comments-container{display:none;}.comments-container.comments-visible .comments-box{display:block}.comments-container.comments-visible .fv-bubble{transform:none;filter:none}.comments-container.comments-visible .commentAuthor{font-family:'AvenirNextLTPro-Regular','Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:bold}.comments-toolbar{position:absolute;list-style-type:none;padding:0;margin:0;top:0;color:#454442;text-align:left;right:-30px;color:#c7c3be;width:16px;}.comments-toolbar button{margin:7px}.comments-toolbar textarea{resize:none;margin:7px;color:#454442;font:12px 'AvenirNextLTPro-Regular','Helvetica Neue',Helvetica,Arial,sans-serif;width:196px;box-sizing:border-box}.comments-toolbar .deleted_comment{font-style:italic;color:#c7c3be}.comments-toolbar .actions{height:22px}.comments-toolbar .comment{color:#454442;font:12px 'AvenirNextLTPro-Regular','Helvetica Neue',Helvetica,Arial,sans-serif;border-width:1px;border-bottom:1px #e4e3e0 solid;padding:7px;line-height:18px;position:relative;}.comments-toolbar .comment:first-child{margin-top:-8px}.comments-toolbar .comment .delete-overlay{position:absolute;top:0;left:0;width:100%;height:100%;text-align:center;background:rgba(242,241,237,0.9);display:none;z-index:100;}.comments-toolbar .comment .delete-overlay .delete-content{position:absolute;top:50%;margin-top:-35px}.comments-toolbar .comment .delete-overlay button{display:inline-block;width:80px}.comments-toolbar .comment.compacted .comment-body{overflow:hidden;max-height:142px;position:relative;z-index:1}.comments-toolbar .comment.compacted .comment-actions{position:relative;z-index:2;box-shadow:0 -15px 10px #fff;}.comments-toolbar .comment.compacted .comment-actions .show-more{display:inline}.comments-toolbar .comment.expanded .comment-actions .show-less{display:inline}.comments-toolbar .comment img{width:40px;height:40px}.comments-toolbar .comment .commentInfo{display:inline-block;line-height:.2;}.comments-toolbar .comment .commentInfo .commentDate{color:#c7c3be}.comments-toolbar .comment .comment-actions{height:16px;position:relative;}.comments-toolbar .comment .comment-actions .comment-action{color:#c7c3be;text-decoration:underline;cursor:pointer}.comments-toolbar .comment .show-less,.comments-toolbar .comment .show-more{display:none}.comments-toolbar .comments{position:absolute;}.comments-toolbar .comments .errorMsg{text-align:center;color:#454442;font:12px 'AvenirNextLTPro-Regular','Helvetica Neue',Helvetica,Arial,sans-serif;margin:5px;padding:5px 0;background-color:rgba(242,241,237,0.9)}.comments-toolbar .comments-toggle{cursor:pointer;height:24px;}.comments-toolbar .comments-toggle:hover .fv-bubble{color:#c7c3be}.comments-toolbar .fv-bubble{margin-left:-5px;margin-top:-5px;font-size:24px;color:#eae9e7;transform:scaleX(-1);filter:FlipH}.comments-toolbar .icon-inner-text{margin-top:1px;margin-left:-5px;font:11px 'AvenirNextLTPro-Regular','Helvetica Neue',Helvetica,Arial,sans-serif;color:#524e47;font-weight:bold;display:table-cell;vertical-align:middle}.comments-toolbar .comments-box{display:none;position:absolute;box-shadow:0 1px 12px #c7c3be;padding:0;background-color:#fff;z-index:1002;margin-left:20px;width:210px;}.comments-toolbar .comments-box.visible{display:block}.comments-toolbar .comments-box.above{bottom:0}.comments-toolbar .comments-box p{margin:5px}.comments-toolbar .comments-box .comment-body{margin-left:0}.comments-toolbar .comments-box .inner-comments{max-height:225px;height:auto;overflow:auto;margin-top:8px}.comments-toolbar .comments-box button{padding:1px 0;line-height:28px;width:95px;}.comments-toolbar .comments-box button.cancel-button{margin-right:0}.comments-toolbar .comments-box button.submit-button{margin-left:0}.updateNotificationContainer{position:fixed;top:0;width:100%;max-width:758px;left:291px;z-index:5010;margin:0 auto;text-align:center;cursor:pointer;}.updateNotificationContainer .updateNotification{display:none;cursor:pointer;color:#486b6d;padding:10px 0;background-color:rgba(242,241,237,0.9)}.updateNotificationContainer .updateNotificationMsg{margin-left:10px}\n"}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};n("collab",["underscore","backbone","handlers/users","handlers/locks","handlers/comments","handlers/updates","views/contributors","views/comments","views/lock","views/update","vent","models/gadget_comment","models/gadget_lock","collections/gadget_comments","collections/collapsible_gadget_comments","collections/gadget_locks","text!styles/collab-client-bundle.css"],function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y;return y=function(){function y(){this._populatePlayerUpdate=e(this._populatePlayerUpdate,this),this._populatePlayerContrib=e(this._populatePlayerContrib,this),this.phoneHome=e(this.phoneHome,this),this.onMessage=e(this.onMessage,this),this.onClose=e(this.onClose,this),this.onOpen=e(this.onOpen,this),this.onError=e(this.onError,this),this.connect=e(this.connect,this)}return t.extend(y.prototype,n.Events),y.prototype.GadgetComment=h,y.prototype.GadgetComments=d,y.prototype.CollapsibleGadgetComments=v,y.prototype.GadgetLock=p,y.prototype.GadgetLocks=m,y.prototype.phoneHomeEveryMs=6e4,y.prototype.tryConnectingEveryMs=2e3,y.prototype.lastActivity=new Date,y.prototype.updates=[],y.prototype.init=function(e,t){return this.mediator=e,this.courseId=t.courseId,this.collabUrl=t.collabUrl,this.site=t.site,this.sessionId=t.api.sessionId,this.connect(),this.resetLastActivity(),this._injectStyles(),new r(this),new i(this),new s(this),new o(this),this.contributorsView=new u({mediator:this.mediator,conn:this,site:this.site}),this.updateBarView=new l({mediator:this.mediator,conn:this}),this.enabled=!1,this.subscribed=!1,this.activeLocks=new this.GadgetLocks,this.initializedGadgetViewContainers=[],this.mediator.on("lesson:opened",this.onLessonOpened,this),this.mediator.on("lesson:closed",this.onLessonClosed,this),this.mediator.on("gadget:rendered",this.onGadgetRendered,this),this.mediator.on("player:authorSideBar:ready",this._populatePlayerContrib,this),this.mediator.on("player:course:ready",this._populatePlayerUpdate,this)},y.prototype.onLessonOpened=function(e){var t=this;return this.enabled?(this.subscribe(e.id),c.trigger("lesson:opened",e)):this.once("ws:open",function(){return t.subscribe(e.id),c.trigger("lesson:opened",e)})},y.prototype.onLessonClosed=function(e){return this.unsubscribe(e.id)},y.prototype.connect=function(){return this.socket=new WebSocket(this.collabUrl),this.socket.onopen=this.onOpen,this.socket.onclose=this.onClose,this.socket.onerror=this.onError,this.socket.onmessage=this.onMessage},y.prototype.onError=function(e){var t;return t=e.channel?"error connecting to course "+e.channel.courseId+" lesson "+e.channel.courseId:"error connecting to "+this.collabUrl,this.trigger("ws:error",t,e)},y.prototype.onOpen=function(){return this.cancelRetryConnect(),this.phoneHomePeriodically(),this.enabled=!0,this.lessonId&&this.subscribe(this.lessonId),this.trigger("ws:open"),this.mediator.trigger("course:collab:open")},y.prototype.subscribe=function(e){this.lessonId=e;if(!this.lessonId)throw new Error("No lesson ID to subscribe to");return this.triggerEvent("subscribe",{sessionId:this.sessionId})},y.prototype.unsubscribe=function(){return this.triggerEvent("unsubscribe"),delete this.lessonId},y.prototype.onClose=function(){return clearTimeout(this.phoneHomeId),this.scheduleRetryConnect(),this.enabled=!1,this.subscribed=!1,this.trigger("ws:close"),this.mediator.trigger("course:collab:close")},y.prototype.resetLastActivity=function(){return this.lastActivity=(new Date).getTime()},y.prototype.onMessage=function(e){var t,n;return this.subscribed=!0,n=JSON.parse(e.data),t=this._dataToModels(n),this.trigger(n.name,t)},y.prototype.scheduleRetryConnect=function(){return this.retryId=setTimeout(this.connect,this.tryConnectingEveryMs)},y.prototype.cancelRetryConnect=function(){if(this.retryId)return clearTimeout(this.retryId)},y.prototype.phoneHome=function(){var e;return e=(new Date).getTime(),this.triggerEvent("ping",{idleMs:e-this.lastActivity})},y.prototype.phoneHomePeriodically=t.once(function(){return this.phoneHomeId=setInterval(this.phoneHome,this.phoneHomeEveryMs)}),y.prototype.onGadgetRendered=function(e){return this._populatePlayerCommentsLocks(e)},y.prototype.triggerEvent=function(e,t){var n;return n={lessonId:this.lessonId,courseId:this.courseId},this.socket.send(JSON.stringify({name:e,channel:n,data:t}))},y.prototype.hasUpdates=function(){return!!this.updates.length},y.prototype.updateCount=function(){return this.updates.length},y.prototype.resetUpdates=function(){return this.updates=[]},y.prototype.hasGadgetUpdates=function(){return t.any(this.updates,function(e){return t.has(e,"gadgetId")})},y.prototype.gadgetHasUpdates=function(e){return!!t.findWhere(this.updates,{gadgetId:e})},y.prototype._dataToModels=function(e){var t,n,r,i,s,o;return i={comment:"GadgetComment",comments:"GadgetComments",lock:"GadgetLock",locks:"GadgetLocks"},n=this._dereferenceEventData(e),o=e.name.split(":"),r=o[0],t=o[1],s=i[r],s&&t!=="delete"?new vs.collab[s](n):n},y.prototype._dereferenceEventData=function(e){var t;return t=e.name.split(":").shift(),e.data[t]},y.prototype._generateCommentsLocks=function(e){var t,n,r,i;return t=new a({model:e,mediator:this.mediator,site:this.site,conn:this}),r=new f({model:e,mediator:this.mediator,site:this.site,conn:this}),(n=(i=this.activeLocks)!=null?i.findWhere({gadgetId:e.id}):void 0)&&r.updateLock(n),{lockView:r,commentsView:t}},y.prototype._populatePlayerCommentsLocks=function(e){var t,n,r;return r=this._generateCommentsLocks(e),n=r.lockView,t=r.commentsView,this.mediator.trigger("plugin:populate:gadgetCommentsRegion",t),this.mediator.trigger("plugin:populate:gadgetLockRegion",n)},y.prototype._populatePlayerContrib=function(){return this.mediator.trigger("plugin:populate:contributorsRegion",this.contributorsView)},y.prototype._populatePlayerUpdate=function(){return this.mediator.trigger("plugin:populate:updateBar",this.updateBarView)},y.prototype._injectStyles=function(){var e;return e=document.createElement("style"),e.textContent=g,document.getElementsByTagName("head")[0].appendChild(e)},y}(),new y})}.call(this),n("underscore",[],function(){return window._}),n("backbone",[],function(){return window.Backbone}),n("backbone.marionette",[],function(){return window.Backbone.Marionette}),t("collab")}),define("text",["module"],function(e){var t,n,r,i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f=typeof location!="undefined"&&location.href,l=f&&location.protocol&&location.protocol.replace(/\:/,""),c=f&&location.hostname,h=f&&(location.port||undefined),p={},d=e.config&&e.config()||{};t={version:"2.0.12",strip:function(e){if(e){e=e.replace(u,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:d.createXhr||function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,r,i=!1,s=e.indexOf("."),o=e.indexOf("./")===0||e.indexOf("../")===0;return s!==-1&&(!o||s>1)?(t=e.substring(0,s),n=e.substring(s+1,e.length)):t=e,r=n||t,s=r.indexOf("!"),s!==-1&&(i=r.substring(s+1)==="strip",r=r.substring(0,s),n?n=r:t=r),{moduleName:t,ext:n,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,i){var s,o,u,a=t.xdRegExp.exec(e);return a?(s=a[2],o=a[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===n)&&(!o||o.toLowerCase()===r.toLowerCase())&&(!u&&!o||u===i)):!0},finishLoad:function(e,n,r,i){r=n?t.strip(r):r,d.isBuild&&(p[e]=r),i(r)},load:function(e,n,r,i){if(i&&i.isBuild&&!i.inlineText){r();return}d.isBuild=i&&i.isBuild;var s=t.parseName(e),o=s.moduleName+(s.ext?"."+s.ext:""),u=n.toUrl(o),a=d.useXhr||t.useXhr;if(u.indexOf("empty:")===0){r();return}!f||a(u,l,c,h)?t.get(u,function(n){t.finishLoad(e,s.strip,n,r)},function(e){r.error&&r.error(e)}):n([o],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,r)})},write:function(e,n,r,i){if(p.hasOwnProperty(n)){var s=t.jsEscape(p[n]);r.asModule(e+"!"+n,"define(function () { return '"+s+"';});\n")}},writeFile:function(e,n,r,i,s){var o=t.parseName(n),u=o.ext?"."+o.ext:"",a=o.moduleName+u,f=r.toUrl(o.moduleName+u)+".js";t.load(a,r,function(n){var r=function(e){return i(f,e)};r.asModule=function(e,t){return i.asModule(e,f,t)},t.write(e,a,r,s)},s)}};if(d.env==="node"||!d.env&&typeof process!="undefined"&&process.versions&&!!process.versions.node&&!process.versions["node-webkit"])n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=n.readFileSync(e,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),t(i)}catch(s){r&&r(s)}};else if(d.env==="xhr"||!d.env&&t.createXhr())t.get=function(e,n,r,i){var s=t.createXhr(),o;s.open("GET",e,!0);if(i)for(o in i)i.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),i[o]);d.onXhr&&d.onXhr(s,e),s.onreadystatechange=function(t){var i,o;s.readyState===4&&(i=s.status||0,i>399&&i<600?(o=new Error(e+" HTTP status: "+i),o.xhr=s,r&&r(o)):n(s.responseText),d.onXhrComplete&&d.onXhrComplete(s,e))},s.send(null)};else if(d.env==="rhino"||!d.env&&typeof Packages!="undefined"&&typeof java!="undefined")t.get=function(e,t){var n,r,i="utf-8",s=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),i)),a="";try{n=new java.lang.StringBuffer,r=u.readLine(),r&&r.length()&&r.charAt(0)===65279&&(r=r.substring(1)),r!==null&&n.append(r);while((r=u.readLine())!==null)n.append(o),n.append(r);a=String(n.toString())}finally{u.close()}t(a)};else if(d.env==="xpconnect"||!d.env&&typeof Components!="undefined"&&Components.classes&&Components.interfaces)r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,o,u,a={};s&&(e=e.replace(/\//g,"\\")),u=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),n.init(u,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(n,"utf-8",n.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),a),o.close(),n.close(),t(a.value)}catch(f){throw new Error((u&&u.path||"")+": "+f)}};return t}),define("text!templates/course.html",[],function(){return'<div class="js-update-notification-container updateNotificationContainer"></div>\n<div class="js-loading loading"></div>\n<div class="js-lessons lessons"></div>\n<div class="js-nav nav"></div>\n'}),function(){var e=[].slice;define("messages/channel",[],function(){var t;return t=function(){function t(){this._subscribers=[],this.channels={}}return t.prototype.on=function(e,t){var n;return t==null&&(t=this),n={context:t,callback:e},this._subscribers.push(n)},t.prototype.off=function(e,t){var n,r,i,s,o;t==null&&(t=null),o=[];for(n=i=s=this._subscribers.length-1;i>=0;n=i+=-1)r=this._subscribers[n],e?r.callback===e?t==null||r.context===t?o.push(this._subscribers.splice(n,1)):o.push(void 0):o.push(void 0):o.push(this._subscribers.splice(n,1));return o},t.prototype.trigger=function(){var t,n,r,i,s,o;t=1<=arguments.length?e.call(arguments,0):[],s=this._subscribers,o=[];for(r=0,i=s.length;r<i;r++)n=s[r],o.push(n.callback.apply(n.context,t));return o},t}()})}.call(this),function(){var e=[].slice;define("messages/mediator",["messages/channel"],function(t){var n;return n=function(){function n(){this.channels=new t}return n.prototype.getChannel=function(e){var n,r,i,s;n=e.split(":"),r=this.channels;while(n.length)s=n.shift(),i=r.channels,i[s]||(i[s]=new t),r=i[s];return r},n.prototype.on=function(e,t,n){var r,i,s,o,u,a;if(!e)return;u=e.split(" "),a=[];for(s=0,o=u.length;s<o;s++)i=u[s],r=this.getChannel(i),a.push(r.on(t,n!=null?n:n=this));return a},n.prototype.off=function(e,t,n){var r,i,s,o,u,a;if(!e)return;u=e.split(" "),a=[];for(s=0,o=u.length;s<o;s++)i=u[s],r=this.getChannel(i),a.push(r.off(t,n!=null?n:n=this));return a},n.prototype.trigger=function(){var t,n,r,i,s;i=arguments[0],r=2<=arguments.length?e.call(arguments,1):[],t=i.split(":"),n=this.channels,s=[];while(t.length){if(!(n=n.channels[t.shift()]))break;t.length?s.push(n.trigger.apply(n,[t.join(":")].concat(e.call(r)))):s.push(n.trigger.apply(n,r))}return s},n.prototype.triggerGadgetEvent=function(){var t,n,r;return n=arguments[0],r=arguments[1],t=3<=arguments.length?e.call(arguments,2):[],r="gadget:"+n+":"+r,this.trigger.apply(this,[r].concat(e.call(t)))},n}()})}.call(this),function(){define("app/mediator",["messages/mediator"],function(e){var t;return t=new e})}.call(this),function(){define("plugins/clonedeep",[],function(){var e;return e=function(t){var n,r,i;if(t===null||typeof t!="object")return t;r=t.constructor();for(n in t)i=t[n],r[n]=e(i);return r}})}.call(this),function(){define("models/settings",["cdn.underscore","plugins/clonedeep"],function(e,t){var n,r,i;return n={whitelabel:!1,embed:!1,site:"//versal.com",container:".player-container",sdk:!1},r={},i=function(e){var t,n;return typeof e.api=="string"&&(e.api={url:e.api}),e.sid&&(e.api.sessionId=e.sid,delete e.sid),e.sessionId&&(e.api.sessionId=e.sessionId,delete e.sessionId),e.course&&(e.courseId=e.course,delete e.course),delete e.event,e.playerUrl||((t=(n=e.api.url)!=null?n.match(/^(https?:\/\/.+?)\//)[1]:void 0)?e.playerUrl=""+t+"/player2":e.playerUrl=""),e},{get:function(e){return t(r[e])},set:function(t){if(!e.isEmpty(r))throw new Error("Options have already been set");if(!e.isObject(t))throw new Error("Options must be an object");if(t.api==null)throw new Error("Please set options.api!");return r=e.defaults({},i(t),n)},toJSON:function(){return t(r)}}})}.call(this),define("libs/keen",[],function(){return window.Keen=window.Keen||{configure:function(e){this._cf=e},addEvent:function(e,t,n,r){this._eq=this._eq||[],this._eq.push([e,t,n,r])},setGlobalProperties:function(e){this._gp=e},onChartsReady:function(e){this._ocrq=this._ocrq||[],this._ocrq.push(e)}},function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://":"http://")+"dc8na2hxrj29i.cloudfront.net/code/keen-2.1.0-min.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}(),window.Keen}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("plugins/tracker",["cdn.underscore","cdn.jquery","models/settings","libs/keen"],function(t,n,r,i){var s,o,u,a,f,l,c,h;return a=[],l={},u=((h=r.get("tracker"))!=null?h.interval:void 0)||2e4,f=function(){var e,i,s,o;return i=(s=r.get("tracker"))!=null?s.path:void 0,!i||a.length<1?!1:(e=t.clone(a),n.ajax({type:"POST",url:i,contentType:"application/json",data:JSON.stringify(a),success:function(){return a=t.difference(a,e)},headers:{AUTHSID:(o=r.get("api"))!=null?o.sessionId:void 0}}))},c=t.throttle(f,u,{leading:!1}),s=function(){function e(e){this._name=e.name||"",this._initialData=e.data||{},this._stopCb=e.done||function(){},this._startTime=this._currentTime()}return e.prototype.stop=function(e){return this._stopCb({name:this._name,data:t.extend({},this._initialData,e),duration:this._currentTime()-this._startTime})},e.prototype._currentTime=function(){return(new Date).getTime()},e}(),o=function(){function n(t){this._source=t,this._addTypes=e(this._addTypes,this)}return n.addSessionData=function(e){return l=t.extend({},l,e)},n.prototype.track=function(e,n){var s,o,u,f;n==null&&(n={}),s=t.extend(n,this._metadata,l),a.push(this._addTypes({source:this._source,event:e,data:s,ts_dt:Math.round((new Date).getTime()/1e3)})),c(),o=t.extend(s,{source:this._source}),((u=r.get("tracker"))!=null?u.path:void 0)&&i.addEvent(e,o);if((f=r.get("tracker"))!=null?f.debug:void 0)return console.log("keen",e,o)},n.prototype.createTimer=function(e,n){var r,i=this;return n==null&&(n={}),r=function(e){var n,r,s;return s=e.name,n=e.data,r=e.duration,i.track(s,t.extend(n,{duration:r}))},new s({name:e,data:n,done:r})},n.prototype.setMetadata=function(e){this._metadata=e},n.prototype.timeXHR=function(e,t,n){var r;return r=this.createTimer(t,n),e.always(function(e,t){return r.stop({status:t})})},n.prototype._addTypes=function(e){var n,r=this;return t.isArray(e)?t.map(e,this._addTypes):t.isObject(e)?(n=t.map(t.pairs(e),function(e){var n,i,s,o,u;return n=e[0],o=e[1],i=n+((u=n.slice(-3))==="_i"||u==="_f"||u==="_dt"||u==="_tsd"?"":t.isNumber(o)?o%1===0?"_i":"_f":t.isString(o)?"_tsd":""),s=t.isObject(o)?r._addTypes(o):o,[i,s]}),t.object(n)):e},n}()})}.call(this),function(){define("messages/player_tracker",["plugins/tracker"],function(e){return new e("player")})}.call(this),define("libs/vs.ui",["cdn.backbone"],function(){var e,t,n;return function(r){function i(e,t){return E.call(e,t)}function s(e,t){var n,r,i,s,o,u,a,f,l,c,h=t&&t.split("/"),p=b.map,d=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(h=h.slice(0,h.length-1),e=h.concat(e.split("/")),f=0;f<e.length;f+=1)if(c=e[f],"."===c)e.splice(f,1),f-=1;else if(".."===c){if(1===f&&(".."===e[2]||".."===e[0]))break;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||d)&&p){for(n=e.split("/"),f=n.length;f>0;f-=1){if(r=n.slice(0,f).join("/"),h)for(l=h.length;l>0;l-=1)if(i=p[h.slice(0,l).join("/")],i&&(i=i[r])){s=i,o=f;break}if(s)break;!u&&d&&d[r]&&(u=d[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function u(e,t){return function(){return d.apply(r,S.call(arguments,0).concat([e,t]))}}function a(e){return function(t){return s(t,e)}}function f(e){return function(t){g[e]=t}}function l(e){if(i(y,e)){var t=y[e];delete y[e],w[e]=!0,p.apply(r,t)}if(!i(g,e)&&!i(w,e))throw new Error("No "+e);return g[e]}function c(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function h(e){return function(){return b&&b.config&&b.config[e]||{}}}var p,d,v,m,g={},y={},b={},w={},E=Object.prototype.hasOwnProperty,S=[].slice;v=function(e,t){var n,r=c(e),i=r[0];return e=r[1],i&&(i=s(i,t),n=l(i)),i?e=n&&n.normalize?n.normalize(e,a(t)):s(e,t):(e=s(e,t),r=c(e),i=r[0],e=r[1],i&&(n=l(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},m={require:function(e){return u(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:h(e)}}},p=function(e,t,n,s){var o,a,c,h,p,d,b=[];if(s=s||e,"function"==typeof n){for(t=!t.length&&n.length?["require","exports","module"]:t,p=0;p<t.length;p+=1)if(h=v(t[p],s),a=h.f,"require"===a)b[p]=m.require(e);else if("exports"===a)b[p]=m.exports(e),d=!0;else if("module"===a)o=b[p]=m.module(e);else if(i(g,a)||i(y,a)||i(w,a))b[p]=l(a);else{if(!h.p)throw new Error(e+" missing "+a);h.p.load(h.n,u(s,!0),f(a),{}),b[p]=g[a]}c=n.apply(g[e],b),e&&(o&&o.exports!==r&&o.exports!==g[e]?g[e]=o.exports:c===r&&d||(g[e]=c))}else e&&(g[e]=n)},e=t=d=function(e,t,n,i,s){return"string"==typeof e?m[e]?m[e](t):l(v(e,t).f):(e.splice||(b=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},"function"==typeof n&&(n=i,i=s),i?p(r,e,t,n):setTimeout(function(){p(r,e,t,n)},4),d)},d.config=function(e){return b=e,b.deps&&d(b.deps,b.callback),d},e._defined=g,n=function(e,t,n){t.splice||(n=t,t=[]),i(g,e)||i(y,e)||(y[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("libs/almond",function(){}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};n("editable_text",[],function(){var t,n,r;return n=[],r=function(e){var t,n;return t=document.createRange(),t.selectNodeContents(e),n=window.getSelection(),n.removeAllRanges(),n.addRange(t),e.focus()},t=function(){function t(t){this.onFocus=e(this.onFocus,this),this.onBlur=e(this.onBlur,this),this.onKeyUp=e(this.onKeyUp,this),this.onKeyPress=e(this.onKeyPress,this),this.onKeyDown=e(this.onKeyDown,this),n.push(this),this.options=_.defaults(t,_.result(this,"defaults")),this.$el=this.options.el,this.$el.attr("contenteditable",!1),this.$el.addClass("vs-ui-editable-text"),this._isEditing=!1,this.options.charCount&&this.attachCharacterCount(this.options.charCount),this.$el.on(this.events())}return t.prototype.defaults=function(){return{el:$("<div>"),type:"input",charCount:0,success:function(){},abort:function(){},complete:function(){},maxlength:!1}},t.prototype.events=function(){return{blur:this.onBlur,focus:this.onFocus,keyup:this.onKeyUp,keydown:this.onKeyDown,keypress:this.onKeyPress}},t.prototype.onKeyDown=function(e){return 13===e.keyCode&&"input"===this.options.type&&(e.preventDefault(),this.success(),this.$el.blur()),27===e.keyCode?(e.preventDefault(),this.setText(this._oldContent),this.abort()):void 0},t.prototype.onKeyPress=function(e){var t,n,r;return t=e.originalEvent,r=!!(t.char||t.charCode&&String.fromCharCode(t.charCode)),n=this.getPretty().length,this.options.maxlength&&n>=this.options.maxlength&&r?e.preventDefault():void 0},t.prototype.onKeyUp=function(e){var t;return t=this.getPretty().length,this.options.maxlength&&t>this.options.maxlength&&this.setText(this.getPretty().slice(0,this.options.maxlength)),t||13===e.keyCode||this.$el.empty(),this.setCurrentCount(t)},t.prototype.onBlur=function(){return this.success(),this.hideCharCount()},t.prototype.onFocus=function(){return this.showCharCount()},t.prototype.selectText=function(){var e=this;return _.defer(function(){return r(e.$el[0])})},t.prototype.toggleEdit=function(e,t){var s,u=this;return null==t&&(t=!0),s=_.isBoolean(e),s&&e===this._isEditing?void 0:(this._isEditing=s?e:!this._isEditing,this._isEditing?(this.$el.attr("contenteditable",!0),t?_.defer(function(){return r(u.$el[0])}):this.hideCharCount(),this._oldContent=this.getPretty(),_.each(n,function(e){return u!==e&&e._isEditing?e.abort():void 0})):this.$el.attr("contenteditable",!1))},t.prototype.setText=function(e){return e?(this.$el.text(e),this.$el.html(this.$el.html().replace(/\n/gi,"<br>"))):void 0},t.prototype.getPretty=function(){var e;return e=$.trim(this.$el.html().replace(/\n/gi,"").replace(/<div><br><\/div>/gi,"\n").replace(/<div>/gi,"\n").replace(/<\/div>/gi,"").replace(/<br>/gi,"\n").replace(/\&nbsp\;/gi," ")),$("<div>").html(e).text()},t.prototype.attachCharacterCount=function(e){var t;return this.count=e,t='<div class="character-count pull-right">'+this.getPretty().length+"/"+this.count+"</div>",this.charCount=$(t),this.$el.after(this.charCount)},t.prototype.setCurrentCount=function(e){if(this.charCount){if(this.charCount.text(e+"/"+this.count),e>this.count&&!this._errorSet)return this._errorSet=!0,this.charCount.addClass("character-count-over");if(e<=this.count&&this._errorSet)return this._errorSet=!1,this.charCount.removeClass("character-count-over")}},t.prototype.showCharCount=function(){return this.charCount?this.charCount.removeClass("hidden"):void 0},t.prototype.hideCharCount=function(){return this.charCount?this.charCount.addClass("hidden"):void 0},t.prototype.abort=function(){return this.options.abort(),this.options.complete("abort")},t.prototype.success=function(){return this.options.success(this.getPretty()),this.options.complete("success")},t.prototype.destroy=function(){return this._isEditing&&this.toggleEdit(!1),this.$el.off(this.events()),n=_.without(n,this)},t}()})}.call(this),function(){n("loading",[],function(){var e;return e=function(){function e(e){var t,n;this.$parent=e,n=this.$parent.position(),t=$('<div class="loading">Loading</div>').css({top:n.top,left:n.left,position:"absolute"}),this.$el=t.appendTo(this.$parent)}return e.prototype.done=function(){return this.$el.remove()},e}()})}.call(this),n("../libs/spin",[],function(){return function(){function e(e,t){var n,r=document.createElement(e||"div");for(n in t)r[n]=t[n];return r}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,r){var i=["opacity",t,~~(100*e),n,r].join("-"),s=.01+n/r*100,o=Math.max(1-(1-e)/t*(100-s),e),u=f.substring(0,f.indexOf("Animation")).toLowerCase(),a=u&&"-"+u+"-"||"";return c[i]||(h.insertRule("@"+a+"keyframes "+i+"{0%{opacity:"+o+"}"+s+"%{opacity:"+e+"}"+(s+.01)+"%{opacity:1}"+(s+t)%100+"%{opacity:"+e+"}100%{opacity:"+o+"}}",h.cssRules.length),c[i]=1),i}function r(e,t){var n,r,i=e.style;if(void 0!==i[t])return t;for(t=t.charAt(0).toUpperCase()+t.slice(1),r=0;r<l.length;r++)if(n=l[r]+t,void 0!==i[n])return n}function i(e,t){for(var n in t)e.style[r(e,n)||n]=t[n];return e}function s(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)void 0===e[r]&&(e[r]=n[r])}return e}function o(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function u(e){return"undefined"==typeof this?new u(e):void (this.opts=s(e||{},u.defaults,p))}function a(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}h.addRule(".spin-vml","behavior:url(#default#VML)"),u.prototype.lines=function(e,r){function s(){return i(n("group",{coordsize:f+" "+f,coordorigin:-a+" "+ -a}),{width:f,height:f})}function o(e,o,u){t(c,t(i(s(),{rotation:360/r.lines*e+"deg",left:~~o}),t(i(n("roundrect",{arcsize:r.corners}),{width:a,height:r.width,left:r.radius,top:-r.width>>1,filter:u}),n("fill",{color:r.color,opacity:r.opacity}),n("stroke",{opacity:0}))))}var u,a=r.length+r.width,f=2*a,l=2*-(r.width+r.length)+"px",c=i(s(),{position:"absolute",top:l,left:l});if(r.shadow)for(u=1;u<=r.lines;u++)o(u,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(u=1;u<=r.lines;u++)o(u);return t(e,c)},u.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var f,l=["webkit","Moz","ms","O"],c={},h=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};u.defaults={},s(u.prototype,{spin:function(t){this.stop();var n,r,s=this,u=s.opts,a=s.el=i(e(0,{className:u.className}),{position:u.position,width:0,zIndex:u.zIndex}),l=u.radius+u.length+u.width;if(t&&(t.insertBefore(a,t.firstChild||null),r=o(t),n=o(a),i(a,{left:("auto"==u.left?r.x-n.x+(t.offsetWidth>>1):parseInt(u.left,10)+l)+"px",top:("auto"==u.top?r.y-n.y+(t.offsetHeight>>1):parseInt(u.top,10)+l)+"px"})),a.setAttribute("role","progressbar"),s.lines(a,s.opts),!f){var c,h=0,p=(u.lines-1)*(1-u.direction)/2,d=u.fps,v=d/u.speed,m=(1-u.opacity)/(v*u.trail/100),g=v/u.lines;!function y(){h++;for(var e=0;e<u.lines;e++)c=Math.max(1-(h+(u.lines-e)*g)%v*m,u.opacity),s.opacity(a,e*u.direction+p,c,u);s.timeout=s.el&&setTimeout(y,~~(1e3/d))}()}return s},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(r,s){function o(t,n){return i(e(),{position:"absolute",width:s.length+s.width+"px",height:s.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/s.lines*a+s.rotate)+"deg) translate("+s.radius+"px,0)",borderRadius:(s.corners*s.width>>1)+"px"})}for(var u,a=0,l=(s.lines-1)*(1-s.direction)/2;a<s.lines;a++)u=i(e(),{position:"absolute",top:1+~(s.width/2)+"px",transform:s.hwaccel?"translate3d(0,0,0)":"",opacity:s.opacity,animation:f&&n(s.opacity,s.trail,l+a*s.direction,s.lines)+" "+1/s.speed+"s linear infinite"}),s.shadow&&t(u,i(o("#000","0 0 4px #000"),{top:"2px"})),t(r,t(u,o(s.color,"0 0 1px rgba(0,0,0,.1)")));return r},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var d=i(e("group"),{behavior:"url(#default#VML)"});return!r(d,"transform")&&d.adj?a():f=r(d,"animation"),u}()}),function(){n("loading_indicator",["../libs/spin"],function(e){var t;return t=function(){function t(t,n){var r;null==n&&(n="#000"),r={lines:15,length:2,width:2,radius:8,corners:.4,rotate:0,direction:1,color:n,speed:.8,trail:46,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"},t instanceof $&&(t=t[0]),this.spinner=(new e(r)).spin(t)}return t.prototype.stop=function(){return this.spinner.stop()},t}()})}.call(this),function(e){var t=!1,n=!1,r=5e3,i=2e3,s=0,o=function(){var e=document.getElementsByTagName("script"),e=e[e.length-1].src.split("?")[0];return 0<e.split("/").length?e.split("/").slice(0,-1).join("/")+"/":""}(),u=["ms","moz","webkit","o"],f=window.requestAnimationFrame||!1,l=window.cancelAnimationFrame||!1;if(!f)for(var c in u){var h=u[c];f||(f=window[h+"RequestAnimationFrame"]),l||(l=window[h+"CancelAnimationFrame"]||window[h+"CancelRequestAnimationFrame"])}var p=window.MutationObserver||window.WebKitMutationObserver||!1,d={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"#424242",cursorwidth:"5px",cursorborder:"1px solid #fff",cursorborderradius:"5px",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:!0,background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1,bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:400,nativeparentscrolling:!0,enablescrollonselection:!0,overflowx:!0,overflowy:!0,cursordragspeed:.3,rtlmode:!1,cursordragontouch:!1,oneaxismousemode:"auto"},v=!1,m=function(){if(v)return v;var e=document.createElement("DIV"),t={haspointerlock:"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document};t.isopera="opera"in window,t.isopera12=t.isopera&&"getUserMedia"in navigator,t.isoperamini="[object OperaMini]"===Object.prototype.toString.call(window.operamini),t.isie="all"in document&&"attachEvent"in e&&!t.isopera,t.isieold=t.isie&&!("msInterpolationMode"in e.style),t.isie7=!(!t.isie||t.isieold||"documentMode"in document&&7!=document.documentMode),t.isie8=t.isie&&"documentMode"in document&&8==document.documentMode,t.isie9=t.isie&&"performance"in window&&9<=document.documentMode,t.isie10=t.isie&&"performance"in window&&10<=document.documentMode,t.isie9mobile=/iemobile.9/i.test(navigator.userAgent),t.isie9mobile&&(t.isie9=!1),t.isie7mobile=!t.isie9mobile&&t.isie7&&/iemobile/i.test(navigator.userAgent),t.ismozilla="MozAppearance"in e.style,t.iswebkit="WebkitAppearance"in e.style,t.ischrome="chrome"in window,t.ischrome22=t.ischrome&&t.haspointerlock,t.ischrome26=t.ischrome&&"transition"in e.style,t.cantouch="ontouchstart"in document.documentElement||"ontouchstart"in window,t.hasmstouch=window.navigator.msPointerEnabled||!1,t.ismac=/^mac$/i.test(navigator.platform),t.isios=t.cantouch&&/iphone|ipad|ipod/i.test(navigator.platform),t.isios4=t.isios&&!("seal"in Object),t.isandroid=/android/i.test(navigator.userAgent),t.trstyle=!1,t.hastransform=!1,t.hastranslate3d=!1,t.transitionstyle=!1,t.hastransition=!1,t.transitionend=!1;for(var n=["transform","msTransform","webkitTransform","MozTransform","OTransform"],r=0;r<n.length;r++)if("undefined"!=typeof e.style[n[r]]){t.trstyle=n[r];break}t.hastransform=0!=t.trstyle,t.hastransform&&(e.style[t.trstyle]="translate3d(1px,2px,3px)",t.hastranslate3d=/translate3d/.test(e.style[t.trstyle])),t.transitionstyle=!1,t.prefixstyle="",t.transitionend=!1;for(var n="transition webkitTransition MozTransition OTransition OTransition msTransition KhtmlTransition".split(" "),i=" -webkit- -moz- -o- -o -ms- -khtml-".split(" "),s="transitionend webkitTransitionEnd transitionend otransitionend oTransitionEnd msTransitionEnd KhtmlTransitionEnd".split(" "),r=0;r<n.length;r++)if(n[r]in e.style){t.transitionstyle=n[r],t.prefixstyle=i[r],t.transitionend=s[r];break}t.ischrome26&&(t.prefixstyle=i[1]),t.hastransition=t.transitionstyle;e:{for(n=["-moz-grab","-webkit-grab","grab"],(t.ischrome&&!t.ischrome22||t.isie)&&(n=[]),r=0;r<n.length;r++)if(i=n[r],e.style.cursor=i,e.style.cursor==i){n=i;break e}n="url(http://www.google.com/intl/en_ALL/mapfiles/openhand.cur),n-resize"}return t.cursorgrabvalue=n,t.hasmousecapture="setCapture"in e,t.hasMutationObserver=!1!==p,v=t},g=function(u,a){function c(){var e=b.win;if("zIndex"in e)return e.zIndex();for(;0<e.length&&9!=e[0].nodeType;){var t=e.css("zIndex");if(!isNaN(t)&&0!=t)return parseInt(t);e=e.parent()}return!1}function h(e,t,n){return t=e.css(t),e=parseFloat(t),isNaN(e)?(e=x[t]||0,n=3==e?n?b.win.outerHeight()-b.win.innerHeight():b.win.outerWidth()-b.win.innerWidth():1,b.isie8&&e&&(e+=1),n?e:0):e}function v(e,t,n,r){b._bind(e,t,function(r){r=r?r:window.event;var i={original:r,target:r.target||r.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"==r.type?0:1,deltaX:0,deltaZ:0,preventDefault:function(){return r.preventDefault?r.preventDefault():r.returnValue=!1,!1},stopImmediatePropagation:function(){r.stopImmediatePropagation?r.stopImmediatePropagation():r.cancelBubble=!0}};return"mousewheel"==t?(i.deltaY=-0.025*r.wheelDelta,r.wheelDeltaX&&(i.deltaX=-0.025*r.wheelDeltaX)):i.deltaY=r.detail,n.call(e,i)},r)}function g(e,t,n){var r,i;if(0==e.deltaMode?(r=-Math.floor(e.deltaX*(b.opt.mousescrollstep/54)),i=-Math.floor(e.deltaY*(b.opt.mousescrollstep/54))):1==e.deltaMode&&(r=-Math.floor(e.deltaX*b.opt.mousescrollstep),i=-Math.floor(e.deltaY*b.opt.mousescrollstep)),t&&b.opt.oneaxismousemode&&0==r&&i&&(r=i,i=0),r&&(b.scrollmom&&b.scrollmom.stop(),b.lastdeltax+=r,b.debounced("mousewheelx",function(){var e=b.lastdeltax;b.lastdeltax=0,b.rail.drag||b.doScrollLeftBy(e)},120)),i){if(b.opt.nativeparentscrolling&&n&&!b.ispage&&!b.zoomactive)if(0>i){if(b.getScrollTop()>=b.page.maxh)return!0}else if(0>=b.getScrollTop())return!0;b.scrollmom&&b.scrollmom.stop(),b.lastdeltay+=i,b.debounced("mousewheely",function(){var e=b.lastdeltay;b.lastdeltay=0,b.rail.drag||b.doScrollBy(e)},120)}return e.stopImmediatePropagation(),e.preventDefault()}var b=this;if(this.version="3.5.2",this.name="nicescroll",this.me=a,this.opt={doc:e("body"),win:!1},e.extend(this.opt,d),this.opt.snapbackspeed=80,u)for(var w in b.opt)"undefined"!=typeof u[w]&&(b.opt[w]=u[w]);this.iddoc=(this.doc=b.opt.doc)&&this.doc[0]?this.doc[0].id||"":"",this.ispage=/BODY|HTML/.test(b.opt.win?b.opt.win[0].nodeName:this.doc[0].nodeName),this.haswrapper=!1!==b.opt.win,this.win=b.opt.win||(this.ispage?e(window):this.doc),this.docscroll=this.ispage&&!this.haswrapper?e(window):this.win,this.body=e("body"),this.iframe=this.isfixed=this.viewport=!1,this.isiframe="IFRAME"==this.doc[0].nodeName&&"IFRAME"==this.win[0].nodeName,this.istextarea="TEXTAREA"==this.win[0].nodeName,this.forcescreen=!1,this.canshowonmouseevent="scroll"!=b.opt.autohidemode,this.page=this.view=this.onzoomout=this.onzoomin=this.onscrollcancel=this.onscrollend=this.onscrollstart=this.onclick=this.ongesturezoom=this.onkeypress=this.onmousewheel=this.onmousemove=this.onmouseup=this.onmousedown=!1,this.scroll={x:0,y:0},this.scrollratio={x:0,y:0},this.cursorheight=20,this.scrollvaluemax=0,this.observerremover=this.observer=this.scrollmom=this.scrollrunning=this.checkrtlmode=!1;do this.id="ascrail"+i++;while(document.getElementById(this.id));this.hasmousefocus=this.hasfocus=this.zoomactive=this.zoom=this.selectiondrag=this.cursorfreezed=this.cursor=this.rail=!1,this.visibility=!0,this.hidden=this.locked=!1,this.cursoractive=!0,this.overflowx=b.opt.overflowx,this.overflowy=b.opt.overflowy,this.nativescrollingarea=!1,this.checkarea=0,this.events=[],this.saved={},this.delaylist={},this.synclist={},this.lastdeltay=this.lastdeltax=0,this.detected=m();var E=e.extend({},this.detected);if(this.ishwscroll=(this.canhwscroll=E.hastransform&&b.opt.hwacceleration)&&b.haswrapper,this.istouchcapable=!1,E.cantouch&&E.ischrome&&!E.isios&&!E.isandroid&&(this.istouchcapable=!0,E.cantouch=!1),E.cantouch&&E.ismozilla&&!E.isios&&!E.isandroid&&(this.istouchcapable=!0,E.cantouch=!1),b.opt.enablemouselockapi||(E.hasmousecapture=!1,E.haspointerlock=!1),this.delayed=function(e,t,n,r){var i=b.delaylist[e],s=(new Date).getTime();return!r&&i&&i.tt?!1:(i&&i.tt&&clearTimeout(i.tt),void (i&&i.last+n>s&&!i.tt?b.delaylist[e]={last:s+n,tt:setTimeout(function(){b.delaylist[e].tt=0,t.call()},n)}:i&&i.tt||(b.delaylist[e]={last:s,tt:0},setTimeout(function(){t.call()},0))))},this.debounced=function(e,t,n){var r=b.delaylist[e];(new Date).getTime(),b.delaylist[e]=t,r||setTimeout(function(){var t=b.delaylist[e];b.delaylist[e]=!1,t.call()},n)},this.synched=function(e,t){return b.synclist[e]=t,function(){b.onsync||(f(function(){b.onsync=!1;for(e in b.synclist){var t=b.synclist[e];t&&t.call(b),b.synclist[e]=!1}}),b.onsync=!0)}(),e},this.unsynched=function(e){b.synclist[e]&&(b.synclist[e]=!1)},this.css=function(e,t){for(var n in t)b.saved.css.push([e,n,e.css(n)]),e.css(n,t[n])},this.scrollTop=function(e){return"undefined"==typeof e?b.getScrollTop():b.setScrollTop(e)},this.scrollLeft=function(e){return"undefined"==typeof e?b.getScrollLeft():b.setScrollLeft(e)},BezierClass=function(e,t,n,r,i,s,o){this.st=e,this.ed=t,this.spd=n,this.p1=r||0,this.p2=i||1,this.p3=s||0,this.p4=o||1,this.ts=(new Date).getTime(),this.df=this.ed-this.st},BezierClass.prototype={B2:function(e){return 3*e*e*(1-e)},B3:function(e){return 3*e*(1-e)*(1-e)},B4:function(e){return(1-e)*(1-e)*(1-e)},getNow:function(){var e=1-((new Date).getTime()-this.ts)/this.spd,t=this.B2(e)+this.B3(e)+this.B4(e);return 0>e?this.ed:this.st+Math.round(this.df*t)},update:function(e,t){return this.st=this.getNow(),this.ed=e,this.spd=t,this.ts=(new Date).getTime(),this.df=this.ed-this.st,this}},this.ishwscroll){this.doc.translate={x:0,y:0,tx:"0px",ty:"0px"},E.hastranslate3d&&E.isios&&this.doc.css("-webkit-backface-visibility","hidden");var S=function(){var e=b.doc.css(E.trstyle);return e&&"matrix"==e.substr(0,6)?e.replace(/^.*\((.*)\)$/g,"$1").replace(/px/g,"").split(/, +/):!1};this.getScrollTop=function(e){if(!e){if(e=S())return 16==e.length?-e[13]:-e[5];if(b.timerscroll&&b.timerscroll.bz)return b.timerscroll.bz.getNow()}return b.doc.translate.y},this.getScrollLeft=function(e){if(!e){if(e=S())return 16==e.length?-e[12]:-e[4];if(b.timerscroll&&b.timerscroll.bh)return b.timerscroll.bh.getNow()}return b.doc.translate.x},this.notifyScrollEvent=document.createEvent?function(e){var t=document.createEvent("UIEvents");t.initUIEvent("scroll",!1,!0,window,1),e.dispatchEvent(t)}:document.fireEvent?function(e){var t=document.createEventObject();e.fireEvent("onscroll"),t.cancelBubble=!0}:function(){},E.hastranslate3d&&b.opt.enabletranslate3d?(this.setScrollTop=function(e,t){b.doc.translate.y=e,b.doc.translate.ty=-1*e+"px",b.doc.css(E.trstyle,"translate3d("+b.doc.translate.tx+","+b.doc.translate.ty+",0px)"),t||b.notifyScrollEvent(b.win[0])},this.setScrollLeft=function(e,t){b.doc.translate.x=e,b.doc.translate.tx=-1*e+"px",b.doc.css(E.trstyle,"translate3d("+b.doc.translate.tx+","+b.doc.translate.ty+",0px)"),t||b.notifyScrollEvent(b.win[0])}):(this.setScrollTop=function(e,t){b.doc.translate.y=e,b.doc.translate.ty=-1*e+"px",b.doc.css(E.trstyle,"translate("+b.doc.translate.tx+","+b.doc.translate.ty+")"),t||b.notifyScrollEvent(b.win[0])},this.setScrollLeft=function(e,t){b.doc.translate.x=e,b.doc.translate.tx=-1*e+"px",b.doc.css(E.trstyle,"translate("+b.doc.translate.tx+","+b.doc.translate.ty+")"),t||b.notifyScrollEvent(b.win[0])})}else this.getScrollTop=function(){return b.docscroll.scrollTop()},this.setScrollTop=function(e){return b.docscroll.scrollTop(e)},this.getScrollLeft=function(){return b.docscroll.scrollLeft()},this.setScrollLeft=function(e){return b.docscroll.scrollLeft(e)};this.getTarget=function(e){return e?e.target?e.target:e.srcElement?e.srcElement:!1:!1},this.hasParent=function(e,t){if(!e)return!1;for(var n=e.target||e.srcElement||e||!1;n&&n.id!=t;)n=n.parentNode||!1;return!1!==n};var x={thin:1,medium:3,thick:5};this.getOffset=function(){if(b.isfixed)return{top:parseFloat(b.win.css("top")),left:parseFloat(b.win.css("left"))};if(!b.viewport)return b.win.offset();var e=b.win.offset(),t=b.viewport.offset();return{top:e.top-t.top+b.viewport.scrollTop(),left:e.left-t.left+b.viewport.scrollLeft()}},this.updateScrollBar=function(e){if(b.ishwscroll)b.rail.css({height:b.win.innerHeight()}),b.railh&&b.railh.css({width:b.win.innerWidth()});else{var t=b.getOffset(),n=t.top,r=t.left,n=n+h(b.win,"border-top-width",!0);b.win.outerWidth(),b.win.innerWidth();var r=r+(b.rail.align?b.win.outerWidth()-h(b.win,"border-right-width")-b.rail.width:h(b.win,"border-left-width")),i=b.opt.railoffset;i&&(i.top&&(n+=i.top),b.rail.align&&i.left&&(r+=i.left)),b.locked||b.rail.css({top:n,left:r,height:e?e.h:b.win.innerHeight()}),b.zoom&&b.zoom.css({top:n+1,left:1==b.rail.align?r-20:r+b.rail.width+4}),b.railh&&!b.locked&&(n=t.top,r=t.left,e=b.railh.align?n+h(b.win,"border-top-width",!0)+b.win.innerHeight()-b.railh.height:n+h(b.win,"border-top-width",!0),r+=h(b.win,"border-left-width"),b.railh.css({top:e,left:r,width:b.railh.width}))}},this.doRailClick=function(e,t,n){var r;b.locked||(b.cancelEvent(e),t?(t=n?b.doScrollLeft:b.doScrollTop,r=n?(e.pageX-b.railh.offset().left-b.cursorwidth/2)*b.scrollratio.x:(e.pageY-b.rail.offset().top-b.cursorheight/2)*b.scrollratio.y,t(r)):(t=n?b.doScrollLeftBy:b.doScrollBy,r=n?b.scroll.x:b.scroll.y,e=n?e.pageX-b.railh.offset().left:e.pageY-b.rail.offset().top,n=n?b.view.w:b.view.h,t(r>=e?n:-n)))},b.hasanimationframe=f,b.hascancelanimationframe=l,b.hasanimationframe?b.hascancelanimationframe||(l=function(){b.cancelAnimationFrame=!0}):(f=function(e){return setTimeout(e,15-Math.floor(+(new Date)/1e3)%16)},l=clearInterval),this.init=function(){if(b.saved.css=[],E.isie7mobile||E.isoperamini)return!0;if(E.hasmstouch&&b.css(b.ispage?e("html"):b.win,{"-ms-touch-action":"none"}),b.zindex="auto",b.zindex=b.ispage||"auto"!=b.opt.zindex?b.opt.zindex:c()||"auto",!b.ispage&&"auto"!=b.zindex&&b.zindex>s&&(s=b.zindex),b.isie&&0==b.zindex&&"auto"==b.opt.zindex&&(b.zindex="auto"),!b.ispage||!E.cantouch&&!E.isieold&&!E.isie9mobile){var i=b.docscroll;b.ispage&&(i=b.haswrapper?b.win:b.doc),E.isie9mobile||b.css(i,{"overflow-y":"hidden"}),b.ispage&&E.isie7&&("BODY"==b.doc[0].nodeName?b.css(e("html"),{"overflow-y":"hidden"}):"HTML"==b.doc[0].nodeName&&b.css(e("body"),{"overflow-y":"hidden"})),!E.isios||b.ispage||b.haswrapper||b.css(e("body"),{"-webkit-overflow-scrolling":"touch"});var u=e(document.createElement("div"));u.css({position:"relative",top:0,"float":"right",width:b.opt.cursorwidth,height:"0px","background-color":b.opt.cursorcolor,border:b.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":b.opt.cursorborderradius,"-moz-border-radius":b.opt.cursorborderradius,"border-radius":b.opt.cursorborderradius}),u.hborder=parseFloat(u.outerHeight()-u.innerHeight()),b.cursor=u;var a=e(document.createElement("div"));a.attr("id",b.id),a.addClass("nicescroll-rails");var f,l,h,d=["left","right"];for(h in d)l=d[h],(f=b.opt.railpadding[l])?a.css("padding-"+l,f+"px"):b.opt.railpadding[l]=0;if(a.append(u),a.width=Math.max(parseFloat(b.opt.cursorwidth),u.outerWidth())+b.opt.railpadding.left+b.opt.railpadding.right,a.css({width:a.width+"px",zIndex:b.zindex,background:b.opt.background,cursor:"default"}),a.visibility=!0,a.scrollable=!0,a.align="left"==b.opt.railalign?0:1,b.rail=a,u=b.rail.drag=!1,!b.opt.boxzoom||b.ispage||E.isieold||(u=document.createElement("div"),b.bind(u,"click",b.doZoom),b.zoom=e(u),b.zoom.css({cursor:"pointer","z-index":b.zindex,backgroundImage:"url("+o+"zoomico.png)",height:18,width:18,backgroundPosition:"0px 0px"}),b.opt.dblclickzoom&&b.bind(b.win,"dblclick",b.doZoom),E.cantouch&&b.opt.gesturezoom&&(b.ongesturezoom=function(e){return 1.5<e.scale&&b.doZoomIn(e),.8>e.scale&&b.doZoomOut(e),b.cancelEvent(e)},b.bind(b.win,"gestureend",b.ongesturezoom))),b.railh=!1,b.opt.horizrailenabled){b.css(i,{"overflow-x":"hidden"}),u=e(document.createElement("div")),u.css({position:"relative",top:0,height:b.opt.cursorwidth,width:"0px","background-color":b.opt.cursorcolor,border:b.opt.cursorborder,"background-clip":"padding-box","-webkit-border-radius":b.opt.cursorborderradius,"-moz-border-radius":b.opt.cursorborderradius,"border-radius":b.opt.cursorborderradius}),u.wborder=parseFloat(u.outerWidth()-u.innerWidth()),b.cursorh=u;var v=e(document.createElement("div"));v.attr("id",b.id+"-hr"),v.addClass("nicescroll-rails"),v.height=Math.max(parseFloat(b.opt.cursorwidth),u.outerHeight()),v.css({height:v.height+"px",zIndex:b.zindex,background:b.opt.background}),v.append(u),v.visibility=!0,v.scrollable=!0,v.align="top"==b.opt.railvalign?0:1,b.railh=v,b.railh.drag=!1}if(b.ispage?(a.css({position:"fixed",top:"0px",height:"100%"}),a.css(a.align?{right:"0px"}:{left:"0px"}),b.body.append(a),b.railh&&(v.css({position:"fixed",left:"0px",width:"100%"}),v.css(v.align?{bottom:"0px"}:{top:"0px"}),b.body.append(v))):(b.ishwscroll?("static"==b.win.css("position")&&b.css(b.win,{position:"relative"}),i="HTML"==b.win[0].nodeName?b.body:b.win,b.zoom&&(b.zoom.css({position:"absolute",top:1,right:0,"margin-right":a.width+4}),i.append(b.zoom)),a.css({position:"absolute",top:0}),a.css(a.align?{right:0}:{left:0}),i.append(a),v&&(v.css({position:"absolute",left:0,bottom:0}),v.css(v.align?{bottom:0}:{top:0}),i.append(v))):(b.isfixed="fixed"==b.win.css("position"),i=b.isfixed?"fixed":"absolute",b.isfixed||(b.viewport=b.getViewport(b.win[0])),b.viewport&&(b.body=b.viewport,0==/fixed|relative|absolute/.test(b.viewport.css("position"))&&b.css(b.viewport,{position:"relative"})),a.css({position:i}),b.zoom&&b.zoom.css({position:i}),b.updateScrollBar(),b.body.append(a),b.zoom&&b.body.append(b.zoom),b.railh&&(v.css({position:i}),b.body.append(v))),E.isios&&b.css(b.win,{"-webkit-tap-highlight-color":"rgba(0,0,0,0)","-webkit-touch-callout":"none"}),E.isie&&b.opt.disableoutline&&b.win.attr("hideFocus","true"),E.iswebkit&&b.opt.disableoutline&&b.win.css({outline:"none"})),!1===b.opt.autohidemode?(b.autohidedom=!1,b.rail.css({opacity:b.opt.cursoropacitymax}),b.railh&&b.railh.css({opacity:b.opt.cursoropacitymax})):!0===b.opt.autohidemode||"leave"===b.opt.autohidemode?(b.autohidedom=e().add(b.rail),E.isie8&&(b.autohidedom=b.autohidedom.add(b.cursor)),b.railh&&(b.autohidedom=b.autohidedom.add(b.railh)),b.railh&&E.isie8&&(b.autohidedom=b.autohidedom.add(b.cursorh))):"scroll"==b.opt.autohidemode?(b.autohidedom=e().add(b.rail),b.railh&&(b.autohidedom=b.autohidedom.add(b.railh))):"cursor"==b.opt.autohidemode?(b.autohidedom=e().add(b.cursor),b.railh&&(b.autohidedom=b.autohidedom.add(b.cursorh))):"hidden"==b.opt.autohidemode&&(b.autohidedom=!1,b.hide(),b.locked=!1),E.isie9mobile)b.scrollmom=new y(b),b.onmangotouch=function(e){e=b.getScrollTop();var t=b.getScrollLeft();if(e==b.scrollmom.lastscrolly&&t==b.scrollmom.lastscrollx)return!0;var n=e-b.mangotouch.sy,r=t-b.mangotouch.sx;if(0!=Math.round(Math.sqrt(Math.pow(r,2)+Math.pow(n,2)))){var i=0>n?-1:1,s=0>r?-1:1,o=+(new Date);b.mangotouch.lazy&&clearTimeout(b.mangotouch.lazy),80<o-b.mangotouch.tm||b.mangotouch.dry!=i||b.mangotouch.drx!=s?(b.scrollmom.stop(),b.scrollmom.reset(t,e),b.mangotouch.sy=e,b.mangotouch.ly=e,b.mangotouch.sx=t,b.mangotouch.lx=t,b.mangotouch.dry=i,b.mangotouch.drx=s,b.mangotouch.tm=o):(b.scrollmom.stop(),b.scrollmom.update(b.mangotouch.sx-r,b.mangotouch.sy-n),b.mangotouch.tm=o,n=Math.max(Math.abs(b.mangotouch.ly-e),Math.abs(b.mangotouch.lx-t)),b.mangotouch.ly=e,b.mangotouch.lx=t,n>2&&(b.mangotouch.lazy=setTimeout(function(){b.mangotouch.lazy=!1,b.mangotouch.dry=0,b.mangotouch.drx=0,b.mangotouch.tm=0,b.scrollmom.doMomentum(30)},100)))}},a=b.getScrollTop(),v=b.getScrollLeft(),b.mangotouch={sy:a,ly:a,dry:0,sx:v,lx:v,drx:0,lazy:!1,tm:0},b.bind(b.docscroll,"scroll",b.onmangotouch);else{if(E.cantouch||b.istouchcapable||b.opt.touchbehavior||E.hasmstouch){b.scrollmom=new y(b),b.ontouchstart=function(t){if(t.pointerType&&2!=t.pointerType)return!1;if(b.hasmoving=!1,!b.locked){if(E.hasmstouch)for(var n=t.target?t.target:!1;n;){var r=e(n).getNiceScroll();if(0<r.length&&r[0].me==b.me)break;if(0<r.length)return!1;if("DIV"==n.nodeName&&n.id==b.id)break;n=n.parentNode?n.parentNode:!1}if(b.cancelScroll(),(n=b.getTarget(t))&&/INPUT/i.test(n.nodeName)&&/range/i.test(n.type))return b.stopPropagation(t);if(!("clientX"in t)&&"changedTouches"in t&&(t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),b.forcescreen&&(r=t,t={original:t.original?t.original:t},t.clientX=r.screenX,t.clientY=r.screenY),b.rail.drag={x:t.clientX,y:t.clientY,sx:b.scroll.x,sy:b.scroll.y,st:b.getScrollTop(),sl:b.getScrollLeft(),pt:2,dl:!1},b.ispage||!b.opt.directionlockdeadzone)b.rail.drag.dl="f";else{var r=e(window).width(),i=e(window).height(),s=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),o=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),i=Math.max(0,o-i),r=Math.max(0,s-r);b.rail.drag.ck=!b.rail.scrollable&&b.railh.scrollable?i>0?"v":!1:b.rail.scrollable&&!b.railh.scrollable&&r>0?"h":!1,b.rail.drag.ck||(b.rail.drag.dl="f")}if(b.opt.touchbehavior&&b.isiframe&&E.isie&&(r=b.win.position(),b.rail.drag.x+=r.left,b.rail.drag.y+=r.top),b.hasmoving=!1,b.lastmouseup=!1,b.scrollmom.reset(t.clientX,t.clientY),!E.cantouch&&!this.istouchcapable&&!E.hasmstouch){if(!n||!/INPUT|SELECT|TEXTAREA/i.test(n.nodeName))return!b.ispage&&E.hasmousecapture&&n.setCapture(),b.opt.touchbehavior?(n.onclick&&!n._onclick&&(n._onclick=n.onclick,n.onclick=function(e){return b.hasmoving?!1:void n._onclick.call(this,e)}),b.cancelEvent(t)):b.stopPropagation(t);/SUBMIT|CANCEL|BUTTON/i.test(e(n).attr("type"))&&(pc={tg:n,click:!1},b.preventclick=pc)}}},b.ontouchend=function(e){return e.pointerType&&2!=e.pointerType?!1:b.rail.drag&&2==b.rail.drag.pt&&(b.scrollmom.doMomentum(),b.rail.drag=!1,b.hasmoving&&(b.lastmouseup=!0,b.hideCursor(),E.hasmousecapture&&document.releaseCapture(),!E.cantouch))?b.cancelEvent(e):void 0};var m=b.opt.touchbehavior&&b.isiframe&&!E.hasmousecapture;b.ontouchmove=function(t,n){if(t.pointerType&&2!=t.pointerType)return!1;if(b.rail.drag&&2==b.rail.drag.pt){if(E.cantouch&&"undefined"==typeof t.original)return!0;if(b.hasmoving=!0,b.preventclick&&!b.preventclick.click&&(b.preventclick.click=b.preventclick.tg.onclick||!1,b.preventclick.tg.onclick=b.onpreventclick),t=e.extend({original:t},t),"changedTouches"in t&&(t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),b.forcescreen){var r=t;t={original:t.original?t.original:t},t.clientX=r.screenX,t.clientY=r.screenY}if(r=ofy=0,m&&!n){var i=b.win.position(),r=-i.left;ofy=-i.top}var s=t.clientY+ofy,i=s-b.rail.drag.y,o=t.clientX+r,u=o-b.rail.drag.x,a=b.rail.drag.st-i;if(b.ishwscroll&&b.opt.bouncescroll?0>a?a=Math.round(a/2):a>b.page.maxh&&(a=b.page.maxh+Math.round((a-b.page.maxh)/2)):(0>a&&(s=a=0),a>b.page.maxh&&(a=b.page.maxh,s=0)),b.railh&&b.railh.scrollable){var f=b.rail.drag.sl-u;b.ishwscroll&&b.opt.bouncescroll?0>f?f=Math.round(f/2):f>b.page.maxw&&(f=b.page.maxw+Math.round((f-b.page.maxw)/2)):(0>f&&(o=f=0),f>b.page.maxw&&(f=b.page.maxw,o=0))}if(r=!1,b.rail.drag.dl)r=!0,"v"==b.rail.drag.dl?f=b.rail.drag.sl:"h"==b.rail.drag.dl&&(a=b.rail.drag.st);else{var i=Math.abs(i),u=Math.abs(u),l=b.opt.directionlockdeadzone;if("v"==b.rail.drag.ck){if(i>l&&.3*i>=u)return b.rail.drag=!1,!0;u>l&&(b.rail.drag.dl="f",e("body").scrollTop(e("body").scrollTop()))}else if("h"==b.rail.drag.ck){if(u>l&&.3*u>=i)return b.rail.drag=!1,!0;i>l&&(b.rail.drag.dl="f",e("body").scrollLeft(e("body").scrollLeft()))}}if(b.synched("touchmove",function(){b.rail.drag&&2==b.rail.drag.pt&&(b.prepareTransition&&b.prepareTransition(0),b.rail.scrollable&&b.setScrollTop(a),b.scrollmom.update(o,s),b.railh&&b.railh.scrollable?(b.setScrollLeft(f),b.showCursor(a,f)):b.showCursor(a),E.isie10&&document.selection.clear())}),E.ischrome&&b.istouchcapable&&(r=!1),r)return b.cancelEvent(t)}}}if(b.onmousedown=function(e,t){if(!b.rail.drag||1==b.rail.drag.pt){if(b.locked)return b.cancelEvent(e);b.cancelScroll(),b.rail.drag={x:e.clientX,y:e.clientY,sx:b.scroll.x,sy:b.scroll.y,pt:1,hr:!!t};var n=b.getTarget(e);return!b.ispage&&E.hasmousecapture&&n.setCapture(),b.isiframe&&!E.hasmousecapture&&(b.saved.csspointerevents=b.doc.css("pointer-events"),b.css(b.doc,{"pointer-events":"none"})),b.cancelEvent(e)}},b.onmouseup=function(e){return b.rail.drag&&(E.hasmousecapture&&document.releaseCapture(),b.isiframe&&!E.hasmousecapture&&b.doc.css("pointer-events",b.saved.csspointerevents),1==b.rail.drag.pt)?(b.rail.drag=!1,b.cancelEvent(e)):void 0},b.onmousemove=function(e){if(b.rail.drag&&1==b.rail.drag.pt){if(E.ischrome&&0==e.which)return b.onmouseup(e);if(b.cursorfreezed=!0,b.rail.drag.hr){b.scroll.x=b.rail.drag.sx+(e.clientX-b.rail.drag.x),0>b.scroll.x&&(b.scroll.x=0);var t=b.scrollvaluemaxw;b.scroll.x>t&&(b.scroll.x=t)}else b.scroll.y=b.rail.drag.sy+(e.clientY-b.rail.drag.y),0>b.scroll.y&&(b.scroll.y=0),t=b.scrollvaluemax,b.scroll.y>t&&(b.scroll.y=t);return b.synched("mousemove",function(){b.rail.drag&&1==b.rail.drag.pt&&(b.showCursor(),b.rail.drag.hr?b.doScrollLeft(Math.round(b.scroll.x*b.scrollratio.x),b.opt.cursordragspeed):b.doScrollTop(Math.round(b.scroll.y*b.scrollratio.y),b.opt.cursordragspeed))}),b.cancelEvent(e)}},E.cantouch||b.opt.touchbehavior)b.onpreventclick=function(e){return b.preventclick?(b.preventclick.tg.onclick=b.preventclick.click,b.preventclick=!1,b.cancelEvent(e)):void 0},b.bind(b.win,"mousedown",b.ontouchstart),b.onclick=E.isios?!1:function(e){return b.lastmouseup?(b.lastmouseup=!1,b.cancelEvent(e)):!0},b.opt.grabcursorenabled&&E.cursorgrabvalue&&(b.css(b.ispage?b.doc:b.win,{cursor:E.cursorgrabvalue}),b.css(b.rail,{cursor:E.cursorgrabvalue}));else{var g=function(e){if(b.selectiondrag){if(e){var t=b.win.outerHeight();e=e.pageY-b.selectiondrag.top,e>0&&t>e&&(e=0),e>=t&&(e-=t),b.selectiondrag.df=e}0!=b.selectiondrag.df&&(b.doScrollBy(2*-Math.floor(b.selectiondrag.df/6)),b.debounced("doselectionscroll",function(){g()},50))}};b.hasTextSelected="getSelection"in document?function(){return 0<document.getSelection().rangeCount}:"selection"in document?function(){return"None"!=document.selection.type}:function(){return!1},b.onselectionstart=function(){b.ispage||(b.selectiondrag=b.win.offset())},b.onselectionend=function(){b.selectiondrag=!1},b.onselectiondrag=function(e){b.selectiondrag&&b.hasTextSelected()&&b.debounced("selectionscroll",function(){g(e)},250)}}E.hasmstouch&&(b.css(b.rail,{"-ms-touch-action":"none"}),b.css(b.cursor,{"-ms-touch-action":"none"}),b.bind(b.win,"MSPointerDown",b.ontouchstart),b.bind(document,"MSPointerUp",b.ontouchend),b.bind(document,"MSPointerMove",b.ontouchmove),b.bind(b.cursor,"MSGestureHold",function(e){e.preventDefault()}),b.bind(b.cursor,"contextmenu",function(e){e.preventDefault()})),this.istouchcapable&&(b.bind(b.win,"touchstart",b.ontouchstart),b.bind(document,"touchend",b.ontouchend),b.bind(document,"touchcancel",b.ontouchend),b.bind(document,"touchmove",b.ontouchmove)),b.bind(b.cursor,"mousedown",b.onmousedown),b.bind(b.cursor,"mouseup",b.onmouseup),b.railh&&(b.bind(b.cursorh,"mousedown",function(e){b.onmousedown(e,!0)}),b.bind(b.cursorh,"mouseup",function(e){return b.rail.drag&&2==b.rail.drag.pt?void 0:(b.rail.drag=!1,b.hasmoving=!1,b.hideCursor(),E.hasmousecapture&&document.releaseCapture(),b.cancelEvent(e))})),(b.opt.cursordragontouch||!E.cantouch&&!b.opt.touchbehavior)&&(b.rail.css({cursor:"default"}),b.railh&&b.railh.css({cursor:"default"}),b.jqbind(b.rail,"mouseenter",function(){b.canshowonmouseevent&&b.showCursor(),b.rail.active=!0}),b.jqbind(b.rail,"mouseleave",function(){b.rail.active=!1,b.rail.drag||b.hideCursor()}),b.opt.sensitiverail&&(b.bind(b.rail,"click",function(e){b.doRailClick(e,!1,!1)}),b.bind(b.rail,"dblclick",function(e){b.doRailClick(e,!0,!1)}),b.bind(b.cursor,"click",function(e){b.cancelEvent(e)}),b.bind(b.cursor,"dblclick",function(e){b.cancelEvent(e)})),b.railh&&(b.jqbind(b.railh,"mouseenter",function(){b.canshowonmouseevent&&b.showCursor(),b.rail.active=!0}),b.jqbind(b.railh,"mouseleave",function(){b.rail.active=!1,b.rail.drag||b.hideCursor()}),b.opt.sensitiverail&&(b.bind(b.railh,"click",function(e){b.doRailClick(e,!1,!0)}),b.bind(b.railh,"dblclick",function(e){b.doRailClick(e,!0,!0)}),b.bind(b.cursorh,"click",function(e){b.cancelEvent(e)}),b.bind(b.cursorh,"dblclick",function(e){b.cancelEvent(e)})))),E.cantouch||b.opt.touchbehavior?(b.bind(E.hasmousecapture?b.win:document,"mouseup",b.ontouchend),b.bind(document,"mousemove",b.ontouchmove),b.onclick&&b.bind(document,"click",b.onclick),b.opt.cursordragontouch&&(b.bind(b.cursor,"mousedown",b.onmousedown),b.bind(b.cursor,"mousemove",b.onmousemove),b.cursorh&&b.bind(b.cursorh,"mousedown",function(e){b.onmousedown(e,!0)}),b.cursorh&&b.bind(b.cursorh,"mousemove",b.onmousemove))):(b.bind(E.hasmousecapture?b.win:document,"mouseup",b.onmouseup),b.bind(document,"mousemove",b.onmousemove),b.onclick&&b.bind(document,"click",b.onclick),!b.ispage&&b.opt.enablescrollonselection&&(b.bind(b.win[0],"mousedown",b.onselectionstart),b.bind(document,"mouseup",b.onselectionend),b.bind(b.cursor,"mouseup",b.onselectionend),b.cursorh&&b.bind(b.cursorh,"mouseup",b.onselectionend),b.bind(document,"mousemove",b.onselectiondrag)),b.zoom&&(b.jqbind(b.zoom,"mouseenter",function(){b.canshowonmouseevent&&b.showCursor(),b.rail.active=!0}),b.jqbind(b.zoom,"mouseleave",function(){b.rail.active=!1,b.rail.drag||b.hideCursor()}))),b.opt.enablemousewheel&&(b.isiframe||b.bind(E.isie&&b.ispage?document:b.win,"mousewheel",b.onmousewheel),b.bind(b.rail,"mousewheel",b.onmousewheel),b.railh&&b.bind(b.railh,"mousewheel",b.onmousewheelhr)),b.ispage||E.cantouch||/HTML|BODY/.test(b.win[0].nodeName)||(b.win.attr("tabindex")||b.win.attr({tabindex:r++}),b.jqbind(b.win,"focus",function(e){t=b.getTarget(e).id||!0,b.hasfocus=!0,b.canshowonmouseevent&&b.noticeCursor()}),b.jqbind(b.win,"blur",function(){t=!1,b.hasfocus=!1}),b.jqbind(b.win,"mouseenter",function(e){n=b.getTarget(e).id||!0,b.hasmousefocus=!0,b.canshowonmouseevent&&b.noticeCursor()}),b.jqbind(b.win,"mouseleave",function(){n=!1,b.hasmousefocus=!1,b.rail.drag||b.hideCursor()}))}if(b.onkeypress=function(r){if(b.locked&&0==b.page.maxh)return!0;r=r?r:window.e;var i=b.getTarget(r);if(i&&/INPUT|TEXTAREA|SELECT|OPTION/.test(i.nodeName)&&(!i.getAttribute("type")&&!i.type||!/submit|button|cancel/i.tp)||e(i).attr("contenteditable"))return!0;if(b.hasfocus||b.hasmousefocus&&!t||b.ispage&&!t&&!n){if(i=r.keyCode,b.locked&&27!=i)return b.cancelEvent(r);var s=r.ctrlKey||!1,o=r.shiftKey||!1,u=!1;switch(i){case 38:case 63233:b.doScrollBy(72),u=!0;break;case 40:case 63235:b.doScrollBy(-72),u=!0;break;case 37:case 63232:b.railh&&(s?b.doScrollLeft(0):b.doScrollLeftBy(72),u=!0);break;case 39:case 63234:b.railh&&(s?b.doScrollLeft(b.page.maxw):b.doScrollLeftBy(-72),u=!0);break;case 33:case 63276:b.doScrollBy(b.view.h),u=!0;break;case 34:case 63277:b.doScrollBy(-b.view.h),u=!0;break;case 36:case 63273:b.railh&&s?b.doScrollPos(0,0):b.doScrollTo(0),u=!0;break;case 35:case 63275:b.railh&&s?b.doScrollPos(b.page.maxw,b.page.maxh):b.doScrollTo(b.page.maxh),u=!0;break;case 32:b.opt.spacebarenabled&&(b.doScrollBy(o?b.view.h:-b.view.h),u=!0);break;case 27:b.zoomactive&&(b.doZoom(),u=!0)}if(u)return b.cancelEvent(r)}},b.opt.enablekeyboard&&b.bind(document,E.isopera&&!E.isopera12?"keypress":"keydown",b.onkeypress),b.bind(window,"resize",b.lazyResize),b.bind(window,"orientationchange",b.lazyResize),b.bind(window,"load",b.lazyResize),E.ischrome&&!b.ispage&&!b.haswrapper){var w=b.win.attr("style"),a=parseFloat(b.win.css("width"))+1;b.win.css("width",a),b.synched("chromefix",function(){b.win.attr("style",w)})}b.onAttributeChange=function(){b.lazyResize(250)},b.ispage||b.haswrapper||(!1!==p?(b.observer=new p(function(e){e.forEach(b.onAttributeChange)}),b.observer.observe(b.win[0],{childList:!0,characterData:!1,attributes:!0,subtree:!1}),b.observerremover=new p(function(e){e.forEach(function(e){if(0<e.removedNodes.length)for(var t in e.removedNodes)if(e.removedNodes[t]==b.win[0])return b.remove()})}),b.observerremover.observe(b.win[0].parentNode,{childList:!0,characterData:!1,attributes:!1,subtree:!1})):(b.bind(b.win,E.isie&&!E.isie9?"propertychange":"DOMAttrModified",b.onAttributeChange),E.isie9&&b.win[0].attachEvent("onpropertychange",b.onAttributeChange),b.bind(b.win,"DOMNodeRemoved",function(e){e.target==b.win[0]&&b.remove()}))),!b.ispage&&b.opt.boxzoom&&b.bind(window,"resize",b.resizeZoom),b.istextarea&&b.bind(b.win,"mouseup",b.lazyResize),b.checkrtlmode=!0,b.lazyResize(30)}if("IFRAME"==this.doc[0].nodeName){var S=function(t){b.iframexd=!1;try{var n="contentDocument"in this?this.contentDocument:this.contentWindow.document}catch(r){b.iframexd=!0,n=!1}return b.iframexd?("console"in window&&console.log("NiceScroll error: policy restriced iframe"),!0):(b.forcescreen=!0,b.isiframe&&(b.iframe={doc:e(n),html:b.doc.contents().find("html")[0],body:b.doc.contents().find("body")[0]},b.getContentSize=function(){return{w:Math.max(b.iframe.html.scrollWidth,b.iframe.body.scrollWidth),h:Math.max(b.iframe.html.scrollHeight,b.iframe.body.scrollHeight)}},b.docscroll=e(b.iframe.body)),E.isios||!b.opt.iframeautoresize||b.isiframe||(b.win.scrollTop(0),b.doc.height(""),t=Math.max(n.getElementsByTagName("html")[0].scrollHeight,n.body.scrollHeight),b.doc.height(t)),b.lazyResize(30),E.isie7&&b.css(e(b.iframe.html),{"overflow-y":"hidden"}),b.css(e(b.iframe.body),{"overflow-y":"hidden"}),E.isios&&b.haswrapper&&b.css(e(n.body),{"-webkit-transform":"translate3d(0,0,0)"}),"contentWindow"in this?b.bind(this.contentWindow,"scroll",b.onscroll):b.bind(n,"scroll",b.onscroll),b.opt.enablemousewheel&&b.bind(n,"mousewheel",b.onmousewheel),b.opt.enablekeyboard&&b.bind(n,E.isopera?"keypress":"keydown",b.onkeypress),(E.cantouch||b.opt.touchbehavior)&&(b.bind(n,"mousedown",b.ontouchstart),b.bind(n,"mousemove",function(e){b.ontouchmove(e,!0)}),b.opt.grabcursorenabled&&E.cursorgrabvalue&&b.css(e(n.body),{cursor:E.cursorgrabvalue})),b.bind(n,"mouseup",b.ontouchend),void (b.zoom&&(b.opt.dblclickzoom&&b.bind(n,"dblclick",b.doZoom),b.ongesturezoom&&b.bind(n,"gestureend",b.ongesturezoom))))};this.doc[0].readyState&&"complete"==this.doc[0].readyState&&setTimeout(function(){S.call(b.doc[0],!1)},500),b.bind(this.doc,"load",S)}},this.showCursor=function(e,t){b.cursortimeout&&(clearTimeout(b.cursortimeout),b.cursortimeout=0),b.rail&&(b.autohidedom&&(b.autohidedom.stop().css({opacity:b.opt.cursoropacitymax}),b.cursoractive=!0),b.rail.drag&&1==b.rail.drag.pt||("undefined"!=typeof e&&!1!==e&&(b.scroll.y=Math.round(1*e/b.scrollratio.y)),"undefined"!=typeof t&&(b.scroll.x=Math.round(1*t/b.scrollratio.x))),b.cursor.css({height:b.cursorheight,top:b.scroll.y}),b.cursorh&&(b.cursorh.css(!b.rail.align&&b.rail.visibility?{width:b.cursorwidth,left:b.scroll.x+b.rail.width}:{width:b.cursorwidth,left:b.scroll.x}),b.cursoractive=!0),b.zoom&&b.zoom.stop().css({opacity:b.opt.cursoropacitymax}))},this.hideCursor=function(e){b.cursortimeout||!b.rail||!b.autohidedom||b.hasmousefocus&&"leave"==b.opt.autohidemode||(b.cursortimeout=setTimeout(function(){b.rail.active&&b.showonmouseevent||(b.autohidedom.stop().animate({opacity:b.opt.cursoropacitymin}),b.zoom&&b.zoom.stop().animate({opacity:b.opt.cursoropacitymin}),b.cursoractive=!1),b.cursortimeout=0},e||b.opt.hidecursordelay))},this.noticeCursor=function(e,t,n){b.showCursor(t,n),b.rail.active||b.hideCursor(e)},this.getContentSize=b.ispage?function(){return{w:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),h:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}}:b.haswrapper?function(){return{w:b.doc.outerWidth()+parseInt(b.win.css("paddingLeft"))+parseInt(b.win.css("paddingRight")),h:b.doc.outerHeight()+parseInt(b.win.css("paddingTop"))+parseInt(b.win.css("paddingBottom"))}}:function(){return{w:b.docscroll[0].scrollWidth,h:b.docscroll[0].scrollHeight}},this.onResize=function(e,t){if(!b||!b.win)return!1;if(!b.haswrapper&&!b.ispage){if("none"==b.win.css("display"))return b.visibility&&b.hideRail().hideRailHr(),!1;b.hidden||b.visibility||b.showRail().showRailHr()}var n=b.page.maxh,r=b.page.maxw,i=b.view.w;if(b.view={w:b.ispage?b.win.width():parseInt(b.win[0].clientWidth),h:b.ispage?b.win.height():parseInt(b.win[0].clientHeight)},b.page=t?t:b.getContentSize(),b.page.maxh=Math.max(0,b.page.h-b.view.h),b.page.maxw=Math.max(0,b.page.w-b.view.w),b.page.maxh==n&&b.page.maxw==r&&b.view.w==i){if(b.ispage)return b;if(n=b.win.offset(),b.lastposition&&(r=b.lastposition,r.top==n.top&&r.left==n.left))return b;b.lastposition=n}return 0==b.page.maxh?(b.hideRail(),b.scrollvaluemax=0,b.scroll.y=0,b.scrollratio.y=0,b.cursorheight=0,b.setScrollTop(0),b.rail.scrollable=!1):b.rail.scrollable=!0,0==b.page.maxw?(b.hideRailHr(),b.scrollvaluemaxw=0,b.scroll.x=0,b.scrollratio.x=0,b.cursorwidth=0,b.setScrollLeft(0),b.railh.scrollable=!1):b.railh.scrollable=!0,b.locked=0==b.page.maxh&&0==b.page.maxw,b.locked?(b.ispage||b.updateScrollBar(b.view),!1):(b.hidden||b.visibility?b.hidden||b.railh.visibility||b.showRailHr():b.showRail().showRailHr(),b.istextarea&&b.win.css("resize")&&"none"!=b.win.css("resize")&&(b.view.h-=20),b.cursorheight=Math.min(b.view.h,Math.round(b.view.h*(b.view.h/b.page.h))),b.cursorheight=b.opt.cursorfixedheight?b.opt.cursorfixedheight:Math.max(b.opt.cursorminheight,b.cursorheight),b.cursorwidth=Math.min(b.view.w,Math.round(b.view.w*(b.view.w/b.page.w))),b.cursorwidth=b.opt.cursorfixedheight?b.opt.cursorfixedheight:Math.max(b.opt.cursorminheight,b.cursorwidth),b.scrollvaluemax=b.view.h-b.cursorheight-b.cursor.hborder,b.railh&&(b.railh.width=0<b.page.maxh?b.view.w-b.rail.width:b.view.w,b.scrollvaluemaxw=b.railh.width-b.cursorwidth-b.cursorh.wborder),b.checkrtlmode&&b.railh&&(b.checkrtlmode=!1,b.opt.rtlmode&&0==b.scroll.x&&b.setScrollLeft(b.page.maxw)),b.ispage||b.updateScrollBar(b.view),b.scrollratio={x:b.page.maxw/b.scrollvaluemaxw,y:b.page.maxh/b.scrollvaluemax},b.getScrollTop()>b.page.maxh?b.doScrollTop(b.page.maxh):(b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y)),b.scroll.x=Math.round(b.getScrollLeft()*(1/b.scrollratio.x)),b.cursoractive&&b.noticeCursor()),b.scroll.y&&0==b.getScrollTop()&&b.doScrollTo(Math.floor(b.scroll.y*b.scrollratio.y)),b)},this.resize=b.onResize,this.lazyResize=function(e){return e=isNaN(e)?30:e,b.delayed("resize",b.resize,e),b},this._bind=function(e,t,n,r){b.events.push({e:e,n:t,f:n,b:r,q:!1}),e.addEventListener?e.addEventListener(t,n,r||!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},this.jqbind=function(t,n,r){b.events.push({e:t,n:n,f:r,q:!0}),e(t).bind(n,r)},this.bind=function(e,t,n,r){var i="jquery"in e?e[0]:e;"mousewheel"==t?"onwheel"in b.win?b._bind(i,"wheel",n,r||!1):(e="undefined"!=typeof document.onmousewheel?"mousewheel":"DOMMouseScroll",v(i,e,n,r||!1),"DOMMouseScroll"==e&&v(i,"MozMousePixelScroll",n,r||!1)):i.addEventListener?(E.cantouch&&/mouseup|mousedown|mousemove/.test(t)&&b._bind(i,"mousedown"==t?"touchstart":"mouseup"==t?"touchend":"touchmove",function(e){if(e.touches){if(2>e.touches.length){var t=e.touches.length?e.touches[0]:e;t.original=e,n.call(this,t)}}else e.changedTouches&&(t=e.changedTouches[0],t.original=e,n.call(this,t))},r||!1),b._bind(i,t,n,r||!1),E.cantouch&&"mouseup"==t&&b._bind(i,"touchcancel",n,r||!1)):b._bind(i,t,function(e){return(e=e||window.event||!1)&&e.srcElement&&(e.target=e.srcElement),"pageY"in e||(e.pageX=e.clientX+document.documentElement.scrollLeft,e.pageY=e.clientY+document.documentElement.scrollTop),!1===n.call(i,e)||!1===r?b.cancelEvent(e):!0})},this._unbind=function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=!1},this.unbindAll=function(){for(var e=0;e<b.events.length;e++){var t=b.events[e];t.q?t.e.unbind(t.n,t.f):b._unbind(t.e,t.n,t.f,t.b)}},this.cancelEvent=function(e){return(e=e.original?e.original:e?e:window.event||!1)?(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.preventManipulation&&e.preventManipulation(),e.cancelBubble=!0,e.cancel=!0,e.returnValue=!1):!1},this.stopPropagation=function(e){return(e=e.original?e.original:e?e:window.event||!1)?e.stopPropagation?e.stopPropagation():(e.cancelBubble&&(e.cancelBubble=!0),!1):!1},this.showRail=function(){return 0==b.page.maxh||!b.ispage&&"none"==b.win.css("display")||(b.visibility=!0,b.rail.visibility=!0,b.rail.css("display","block")),b},this.showRailHr=function(){return b.railh?(0==b.page.maxw||!b.ispage&&"none"==b.win.css("display")||(b.railh.visibility=!0,b.railh.css("display","block")),b):b},this.hideRail=function(){return b.visibility=!1,b.rail.visibility=!1,b.rail.css("display","none"),b},this.hideRailHr=function(){return b.railh?(b.railh.visibility=!1,b.railh.css("display","none"),b):b},this.show=function(){return b.hidden=!1,b.locked=!1,b.showRail().showRailHr()},this.hide=function(){return b.hidden=!0,b.locked=!0,b.hideRail().hideRailHr()},this.toggle=function(){return b.hidden?b.show():b.hide()},this.remove=function(){b.stop(),b.cursortimeout&&clearTimeout(b.cursortimeout),b.doZoomOut(),b.unbindAll(),E.isie9&&b.win[0].detachEvent("onpropertychange",b.onAttributeChange),!1!==b.observer&&b.observer.disconnect(),!1!==b.observerremover&&b.observerremover.disconnect(),b.events=null,b.cursor&&b.cursor.remove(),b.cursorh&&b.cursorh.remove(),b.rail&&b.rail.remove(),b.railh&&b.railh.remove(),b.zoom&&b.zoom.remove();for(var t=0;t<b.saved.css.length;t++){var n=b.saved.css[t];n[0].css(n[1],"undefined"==typeof n[2]?"":n[2])}b.saved=!1,b.me.data("__nicescroll","");var r=e.nicescroll;r.each(function(e){if(this&&this.id===b.id){delete r[e];for(var t=++e;t<r.length;t++,e++)r[e]=r[t];r.length--,r.length&&delete r[r.length]}});for(var i in b)b[i]=null,delete b[i];b=null},this.scrollstart=function(e){return this.onscrollstart=e,b},this.scrollend=function(e){return this.onscrollend=e,b},this.scrollcancel=function(e){return this.onscrollcancel=e,b},this.zoomin=function(e){return this.onzoomin=e,b},this.zoomout=function(e){return this.onzoomout=e,b},this.isScrollable=function(t){if(t=t.target?t.target:t,"OPTION"==t.nodeName)return!0;for(;t&&1==t.nodeType&&!/BODY|HTML/.test(t.nodeName);){var n=e(t),n=n.css("overflowY")||n.css("overflowX")||n.css("overflow")||"";if(/scroll|auto/.test(n))return t.clientHeight!=t.scrollHeight;t=t.parentNode?t.parentNode:!1}return!1},this.getViewport=function(t){for(t=t&&t.parentNode?t.parentNode:!1;t&&1==t.nodeType&&!/BODY|HTML/.test(t.nodeName);){var n=e(t);if(/fixed|absolute/.test(n.css("position")))return n;var r=n.css("overflowY")||n.css("overflowX")||n.css("overflow")||"";if(/scroll|auto/.test(r)&&t.clientHeight!=t.scrollHeight||0<n.getNiceScroll().length)return n;t=t.parentNode?t.parentNode:!1}return!1},this.onmousewheel=function(e){if(b.locked)return b.debounced("checkunlock",b.resize,250),!0;if(b.rail.drag)return b.cancelEvent(e);if("auto"==b.opt.oneaxismousemode&&0!=e.deltaX&&(b.opt.oneaxismousemode=!1),b.opt.oneaxismousemode&&0==e.deltaX&&!b.rail.scrollable)return b.railh&&b.railh.scrollable?b.onmousewheelhr(e):!0;var t=+(new Date),n=!1;return b.opt.preservenativescrolling&&b.checkarea+600<t&&(b.nativescrollingarea=b.isScrollable(e),n=!0),b.checkarea=t,b.nativescrollingarea?!0:((e=g(e,!1,n))&&(b.checkarea=0),e)},this.onmousewheelhr=function(e){if(b.locked||!b.railh.scrollable)return!0;if(b.rail.drag)return b.cancelEvent(e);var t=+(new Date),n=!1;return b.opt.preservenativescrolling&&b.checkarea+600<t&&(b.nativescrollingarea=b.isScrollable(e),n=!0),b.checkarea=t,b.nativescrollingarea?!0:b.locked?b.cancelEvent(e):g(e,!0,n)},this.stop=function(){return b.cancelScroll(),b.scrollmon&&b.scrollmon.stop(),b.cursorfreezed=!1,b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y)),b.noticeCursor(),b},this.getTransitionSpeed=function(e){var t=Math.round(10*b.opt.scrollspeed);return e=Math.min(t,Math.round(e/20*b.opt.scrollspeed)),e>20?e:0},b.opt.smoothscroll?b.ishwscroll&&E.hastransition&&b.opt.usetransition?(this.prepareTransition=function(e,t){var n=t?e>20?e:0:b.getTransitionSpeed(e),r=n?E.prefixstyle+"transform "+n+"ms ease-out":"";return b.lasttransitionstyle&&b.lasttransitionstyle==r||(b.lasttransitionstyle=r,b.doc.css(E.transitionstyle,r)),n},this.doScrollLeft=function(e,t){var n=b.scrollrunning?b.newscrolly:b.getScrollTop();b.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=b.scrollrunning?b.newscrollx:b.getScrollLeft();b.doScrollPos(n,e,t)},this.doScrollPos=function(e,t,n){var r=b.getScrollTop(),i=b.getScrollLeft();return(0>(b.newscrolly-r)*(t-r)||0>(b.newscrollx-i)*(e-i))&&b.cancelScroll(),0==b.opt.bouncescroll&&(0>t?t=0:t>b.page.maxh&&(t=b.page.maxh),0>e?e=0:e>b.page.maxw&&(e=b.page.maxw)),b.scrollrunning&&e==b.newscrollx&&t==b.newscrolly?!1:(b.newscrolly=t,b.newscrollx=e,b.newscrollspeed=n||!1,b.timer?!1:void (b.timer=setTimeout(function(){var n,r,i=b.getScrollTop(),s=b.getScrollLeft();n=e-s,r=t-i,n=Math.round(Math.sqrt(Math.pow(n,2)+Math.pow(r,2))),n=b.newscrollspeed&&1<b.newscrollspeed?b.newscrollspeed:b.getTransitionSpeed(n),b.newscrollspeed&&1>=b.newscrollspeed&&(n*=b.newscrollspeed),b.prepareTransition(n,!0),b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm),n>0&&(!b.scrollrunning&&b.onscrollstart&&b.onscrollstart.call(b,{type:"scrollstart",current:{x:s,y:i},request:{x:e,y:t},end:{x:b.newscrollx,y:b.newscrolly},speed:n}),E.transitionend?b.scrollendtrapped||(b.scrollendtrapped=!0,b.bind(b.doc,E.transitionend,b.onScrollEnd,!1)):(b.scrollendtrapped&&clearTimeout(b.scrollendtrapped),b.scrollendtrapped=setTimeout(b.onScrollEnd,n)),b.timerscroll={bz:new BezierClass(i,b.newscrolly,n,0,0,.58,1),bh:new BezierClass(s,b.newscrollx,n,0,0,.58,1)},b.cursorfreezed||(b.timerscroll.tm=setInterval(function(){b.showCursor(b.getScrollTop(),b.getScrollLeft())},60))),b.synched("doScroll-set",function(){b.timer=0,b.scrollendtrapped&&(b.scrollrunning=!0),b.setScrollTop(b.newscrolly),b.setScrollLeft(b.newscrollx),b.scrollendtrapped||b.onScrollEnd()})},50)))},this.cancelScroll=function(){if(!b.scrollendtrapped)return!0;var e=b.getScrollTop(),t=b.getScrollLeft();return b.scrollrunning=!1,E.transitionend||clearTimeout(E.transitionend),b.scrollendtrapped=!1,b._unbind(b.doc,E.transitionend,b.onScrollEnd),b.prepareTransition(0),b.setScrollTop(e),b.railh&&b.setScrollLeft(t),b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm),b.timerscroll=!1,b.cursorfreezed=!1,b.showCursor(e,t),b},this.onScrollEnd=function(){b.scrollendtrapped&&b._unbind(b.doc,E.transitionend,b.onScrollEnd),b.scrollendtrapped=!1,b.prepareTransition(0),b.timerscroll&&b.timerscroll.tm&&clearInterval(b.timerscroll.tm),b.timerscroll=!1;var e=b.getScrollTop(),t=b.getScrollLeft();return b.setScrollTop(e),b.railh&&b.setScrollLeft(t),b.noticeCursor(!1,e,t),b.cursorfreezed=!1,0>e?e=0:e>b.page.maxh&&(e=b.page.maxh),0>t?t=0:t>b.page.maxw&&(t=b.page.maxw),e!=b.newscrolly||t!=b.newscrollx?b.doScrollPos(t,e,b.opt.snapbackspeed):(b.onscrollend&&b.scrollrunning&&b.onscrollend.call(b,{type:"scrollend",current:{x:t,y:e},end:{x:b.newscrollx,y:b.newscrolly}}),void (b.scrollrunning=!1))}):(this.doScrollLeft=function(e,t){var n=b.scrollrunning?b.newscrolly:b.getScrollTop();b.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=b.scrollrunning?b.newscrollx:b.getScrollLeft();b.doScrollPos(n,e,t)},this.doScrollPos=function(e,t,n){function r(){if(b.cancelAnimationFrame)return!0;if(b.scrollrunning=!0,c=1-c)return b.timer=f(r)||1;var e=0,t=sy=b.getScrollTop();if(b.dst.ay){var t=b.bzscroll?b.dst.py+b.bzscroll.getNow()*b.dst.ay:b.newscrolly,n=t-sy;(0>n&&t<b.newscrolly||n>0&&t>b.newscrolly)&&(t=b.newscrolly),b.setScrollTop(t),t==b.newscrolly&&(e=1)}else e=1;var i=sx=b.getScrollLeft();b.dst.ax?(i=b.bzscroll?b.dst.px+b.bzscroll.getNow()*b.dst.ax:b.newscrollx,n=i-sx,(0>n&&i<b.newscrollx||n>0&&i>b.newscrollx)&&(i=b.newscrollx),b.setScrollLeft(i),i==b.newscrollx&&(e+=1)):e+=1,2==e?(b.timer=0,b.cursorfreezed=!1,b.bzscroll=!1,b.scrollrunning=!1,0>t?t=0:t>b.page.maxh&&(t=b.page.maxh),0>i?i=0:i>b.page.maxw&&(i=b.page.maxw),i!=b.newscrollx||t!=b.newscrolly?b.doScrollPos(i,t):b.onscrollend&&b.onscrollend.call(b,{type:"scrollend",current:{x:sx,y:sy},end:{x:b.newscrollx,y:b.newscrolly}})):b.timer=f(r)||1}if(t="undefined"==typeof t||!1===t?b.getScrollTop(!0):t,b.timer&&b.newscrolly==t&&b.newscrollx==e)return!0;b.timer&&l(b.timer),b.timer=0;var i=b.getScrollTop(),s=b.getScrollLeft();(0>(b.newscrolly-i)*(t-i)||0>(b.newscrollx-s)*(e-s))&&b.cancelScroll(),b.newscrolly=t,b.newscrollx=e,b.bouncescroll&&b.rail.visibility||(0>b.newscrolly?b.newscrolly=0:b.newscrolly>b.page.maxh&&(b.newscrolly=b.page.maxh)),b.bouncescroll&&b.railh.visibility||(0>b.newscrollx?b.newscrollx=0:b.newscrollx>b.page.maxw&&(b.newscrollx=b.page.maxw)),b.dst={},b.dst.x=e-s,b.dst.y=t-i,b.dst.px=s,b.dst.py=i;var o=Math.round(Math.sqrt(Math.pow(b.dst.x,2)+Math.pow(b.dst.y,2)));b.dst.ax=b.dst.x/o,b.dst.ay=b.dst.y/o;var u=0,a=o;if(0==b.dst.x?(u=i,a=t,b.dst.ay=1,b.dst.py=0):0==b.dst.y&&(u=s,a=e,b.dst.ax=1,b.dst.px=0),o=b.getTransitionSpeed(o),n&&1>=n&&(o*=n),b.bzscroll=o>0?b.bzscroll?b.bzscroll.update(a,o):new BezierClass(u,a,o,0,1,0,1):!1,!b.timer){(i==b.page.maxh&&t>=b.page.maxh||s==b.page.maxw&&e>=b.page.maxw)&&b.checkContentSize();var c=1;b.cancelAnimationFrame=!1,b.timer=1,b.onscrollstart&&!b.scrollrunning&&b.onscrollstart.call(b,{type:"scrollstart",current:{x:s,y:i},request:{x:e,y:t},end:{x:b.newscrollx,y:b.newscrolly},speed:o}),r(),(i==b.page.maxh&&t>=i||s==b.page.maxw&&e>=s)&&b.checkContentSize(),b.noticeCursor()}},this.cancelScroll=function(){return b.timer&&l(b.timer),b.timer=0,b.bzscroll=!1,b.scrollrunning=!1,b}):(this.doScrollLeft=function(e,t){var n=b.getScrollTop();b.doScrollPos(e,n,t)},this.doScrollTop=function(e,t){var n=b.getScrollLeft();b.doScrollPos(n,e,t)},this.doScrollPos=function(e,t){var n=e>b.page.maxw?b.page.maxw:e;0>n&&(n=0);var r=t>b.page.maxh?b.page.maxh:t;0>r&&(r=0),b.synched("scroll",function(){b.setScrollTop(r),b.setScrollLeft(n)})},this.cancelScroll=function(){}),this.doScrollBy=function(e,t){var n=0,n=t?Math.floor((b.scroll.y-e)*b.scrollratio.y):(b.timer?b.newscrolly:b.getScrollTop(!0))-e;if(b.bouncescroll){var r=Math.round(b.view.h/2);-r>n?n=-r:n>b.page.maxh+r&&(n=b.page.maxh+r)}return b.cursorfreezed=!1,py=b.getScrollTop(!0),0>n&&0>=py?b.noticeCursor():n>b.page.maxh&&py>=b.page.maxh?(b.checkContentSize(),b.noticeCursor()):void b.doScrollTop(n)},this.doScrollLeftBy=function(e,t){var n=0,n=t?Math.floor((b.scroll.x-e)*b.scrollratio.x):(b.timer?b.newscrollx:b.getScrollLeft(!0))-e;if(b.bouncescroll){var r=Math.round(b.view.w/2);-r>n?n=-r:n>b.page.maxw+r&&(n=b.page.maxw+r)}return b.cursorfreezed=!1,px=b.getScrollLeft(!0),0>n&&0>=px||n>b.page.maxw&&px>=b.page.maxw?b.noticeCursor():void b.doScrollLeft(n)},this.doScrollTo=function(e,t){t&&Math.round(e*b.scrollratio.y),b.cursorfreezed=!1,b.doScrollTop(e)},this.checkContentSize=function(){var e=b.getContentSize();e.h==b.page.h&&e.w==b.page.w||b.resize(!1,e)},b.onscroll=function(){b.rail.drag||b.cursorfreezed||b.synched("scroll",function(){b.scroll.y=Math.round(b.getScrollTop()*(1/b.scrollratio.y)),b.railh&&(b.scroll.x=Math.round(b.getScrollLeft()*(1/b.scrollratio.x))),b.noticeCursor()})},b.bind(b.docscroll,"scroll",b.onscroll),this.doZoomIn=function(t){if(!b.zoomactive){b.zoomactive=!0,b.zoomrestore={style:{}};var n,r="position top left zIndex backgroundColor marginTop marginBottom marginLeft marginRight".split(" "),i=b.win[0].style;for(n in r){var o=r[n];b.zoomrestore.style[o]="undefined"!=typeof i[o]?i[o]:""}return b.zoomrestore.style.width=b.win.css("width"),b.zoomrestore.style.height=b.win.css("height"),b.zoomrestore.padding={w:b.win.outerWidth()-b.win.width(),h:b.win.outerHeight()-b.win.height()},E.isios4&&(b.zoomrestore.scrollTop=e(window).scrollTop(),e(window).scrollTop(0)),b.win.css({position:E.isios4?"absolute":"fixed",top:0,left:0,"z-index":s+100,margin:"0px"}),r=b.win.css("backgroundColor"),(""==r||/transparent|rgba\(0, 0, 0, 0\)|rgba\(0,0,0,0\)/.test(r))&&b.win.css("backgroundColor","#fff"),b.rail.css({"z-index":s+101}),b.zoom.css({"z-index":s+102}),b.zoom.css("backgroundPosition","0px -18px"),b.resizeZoom(),b.onzoomin&&b.onzoomin.call(b),b.cancelEvent(t)}},this.doZoomOut=function(t){return b.zoomactive?(b.zoomactive=!1,b.win.css("margin",""),b.win.css(b.zoomrestore.style),E.isios4&&e(window).scrollTop(b.zoomrestore.scrollTop),b.rail.css({"z-index":b.zindex}),b.zoom.css({"z-index":b.zindex}),b.zoomrestore=!1,b.zoom.css("backgroundPosition","0px 0px"),b.onResize(),b.onzoomout&&b.onzoomout.call(b),b.cancelEvent(t)):void 0},this.doZoom=function(e){return b.zoomactive?b.doZoomOut(e):b.doZoomIn(e)},this.resizeZoom=function(){if(b.zoomactive){var t=b.getScrollTop();b.win.css({width:e(window).width()-b.zoomrestore.padding.w+"px",height:e(window).height()-b.zoomrestore.padding.h+"px"}),b.onResize(),b.setScrollTop(Math.min(b.page.maxh,t))}},this.init(),e.nicescroll.push(this)},y=function(e){var t=this;this.nc=e,this.steptime=this.lasttime=this.speedy=this.speedx=this.lasty=this.lastx=0,this.snapy=this.snapx=!1,this.demuly=this.demulx=0,this.lastscrolly=this.lastscrollx=-1,this.timer=this.chky=this.chkx=0,this.time=function(){return+(new Date)},this.reset=function(e,n){t.stop();var r=t.time();t.steptime=0,t.lasttime=r,t.speedx=0,t.speedy=0,t.lastx=e,t.lasty=n,t.lastscrollx=-1,t.lastscrolly=-1},this.update=function(e,n){var r=t.time();t.steptime=r-t.lasttime,t.lasttime=r;var r=n-t.lasty,i=e-t.lastx,s=t.nc.getScrollTop(),o=t.nc.getScrollLeft(),s=s+r,o=o+i;t.snapx=0>o||o>t.nc.page.maxw,t.snapy=0>s||s>t.nc.page.maxh,t.speedx=i,t.speedy=r,t.lastx=e,t.lasty=n},this.stop=function(){t.nc.unsynched("domomentum2d"),t.timer&&clearTimeout(t.timer),t.timer=0,t.lastscrollx=-1,t.lastscrolly=-1},this.doSnapy=function(e,n){var r=!1;0>n?(n=0,r=!0):n>t.nc.page.maxh&&(n=t.nc.page.maxh,r=!0),0>e?(e=0,r=!0):e>t.nc.page.maxw&&(e=t.nc.page.maxw,r=!0),r&&t.nc.doScrollPos(e,n,t.nc.opt.snapbackspeed)},this.doMomentum=function(e){var n=t.time(),r=e?n+e:t.lasttime;e=t.nc.getScrollLeft();var i=t.nc.getScrollTop(),s=t.nc.page.maxh,o=t.nc.page.maxw;if(t.speedx=o>0?Math.min(60,t.speedx):0,t.speedy=s>0?Math.min(60,t.speedy):0,r=r&&60>=n-r,(0>i||i>s||0>e||e>o)&&(r=!1),e=t.speedx&&r?t.speedx:!1,t.speedy&&r&&t.speedy||e){var u=Math.max(16,t.steptime);u>50&&(e=u/50,t.speedx*=e,t.speedy*=e,u=50),t.demulxy=0,t.lastscrollx=t.nc.getScrollLeft(),t.chkx=t.lastscrollx,t.lastscrolly=t.nc.getScrollTop(),t.chky=t.lastscrolly;var a=t.lastscrollx,f=t.lastscrolly,l=function(){var e=600<t.time()-n?.04:.02;t.speedx&&(a=Math.floor(t.lastscrollx-t.speedx*(1-t.demulxy)),t.lastscrollx=a,0>a||a>o)&&(e=.1),t.speedy&&(f=Math.floor(t.lastscrolly-t.speedy*(1-t.demulxy)),t.lastscrolly=f,0>f||f>s)&&(e=.1),t.demulxy=Math.min(1,t.demulxy+e),t.nc.synched("domomentum2d",function(){t.speedx&&(t.nc.getScrollLeft()!=t.chkx&&t.stop(),t.chkx=a,t.nc.setScrollLeft(a)),t.speedy&&(t.nc.getScrollTop()!=t.chky&&t.stop(),t.chky=f,t.nc.setScrollTop(f)),t.timer||(t.nc.hideCursor(),t.doSnapy(a,f))}),1>t.demulxy?t.timer=setTimeout(l,u):(t.stop(),t.nc.hideCursor(),t.doSnapy(a,f))};l()}else t.doSnapy(t.nc.getScrollLeft(),t.nc.getScrollTop())}},b=e.fn.scrollTop;e.cssHooks.pageYOffset={get:function(t,n){return(n=e.data(t,"__nicescroll")||!1)&&n.ishwscroll?n.getScrollTop():b.call(t)},set:function(t,n){var r=e.data(t,"__nicescroll")||!1;return r&&r.ishwscroll?r.setScrollTop(parseInt(n)):b.call(t,n),this}},e.fn.scrollTop=function(t){if("undefined"==typeof t){var n=this[0]?e.data(this[0],"__nicescroll")||!1:!1;return n&&n.ishwscroll?n.getScrollTop():b.call(this)}return this.each(function(){var n=e.data(this,"__nicescroll")||!1;n&&n.ishwscroll?n.setScrollTop(parseInt(t)):b.call(e(this),t)})};var w=e.fn.scrollLeft;e.cssHooks.pageXOffset={get:function(t,n){return(n=e.data(t,"__nicescroll")||!1)&&n.ishwscroll?n.getScrollLeft():w.call(t)},set:function(t,n){var r=e.data(t,"__nicescroll")||!1;return r&&r.ishwscroll?r.setScrollLeft(parseInt(n)):w.call(t,n),this}},e.fn.scrollLeft=function(t){if("undefined"==typeof t){var n=this[0]?e.data(this[0],"__nicescroll")||!1:!1;return n&&n.ishwscroll?n.getScrollLeft():w.call(this)}return this.each(function(){var n=e.data(this,"__nicescroll")||!1;n&&n.ishwscroll?n.setScrollLeft(parseInt(t)):w.call(e(this),t)})};var E=function(t){var n=this;if(this.length=0,this.name="nicescrollarray",this.each=function(e){for(var t=0,r=0;t<n.length;t++)e.call(n[t],r++);return n},this.push=function(e){n[n.length]=e,n.length++},this.eq=function(e){return n[e]},t)for(a=0;a<t.length;a++){var r=e.data(t[a],"__nicescroll")||!1;r&&(this[this.length]=r,this.length++)}return this};!function(e,t,n){for(var r=0;r<t.length;r++)n(e,t[r])}(E.prototype,"show hide toggle onResize resize remove stop doScrollPos".split(" "),function(e,t){e[t]=function(){var e=arguments;return this.each(function(){this[t].apply(this,e)})}}),e.fn.getNiceScroll=function(t){return"undefined"==typeof t?new E(this):this[t]&&e.data(this[t],"__nicescroll")||!1},e.extend(e.expr[":"],{nicescroll:function(t){return e.data(t,"__nicescroll")?!0:!1}}),e.fn.niceScroll=function(t,n){"undefined"!=typeof n||"object"!=typeof t||"jquery"in t||(n=t,t=!1);var r=new E;"undefined"==typeof n&&(n={}),t&&(n.doc=e(t),n.win=e(this));var i=!("doc"in n);return i||"win"in n||(n.win=e(this)),this.each(function(){var t=e(this).data("__nicescroll")||!1;t||(n.doc=i?e(this):n.doc,t=new g(n,e(this)),e(this).data("__nicescroll",t)),r.push(t)}),1==r.length?r[0]:r},window.NiceScroll={getjQuery:function(){return e}},e.nicescroll||(e.nicescroll=new E,e.nicescroll.options=d)}(jQuery),n("libs/jquery.nicescroll.min",function(){}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};n("scroll",["libs/jquery.nicescroll.min"],function(){var t;return t=function(){function t(n,r){var i;return this.$el=n,null==r&&(r={}),this.onScrollEnd=e(this.onScrollEnd,this),this.onScrollStart=e(this.onScrollStart,this),r.allBrowsers||(r.userAgent||(r.userAgent=/Windows\ NT/),navigator.userAgent.match(r.userAgent))?(null==r.horizontal&&(r.horizontal=!0),null==r.zindex&&(r.zindex=9e3),i={cursorcolor:"rgba(0,0,0,0.5)",cursorwidth:"8px",zindex:r.zindex,horizrailenabled:r.horizontal},this.nice=this.$el.niceScroll(i),this.nice.scrollstart(this.onScrollStart),this.nice.scrollend(this.onScrollEnd),void t.scrollers.push(this.nice)):!1}return t.scrollers=[],t.prototype._otherScrollers=function(){var e,n,r,i,s;for(e=[],s=t.scrollers,r=0,i=s.length;i>r;r++)n=s[r],n!==this.nice&&e.push(n);return e},t.prototype.onScrollStart=function(){var e,t,n,r,i;for(r=this._otherScrollers(),i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(e.hide());return i},t.prototype.onScrollEnd=function(){var e,t,n,r,i;for(r=this._otherScrollers(),i=[],t=0,n=r.length;n>t;t++)e=r[t],e.resize(),i.push(e.show());return i},t.prototype.resize=function(){return this.nice.resize()},t.prototype.destroy=function(){return t.scrollers=this._otherScrollers(),this.nice.remove()},t}()})}.call(this),function(){n("ui",["editable_text","loading","loading_indicator","scroll"],function(e,t,n,r){var i;return i={EditableText:e,Loading:t,LoadingIndicator:n,Scroll:r},"undefined"!=typeof window&&(window.vs||(window.vs={}),window.vs.ui=i),i})}.call(this),t("ui")}),define("text!templates/lesson.html",[],function(){return'<header>\n  <h1 class="lesson-title js-lesson-title"><%- title %></h1>\n</header>\n\n<div class="lesson-content js-lesson-content">\n  <div class="gadgets js-lesson-gadgets">\n    <p class="canvas-message">\n      To begin, grab a gadget and drag it onto the canvas\n    </p>\n  </div>\n</div>\n\n<div class="lesson-screen js-lesson-screen"></div>\n'}),define("text!templates/gadget_drag_image.html",[],function(){return'<div class="js-gadget-drag-image-icon gadget-drag-image-icon"></div>\n\n<div class="gadget-drag-image-details">\n  <div><%- title %></div>\n  <div><%- author %></div>\n  <div><%- version %></div>\n</div>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/gadget/drag_image",["cdn.underscore","cdn.marionette","text!templates/gadget_drag_image.html"],function(e,n,r){var i,s;return i=function(n){function i(){return s=i.__super__.constructor.apply(this,arguments),s}return t(i,n),i.prototype.template=e.template(r),i.prototype.className="gadget-drag-image",i.prototype.ui={icon:".js-gadget-drag-image-icon"},i.prototype.onRender=function(){var e;if(this.model.has("icon"))return e=this.model.get("icon"),this.ui.icon.css({"background-image":"url("+e+")"})},i}(n.ItemView)})}.call(this),define("text!templates/property_sheet.html",[],function(){return'<div class="properties-dialog-arrow"></div>\n\n<div class="properties-dialog-header">\n  Properties\n\n  <div class="properties-dialog-error-count js-error-count-container">\n    <span class="js-error-count">1</span>\n    error<span class="js-error-count-plural">s</span>\n  </div>\n</div>\n\n<div class="js-form"></div>\n'}),function(e,t){typeof define=="function"&&define.amd?define("bower_components/tether/tether",t):typeof exports=="object"?module.exports=t(require,exports,module):e.Tether=t()}(this,function(e,t,n){return function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g={}.hasOwnProperty,y=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},b=[].slice;this.Tether==null&&(this.Tether={modules:[]}),l=function(e){var t,n,r,i,s;n=getComputedStyle(e).position;if(n==="fixed")return e;r=void 0,t=e;while(t=t.parentNode){try{i=getComputedStyle(t)}catch(o){}if(i==null)return t;if(/(auto|scroll)/.test(i.overflow+i.overflowY+i.overflowX))if(n!=="absolute"||(s=i.position)==="relative"||s==="absolute"||s==="fixed")return t}return document.body},d=function(){var e;return e=0,function(){return e++}}(),m={},a=function(e){var t,r,s,o,u;s=e._tetherZeroElement,s==null&&(s=e.createElement("div"),s.setAttribute("data-tether-id",d()),i(s.style,{top:0,left:0,position:"absolute"}),e.body.appendChild(s),e._tetherZeroElement=s),t=s.getAttribute("data-tether-id");if(m[t]==null){m[t]={},u=s.getBoundingClientRect();for(r in u)o=u[r],m[t][r]=o;n(function(){return m[t]=void 0})}return m[t]},h=null,o=function(e){var t,n,r,i,s,o,u;e===document?(n=document,e=document.documentElement):n=e.ownerDocument,r=n.documentElement,t={},u=e.getBoundingClientRect();for(i in u)o=u[i],t[i]=o;return s=a(n),t.top-=s.top,t.left-=s.left,t.width==null&&(t.width=document.body.scrollWidth-t.left-t.right),t.height==null&&(t.height=document.body.scrollHeight-t.top-t.bottom),t.top=t.top-r.clientTop,t.left=t.left-r.clientLeft,t.right=n.body.clientWidth-t.width-t.left,t.bottom=n.body.clientHeight-t.height-t.top,t},u=function(e){return e.offsetParent||document.documentElement},f=function(){var e,t,n,r,s;return e=document.createElement("div"),e.style.width="100%",e.style.height="200px",t=document.createElement("div"),i(t.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),t.appendChild(e),document.body.appendChild(t),r=e.offsetWidth,t.style.overflow="scroll",s=e.offsetWidth,r===s&&(s=t.clientWidth),document.body.removeChild(t),n=r-s,{width:n,height:n}},i=function(e){var t,n,r,i,s,o,u;e==null&&(e={}),t=[],Array.prototype.push.apply(t,arguments),u=t.slice(1);for(s=0,o=u.length;s<o;s++){r=u[s];if(r)for(n in r){if(!g.call(r,n))continue;i=r[n],e[n]=i}}return e},p=function(e,t){var n,r,i,s,o;if(e.classList!=null){s=t.split(" "),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],n.trim()&&o.push(e.classList.remove(n));return o}return e.setAttribute("class",e.getAttribute("class").replace(new RegExp("(^| )"+t.split(" ").join("|")+"( |$)","gi")," "))},t=function(e,t){var n,r,i,s,o;if(e.classList!=null){s=t.split(" "),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],n.trim()&&o.push(e.classList.add(n));return o}return p(e,t),e.className+=" "+t},c=function(e,t){return e.classList!=null?e.classList.contains(t):(new RegExp("(^| )"+t+"( |$)","gi")).test(e.className)},v=function(e,n,r){var i,s,o,u,a,f;for(s=0,u=r.length;s<u;s++)i=r[s],y.call(n,i)<0&&c(e,i)&&p(e,i);f=[];for(o=0,a=n.length;o<a;o++)i=n[o],c(e,i)?f.push(void 0):f.push(t(e,i));return f},r=[],n=function(e){return r.push(e)},s=function(){var e,t;t=[];while(e=r.pop())t.push(e());return t},e=function(){function e(){}return e.prototype.on=function(e,t,n,r){var i;return r==null&&(r=!1),this.bindings==null&&(this.bindings={}),(i=this.bindings)[e]==null&&(i[e]=[]),this.bindings[e].push({handler:t,ctx:n,once:r})},e.prototype.once=function(e,t,n){return this.on(e,t,n,!0)},e.prototype.off=function(e,t){var n,r,i;if(((r=this.bindings)!=null?r[e]:void 0)==null)return;if(t==null)return delete this.bindings[e];n=0,i=[];while(n<this.bindings[e].length)this.bindings[e][n].handler===t?i.push(this.bindings[e].splice(n,1)):i.push(n++);return i},e.prototype.trigger=function(){var e,t,n,r,i,s,o,u,a;n=arguments[0],e=2<=arguments.length?b.call(arguments,1):[];if((o=this.bindings)!=null?o[n]:void 0){i=0,a=[];while(i<this.bindings[n].length)u=this.bindings[n][i],r=u.handler,t=u.ctx,s=u.once,r.apply(t!=null?t:this,e),s?a.push(this.bindings[n].splice(i,1)):a.push(i++);return a}},e}(),this.Tether.Utils={getScrollParent:l,getBounds:o,getOffsetParent:u,extend:i,addClass:t,removeClass:p,hasClass:c,updateClasses:v,defer:n,flush:s,uniqueId:d,Evented:e,getScrollBarSize:f}}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A=[].slice,O=function(e,t){return function(){return e.apply(t,arguments)}};if(this.Tether==null)throw new Error("You must include the utils.js file before tether.js");r=this.Tether,L=r.Utils,v=L.getScrollParent,m=L.getSize,p=L.getOuterSize,c=L.getBounds,h=L.getOffsetParent,f=L.extend,i=L.addClass,S=L.removeClass,N=L.updateClasses,a=L.defer,l=L.flush,d=L.getScrollBarSize,C=function(e,t,n){return n==null&&(n=1),e+n>=t&&t>=e-n},T=function(){var e,t,n,r,i;e=document.createElement("div"),i=["transform","webkitTransform","OTransform","MozTransform","msTransform"];for(n=0,r=i.length;n<r;n++){t=i[n];if(e.style[t]!==void 0)return t}}(),x=[],E=function(){var e,t,n;for(t=0,n=x.length;t<n;t++)e=x[t],e.position(!1);return l()},g=function(){var e;return(e=typeof performance!=="undefined"&&performance!==null?typeof performance.now==="function"?performance.now():void 0:void 0)!=null?e:+(new Date)},function(){var e,t,n,r,i,s,o,u,a;t=null,n=null,r=null,i=function(){if(n!=null&&n>16){n=Math.min(n-16,250),r=setTimeout(i,250);return}if(t!=null&&g()-t<10)return;return r!=null&&(clearTimeout(r),r=null),t=g(),E(),n=g()-t},u=["resize","scroll","touchmove"],a=[];for(s=0,o=u.length;s<o;s++)e=u[s],a.push(window.addEventListener(e,i));return a}(),e={center:"center",left:"right",right:"left"},t={middle:"middle",top:"bottom",bottom:"top"},n={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},u=function(n,r){var i,s;return i=n.left,s=n.top,i==="auto"&&(i=e[r.left]),s==="auto"&&(s=t[r.top]),{left:i,top:s}},o=function(e){var t,r;return{left:(t=n[e.left])!=null?t:e.left,top:(r=n[e.top])!=null?r:e.top}},s=function(){var e,t,n,r,i,s,o;t=1<=arguments.length?A.call(arguments,0):[],n={top:0,left:0};for(i=0,s=t.length;i<s;i++)o=t[i],r=o.top,e=o.left,typeof r=="string"&&(r=parseFloat(r,10)),typeof e=="string"&&(e=parseFloat(e,10)),n.top+=r,n.left+=e;return n},y=function(e,t){return typeof e.left=="string"&&e.left.indexOf("%")!==-1&&(e.left=parseFloat(e.left,10)/100*t.width),typeof e.top=="string"&&e.top.indexOf("%")!==-1&&(e.top=parseFloat(e.top,10)/100*t.height),e},b=w=function(e){var t,n,r;return r=e.split(" "),n=r[0],t=r[1],{top:n,left:t}},k=function(){function e(e){this.position=O(this.position,this);var t,n,i,s,o;x.push(this),this.history=[],this.setOptions(e,!1),s=r.modules;for(n=0,i=s.length;n<i;n++)t=s[n],(o=t.initialize)!=null&&o.call(this);this.position()}return e.modules=[],e.prototype.getClass=function(e){var t,n;return((t=this.options.classes)!=null?t[e]:void 0)?this.options.classes[e]:((n=this.options.classes)!=null?n[e]:void 0)!==!1?this.options.classPrefix?""+this.options.classPrefix+"-"+e:e:""},e.prototype.setOptions=function(e,t){var n,r,s,o,u,a;this.options=e,t==null&&(t=!0),n={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"},this.options=f(n,this.options),u=this.options,this.element=u.element,this.target=u.target,this.targetModifier=u.targetModifier,this.target==="viewport"?(this.target=document.body,this.targetModifier="visible"):this.target==="scroll-handle"&&(this.target=document.body,this.targetModifier="scroll-handle"),a=["element","target"];for(s=0,o=a.length;s<o;s++){r=a[s];if(this[r]==null)throw new Error("Tether Error: Both element and target must be defined");this[r].jquery!=null?this[r]=this[r][0]:typeof this[r]=="string"&&(this[r]=document.querySelector(this[r]))}i(this.element,this.getClass("element")),i(this.target,this.getClass("target"));if(!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");this.targetAttachment=b(this.options.targetAttachment),this.attachment=b(this.options.attachment),this.offset=w(this.options.offset),this.targetOffset=w(this.options.targetOffset),this.scrollParent!=null&&this.disable(),this.targetModifier==="scroll-handle"?this.scrollParent=this.target:this.scrollParent=v(this.target);if(this.options.enabled!==!1)return this.enable(t)},e.prototype.getTargetBounds=function(){var e,t,n,r,i,s,o,u,a;if(this.targetModifier==null)return c(this.target);switch(this.targetModifier){case"visible":return this.target===document.body?{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth}:(e=c(this.target),i={height:e.height,width:e.width,top:e.top,left:e.left},i.height=Math.min(i.height,e.height-(pageYOffset-e.top)),i.height=Math.min(i.height,e.height-(e.top+e.height-(pageYOffset+innerHeight))),i.height=Math.min(innerHeight,i.height),i.height-=2,i.width=Math.min(i.width,e.width-(pageXOffset-e.left)),i.width=Math.min(i.width,e.width-(e.left+e.width-(pageXOffset+innerWidth))),i.width=Math.min(innerWidth,i.width),i.width-=2,i.top<pageYOffset&&(i.top=pageYOffset),i.left<pageXOffset&&(i.left=pageXOffset),i);case"scroll-handle":return a=this.target,a===document.body?(a=document.documentElement,e={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):e=c(a),u=getComputedStyle(a),n=a.scrollWidth>a.clientWidth||"scroll"===[u.overflow,u.overflowX]||this.target!==document.body,s=0,n&&(s=15),r=e.height-parseFloat(u.borderTopWidth)-parseFloat(u.borderBottomWidth)-s,i={width:15,height:r*.975*(r/a.scrollHeight),left:e.left+e.width-parseFloat(u.borderLeftWidth)-15},t=0,r<408&&this.target===document.body&&(t=-0.00011*Math.pow(r,2)-.00727*r+22.58),this.target!==document.body&&(i.height=Math.max(i.height,24)),o=this.target.scrollTop/(a.scrollHeight-r),i.top=o*(r-i.height-t)+e.top+parseFloat(u.borderTopWidth),this.target===document.body&&(i.height=Math.max(i.height,24)),i}},e.prototype.clearCache=function(){return this._cache={}},e.prototype.cache=function(e,t){return this._cache==null&&(this._cache={}),this._cache[e]==null&&(this._cache[e]=t.call(this)),this._cache[e]},e.prototype.enable=function(e){e==null&&(e=!0),i(this.target,this.getClass("enabled")),i(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position);if(e)return this.position()},e.prototype.disable=function(){S(this.target,this.getClass("enabled")),S(this.element,this.getClass("enabled")),this.enabled=!1;if(this.scrollParent!=null)return this.scrollParent.removeEventListener("scroll",this.position)},e.prototype.destroy=function(){var e,t,n,r,i;this.disable(),i=[];for(e=n=0,r=x.length;n<r;e=++n){t=x[e];if(t===this){x.splice(e,1);break}i.push(void 0)}return i},e.prototype.updateAttachClasses=function(e,t){var n,r,i,s,o,u,f,l,c,h=this;e==null&&(e=this.attachment),t==null&&(t=this.targetAttachment),s=["left","top","bottom","right","middle","center"],((c=this._addAttachClasses)!=null?c.length:void 0)&&this._addAttachClasses.splice(0,this._addAttachClasses.length),n=this._addAttachClasses!=null?this._addAttachClasses:this._addAttachClasses=[],e.top&&n.push(""+this.getClass("element-attached")+"-"+e.top),e.left&&n.push(""+this.getClass("element-attached")+"-"+e.left),t.top&&n.push(""+this.getClass("target-attached")+"-"+t.top),t.left&&n.push(""+this.getClass("target-attached")+"-"+t.left),r=[];for(o=0,f=s.length;o<f;o++)i=s[o],r.push(""+this.getClass("element-attached")+"-"+i);for(u=0,l=s.length;u<l;u++)i=s[u],r.push(""+this.getClass("target-attached")+"-"+i);return a(function(){if(h._addAttachClasses==null)return;return N(h.element,h._addAttachClasses,r),N(h.target,h._addAttachClasses,r),h._addAttachClasses=void 0})},e.prototype.position=function(e){var t,n,i,a,f,p,v,m,g,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X=this;e==null&&(e=!0);if(!this.enabled)return;this.clearCache(),A=u(this.targetAttachment,this.attachment),this.updateAttachClasses(this.attachment,A),t=this.cache("element-bounds",function(){return c(X.element)}),P=t.width,i=t.height,P===0&&i===0&&this.lastSize!=null?(I=this.lastSize,P=I.width,i=I.height):this.lastSize={width:P,height:i},_=M=this.cache("target-bounds",function(){return X.getTargetBounds()}),g=y(o(this.attachment),{width:P,height:i}),O=y(o(A),_),f=y(this.offset,{width:P,height:i}),p=y(this.targetOffset,_),g=s(g,f),O=s(O,p),a=M.left+O.left-g.left,D=M.top+O.top-g.top,q=r.modules;for(H=0,j=q.length;H<j;H++){v=q[H],T=v.position.call(this,{left:a,top:D,targetAttachment:A,targetPos:M,attachment:this.attachment,elementPos:t,offset:g,targetOffset:O,manualOffset:f,manualTargetOffset:p,scrollbarSize:k});if(T==null||typeof T!="object")continue;if(T===!1)return!1;D=T.top,a=T.left}m={page:{top:D,left:a},viewport:{top:D-pageYOffset,bottom:pageYOffset-D-i+innerHeight,left:a-pageXOffset,right:pageXOffset-a-P+innerWidth}},document.body.scrollWidth>window.innerWidth&&(k=this.cache("scrollbar-size",d),m.viewport.bottom-=k.height),document.body.scrollHeight>window.innerHeight&&(k=this.cache("scrollbar-size",d),m.viewport.right-=k.width);if((R=document.body.style.position)!==""&&R!=="static"||(U=document.body.parentElement.style.position)!==""&&U!=="static")m.page.bottom=document.body.scrollHeight-D-i,m.page.right=document.body.scrollWidth-a-P;if(((z=this.options.optimizations)!=null?z.moveElement:void 0)!==!1&&this.targetModifier==null){w=this.cache("target-offsetparent",function(){return h(X.target)}),x=this.cache("target-offsetparent-bounds",function(){return c(w)}),S=getComputedStyle(w),n=getComputedStyle(this.element),E=x,b={},W=["Top","Left","Bottom","Right"];for(B=0,F=W.length;B<F;B++)L=W[B],b[L.toLowerCase()]=parseFloat(S["border"+L+"Width"]);x.right=document.body.scrollWidth-x.left-E.width+b.right,x.bottom=document.body.scrollHeight-x.top-E.height+b.bottom,m.page.top>=x.top+b.top&&m.page.bottom>=x.bottom&&m.page.left>=x.left+b.left&&m.page.right>=x.right&&(C=w.scrollTop,N=w.scrollLeft,m.offset={top:m.page.top-x.top+C-b.top,left:m.page.left-x.left+N-b.left})}return this.move(m),this.history.unshift(m),this.history.length>3&&this.history.pop(),e&&l(),!0},e.prototype.move=function(e){var t,n,r,i,s,o,u,l,c,p,d,v,m,g,y,b,w,E=this;if(this.element.parentNode==null)return;l={};for(p in e){l[p]={};for(i in e[p]){r=!1,b=this.history;for(g=0,y=b.length;g<y;g++){u=b[g];if(!C((w=u[p])!=null?w[i]:void 0,e[p][i])){r=!0;break}}r||(l[p][i]=!0)}}t={top:"",left:"",right:"",bottom:""},c=function(e,n){var r,i,s;if(((s=E.options.optimizations)!=null?s.gpu:void 0)===!1)return e.top?t.top=""+n.top+"px":t.bottom=""+n.bottom+"px",e.left?t.left=""+n.left+"px":t.right=""+n.right+"px";e.top?(t.top=0,i=n.top):(t.bottom=0,i=-n.bottom),e.left?(t.left=0,r=n.left):(t.right=0,r=-n.right),t[T]="translateX("+Math.round(r)+"px) translateY("+Math.round(i)+"px)";if(T!=="msTransform")return t[T]+=" translateZ(0)"},s=!1,(l.page.top||l.page.bottom)&&(l.page.left||l.page.right)?(t.position="absolute",c(l.page,e.page)):(l.viewport.top||l.viewport.bottom)&&(l.viewport.left||l.viewport.right)?(t.position="fixed",c(l.viewport,e.viewport)):l.offset!=null&&l.offset.top&&l.offset.left?(t.position="absolute",o=this.cache("target-offsetparent",function(){return h(E.target)}),h(this.element)!==o&&a(function(){return E.element.parentNode.removeChild(E.element),o.appendChild(E.element)}),c(l.offset,e.offset),s=!0):(t.position="absolute",c({top:!0,left:!0},e.page)),!s&&this.element.parentNode.tagName!=="BODY"&&(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element)),m={},v=!1;for(i in t)d=t[i],n=this.element.style[i],n!==""&&d!==""&&(i==="top"||i==="left"||i==="bottom"||i==="right")&&(n=parseFloat(n),d=parseFloat(d)),n!==d&&(v=!0,m[i]=t[i]);if(v)return a(function(){return f(E.element.style,m)})},e}(),r.position=E,this.Tether=f(k,r)}.call(this),function(){var e,t,n,r,i,s,o,u,a,f,l=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};f=this.Tether.Utils,o=f.getOuterSize,s=f.getBounds,u=f.getSize,r=f.extend,a=f.updateClasses,n=f.defer,t={left:"right",right:"left",top:"bottom",bottom:"top",middle:"middle"},e=["left","top","right","bottom"],i=function(t,n){var r,i,o,u,a,f,l;n==="scrollParent"?n=t.scrollParent:n==="window"&&(n=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),n===document&&(n=n.documentElement);if(n.nodeType!=null){i=u=s(n),a=getComputedStyle(n),n=[i.left,i.top,u.width+i.left,u.height+i.top];for(r=f=0,l=e.length;f<l;r=++f)o=e[r],o=o[0].toUpperCase()+o.substr(1),o==="Top"||o==="Left"?n[r]+=parseFloat(a["border"+o+"Width"]):n[r]-=parseFloat(a["border"+o+"Width"])}return n},this.Tether.modules.push({position:function(t){var o,u,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt=this;D=t.top,y=t.left,L=t.targetAttachment;if(!this.options.constraints)return!0;N=function(t){var n,r,i,s;tt.removeClass(t),s=[];for(r=0,i=e.length;r<i;r++)n=e[r],s.push(tt.removeClass(""+t+"-"+n));return s},$=this.cache("element-bounds",function(){return s(tt.element)}),g=$.height,P=$.width,P===0&&g===0&&this.lastSize!=null&&(J=this.lastSize,P=J.width,g=J.height),O=this.cache("target-bounds",function(){return tt.getTargetBounds()}),A=O.height,M=O.width,k={},m={},u=[this.getClass("pinned"),this.getClass("out-of-bounds")],K=this.options.constraints;for(H=0,I=K.length;H<I;H++)v=K[H],v.outOfBoundsClass&&u.push(v.outOfBoundsClass),v.pinnedClass&&u.push(v.pinnedClass);for(B=0,q=u.length;B<q;B++){d=u[B],Q=["left","top","right","bottom"];for(j=0,R=Q.length;j<R;j++)C=Q[j],u.push(""+d+"-"+C)}o=[],k=r({},L),m=r({},this.attachment),G=this.options.constraints;for(F=0,U=G.length;F<U;F++){v=G[F],_=v.to,f=v.attachment,S=v.pin,f==null&&(f=""),l.call(f," ")>=0?(Y=f.split(" "),p=Y[0],h=Y[1]):h=p=f,c=i(this,_);if(p==="target"||p==="both")D<c[1]&&k.top==="top"&&(D+=A,k.top="bottom"),D+g>c[3]&&k.top==="bottom"&&(D-=A,k.top="top");p==="together"&&(D<c[1]&&k.top==="top"&&(m.top==="bottom"?(D+=A,k.top="bottom",D+=g,m.top="top"):m.top==="top"&&(D+=A,k.top="bottom",D-=g,m.top="bottom")),D+g>c[3]&&k.top==="bottom"&&(m.top==="top"?(D-=A,k.top="top",D-=g,m.top="bottom"):m.top==="bottom"&&(D-=A,k.top="top",D+=g,m.top="top")),k.top==="middle"&&(D+g>c[3]&&m.top==="top"?(D-=g,m.top="bottom"):D<c[1]&&m.top==="bottom"&&(D+=g,m.top="top")));if(h==="target"||h==="both")y<c[0]&&k.left==="left"&&(y+=M,k.left="right"),y+P>c[2]&&k.left==="right"&&(y-=M,k.left="left");h==="together"&&(y<c[0]&&k.left==="left"?m.left==="right"?(y+=M,k.left="right",y+=P,m.left="left"):m.left==="left"&&(y+=M,k.left="right",y-=P,m.left="right"):y+P>c[2]&&k.left==="right"?m.left==="left"?(y-=M,k.left="left",y-=P,m.left="right"):m.left==="right"&&(y-=M,k.left="left",y+=P,m.left="left"):k.left==="center"&&(y+P>c[2]&&m.left==="left"?(y-=P,m.left="right"):y<c[0]&&m.left==="right"&&(y+=P,m.left="left")));if(p==="element"||p==="both")D<c[1]&&m.top==="bottom"&&(D+=g,m.top="top"),D+g>c[3]&&m.top==="top"&&(D-=g,m.top="bottom");if(h==="element"||h==="both")y<c[0]&&m.left==="right"&&(y+=P,m.left="left"),y+P>c[2]&&m.left==="left"&&(y-=P,m.left="right");typeof S=="string"?S=function(){var e,t,n,r;n=S.split(","),r=[];for(t=0,e=n.length;t<e;t++)E=n[t],r.push(E.trim());return r}():S===!0&&(S=["top","left","right","bottom"]),S||(S=[]),x=[],b=[],D<c[1]&&(l.call(S,"top")>=0?(D=c[1],x.push("top")):b.push("top")),D+g>c[3]&&(l.call(S,"bottom")>=0?(D=c[3]-g,x.push("bottom")):b.push("bottom")),y<c[0]&&(l.call(S,"left")>=0?(y=c[0],x.push("left")):b.push("left")),y+P>c[2]&&(l.call(S,"right")>=0?(y=c[2]-P,x.push("right")):b.push("right"));if(x.length){T=(Z=this.options.pinnedClass)!=null?Z:this.getClass("pinned"),o.push(T);for(X=0,z=x.length;X<z;X++)C=x[X],o.push(""+T+"-"+C)}if(b.length){w=(et=this.options.outOfBoundsClass)!=null?et:this.getClass("out-of-bounds"),o.push(w);for(V=0,W=b.length;V<W;V++)C=b[V],o.push(""+w+"-"+C)}if(l.call(x,"left")>=0||l.call(x,"right")>=0)m.left=k.left=!1;if(l.call(x,"top")>=0||l.call(x,"bottom")>=0)m.top=k.top=!1;(k.top!==L.top||k.left!==L.left||m.top!==this.attachment.top||m.left!==this.attachment.left)&&this.updateAttachClasses(m,k)}return n(function(){return a(tt.target,o,u),a(tt.element,o,u)}),{top:D,left:y}}})}.call(this),function(){var e,t,n,r;r=this.Tether.Utils,t=r.getBounds,n=r.updateClasses,e=r.defer,this.Tether.modules.push({position:function(r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A=this;d=r.top,f=r.left,T=this.cache("element-bounds",function(){return t(A.element)}),a=T.height,v=T.width,p=this.getTargetBounds(),u=d+a,l=f+v,i=[];if(d<=p.bottom&&u>=p.top){N=["left","right"];for(m=0,w=N.length;m<w;m++)c=N[m],((C=p[c])===f||C===l)&&i.push(c)}if(f<=p.right&&l>=p.left){k=["top","bottom"];for(g=0,E=k.length;g<E;g++)c=k[g],((L=p[c])===d||L===u)&&i.push(c)}o=[],s=[],h=["left","top","right","bottom"],o.push(this.getClass("abutted"));for(y=0,S=h.length;y<S;y++)c=h[y],o.push(""+this.getClass("abutted")+"-"+c);i.length&&s.push(this.getClass("abutted"));for(b=0,x=i.length;b<x;b++)c=i[b],s.push(""+this.getClass("abutted")+"-"+c);return e(function(){return n(A.target,s,o),n(A.element,s,o)}),!0}})}.call(this),function(){this.Tether.modules.push({position:function(e){var t,n,r,i,s,o,u;o=e.top,t=e.left;if(!this.options.shift)return;return n=function(e){return typeof e=="function"?e.call(this,{top:o,left:t}):e},r=n(this.options.shift),typeof r=="string"?(r=r.split(" "),r[1]||(r[1]=r[0]),s=r[0],i=r[1],s=parseFloat(s,10),i=parseFloat(i,10)):(u=[r.top,r.left],s=u[0],i=u[1]),o+=s,t+=i,{top:o,left:t}}})}.call(this),this.Tether}),define("libs/backbone-forms",["cdn.jquery","cdn.underscore","cdn.backbone"],function(e,t,n){var r=n.View.extend({initialize:function(e){var n=this;e=e||{};var r=this.schema=function(){if(e.schema)return t.result(e,"schema");var r=e.model;return r&&r.schema?t.isFunction(r.schema)?r.schema():r.schema:n.schema?t.isFunction(n.schema)?n.schema():n.schema:{}}();t.extend(this,t.pick(e,"model","data","idPrefix"));var i=this.constructor;this.template=e.template||i.template,this.Fieldset=e.Fieldset||i.Fieldset,this.Field=e.Field||i.Field,this.NestedField=e.NestedField||i.NestedField;var s=this.selectedFields=e.fields||t.keys(r),o=this.fields={};t.each(s,function(e){var t=r[e];o[e]=this.createField(e,t)},this);var u=e.fieldsets||[s],a=this.fieldsets=[];t.each(u,function(e){this.fieldsets.push(this.createFieldset(e))},this)},createFieldset:function(e){var t={schema:e,fields:this.fields};return new this.Fieldset(t)},createField:function(e,t){var n={form:this,key:e,schema:t,idPrefix:this.idPrefix};this.model?n.model=this.model:this.data?n.value=this.data[e]:n.value=null;var r=new this.Field(n);return this.listenTo(r.editor,"all",this.handleEditorEvent),r},handleEditorEvent:function(e,n){var r=n.key+":"+e;this.trigger.call(this,r,this,n);switch(e){case"change":this.trigger("change",this);break;case"focus":this.hasFocus||this.trigger("focus",this);break;case"blur":if(this.hasFocus){var i=this;setTimeout(function(){var e=t.find(i.fields,function(e){return e.editor.hasFocus});e||i.trigger("blur",i)},0)}}},render:function(){var n=this,r=this.fields,i=e(e.trim(this.template(t.result(this,"templateData"))));return i.find("[data-editors]").add(i).each(function(i,s){var o=e(s),u=o.attr("data-editors");if(t.isUndefined(u))return;var a=u=="*"?n.selectedFields||t.keys(r):u.split(",");t.each(a,function(e){var t=r[e];o.append(t.editor.render().el)})}),i.find("[data-fields]").add(i).each(function(i,s){var o=e(s),u=o.attr("data-fields");if(t.isUndefined(u))return;var a=u=="*"?n.selectedFields||t.keys(r):u.split(",");t.each(a,function(e){var t=r[e];o.append(t.render().el)})}),i.find("[data-fieldsets]").add(i).each(function(r,i){var s=e(i),o=s.attr("data-fieldsets");if(t.isUndefined(o))return;t.each(n.fieldsets,function(e){s.append(e.render().el)})}),this.setElement(i),this},validate:function(){var e=this,n=this.fields,r=this.model,i={};t.each(n,function(e){var t=e.validate();t&&(i[e.key]=t)});if(r&&r.validate){var s=r.validate(this.getValue());if(s){var o=t.isObject(s)&&!t.isArray(s);o||(i._others=i._others||[],i._others.push(s)),o&&t.each(s,function(e,t){if(n[t]&&!i[t])n[t].setError(e),i[t]=e;else{i._others=i._others||[];var r={};r[t]=e,i._others.push(r)}})}}return t.isEmpty(i)?null:i},commit:function(e){var n=this.validate();if(n)return n;var r,i=t.extend({error:function(e,t){r=t}},e);this.model.set(this.getValue(),i);if(r)return r},getValue:function(e){if(e)return this.fields[e].getValue();var n={};return t.each(this.fields,function(e){n[e.key]=e.getValue()}),n},setValue:function(e,t){var n={};typeof e=="string"?n[e]=t:n=e;var r;for(r in this.schema)n[r]!==undefined&&this.fields[r].setValue(n[r])},getEditor:function(e){var t=this.fields[e];if(!t)throw"Field not found: "+e;return t.editor},focus:function(){if(this.hasFocus)return;var e=this.fieldsets[0],t=e.getFieldAt(0);if(!t)return;t.editor.focus()},blur:function(){if(!this.hasFocus)return;var e=t.find(this.fields,function(e){return e.editor.hasFocus});e&&e.editor.blur()},trigger:function(e){return e==="focus"?this.hasFocus=!0:e==="blur"&&(this.hasFocus=!1),n.View.prototype.trigger.apply(this,arguments)},remove:function(){t.each(this.fieldsets,function(e){e.remove()}),t.each(this.fields,function(e){e.remove()}),n.View.prototype.remove.call(this)}},{template:t.template("    <form data-fieldsets></form>  ",null,this.templateSettings),templateSettings:{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},editors:{}});return r.validators=function(){var e={};return e.errMessages={required:"Required",regexp:"Invalid",email:"Invalid email address",url:"Invalid URL",match:t.template('Must match field "<%= field %>"',null,r.templateSettings)},e.required=function(e){return e=t.extend({type:"required",message:this.errMessages.required},e),function(r){e.value=r;var i={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};if(r===null||r===undefined||r===!1||r==="")return i}},e.regexp=function(e){if(!e.regexp)throw new Error('Missing required "regexp" option for "regexp" validator');return e=t.extend({type:"regexp",message:this.errMessages.regexp},e),function(r){e.value=r;var i={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};if(r===null||r===undefined||r==="")return;if(!e.regexp.test(r))return i}},e.email=function(n){return n=t.extend({type:"email",message:this.errMessages.email,regexp:/^[\w\-]{1,}([\w\-\+.]{1,1}[\w\-]{1,}){0,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/},n),e.regexp(n)},e.url=function(n){return n=t.extend({type:"url",message:this.errMessages.url,regexp:/^(http|https):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i},n),e.regexp(n)},e.match=function(e){if(!e.field)throw new Error('Missing required "field" options for "match" validator');return e=t.extend({type:"match",message:this.errMessages.match},e),function(r,i){e.value=r;var s={type:e.type,message:t.isFunction(e.message)?e.message(e):e.message};if(r===null||r===undefined||r==="")return;if(r!==i[e.field])return s}},e}(),r.Fieldset=n.View.extend({initialize:function(e){e=e||{};var n=this.schema=this.createSchema(e.schema);this.fields=t.pick(e.fields,n.fields),this.template=e.template||this.constructor.template},createSchema:function(e){return t.isArray(e)&&(e={fields:e}),e.legend=e.legend||null,e},getFieldAt:function(e){var t=this.schema.fields[e];return this.fields[t]},templateData:function(){return this.schema},render:function(){var n=this.schema,r=this.fields,i=e(e.trim(this.template(t.result(this,"templateData"))));return i.find("[data-fields]").add(i).each(function(n,i){var s=e(i),o=s.attr("data-fields");if(t.isUndefined(o))return;t.each(r,function(e){s.append(e.render().el)})}),this.setElement(i),this},remove:function(){t.each(this.fields,function(e){e.remove()}),n.View.prototype.remove.call(this)}},{template:t.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  ",null,r.templateSettings)}),r.Field=n.View.extend({initialize:function(e){e=e||{},t.extend(this,t.pick(e,"form","key","model","value","idPrefix"));var n=this.schema=this.createSchema(e.schema);this.template=e.template||n.template||this.constructor.template,this.errorClassName=e.errorClassName||this.constructor.errorClassName,this.editor=this.createEditor()},createSchema:function(e){return t.isString(e)&&(e={type:e}),e=t.extend({type:"Text",title:this.createTitle()},e),e.type=t.isString(e.type)?r.editors[e.type]:e.type,e},createEditor:function(){var e=t.extend(t.pick(this,"schema","form","key","model","value"),{id:this.createEditorId()}),n=this.schema.type;return new n(e)},createEditorId:function(){var e=this.idPrefix,n=this.key;return n=n.replace(/\./g,"_"),t.isString(e)||t.isNumber(e)?e+n:t.isNull(e)?n:this.model?this.model.cid+"_"+n:n},createTitle:function(){var e=this.key;return e=e.replace(/([A-Z])/g," $1"),e=e.replace(/^./,function(e){return e.toUpperCase()}),e},templateData:function(){var e=this.schema;return{help:e.help||"",title:e.title,fieldAttrs:e.fieldAttrs,editorAttrs:e.editorAttrs,key:this.key,editorId:this.editor.id}},render:function(){var n=this.schema,r=this.editor,i=e(e.trim(this.template(t.result(this,"templateData"))));return n.fieldClass&&i.addClass(n.fieldClass),n.fieldAttrs&&i.attr(n.fieldAttrs),i.find("[data-editor]").add(i).each(function(n,i){var s=e(i),o=s.attr("data-editor");if(t.isUndefined(o))return;s.append(r.render().el)}),this.setElement(i),this},validate:function(){var e=this.editor.validate();return e?this.setError(e.message):this.clearError(),e},setError:function(e){if(this.editor.hasNestedForm)return;this.$el.addClass(this.errorClassName),this.$("[data-error]").html(e)},clearError:function(){this.$el.removeClass(this.errorClassName),this.$("[data-error]").empty()},commit:function(){return this.editor.commit()},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),n.View.prototype.remove.call(this)}},{template:t.template('    <div>      <label for="<%= editorId %>"><%= title %></label>      <div>        <span data-editor></span>        <div data-error></div>        <div><%= help %></div>      </div>    </div>  ',null,r.templateSettings),errorClassName:"error"}),r.NestedField=r.Field.extend({template:t.template(e.trim("    <div>      <span data-editor></span>      <% if (help) { %>        <div><%= help %></div>      <% } %>      <div data-error></div>    </div>  "),null,r.templateSettings)}),r.Editor=r.editors.Base=n.View.extend({defaultValue:null,hasFocus:!1,initialize:function(e){var e=e||{};if(e.model){if(!e.key)throw"Missing option: 'key'";this.model=e.model,this.value=this.model.get(e.key)}else e.value&&(this.value=e.value);this.value===undefined&&(this.value=this.defaultValue),t.extend(this,t.pick(e,"key","form"));var n=this.schema=e.schema||{};this.validators=e.validators||n.validators,this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),n.editorClass&&this.$el.addClass(n.editorClass),n.editorAttrs&&this.$el.attr(n.editorAttrs)},getName:function(){var e=this.key||"";return e.replace(/\./g,"_")},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){throw"Not implemented"},blur:function(){throw"Not implemented"},commit:function(e){var t=this.validate();if(t)return t;this.listenTo(this.model,"invalid",function(e,n){t=n}),this.model.set(this.key,this.getValue(),e);if(t)return t},validate:function(){var e=this.$el,n=null,r=this.getValue(),i=this.form?this.form.getValue():{},s=this.validators,o=this.getValidator;return s&&t.every(s,function(e){return n=o(e)(r,i),n?!1:!0}),n},trigger:function(e){return e==="focus"?this.hasFocus=!0:e==="blur"&&(this.hasFocus=!1),n.View.prototype.trigger.apply(this,arguments)},getValidator:function(e){var n=r.validators;if(t.isRegExp(e))return n.regexp({regexp:e});if(t.isString(e)){if(!n[e])throw new Error('Validator "'+e+'" not found');return n[e]()}if(t.isFunction(e))return e;if(t.isObject(e)&&e.type){var i=e;return n[i.type](i)}throw new Error("Invalid validator: "+e)}}),r.editors.Text=r.Editor.extend({tagName:"input",defaultValue:"",previousValue:"",events:{keyup:"determineChange",keypress:function(e){var t=this;setTimeout(function(){t.determineChange()},0)},select:function(e){this.trigger("select",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e);var t=this.schema,n="text";t&&t.editorAttrs&&t.editorAttrs.type&&(n=t.editorAttrs.type),t&&t.dataType&&(n=t.dataType),this.$el.attr("type",n)},render:function(){return this.setValue(this.value),this},determineChange:function(e){var t=this.$el.val(),n=t!==this.previousValue;n&&(this.previousValue=t,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e),this.previousValue=this.$el.val()},focus:function(){if(this.hasFocus)return;this.$el.focus()},blur:function(){if(!this.hasFocus)return;this.$el.blur()},select:function(){this.$el.select()}}),r.editors.TextArea=r.editors.Text.extend({tagName:"textarea"}),r.editors.Password=r.editors.Text.extend({initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","password")}}),r.editors.Number=r.editors.Text.extend({defaultValue:0,events:t.extend({},r.editors.Text.prototype.events,{keypress:"onKeyPress",input:"determineChange"}),initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","number"),this.$el.attr("step","any")},onKeyPress:function(e){var t=this,n=function(){setTimeout(function(){t.determineChange()},0)};if(e.charCode===0){n();return}var r=this.$el.val()+String.fromCharCode(e.charCode),i=/^-?[0-9]*\.?[0-9]*$/.test(r);i?n():e.preventDefault()},getValue:function(){var e=this.$el.val();return e===""?null:parseFloat(e,10)},setValue:function(e){e=function(){return t.isNumber(e)?e:t.isString(e)&&e!==""?parseFloat(e,10):null}(),t.isNaN(e)&&(e=null),r.editors.Text.prototype.setValue.call(this,e)}}),r.editors.Hidden=r.editors.Base.extend({defaultValue:"",initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","hidden")},focus:function(){},blur:function(){}}),r.editors.Checkbox=r.editors.Base.extend({defaultValue:!1,tagName:"input",events:{click:function(e){this.trigger("change",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e),this.$el.attr("type","checkbox")},render:function(){return this.setValue(this.value),this},getValue:function(){return this.$el.prop("checked")},setValue:function(e){e&&this.$el.prop("checked",!0)},focus:function(){if(this.hasFocus)return;this.$el.focus()},blur:function(){if(!this.hasFocus)return;this.$el.blur()}}),r.editors.Select=r.editors.Base.extend({tagName:"select",events:{change:function(e){this.trigger("change",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e);if(!this.schema||!this.schema.options)throw"Missing required 'schema.options'"},render:function(){return this.setOptions(this.schema.options),this},setOptions:function(e){var r=this;if(e instanceof n.Collection){var i=e;i.length>0?this.renderOptions(e):i.fetch({success:function(t){r.renderOptions(e)}})}else t.isFunction(e)?e(function(e){r.renderOptions(e)},r):this.renderOptions(e)},renderOptions:function(e){var t=this.$el,n;n=this._getOptionsHtml(e),t.html(n),this.setValue(this.value)},_getOptionsHtml:function(e){var r;if(t.isString(e))r=e;else if(t.isArray(e))r=this._arrayToHtml(e);else if(e instanceof n.Collection)r=this._collectionToHtml(e);else if(t.isFunction(e)){var i;e(function(e){i=e},this),r=this._getOptionsHtml(i)}return r},getValue:function(){return this.$el.val()},setValue:function(e){this.$el.val(e)},focus:function(){if(this.hasFocus)return;this.$el.focus()},blur:function(){if(!this.hasFocus)return;this.$el.blur()},_collectionToHtml:function(e){var t=[];e.each(function(e){t.push({val:e.id,label:e.toString()})});var n=this._arrayToHtml(t);return n},_arrayToHtml:function(e){var n=[];return t.each(e,function(e){if(t.isObject(e))if(e.group)n.push('<optgroup label="'+e.group+'">'),n.push(this._getOptionsHtml(e.options)),n.push("</optgroup>");else{var r=e.val||e.val===0?e.val:"";n.push('<option value="'+r+'">'+e.label+"</option>")}else n.push("<option>"+e+"</option>")},this),n.join("")}}),r.editors.Radio=r.editors.Select.extend({tagName:"ul",events:{"change input[type=radio]":function(){this.trigger("change",this)},"focus input[type=radio]":function(){if(this.hasFocus)return;this.trigger("focus",this)},"blur input[type=radio]":function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(e.$("input[type=radio]:focus")[0])return;e.trigger("blur",e)},0)}},getValue:function(){return this.$("input[type=radio]:checked").val()},setValue:function(e){this.$("input[type=radio]").val([e])},focus:function(){if(this.hasFocus)return;var e=this.$("input[type=radio]:checked");if(e[0]){e.focus();return}this.$("input[type=radio]").first().focus()},blur:function(){if(!this.hasFocus)return;this.$("input[type=radio]:focus").blur()},_arrayToHtml:function(e){var n=[],r=this;return t.each(e,function(e,i){var s="<li>";if(t.isObject(e)){var o=e.val||e.val===0?e.val:"";s+='<input type="radio" name="'+r.id+'" value="'+o+'" id="'+r.id+"-"+i+'" />',s+='<label for="'+r.id+"-"+i+'">'+e.label+"</label>"}else s+='<input type="radio" name="'+r.id+'" value="'+e+'" id="'+r.id+"-"+i+'" />',s+='<label for="'+r.id+"-"+i+'">'+e+"</label>";s+="</li>",n.push(s)}),n.join("")}}),r.editors.Checkboxes=r.editors.Select.extend({tagName:"ul",events:{"click input[type=checkbox]":function(){this.trigger("change",this)},"focus input[type=checkbox]":function(){if(this.hasFocus)return;this.trigger("focus",this)},"blur input[type=checkbox]":function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(e.$("input[type=checkbox]:focus")[0])return;e.trigger("blur",e)},0)}},getValue:function(){var t=[];return this.$("input[type=checkbox]:checked").each(function(){t.push(e(this).val())}),t},setValue:function(e){t.isArray(e)||(e=[e]),this.$("input[type=checkbox]").val(e)},focus:function(){if(this.hasFocus)return;this.$("input[type=checkbox]").first().focus()},blur:function(){if(!this.hasFocus)return;this.$("input[type=checkbox]:focus").blur()},_arrayToHtml:function(e){var n=[],r=this;return t.each(e,function(e,i){var s="<li>";if(t.isObject(e)){var o=e.val||e.val===0?e.val:"";s+='<input type="checkbox" name="'+r.id+'" value="'+o+'" id="'+r.id+"-"+i+'" />',s+='<label for="'+r.id+"-"+i+'">'+e.label+"</label>"}else s+='<input type="checkbox" name="'+r.id+'" value="'+e+'" id="'+r.id+"-"+i+'" />',s+='<label for="'+r.id+"-"+i+'">'+e+"</label>";s+="</li>",n.push(s)}),n.join("")}}),r.editors.Object=r.editors.Base.extend({hasNestedForm:!0,initialize:function(e){this.value={},r.editors.Base.prototype.initialize.call(this,e);if(!this.form)throw'Missing required option "form"';if(!this.schema.subSchema)throw new Error("Missing required 'schema.subSchema' option for Object editor")},render:function(){var e=this.form.constructor;return this.nestedForm=new e({schema:this.schema.subSchema,data:this.value,idPrefix:this.id+"_",Field:e.NestedField}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){return this.nestedForm?this.nestedForm.getValue():this.value},setValue:function(e){this.value=e,this.render()},focus:function(){if(this.hasFocus)return;this.nestedForm.focus()},blur:function(){if(!this.hasFocus)return;this.nestedForm.blur()},remove:function(){this.nestedForm.remove(),n.View.prototype.remove.call(this)},validate:function(){return this.nestedForm.validate()},_observeFormEvents:function(){if(!this.nestedForm)return;this.nestedForm.on("all",function(){var e=t.toArray(arguments);e[1]=this,this.trigger.apply(this,e)},this)}}),r.editors.NestedModel=r.editors.Object.extend({initialize:function(e){r.editors.Base.prototype.initialize.call(this,e);if(!this.form)throw'Missing required option "form"';if(!e.schema.model)throw'Missing required "schema.model" option for NestedModel editor'},render:function(){var e=this.form.constructor,t=this.value||{},n=this.key,r=this.schema.model,i=t.constructor===r?t:new r(t);return this.nestedForm=new e({model:i,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},commit:function(){var e=this.nestedForm.commit();return e?(this.$el.addClass("error"),e):r.editors.Object.prototype.commit.call(this)}}),r.editors.Date=r.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){if(this.hasFocus)return;this.trigger("focus",this)},"blur select":function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(e.$("select:focus")[0])return;e.trigger("blur",e)},0)}},initialize:function(e){e=e||{},r.editors.Base.prototype.initialize.call(this,e);var n=r.editors.Date,i=new Date;this.options=t.extend({monthNames:n.monthNames,showMonthNames:n.showMonthNames},e),this.schema=t.extend({yearStart:i.getFullYear()-100,yearEnd:i.getFullYear()},e.schema||{}),this.value&&!t.isDate(this.value)&&(this.value=new Date(this.value));if(!this.value){var s=new Date;s.setSeconds(0),s.setMilliseconds(0),this.value=s}this.template=e.template||this.constructor.template},render:function(){var n=this.options,r=this.schema,i=t.map(t.range(1,32),function(e){return'<option value="'+e+'">'+e+"</option>"}),s=t.map(t.range(0,12),function(e){var t=n.showMonthNames?n.monthNames[e]:e+1;return'<option value="'+e+'">'+t+"</option>"}),o=r.yearStart<r.yearEnd?t.range(r.yearStart,r.yearEnd+1):t.range(r.yearStart,r.yearEnd-1,-1),u=t.map(o,function(e){return'<option value="'+e+'">'+e+"</option>"}),a=e(e.trim(this.template({dates:i.join(""),months:s.join(""),years:u.join("")})));return this.$date=a.find('[data-type="date"]'),this.$month=a.find('[data-type="month"]'),this.$year=a.find('[data-type="year"]'),this.$hidden=e('<input type="hidden" name="'+this.key+'" />'),a.append(this.$hidden),this.setValue(this.value),this.setElement(a),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.$year.val(),t=this.$month.val(),n=this.$date.val();return!e||!t||!n?null:new Date(e,t,n)},setValue:function(e){this.$date.val(e.getDate()),this.$month.val(e.getMonth()),this.$year.val(e.getFullYear()),this.updateHidden()},focus:function(){if(this.hasFocus)return;this.$("select").first().focus()},blur:function(){if(!this.hasFocus)return;this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();t.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)}},{template:t.template('    <div>      <select data-type="date"><%= dates %></select>      <select data-type="month"><%= months %></select>      <select data-type="year"><%= years %></select>    </div>  ',null,r.templateSettings),showMonthNames:!0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"]}),r.editors.DateTime=r.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){if(this.hasFocus)return;this.trigger("focus",this)},"blur select":function(){if(!this.hasFocus)return;var e=this;setTimeout(function(){if(e.$("select:focus")[0])return;e.trigger("blur",e)},0)}},initialize:function(e){e=e||{},r.editors.Base.prototype.initialize.call(this,e),this.options=t.extend({DateEditor:r.editors.DateTime.DateEditor},e),this.schema=t.extend({minsInterval:15},e.schema||{}),this.dateEditor=new this.options.DateEditor(e),this.value=this.dateEditor.value,this.template=e.template||this.constructor.template},render:function(){function n(e){return e<10?"0"+e:e}var r=this.schema,i=t.map(t.range(0,24),function(e){return'<option value="'+e+'">'+n(e)+"</option>"}),s=t.map(t.range(0,60,r.minsInterval),function(e){return'<option value="'+e+'">'+n(e)+"</option>"}),o=e(e.trim(this.template({hours:i.join(),mins:s.join()})));return o.find("[data-date]").append(this.dateEditor.render().el),this.$hour=o.find('select[data-type="hour"]'),this.$min=o.find('select[data-type="min"]'),this.$hidden=o.find('input[type="hidden"]'),this.setValue(this.value),this.setElement(o),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.dateEditor.getValue(),t=this.$hour.val(),n=this.$min.val();return!e||!t||!n?null:(e.setHours(t),e.setMinutes(n),e)},setValue:function(e){t.isDate(e)||(e=new Date(e)),this.dateEditor.setValue(e),this.$hour.val(e.getHours()),this.$min.val(e.getMinutes()),this.updateHidden()},focus:function(){if(this.hasFocus)return;this.$("select").first().focus()},blur:function(){if(!this.hasFocus)return;this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();t.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)},remove:function(){this.dateEditor.remove(),r.editors.Base.prototype.remove.call(this)}},{template:t.template('    <div class="bbf-datetime">      <div class="bbf-date-container" data-date></div>      <select data-type="hour"><%= hours %></select>      :      <select data-type="min"><%= mins %></select>    </div>  ',null,r.templateSettings),DateEditor:r.editors.Date}),r.VERSION="0.12.0",n.Form=r,r}),function(){define("plugins/backbone-forms.bootstrap",["cdn.jquery","cdn.underscore","cdn.backbone","libs/backbone-forms"],function(e,t,n){var r;return r=n.Form,r.template=t.template('<form class="form" data-fieldsets></form>'),r.Fieldset.template=t.template('<fieldset class="bbf-fieldset" data-fields>\n  <% if (legend) { %>\n    <legend><%= legend %></legend>\n  <% } %>\n</fieldset>'),r.Field.template=t.template('<div class="control-group field-<%= key %> bbf-field">\n  <% if (this.options.schema.type === "Checkbox") { %>\n    <div class="bbf-editor hacked-for-checkbox" data-editor><label class="control-label" for="<%= editorId %>"><%= title %></label></div>\n    <div class="clearfix"></div>\n  <% } else { %>\n    <label class="control-label" for="<%= editorId %>"><%= title %></label>\n    <div class="bbf-editor" data-editor></div>\n  <% } %>\n  <div class="bbf-error-tooltip-container">\n    <div class="bff-error-tooltip versal-tooltip versal-tooltip-text versal-tooltip-left versal-tooltip-align-top">\n      <div class="versal-tooltip-arrow"></div>\n      <div class="bbf-error" data-error></div>\n    </div>\n  </div>\n</div>'),r.editors.Date.template=t.template('<div class="bbf-date">\n  <select data-type="date" class="bbf-date"><%= dates %></select>\n  <select data-type="month" class="bbf-month"><%= months %></select>\n  <select data-type="year" class="bbf-year"><%= years %></select>\n</div>'),r.editors.DateTime.template=t.template('<div class="bbf-datetime">\n  <div class="bbf-date-container" data-date></div>\n  <select data-type="hour" style="width: 4em"><%= hours %></select>\n  :\n  <select data-type="min" style="width: 4em"><%= mins %></select>\n</div>'),r.Field.errorClassName="bbf-error"})}.call(this);try{window.Modernizr=function(e,t,n){function r(e){v.cssText=e}function i(e,t){return r(prefixes.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}function a(){l.inputtypes=function(e){for(var r=0,i,s,o,u=e.length;r<u;r++)m.setAttribute("type",s=e[r]),i=m.type!=="text",i&&(m.value=g,m.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(s)&&m.style.WebkitAppearance!==n?(h.appendChild(m),o=t.defaultView,i=o.getComputedStyle&&o.getComputedStyle(m,null).WebkitAppearance!=="textfield"&&m.offsetHeight!==0,h.removeChild(m)):/^(search|tel)$/.test(s)||(/^(url|email)$/.test(s)?i=m.checkValidity&&m.checkValidity()===!1:i=m.value!=g)),w[e[r]]=!!i;return w}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var f="2.6.2",l={},c=!0,h=t.documentElement,p="modernizr",d=t.createElement(p),v=d.style,m=t.createElement("input"),g=":)",y={}.toString,b={},w={},E={},S=[],x=S.slice,T,N={}.hasOwnProperty,C;!s(N,"undefined")&&!s(N.call,"undefined")?C=function(e,t){return N.call(e,t)}:C=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=x.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(x.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(x.call(arguments)))};return r});for(var k in b)C(b,k)&&(T=k.toLowerCase(),l[T]=b[k](),S.push((l[T]?"":"no-")+T));return l.input||a(),l.addTest=function(e,t){if(typeof e=="object")for(var r in e)C(e,r)&&l.addTest(r,e[r]);else{e=e.toLowerCase();if(l[e]!==n)return l;t=typeof t=="function"?t():t,typeof c!="undefined"&&c&&(h.className+=" "+(t?"":"no-")+e),l[e]=t}return l},r(""),d=m=null,function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=g.elements;return typeof e=="string"?e.split(" "):e}function i(e){var t=v[e[p]];return t||(t={},d++,e[p]=d,v[d]=t),t}function s(e,n,r){n||(n=t);if(m)return n.createElement(e);r||(r=i(n));var s;return r.cache[e]?s=r.cache[e].cloneNode():c.test(e)?s=(r.cache[e]=r.createElem(e)).cloneNode():s=r.createElem(e),s.canHaveChildren&&!l.test(e)?r.frag.appendChild(s):s}function o(e,n){e||(e=t);if(m)return e.createDocumentFragment();n=n||i(e);var s=n.frag.cloneNode(),o=0,u=r(),a=u.length;for(;o<a;o++)s.createElement(u[o]);return s}function u(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return g.shivMethods?s(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(g,t.frag)}function a(e){e||(e=t);var r=i(e);return g.shivCSS&&!h&&!r.hasCSS&&(r.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),m||u(e,r),e}var f=e.html5||{},l=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,c=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,h,p="_html5shiv",d=0,v={},m;(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",h="hidden"in e,m=e.childNodes.length==1||function(){t.createElement("a");var e=t.createDocumentFragment();return typeof e.cloneNode=="undefined"||typeof e.createDocumentFragment=="undefined"||typeof e.createElement=="undefined"}()}catch(n){h=!0,m=!0}})();var g={elements:f.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:f.shivCSS!==!1,supportsUnknownElements:m,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:a,createElement:s,createDocumentFragment:o};e.html5=g,a(t)}(this,t),l._version=f,h.className=h.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(c?" js "+S.join(" "):""),l}(this,this.document),function(e,t,n){function r(e){return"[object Function]"==d.call(e)}function i(e){return"string"==typeof e}function s(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function u(){var e=v.shift();m=1,e?e.t?h(function(){("c"==e.t?k.injectCss:k.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),u()):m=0}function a(e,n,r,i,s,a,f){function l(t){if(!d&&o(c.readyState)&&(w.r=d=1,!m&&u(),c.onload=c.onreadystatechange=null,t)){"img"!=e&&h(function(){b.removeChild(c)},50);for(var r in T[n])T[n].hasOwnProperty(r)&&T[n][r].onload()}}var f=f||k.errorTimeout,c=t.createElement(e),d=0,g=0,w={t:r,s:n,e:s,a:a,x:f};1===T[n]&&(g=1,T[n]=[]),"object"==e?c.data=n:(c.src=n,c.type=e),c.width=c.height="0",c.onerror=c.onload=c.onreadystatechange=function(){l.call(this,g)},v.splice(i,0,w),"img"!=e&&(g||2===T[n]?(b.insertBefore(c,y?null:p),h(l,f)):T[n].push(c))}function f(e,t,n,r,s){return m=0,t=t||"j",i(e)?a("c"==t?E:w,e,t,this.i++,n,r,s):(v.splice(this.i++,0,e),1==v.length&&u()),this}function l(){var e=k;return e.loader={load:f,i:0},e}var c=t.documentElement,h=e.setTimeout,p=t.getElementsByTagName("script")[0],d={}.toString,v=[],m=0,g="MozAppearance"in c.style,y=g&&!!t.createRange().compareNode,b=y?c:p.parentNode,c=e.opera&&"[object Opera]"==d.call(e.opera),c=!!t.attachEvent&&!c,w=g?"object":c?"script":"img",E=c?"script":w,S=Array.isArray||function(e){return"[object Array]"==d.call(e)},x=[],T={},N={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}},C,k;k=function(e){function t(e){var e=e.split("!"),t=x.length,n=e.pop(),r=e.length,n={url:n,origUrl:n,prefixes:e},i,s,o;for(s=0;s<r;s++)o=e[s].split("="),(i=N[o.shift()])&&(n=i(n,o));for(s=0;s<t;s++)n=x[s](n);return n}function o(e,i,s,o,u){var a=t(e),f=a.autoCallback;a.url.split(".").pop().split("?").shift(),a.bypass||(i&&(i=r(i)?i:i[e]||i[o]||i[e.split("/").pop().split("?")[0]]),a.instead?a.instead(e,i,s,o,u):(T[a.url]?a.noexec=!0:T[a.url]=1,s.load(a.url,a.forceCSS||!a.forceJS&&"css"==a.url.split(".").pop().split("?").shift()?"c":n,a.noexec,a.attrs,a.timeout),(r(i)||r(f))&&s.load(function(){l(),i&&i(a.origUrl,u,o),f&&f(a.origUrl,u,o),T[a.url]=2})))}function u(e,t){function n(e,n){if(e){if(i(e))n||(f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}),o(e,f,t,0,u);else if(Object(e)===e)for(p in h=function(){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(),e)e.hasOwnProperty(p)&&(!n&&!--h&&(r(f)?f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}:f[p]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),c()}}(l[p])),o(e[p],f,t,p,u))}else!n&&c()}var u=!!e.test,a=e.load||e.both,f=e.callback||s,l=f,c=e.complete||s,h,p;n(u?e.yep:e.nope,!!a),a&&n(a)}var a,f,c=this.yepnope.loader;if(i(e))o(e,0,c,0);else if(S(e))for(a=0;a<e.length;a++)f=e[a],i(f)?o(f,0,c,0):S(f)?k(f):Object(f)===f&&u(f,c);else Object(e)===e&&u(e,c)},k.addPrefix=function(e,t){N[e]=t},k.addFilter=function(e){x.push(e)},k.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",C=function(){t.removeEventListener("DOMContentLoaded",C,0),t.readyState="complete"},0)),e.yepnope=l(),e.yepnope.executeStack=u,e.yepnope.injectJs=function(e,n,r,i,a,f){var l=t.createElement("script"),c,d,i=i||k.errorTimeout;l.src=e;for(d in r)l.setAttribute(d,r[d]);n=f?u:n||s,l.onreadystatechange=l.onload=function(){!c&&o(l.readyState)&&(c=1,n(),l.onload=l.onreadystatechange=null)},h(function(){c||(c=1,n(1))},i),a?l.onload():p.parentNode.insertBefore(l,p)},e.yepnope.injectCss=function(e,n,r,i,o,a){var i=t.createElement("link"),f,n=a?u:n||s;i.href=e,i.rel="stylesheet",i.type="text/css";for(f in r)i.setAttribute(f,r[f]);o||(p.parentNode.insertBefore(i,p),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("pointerevents",function(){var e=document.createElement("x"),t=document.documentElement,n=window.getComputedStyle,r;return"pointerEvents"in e.style?(e.style.pointerEvents="auto",e.style.pointerEvents="x",t.appendChild(e),r=n&&n(e,"").pointerEvents==="auto",t.removeChild(e),!!r):!1})}catch(e){}define("libs/modernizr",function(){}),function(e,t,n){function f(e,t,n){var r=[];for(var i=0;i<e.length;i++){var s=tinycolor(e[i]),u=s.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";u+=tinycolor.equals(t,e[i])?" sp-thumb-active":"";var a=o?"background-color:"+s.toRgbString():"filter:"+s.toFilter();r.push('<span title="'+s.toRgbString()+'" data-color="'+s.toRgbString()+'" class="'+u+'"><span class="sp-thumb-inner" style="'+a+';" /></span>')}return"<div class='sp-cf "+n+"'>"+r.join("")+"</div>"}function l(){for(var e=0;e<i.length;e++)i[e]&&i[e].hide()}function c(e,n){var i=t.extend({},r,e);return i.callbacks={move:m(i.move,n),change:m(i.change,n),show:m(i.show,n),hide:m(i.hide,n),beforeShow:m(i.beforeShow,n)},i}function h(r,h){function gt(){d.showPaletteOnly&&(d.showPalette=!0),J.toggleClass("sp-flat",m),J.toggleClass("sp-input-disabled",!d.showInput),J.toggleClass("sp-alpha-enabled",d.showAlpha),J.toggleClass("sp-buttons-disabled",!d.showButtons),J.toggleClass("sp-palette-disabled",!d.showPalette),J.toggleClass("sp-palette-only",d.showPaletteOnly),J.toggleClass("sp-initial-disabled",!d.showInitial),J.addClass(d.className),jt()}function yt(){function o(e){return e.data&&e.data.ignore?(Ot(t(this).data("color")),Dt()):(Ot(t(this).data("color")),Bt(!0),Dt(),Lt()),!1}s&&J.find("*:not(input)").attr("unselectable","on"),gt(),at&&X.after(ft).hide();if(m)X.after(J).hide();else{var n=d.appendTo==="parent"?X.parent():t(d.appendTo);n.length!==1&&(n=t("body")),n.append(J)}if(w&&e.localStorage){try{var r=e.localStorage[w].split(",#");r.length>1&&(delete e.localStorage[w],t.each(r,function(e,t){bt(t)}))}catch(i){}try{I=e.localStorage[w].split(";")}catch(i){}}lt.bind("click.spectrum touchstart.spectrum",function(e){V||Ct(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(X.is(":disabled")||d.disabled===!0)&&Rt(),J.click(v),nt.change(Nt),nt.bind("paste",function(){setTimeout(Nt,1)}),nt.keydown(function(e){e.keyCode==13&&Nt()}),st.text(d.cancelText),st.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),Lt("cancel")}),ot.text(d.chooseText),ot.bind("click.spectrum",function(e){e.stopPropagation(),e.preventDefault(),_t()&&(Bt(!0),Lt())}),g(et,function(e,t,n){B=e/O,n.shiftKey&&(B=Math.round(B*10)/10),Dt()}),g(G,function(e,t){D=parseFloat(t/L),Dt()},xt,Tt),g(K,function(e,t,n){if(!n.shiftKey)U=null;else if(!U){var r=P*N,i=C-H*C,s=Math.abs(e-r)>Math.abs(t-i);U=s?"x":"y"}var o=!U||U==="x",u=!U||U==="y";o&&(P=parseFloat(e/N)),u&&(H=parseFloat((C-t)/C)),Dt()},xt,Tt),ht?(Ot(ht),Pt(),vt=dt||tinycolor(ht).format,bt(ht)):Pt(),m&&kt();var u=s?"mousedown.spectrum":"click.spectrum touchstart.spectrum";rt.delegate(".sp-thumb-el",u,o),it.delegate(".sp-thumb-el:nth-child(1)",u,{ignore:!0},o)}function bt(n){if(b){var r=tinycolor(n).toRgbString();if(t.inArray(r,I)===-1){I.push(r);while(I.length>q)I.shift()}if(w&&e.localStorage)try{e.localStorage[w]=I.join(";")}catch(i){}}}function wt(){var e=[],t=I,n={},r;if(d.showPalette){for(var i=0;i<F.length;i++)for(var s=0;s<F[i].length;s++)r=tinycolor(F[i][s]).toRgbString(),n[r]=!0;for(i=0;i<t.length;i++)r=tinycolor(t[i]).toRgbString(),n.hasOwnProperty(r)||(e.push(t[i]),n[r]=!0)}return e.reverse().slice(0,d.maxSelectionSize)}function Et(){var e=Mt(),n=t.map(F,function(t,n){return f(t,e,"sp-palette-row sp-palette-row-"+n)});I&&n.push(f(wt(),e,"sp-palette-row sp-palette-row-selection")),rt.html(n.join(""))}function St(){if(d.showInitial){var e=pt,t=Mt();it.html(f([e,t],t,"sp-palette-row-initial"))}}function xt(){(C<=0||N<=0||L<=0)&&jt(),J.addClass(R),U=null}function Tt(){J.removeClass(R)}function Nt(){var e=tinycolor(nt.val());e.ok?Ot(e):nt.addClass("sp-validation-error")}function Ct(){T?Lt():kt()}function kt(){var n=t.Event("beforeShow.spectrum");if(T){jt();return}X.trigger(n,[Mt()]);if(S.beforeShow(Mt())===!1||n.isDefaultPrevented())return;l(),T=!0,t(z).bind("click.spectrum",Lt),t(e).bind("resize.spectrum",x),ft.addClass("sp-active"),J.removeClass("sp-hidden"),d.showPalette&&Et(),jt(),Pt(),pt=Mt(),St(),S.show(pt),X.trigger("show.spectrum",[pt])}function Lt(n){if(n&&n.type=="click"&&n.button==2)return;if(!T||m)return;T=!1,t(z).unbind("click.spectrum",Lt),t(e).unbind("resize.spectrum",x),ft.removeClass("sp-active"),J.addClass("sp-hidden");var r=!tinycolor.equals(Mt(),pt);r&&(mt&&n!=="cancel"?Bt(!0):At()),S.hide(Mt()),X.trigger("hide.spectrum",[Mt()])}function At(){Ot(pt,!0)}function Ot(e,t){if(tinycolor.equals(e,Mt()))return;var n=tinycolor(e),r=n.toHsv();D=r.h%360/360,P=r.s,H=r.v,B=r.a,Pt(),n.ok&&!t&&(vt=dt||n.format)}function Mt(e){return e=e||{},tinycolor.fromRatio({h:D,s:P,v:H,a:Math.round(B*100)/100},{format:e.format||vt})}function _t(){return!nt.hasClass("sp-validation-error")}function Dt(){Pt(),S.move(Mt()),X.trigger("move.spectrum",[Mt()])}function Pt(){nt.removeClass("sp-validation-error"),Ht();var e=tinycolor.fromRatio({h:D,s:1,v:1});K.css("background-color",e.toHexString());var t=vt;B<1&&(t==="hex"||t==="hex3"||t==="hex6"||t==="name")&&(t="rgb");var n=Mt({format:t}),r=n.toHexString(),i=n.toRgbString();o||n.alpha===1?ct.css("background-color",i):(ct.css("background-color","transparent"),ct.css("filter",n.toFilter()));if(d.showAlpha){var u=n.toRgb();u.a=0;var a=tinycolor(u).toRgbString(),f="linear-gradient(left, "+a+", "+r+")";s?Z.css("filter",tinycolor(a).toFilter({gradientType:1},r)):(Z.css("background","-webkit-"+f),Z.css("background","-moz-"+f),Z.css("background","-ms-"+f),Z.css("background",f))}d.showInput&&nt.val(n.toString(t)),d.showPalette&&Et(),St()}function Ht(){var e=P,t=H,n=e*N,r=C-t*C;n=Math.max(-k,Math.min(N-k,n-k)),r=Math.max(-k,Math.min(C-k,r-k)),Q.css({top:r,left:n});var i=B*O;tt.css({left:i-M/2});var s=D*L;Y.css({top:s-_})}function Bt(e){var t=Mt();ut&&X.val(t.toString(vt));var n=!tinycolor.equals(t,pt);pt=t,bt(t),e&&n&&(S.change(t),X.trigger("change",[t]))}function jt(){N=K.width(),C=K.height(),k=Q.height(),A=G.width(),L=G.height(),_=Y.height(),O=et.width(),M=tt.width(),m||(J.css("position","absolute"),J.offset(p(J,lt))),Ht()}function Ft(){X.show(),lt.unbind("click.spectrum touchstart.spectrum"),J.remove(),ft.remove(),i[Ut.id]=null}function It(e,r){if(e===n)return t.extend({},d);if(r===n)return d[e];d[e]=r,gt()}function qt(){V=!1,X.attr("disabled",!1),lt.removeClass("sp-disabled")}function Rt(){Lt(),V=!0,X.attr("disabled",!0),lt.addClass("sp-disabled")}var d=c(h,r),m=d.flat,b=d.showSelectionPalette,w=d.localStorageKey,E=d.theme,S=d.callbacks,x=y(jt,10),T=!1,N=0,C=0,k=0,L=0,A=0,O=0,M=0,_=0,D=0,P=0,H=0,B=1,j=d.palette.slice(0),F=t.isArray(j[0])?j:[j],I=d.selectionPalette.slice(0),q=d.maxSelectionSize,R="sp-dragging",U=null,z=r.ownerDocument,W=z.body,X=t(r),V=!1,J=t(a,z).addClass(E),K=J.find(".sp-color"),Q=J.find(".sp-dragger"),G=J.find(".sp-hue"),Y=J.find(".sp-slider"),Z=J.find(".sp-alpha-inner"),et=J.find(".sp-alpha"),tt=J.find(".sp-alpha-handle"),nt=J.find(".sp-input"),rt=J.find(".sp-palette"),it=J.find(".sp-initial"),st=J.find(".sp-cancel"),ot=J.find(".sp-choose"),ut=X.is("input"),at=ut&&!m,ft=at?t(u).addClass(E).addClass(d.className):t([]),lt=at?ft:X,ct=ft.find(".sp-preview-inner"),ht=d.color||ut&&X.val(),pt=!1,dt=d.preferredFormat,vt=dt,mt=!d.showButtons||d.clickoutFiresChange;yt();var Ut={show:kt,hide:Lt,toggle:Ct,reflow:jt,option:It,enable:qt,disable:Rt,set:function(e){Ot(e),Bt()},get:Mt,destroy:Ft,container:J};return Ut.id=i.push(Ut)-1,Ut}function p(e,n){var r=0,i=e.outerWidth(),s=e.outerHeight(),o=n.outerHeight(),u=e[0].ownerDocument,a=u.documentElement,f=a.clientWidth+t(u).scrollLeft(),l=a.clientHeight+t(u).scrollTop(),c=n.offset();return c.top+=o,c.left-=Math.min(c.left,c.left+i>f&&f>i?Math.abs(c.left+i-f):0),c.top-=Math.min(c.top,c.top+s>l&&l>s?Math.abs(s+o-r):r),c}function d(){}function v(e){e.stopPropagation()}function m(e,t){var n=Array.prototype.slice,r=n.call(arguments,2);return function(){return e.apply(t,r.concat(n.call(arguments)))}}function g(n,r,i,o){function d(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e.returnValue=!1}function v(e){if(a){if(s&&document.documentMode<9&&!e.button)return g();var t=e.originalEvent.touches,i=t?t[0].pageX:e.pageX,o=t?t[0].pageY:e.pageY,u=Math.max(0,Math.min(i-f.left,c)),p=Math.max(0,Math.min(o-f.top,l));h&&d(e),r.apply(n,[u,p,e])}}function m(e){var r=e.which?e.which==3:e.button==2,s=e.originalEvent.touches;!r&&!a&&i.apply(n,arguments)!==!1&&(a=!0,l=t(n).height(),c=t(n).width(),f=t(n).offset(),t(u).bind(p),t(u.body).addClass("sp-dragging"),h||v(e),d(e))}function g(){a&&(t(u).unbind(p),t(u.body).removeClass("sp-dragging"),o.apply(n,arguments)),a=!1}r=r||function(){},i=i||function(){},o=o||function(){};var u=n.ownerDocument||document,a=!1,f={},l=0,c=0,h="ontouchstart"in e,p={};p.selectstart=d,p.dragstart=d,p["touchmove mousemove"]=v,p["touchend mouseup"]=g,t(n).bind("touchstart mousedown",m)}function y(e,t,n){var r;return function(){var i=this,s=arguments,o=function(){r=null,e.apply(i,s)};n&&clearTimeout(r);if(n||!r)r=setTimeout(o,t)}}function b(){e.console&&(Function.prototype.bind?b=Function.prototype.bind.call(console.log,console):b=function(){Function.prototype.apply.call(console.log,console,arguments)},b.apply(this,arguments))}var r={beforeShow:d,move:d,change:d,show:d,hide:d,color:!1,flat:!1,showInput:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",preferredFormat:!1,className:"",showAlpha:!1,theme:"sp-light",palette:["fff","000"],selectionPalette:[],disabled:!1},i=[],s=!!/msie/i.exec(e.navigator.userAgent),o=function(){function e(e,t){return!!~(""+e).indexOf(t)}var t=document.createElement("div"),n=t.style;return n.cssText="background-color:rgba(0,0,0,.5)",e(n.backgroundColor,"rgba")||e(n.backgroundColor,"hsla")}(),u=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),a=function(){var e="";if(s)for(var t=1;t<=6;t++)e+="<div class='sp-"+t+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",e,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),w="spectrum.id";t.fn.spectrum=function(e,n){if(typeof e=="string"){var r=this,s=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=i[t(this).data(w)];if(n){var o=n[e];if(!o)throw new Error("Spectrum: no such method: '"+e+"'");e=="get"?r=n.get():e=="container"?r=n.container:e=="option"?r=n.option.apply(n,s):e=="destroy"?(n.destroy(),t(this).removeData(w)):o.apply(n,s)}}),r}return this.spectrum("destroy").each(function(){var n=h(this,e);t(this).data(w,n.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=g,t.fn.spectrum.defaults=r,t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){var e=t("<input type='color' value='!' />")[0],n=e.type==="color"&&e.value!="!";n||t("input[type=color]").spectrum({preferredFormat:"hex6"})},function(e){function f(e,t){e=e?e:"",t=t||{};if(typeof e=="object"&&e.hasOwnProperty("_tc_id"))return e;var n=l(e),i=n.r,o=n.g,u=n.b,a=n.a,c=s(100*a)/100,p=t.format||n.format;return i<1&&(i=s(i)),o<1&&(o=s(o)),u<1&&(u=s(u)),{ok:n.ok,format:p,_tc_id:r++,alpha:a,toHsv:function(){var e=d(i,o,u);return{h:e.h*360,s:e.s,v:e.v,a:a}},toHsvString:function(){var e=d(i,o,u),t=s(e.h*360),n=s(e.s*100),r=s(e.v*100);return a==1?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+c+")"},toHsl:function(){var e=h(i,o,u);return{h:e.h*360,s:e.s,l:e.l,a:a}},toHslString:function(){var e=h(i,o,u),t=s(e.h*360),n=s(e.s*100),r=s(e.l*100);return a==1?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+c+")"},toHex:function(e){return m(i,o,u,e)},toHexString:function(e){return"#"+m(i,o,u,e)},toRgb:function(){return{r:s(i),g:s(o),b:s(u),a:a}},toRgbString:function(){return a==1?"rgb("+s(i)+", "+s(o)+", "+s(u)+")":"rgba("+s(i)+", "+s(o)+", "+s(u)+", "+c+")"},toPercentageRgb:function(){return{r:s(w(i,255)*100)+"%",g:s(w(o,255)*100)+"%",b:s(w(u,255)*100)+"%",a:a}},toPercentageRgbString:function(){return a==1?"rgb("+s(w(i,255)*100)+"%, "+s(w(o,255)*100)+"%, "+s(w(u,255)*100)+"%)":"rgba("+s(w(i,255)*100)+"%, "+s(w(o,255)*100)+"%, "+s(w(u,255)*100)+"%, "+c+")"},toName:function(){return y[m(i,o,u,!0)]||!1},toFilter:function(e){var n=m(i,o,u),r=n,s=Math.round(parseFloat(a)*255).toString(16),l=s,c=t&&t.gradientType?"GradientType = 1, ":"";if(e){var h=f(e);r=h.toHex(),l=Math.round(parseFloat(h.alpha)*255).toString(16)}return"progid:DXImageTransform.Microsoft.gradient("+c+"startColorstr=#"+N(s)+n+",endColorstr=#"+N(l)+r+")"},toString:function(e){e=e||this.format;var t=!1;e==="rgb"&&(t=this.toRgbString()),e==="prgb"&&(t=this.toPercentageRgbString());if(e==="hex"||e==="hex6")t=this.toHexString();return e==="hex3"&&(t=this.toHexString(!0)),e==="name"&&(t=this.toName()),e==="hsl"&&(t=this.toHslString()),e==="hsv"&&(t=this.toHsvString()),t||this.toHexString()}}}function l(e){var t={r:0,g:0,b:0},n=1,r=!1,i=!1;typeof e=="string"&&(e=L(e)),typeof e=="object"&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(t=c(e.r,e.g,e.b),r=!0,i=String(e.r).substr(-1)==="%"?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=C(e.s),e.v=C(e.v),t=v(e.h,e.s,e.v),r=!0,i="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=C(e.s),e.l=C(e.l),t=p(e.h,e.s,e.l),r=!0,i="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=parseFloat(n);if(isNaN(n)||n<0||n>1)n=1;return{ok:r,format:e.format||i,r:o(255,u(t.r,0)),g:o(255,u(t.g,0)),b:o(255,u(t.b,0)),a:n}}function c(e,t,n){return{r:w(e,255)*255,g:w(t,255)*255,b:w(n,255)*255}}function h(e,t,n){e=w(e,255),t=w(t,255),n=w(n,255);var r=u(e,t,n),i=o(e,t,n),s,a,f=(r+i)/2;if(r==i)s=a=0;else{var l=r-i;a=f>.5?l/(2-r-i):l/(r+i);switch(r){case e:s=(t-n)/l+(t<n?6:0);break;case t:s=(n-e)/l+2;break;case n:s=(e-t)/l+4}s/=6}return{h:s,s:a,l:f}}function p(e,t,n){function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var r,i,s;e=w(e,360),t=w(t,100),n=w(n,100);if(t===0)r=i=s=n;else{var u=n<.5?n*(1+t):n+t-n*t,a=2*n-u;r=o(a,u,e+1/3),i=o(a,u,e),s=o(a,u,e-1/3)}return{r:r*255,g:i*255,b:s*255}}function d(e,t,n){e=w(e,255),t=w(t,255),n=w(n,255);var r=u(e,t,n),i=o(e,t,n),s,a,f=r,l=r-i;a=r===0?0:l/r;if(r==i)s=0;else{switch(r){case e:s=(t-n)/l+(t<n?6:0);break;case t:s=(n-e)/l+2;break;case n:s=(e-t)/l+4}s/=6}return{h:s,s:a,v:f}}function v(e,t,n){e=w(e,360)*6,t=w(t,100),n=w(n,100);var r=i.floor(e),s=e-r,o=n*(1-t),u=n*(1-s*t),a=n*(1-(1-s)*t),f=r%6,l=[n,u,o,o,a,n][f],c=[a,n,n,u,o,o][f],h=[o,o,a,n,n,u][f];return{r:l*255,g:c*255,b:h*255}}function m(e,t,n,r){var i=[N(s(e).toString(16)),N(s(t).toString(16)),N(s(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function b(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function w(e,t){x(e)&&(e="100%");var n=T(e);return e=o(t,u(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),i.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function E(e){return o(1,u(0,e))}function S(e){return parseInt(e,16)}function x(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function T(e){return typeof e=="string"&&e.indexOf("%")!=-1}function N(e){return e.length==1?"0"+e:""+e}function C(e){return e<=1&&(e=e*100+"%"),e}function L(e){e=e.replace(t,"").replace(n,"").toLowerCase();var r=!1;if(g[e])e=g[e],r=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0};var i;return(i=k.rgb.exec(e))?{r:i[1],g:i[2],b:i[3]}:(i=k.rgba.exec(e))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=k.hsl.exec(e))?{h:i[1],s:i[2],l:i[3]}:(i=k.hsla.exec(e))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=k.hsv.exec(e))?{h:i[1],s:i[2],v:i[3]}:(i=k.hex6.exec(e))?{r:S(i[1]),g:S(i[2]),b:S(i[3]),format:r?"name":"hex"}:(i=k.hex3.exec(e))?{r:S(i[1]+""+i[1]),g:S(i[2]+""+i[2]),b:S(i[3]+""+i[3]),format:r?"name":"hex"}:!1}var t=/^[\s,#]+/,n=/\s+$/,r=0,i=Math,s=i.round,o=i.min,u=i.max,a=i.random;f.fromRatio=function(e,t){if(typeof e=="object"){var n={};for(var r in e)e.hasOwnProperty(r)&&(r==="a"?n[r]=e[r]:n[r]=C(e[r]));e=n}return f(e,t)},f.equals=function(e,t){return!e||!t?!1:f(e).toRgbString()==f(t).toRgbString()},f.random=function(){return f.fromRatio({r:a(),g:a(),b:a()})},f.desaturate=function(e,t){var n=f(e).toHsl();return n.s-=(t||10)/100,n.s=E(n.s),f(n)},f.saturate=function(e,t){var n=f(e).toHsl();return n.s+=(t||10)/100,n.s=E(n.s),f(n)},f.greyscale=function(e){return f.desaturate(e,100)},f.lighten=function(e,t){var n=f(e).toHsl();return n.l+=(t||10)/100,n.l=E(n.l),f(n)},f.darken=function(e,t){var n=f(e).toHsl();return n.l-=(t||10)/100,n.l=E(n.l),f(n)},f.complement=function(e){var t=f(e).toHsl();return t.h=(t.h+180)%360,f(t)},f.triad=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+120)%360,s:t.s,l:t.l}),f({h:(n+240)%360,s:t.s,l:t.l})]},f.tetrad=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+90)%360,s:t.s,l:t.l}),f({h:(n+180)%360,s:t.s,l:t.l}),f({h:(n+270)%360,s:t.s,l:t.l})]},f.splitcomplement=function(e){var t=f(e).toHsl(),n=t.h;return[f(e),f({h:(n+72)%360,s:t.s,l:t.l}),f({h:(n+216)%360,s:t.s,l:t.l})]},f.analogous=function(e,t,n){t=t||6,n=n||30;var r=f(e).toHsl(),i=360/n,s=[f(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,s.push(f(r));return s},f.monochromatic=function(e,t){t=t||6;var n=f(e).toHsv(),r=n.h,i=n.s,s=n.v,o=[],u=1/t;while(t--)o.push(f({h:r,s:i,v:s})),s=(s+u)%1;return o},f.readability=function(e,t){var n=f(e).toRgb(),r=f(t).toRgb(),i=(n.r*299+n.g*587+n.b*114)/1e3,s=(r.r*299+r.g*587+r.b*114)/1e3,o=Math.max(n.r,r.r)-Math.min(n.r,r.r)+Math.max(n.g,r.g)-Math.min(n.g,r.g)+Math.max(n.b,r.b)-Math.min(n.b,r.b);return{brightness:Math.abs(i-s),color:o}},f.readable=function(e,t){var n=f.readability(e,t);return n.brightness>125&&n.color>500},f.mostReadable=function(e,t){var n=null,r=0,i=!1;for(var s=0;s<t.length;s++){var o=f.readability(e,t[s]),u=o.brightness>125&&o.color>500,a=3*(o.brightness/125)+o.color/500;if(u&&!i||u&&i&&a>r||!u&&!i&&a>r)i=u,r=a,n=f(t[s])}return n};var g=f.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},y=f.hexNames=b(g),k=function(){var e="[-\\+]?\\d+%?",t="[-\\+]?\\d*\\.\\d+%?",n="(?:"+t+")|(?:"+e+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",i="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+r),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();e.tinycolor=f}(this),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})}(window,jQuery),define("libs/spectrum",function(){}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/backbone-forms/color",["libs/backbone-forms","libs/modernizr","libs/spectrum"],function(e){var n;return e.editors.Color=function(e){function r(){return n=r.__super__.constructor.apply(this,arguments),n}return t(r,e),r.prototype.events={"change  input[type=color]":"onColorChange","change  input[type=text]":"onTextChange","keyup   input[type=text]":"onTextChange","keydown input[type=text]":"onTextChange",focus:"onFocus",blur:"onBlur"},r.prototype.onColorChange=function(){return this.setPickerColor(this.$colorInput().val())},r.prototype.onTextChange=function(){return this.color=this.$textInput().val(),this.$colorInput().val(this.color),this.trigger("change",this)},r.prototype.onFocus=function(){return this.trigger("focus",this)},r.prototype.onBlur=function(){return this.trigger("blur",this)},r.prototype.render=function(){var e=this;return this.$el.html(this.$colorInput()),Modernizr.inputtypes.color||this.$colorInput().spectrum({color:this.value,move:function(t){return e.setPickerColor("#"+t.toHex())}}),this.$el.append(this.$textInput()),this.setValue(this.value),this},r.prototype.setPickerColor=function(e){return this.color=e,this.$textInput().val(this.color),this.trigger("change",this)},r.prototype.$colorInput=function(){return this._colorInput!=null?this._colorInput:this._colorInput=$('<input class="input-color-color" type="color"></input>')},r.prototype.$textInput=function(){return this._textInput!=null?this._textInput:this._textInput=$('<input class="input-color-text" type="text"></input>')},r.prototype.getValue=function(){return this.color},r.prototype.setValue=function(e){return this.color=e,this.$colorInput().val(this.color),this.$textInput().val(this.color)},r.prototype.focus=function(){if(!this.hasFocus)return this.$colorInput().focus()},r.prototype.blur=function(){if(this.hasFocus)return this.$colorInput().blur()},r}(e.editors.Base)})}.call(this),function(){define("libs/clayer",[],function(){var e={};return window.clayer=e,e.texts={drag:"drag"},e.makeCall=function(e,t,n){if(e[t])return e[t].apply(e,n)},e.setCss3=function(e,t,n,r){r=r||!1;var i=["","-ms-","-moz-","-webkit-","-o-"];for(var s=0;s<i.length;s++){var o=i[s]+t,u=(r?i[s]:"")+n;e.css(o,u)}},e.isTouch="ontouchstart"in document.documentElement,e.initBody=function(){e.isTouch?$("body").addClass("clayer-body-touch"):$("body").addClass("clayer-body-mouse")},e.Touchable=function(){return this.init.apply(this,arguments)},e.Touchable.prototype={init:function(e,t){this.$element=e,this.$document=$(e[0].ownerDocument),this.callbacks=t,this.mouseDown=$.proxy(this.mouseDown,this),this.mouseMove=$.proxy(this.mouseMove,this),this.mouseUp=$.proxy(this.mouseUp,this),this.touchStart=$.proxy(this.touchStart,this),this.touchMove=$.proxy(this.touchMove,this),this.touchEnd=$.proxy(this.touchEnd,this),this.hoverMove=$.proxy(this.hoverMove,this),this.hoverLeave=$.proxy(this.hoverLeave,this),this.documentEvents={mousemove:this.mouseMove,mouseup:this.mouseUp,touchmove:this.touchMove,touchend:this.touchEnd,touchcancel:this.touchEnd},this.setTouchable(!1),this.setHoverable(!1)},remove:function(){this.setTouchable(!1),this.setHoverable(!1)},setTouchable:function(e){if(this.isTouchable===e)return;this.isTouchable=e,this.touchEvent=null,e?this.$element.on({mousedown:this.mouseDown,touchstart:this.touchStart}):(this.$element.off("mousedown touchstart"),this.$document.off(this.documentEvents))},setHoverable:function(e){if(this.isHoverable===e)return;this.isHoverable=e,this.hoverEvent=null,e?this.$element.on({mousemove:this.hoverMove,mouseleave:this.hoverLeave}):this.$element.off({mousemove:this.hoverMove,mouseleave:this.hoverLeave})},mouseDown:function(t){return this.isTouchable&&(this.$document.on({mousemove:this.mouseMove,mouseup:this.mouseUp}),this.touchEvent=new e.PositionEvent(this.$element,t,t.timeStamp,!0),e.makeCall(this.callbacks,"touchDown",[this.touchEvent])),!1},mouseMove:function(t){return this.isTouchable&&this.touchEvent&&(this.touchEvent.move(t,t.timeStamp),e.makeCall(this.callbacks,"touchMove",[this.touchEvent])),!1},mouseUp:function(t){return this.isTouchable&&this.touchEvent&&(this.touchEvent.up(t,t.timeStamp),e.makeCall(this.callbacks,"touchUp",[this.touchEvent]),this.touchEvent=null),this.$document.off(this.documentEvents),!1},touchStart:function(t){return this.$element.off({mousedown:this.mouseDown,mousemove:this.hoverMove,mouseleave:this.hoverLeave}),!this.isTouchable||this.touchEvent||t.originalEvent.targetTouches.length>1?this.touchEnd(t):(this.$document.on({touchmove:this.touchMove,touchend:this.touchEnd,touchcancel:this.touchEnd}),this.touchEvent=new e.PositionEvent(this.$element,t.originalEvent.targetTouches[0],t.timeStamp,!1),e.makeCall(this.callbacks,"touchDown",[this.touchEvent])),!1},touchMove:function(t){if(this.isTouchable&&this.touchEvent){var n=this.findTouchEvent(t.originalEvent.touches);n===null?this.touchEnd(t):(this.touchEvent.move(n,t.timeStamp),e.makeCall(this.callbacks,"touchMove",[this.touchEvent]))}return!1},touchEnd:function(t){return this.isTouchable&&this.touchEvent&&(this.touchEvent.up(this.findTouchEvent(t.originalEvent.touches),t.timeStamp),e.makeCall(this.callbacks,"touchUp",[this.touchEvent]),this.touchEvent=null),this.$document.off(this.documentEvents),!1},hoverMove:function(t){return this.touchEvent?this.mouseMove(t):this.isHoverable&&(this.hoverEvent?this.hoverEvent.move(t,t.timeStamp):this.hoverEvent=new e.PositionEvent(this.$element,t,!0),e.makeCall(this.callbacks,"hoverMove",[this.hoverEvent])),!1},hoverLeave:function(t){return this.isHoverable&&this.hoverEvent&&(this.hoverEvent.move(t),e.makeCall(this.callbacks,"hoverLeave",[this.hoverEvent]),this.hoverEvent=null),!1},findTouchEvent:function(e){for(var t=0;t<e.length;t++)if(e[t].identifier===this.touchEvent.event.identifier)return e[t];return null}},e.PositionEvent=function(){return this.init.apply(this,arguments)},e.PositionEvent.prototype={init:function(e,t,n,r){this.$element=e,this.globalPoint={x:t.pageX,y:t.pageY},this.translation={x:0,y:0},this.deltaTranslation={x:0,y:0},this.localPoint={x:0,y:0},this.updateLocalPoint(),this.event=t,this.startTimestamp=this.timestamp=n,this.hasMoved=!1,this.wasTap=!1,this.mouse=r},getTimeSinceGoingDown:function(){return this.timestamp-this.startTimestamp},resetDeltaTranslation:function(){this.deltaTranslation.x=0,this.deltaTranslation.y=0},inElement:function(){return this.localPoint.x>=0&&this.localPoint.x<=this.$element.outerWidth()&&this.localPoint.y>=0&&this.localPoint.y<=this.$element.outerHeight()},move:function(e,t){this.event=e,this.timestamp=t,this.updatePositions()},up:function(e,t){this.event=e||this.event,this.timestamp=t,this.wasTap=!this.hasMoved&&this.getTimeSinceGoingDown()<300},updatePositions:function(){var e=this.event.pageX-this.globalPoint.x,t=this.event.pageY-this.globalPoint.y;this.translation.x+=e,this.translation.y+=t,this.deltaTranslation.x+=e,this.deltaTranslation.y+=t,this.globalPoint.x=this.event.pageX,this.globalPoint.y=this.event.pageY,this.updateLocalPoint(),this.translation.x*this.translation.x+this.translation.y*this.translation.y>200&&(this.hasMoved=!0)},updateLocalPoint:function(){var e=this.$element.offset();this.localPoint.x=this.globalPoint.x-e.left,this.localPoint.y=this.globalPoint.y-e.top}},e.Scrubbable=function(){return this.init.apply(this,arguments)},e.Scrubbable.prototype={init:function(t,n,r){this.$element=t,this.callbacks=n,this.options=r||{},this.touchable=new e.Touchable(t,this),this.setScrubbable(!0)},remove:function(){this.touchable.remove()},setScrubbable:function(e){this.touchable.setTouchable(e),this.options.disableHover?this.touchable.setHoverable(!1):this.touchable.setHoverable(e)},hoverMove:function(t){e.makeCall(this.callbacks,"scrubMove",[t.localPoint.x,t.localPoint.y,!1])},hoverLeave:function(t){e.makeCall(this.callbacks,"scrubLeave",[])},touchDown:function(e){this.touchMove(e)},touchMove:function(t){e.makeCall(this.callbacks,"scrubMove",[t.localPoint.x,t.localPoint.y,!0])},touchUp:function(t){!t.mouse||!t.inElement()?e.makeCall(this.callbacks,"scrubLeave",[]):this.hoverMove(t),t.wasTap&&e.makeCall(this.callbacks,"scrubTap",[t.localPoint.x,t.localPoint.y])}},e.Slider=function(){return this.init.apply(this,arguments)},e.Slider.prototype={init:function(t,n,r,i){this.$element=t,this.$element.addClass("clayer-slider"),this.callbacks=n,this.valueWidth=r||1,this.markerValue=0,this.knobValue=0,this.$container=$('<div class="clayer-slider-container"></div>'),this.$element.append(this.$container),this.$bar=$('<div class="clayer-slider-bar"></div>'),this.$container.append(this.$bar),this.$segmentContainer=$('<div class="clayer-slider-segment-container"></div>'),this.$bar.append(this.$segmentContainer),this.$marker=$('<div class="clayer-slider-marker"></div>'),this.markerWidth=Math.min(this.valueWidth,10),this.$marker.width(this.markerWidth),this.$bar.append(this.$marker),this.$knob=$('<div class="clayer-slider-knob"></div>'),this.$container.append(this.$knob),this.scrubbable=new e.Scrubbable(this.$element,this,i),this.bounceTimer=null,this.renderKnob(),this.renderMarker()},remove:function(){this.scrubbable.remove(),this.$segmentContainer.remove(),this.$marker.remove(),this.$knob.remove(),this.$bar.remove(),this.$container.remove()},setSegments:function(e){this.$segmentContainer.html("");for(var t=0;t<e.length;t++){var n=e[t],r=$('<div class="clayer-slider-segment"></div>');this.$segmentContainer.append(r),r.css("left",n.start*this.valueWidth),r.width((n.end-n.start+1)*this.valueWidth),r.css("background-color",n.color)}},setValue:function(e){this.markerValue=this.knobValue=e,this.renderKnob(),this.renderMarker()},setKnobValue:function(e){this.knobValue=e,this.renderKnob()},changed:function(t){e.makeCall(this.callbacks,"sliderChanged",[this.knobValue,t])},updateKnob:function(e){e=Math.max(0,Math.min(this.$element.width()-1,e)),this.updateKnobValue(Math.floor(e/this.valueWidth))},updateKnobValue:function(e){this.knobValue!==e&&(this.knobValue=e,this.renderKnob(),this.changed(!1))},updateMarker:function(e){e=Math.max(0,Math.min(this.$element.width()-1,e));var t=Math.floor(e/this.valueWidth);this.markerValue!==t&&(this.knobValue=this.markerValue=t,this.renderKnob(),this.renderMarker(),this.changed(!0))},renderKnob:function(){this.$knob.css("left",(this.knobValue+.5)*this.valueWidth)},renderMarker:function(){this.$marker.css("left",(this.markerValue+.5)*this.valueWidth-this.markerWidth/2)},scrubMove:function(e,t,n){this.$knob.addClass("clayer-active"),n?(this.$knob.addClass("clayer-pressed"),this.updateMarker(e)):(this.$knob.removeClass("clayer-pressed"),this.updateKnob(e))},scrubLeave:function(){this.$knob.removeClass("clayer-active clayer-pressed"),this.updateKnobValue(this.markerValue),e.makeCall(this.callbacks,"sliderLeave")},scrubTap:function(){this.$knob.removeClass("clayer-slider-knob-jump"),setTimeout($.proxy(this.startJump,this),0)},startJump:function(){this.$knob.addClass("clayer-slider-knob-jump")}},e.Draggable=function(){return this.init.apply(this,arguments)},e.Draggable.prototype={init:function(t,n,r){this.$element=t,this.callbacks=n,this.$parent=r,this.touchable=new e.Touchable(t,this),this.setDraggable(!0)},remove:function(){this.touchable.remove()},setDraggable:function(e){this.touchable.setTouchable(e),this.touchable.setHoverable(!1)},touchDown:function(t){this.offsetX=t.localPoint.x+parseInt(this.$element.css("margin-left"),10),this.offsetY=t.localPoint.y+parseInt(this.$element.css("margin-top"),10),e.makeCall(this.callbacks,"dragStart",[this.offsetX,this.offsetY])},touchMove:function(t){var n=t.globalPoint.x-this.offsetX,r=t.globalPoint.y-this.offsetY;if(this.$parent!==undefined){var i=this.$parent.offset();n=Math.max(0,Math.min(this.$parent.outerWidth(),n-i.left)),r=Math.max(0,Math.min(this.$parent.outerHeight(),r-i.top)),this.$element.css("left",n),this.$element.css("top",r),e.makeCall(this.callbacks,"dragMove",[n,r,t.globalPoint.x,t.globalPoint.y])}else e.makeCall(this.callbacks,"dragMove",[n,r,t.globalPoint.x,t.globalPoint.y])},touchUp:function(t){e.makeCall(this.callbacks,"dragEnd"),t.wasTap&&e.makeCall(this.callbacks,"dragTap",[t.localPoint.x,t.localPoint.y])}},e.DragKnob=function(){return this.init.apply(this,arguments)},e.DragKnob.prototype={init:function(t,n,r){this.$element=t,this.$element.addClass("clayer-dragknob"),this.$element.append('<div class="clayer-dragknob-label">'+e.texts.drag+"</div>"),this.$parent=r,this.$parent!==undefined&&this.$parent.addClass("clayer-dragknob-parent"),this.callbacks=n,this.draggable=new e.Draggable(t,this,r)},remove:function(){this.draggable.remove(),this.$element.removeClass("clayer-dragknob"),this.$parent!==undefined&&this.$parent.addClass("clayer-dragknob-parent")},dragStart:function(){this.$element.addClass("clayer-pressed"),this.$element.removeClass("clayer-dragknob-show-label"),e.makeCall(this.callbacks,"dragStart")},dragMove:function(t,n){e.makeCall(this.callbacks,"dragMove",arguments)},dragEnd:function(){this.$element.removeClass("clayer-pressed"),e.makeCall(this.callbacks,"dragEnd")},dragTap:function(){this.$element.addClass("clayer-dragknob-show-label"),e.makeCall(this.callbacks,"dragTap")}},e})}(),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/backbone-forms/range",["cdn.jquery","libs/backbone-forms","libs/clayer"],function(e,n,r){var i;return n.editors.Range=function(n){function s(){return i=s.__super__.constructor.apply(this,arguments),i}return t(s,n),s.prototype.width=210,s.prototype.initialize=function(e){return s.__super__.initialize.call(this,e),this.min=this.schema.min||0,this.max=this.schema.max||100,this.step=this.schema.step||1},s.prototype.render=function(){var t;return this.$el.width(this.width),t=(this.max-this.min)/this.step+1,this.slider=new r.Slider(this.$el,this,this.width/t,{disableHover:!0}),this.$knob=e('<div class="clayer-slider-knob-value"></div>'),this.$(".clayer-slider-knob").append(this.$knob),this.setValue(this.value||0),this},s.prototype.sliderChanged=function(e){var t,n;return t=this._decimalPlaces(),n=Number((e*this.step+this.min).toFixed(t)),this.sliderValue=this._clamp(n),this.updateKnob(),this.trigger("change",this)},s.prototype._decimalPlaces=function(){var e;return e=(""+this.step).split(".")[1]||"",e.length},s.prototype._clamp=function(e){return Math.min(this.max,Math.max(this.min,e))},s.prototype.getValue=function(){return this.sliderValue},s.prototype.setValue=function(e){return this.sliderValue=e,this.slider.setValue((e-this.min)/this.step),this.updateKnob()},s.prototype.updateKnob=function(){return this.$knob.text(this.sliderValue)},s.prototype.focus=function(){this.hasFocus},s.prototype.blur=function(){!this.hasFocus},s}(n.editors.Base)})}.call(this),function(e){e.autocomplete=function(t,n,r){var i={url:!1,apply:function(e){o.val(e)}},s=this;s.settings={};var o=e(t),t=t;s.init=function(){s.settings=e.extend({},i,r),s.input=o,s.ignore=[],s.data={},s.open=!1,s.load(),s.blocker=e('<div class="autocomplete-blocker"></div>').css({position:"fixed",top:0,left:0,right:0,bottom:0,"z-index":1999}).hide(),s.box=e('<div class="autocomplete"></div>').css("z-index",2e3),s.tooltip=e('<div class="versal-tooltip versal-tooltip-white versal-tooltip-top versal-tooltip-align-left versal-tooltip-offset"><div class="versal-tooltip-arrow"></div></div>'),s.box.append(s.tooltip),s.ul=e("<ul></ul>"),s.tooltip.hide(),s.blocker.click(function(e){s.kill(),s.input.focus(),e.stopPropagation()}),o.keyup(function(t){s.pos=s.selection();switch(t.keyCode){case 13:s.apply();case 27:s.kill();case 38:case 40:return!1;case 39:var n=s.value();n.length>0&&s.pos==s.input.val().length&&s.apply();break;case 188:s.apply();default:s.complete(e(this).val())}}),o.keydown(function(e){s.pos=s.selection();switch(e.keyCode){case 9:return s.value().length>0?(s.apply(),!1):!0;case 38:return s.prev(),!1;case 40:return s.next(),!1}}),s.box.click(function(e){e.stopPropagation()}),e("body").append(s.box),e("body").append(s.blocker),e(window).resize(s.position),s.position()},s.load=function(){typeof n=="object"?s.data=n:e.getJSON(n,function(e){s.data=e})},s.complete=function(t){s.kill(),s.position();var n=0,t=e.trim(t);if(t.length==0)return!1;var r=new RegExp("^"+t,"i"),i=s.data.filter(function(e){if(s.ignore.indexOf(e)==-1&&e.match(r))return e});i=i.slice(0,5),e.each(i,function(r,i){var o='<span class="autocomplete-highlight">'+i.substring(0,t.length)+"</span>"+i.substring(t.length),u=e("<li>"+o+"</li>");u.click(function(){s.apply(i)}),u.mouseover(function(){s.ul.find(".selected").removeClass("selected"),u.addClass("over")}),u.mouseout(function(){u.removeClass("over")}),s.ul.append(u),n==0&&u.addClass("first selected"),n++}),n>0&&(s.tooltip.append(s.ul),s.tooltip.show(),s.blocker.show(),s.open=!0)},s.kill=function(){s.blocker.hide(),s.ul.empty(),s.tooltip.hide(),s.open=!1},s.apply=function(e){if(!e)var e=s.value();s.settings.apply.call(s,e)},s.value=function(){return s.selected().text()},s.selected=function(){return s.ul.find(".selected")},s.select=function(e){s.deselect(),e.addClass("selected")},s.deselect=function(){s.selected().removeClass("selected")},s.prev=function(){var e=s.selected(),t=e.prev();t.length>0&&s.select(t)},s.next=function(){var e=s.selected(),t=e.length>0?e.next():s.ul.find("li:first-child");t.length>0&&s.select(t)},s.selection=function(){var e=s.input[0],t=s.val;if(!e.createTextRange)return e.selectionStart;var n=document.selection.createRange().duplicate();return n.moveEnd("character",t.length),n.text==""?t.length:t.lastIndexOf(n.text)},s.position=function(){var e=o.offset(),t=o.innerHeight();e.top=e.top+t,s.box.css(e)},s.init()},e.fn.autocomplete=function(t,n){return this.each(function(){if(undefined==e(this).data("autocomplete")){var r=new e.autocomplete(this,t,n);e(this).data("autocomplete",r)}})}}(jQuery),function(e){e.tagbox=function(t,n){var r={url:!1,autocomplete:{},lowercase:!0,classname:"tagbox",separator:", ",duplicates:!1,minLength:1,maxLength:140,keydown:function(){},onAdd:function(){},onRemove:function(){},onDuplicate:function(){return i.input.focus()},onInvalid:function(){return i.input.focus()},onReady:function(){}},i=this,s=null;i.settings={};var o=e(t),t=t;i.init=function(){i.settings=e.extend({},r,n);var t=o.attr("name"),s=o.attr("id"),u=o.val();i.index=[],i.val="",i.focused=!1,i.origin=o.addClass("tagboxified").hide(),i.box=e('<div class="'+i.settings.classname+'"><ul><li class="new"><input autocomplete="off" tabindex="0" type="text" /></li></ul></div>'),i.input=i.box.find("input").css("width",20),i.bhits=0,i.lhits=0;if(i.settings.url){var a={apply:function(e){i.add(e),this.kill(),i.input.focus()}};i.input.autocomplete(i.settings.url,e.extend({},a,i.settings.autocomplete)),i.autocomplete=i.input.data("autocomplete"),i.settings.onAdd=function(e){i.autocomplete.ignore=i.serialize()},i.settings.onRemove=function(e){i.autocomplete.ignore=i.serialize()}}i.origin.before(i.box),i.measure=e('<div style="display: inline" />').css({"font-size":i.input.css("font-size"),"font-family":i.input.css("font-family"),visibility:"hidden",position:"absolute",top:-1e4,left:-1e4}),e("body").append(i.measure),i.box.click(function(e){i.focus(),i.input.focus(),e.stopPropagation()}),i.input.keydown(function(e){i.val=i.input.val(),i.position=i.selection(),i.settings.keydown.call(i,e,i.val)}),i.input.keyup(function(e){i.val=i.input.val(),i.position=i.selection(),i.resize(i.val),i.val.match(new RegExp(i.settings.separator))&&i.add(i.val)}),i.input.focus(function(e){i.input.focused=!0,i.deselect(),i.bhits=0,i.focus()}),i.input.blur(function(e){i.input.focused=!1,i.bhits=0,i.val.length==0&&i.blur()}),i.settings.onReady.call(this),e(document).keydown(function(e){if(!i.focused)return!0;switch(e.keyCode){case 8:if(!i.input.focused)return i.remove(),!1;if(i.val.length==0)return i.next(),!1;if(i.position==0){if(i.bhits>0)return i.bhits=0,i.next(),!1;i.bhits++}break;case 37:if(!i.input.focused)return i.previous();if(i.val.length==0)return i.next(),!1;if(i.position==0){if(i.lhits>0)return i.lhits=0,i.next(),!1;i.lhits++}break;case 39:if(!i.input.focused)return i.next(),!1;break;case 9:if(i.input.focused&&i.val.length>i.settings.minLength)return i.add(i.val),!1;if(i.selected().length>0)return i.deselect(),i.input.focus(),!1;break;case 13:case 188:if(i.input.focused)return i.settings.autocomplete||i.add(i.val),!1}}).click(function(e){i.val.length>0&&i.add(i.val)}),u.length>0&&i.add(u)},i.resize=function(e){i.measure.text(e),i.input.css("width",i.measure.width()+20)},i.focus=function(t){if(i.focused)return!0;e(".tagboxified").not(i.origin).each(function(){e(this).data("tagbox")&&e(this).data("tagbox").blur()}),i.box.addClass("focus"),i.focused=!0;if(t==undefined)var t=!0;t!==!1&&i.input.focus()},i.blur=function(){if(!i.focused)return!0;i.box.removeClass("focus"),i.focused=!1,i.input.blur(),i.deselect()},i.tag=function(t){return t=t.replace(/,/g,"").replace(/;/g,""),i.settings.lowercase&&(t=t.toLowerCase()),e.trim(t)},i.serialize=function(){return i.index},i.string=function(){return i.serialize().toString()},i.add=function(t){i.input.val("");if(!t&&i.val.length>0)return i.add(i.val);if(!t)return!0;if(e.isArray(t)||t.match(new RegExp(i.settings.separator))){var n=e.isArray(t)?t:t.split(i.settings.separator);return e.each(n,function(e,t){i.add(t)}),!0}var t=i.tag(t);if(t.length<i.settings.minLength||t.length>i.settings.maxLength)return i.settings.onInvalid.call(i,t,length);if(i.settings.duplicates==0&&e.inArray(t,i.index)>-1)return i.settings.onDuplicate.call(i,t);i.index.push(t);var r=e('<li><span class="tag"></span><span class="delete">&#215;</span></li>').data("tag",t);r.find(".tag").text(t),r.find(".delete").click(function(){i.remove(r)}),r.click(function(e){i.blur(),e.stopPropagation(),i.select(r)}),r.focus(function(e){i.select(r)}),i.input.parent().before(r),i.input.val(""),i.input.css("width",20);var s=i.serialize();i.origin.val(s.join(i.settings.separator)),i.settings.onAdd.call(i,t,s,r)},i.select=function(e){if(typeof e=="string"){var e=i.find(e);if(!e)return!1}if(e.length==0)return!1;i.input.blur(),this.deselect(),e.addClass("selected"),i.focus(!1)},i.selected=function(){return i.box.find(".selected")},i.deselect=function(){var e=i.selected();e.removeClass("selected")},i.find=function(t){var n=!1;return i.box.find("li").not(".new").each(function(){e(this).data("tag")==t&&(n=e(this))}),n},i.remove=function(e){i.input.val("");if(typeof e=="string"){var e=i.find(e);if(!e)return!1}var t=i.selected();if(!e&&t.length>0)var e=t.first();var n=i.previous(!0);n.length==0?i.next():i.select(n);var r=e.find(".tag").text();i.removeFromIndex(r),e.remove();var s=i.serialize();i.origin.val(s),i.settings.onRemove.call(i,r,s,e)},i.removeFromIndex=function(e){var t=i.index.indexOf(e);i.index.splice(t,1)},i.selection=function(){var e=i.input[0],t=i.val;if(!e.createTextRange)return e.selectionStart;var n=document.selection.createRange().duplicate();return n.moveEnd("character",t.length),n.text==""?t.length:t.lastIndexOf(n.text)},i.previous=function(e){var t=i.selected(),n=t.length==0?i.box.find("li").not(".new").first():t.prev().not(".new");return e?n:i.select(n)},i.next=function(e){var t=i.selected(),n=t.length==0?i.box.find("li").not(".new").last():t.next();return e?n:n.hasClass("new")?i.input.focus():i.select(n)},i.init()},e.fn.tagbox=function(t){return this.each(function(){if(undefined==e(this).data("tagbox")){var n=new e.tagbox(this,t);e(this).data("tagbox",n)}})}}(jQuery),define("libs/tags",function(){}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/backbone-forms/tags",["cdn.underscore","libs/backbone-forms","libs/tags"],function(e,n,r){var i;return n.editors.Tags=function(n){function r(){return i=r.__super__.constructor.apply(this,arguments),i}return t(r,n),r.prototype.width=210,r.prototype.tagName="input",r.prototype.initialize=function(e){return r.__super__.initialize.call(this,e),this.tagboxValue=this.value||[]},r.prototype.render=function(){var t=this;return e.defer(function(){return t.renderTagbox()}),this},r.prototype.renderTagbox=function(){var e,t,n,r,i,s,o,u=this;return this.tagboxOptions=(n=this.schema.options)!=null?n:[],this.$el.tagbox({url:this.tagboxOptions,lowercase:(r=this.schema.lowercase)!=null?r:!0,duplicates:(i=this.schema.duplicates)!=null?i:!1,minLength:(s=this.schema.minLength)!=null?s:1,maxLength:(o=this.schema.maxLength)!=null?o:140}),this.tagbox=this.$el.data("tagbox"),e=this.tagbox.settings.onAdd,this.tagbox.settings.onAdd=function(){e();if(u.updating)return;return u.onChange(),u.updateTagboxOptions()},t=this.tagbox.settings.onRemove,this.tagbox.settings.onRemove=function(){t();if(u.updating)return;return u.onChange()},this.updateTagbox()},r.prototype.getValue=function(){return this.tagbox!=null&&(this.tagboxValue=this.tagbox.serialize().slice(0)),this.tagboxValue||[]},r.prototype.setValue=function(t){if(!e.isArray(t))return;if(e.isEqual(t,this.tagboxValue))return;return this.tagboxValue=t,this.updateTagbox()},r.prototype.updateTagbox=function(){var e,t,n,r;if(this.tagbox==null)return;this.updating=!0,this.clearValue(),r=this.tagboxValue;for(t=0,n=r.length;t<n;t++)e=r[t],this.tagbox.add(""+e);return this.updating=!1,this.updateTagboxOptions()},r.prototype.clearValue=function(){var e,t;t=[];while(((e=this.tagbox.serialize())!=null?e.length:void 0)>0)t.push(this.tagbox.remove(0));return t},r.prototype.onChange=function(){return this.trigger("change",this)},r.prototype.updateTagboxOptions=function(){var t,n,r,i,s;if(!this.schema.updateAutoComplete)return;i=e.difference(this.tagbox.serialize(),this.tagboxOptions),s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(this.tagboxOptions.push(t));return s},r}(n.editors.Base)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/property_sheet",["app/mediator","cdn.marionette","text!templates/property_sheet.html","bower_components/tether/tether","libs/backbone-forms","plugins/backbone-forms.bootstrap","views/backbone-forms/color","views/backbone-forms/range","views/backbone-forms/tags"],function(e,n,r,i,s){var o,u;return o=function(e){function n(){return u=n.__super__.constructor.apply(this,arguments),u}return t(n,e),n.prototype.template=_.template(r),n.prototype.className="properties-dialog",n.prototype.events={"change input[type=number]":"onFormChange","submit .js-form":"doNothing",click:"stopPropagation"},n.prototype.ui={form:".js-form",errorCount:".js-error-count",errorCountPlural:".js-error-count-plural",errorCountContainer:".js-error-count-container"},n.prototype.initialize=function(){return this.listenTo(this.options.config,"change",this.onConfigChange),this.listenTo(this.options.propertySheetSchema,"change",this.onSchemaChange),this.$el.appendTo("body")},n.prototype.onBeforeClose=function(){return this._hide()},n.prototype.onConfigChange=function(e,t){if(!t.propertySheetChanging)return this.render()},n.prototype.onSchemaChange=function(){return this.render()},n.prototype.setErrorCount=function(e){return this.ui.errorCount.text(e),this.ui.errorCountPlural.toggle(e!==1),this.ui.errorCountContainer.toggle(e>0)},n.prototype._show=function(){return this.$el.show(),this._tether=new i({element:this.el,target:this.options.targetElement,attachment:"top right",targetAttachment:"middle left",offset:"2px -4px"})},n.prototype._hide=function(){var e;return(e=this._tether)!=null&&e.destroy(),this._tether=null,this.$el.hide()},n.prototype.onRender=function(){var e;return this.form!=null&&this.stopListening(this.form),this.options.propertySheetSchema.isEmpty()?this._hide():(this.form=new s({data:this.options.config.toJSON(),schema:this.options.propertySheetSchema.sanitizedSchema()}),this.form.render(),e=this.form.validate(),this.setErrorCount(_.size(e)),this.listenTo(this.form,"change",this.onFormChange),this.ui.form.html(this.form.el),this._show())},n.prototype.doNothing=function(e){return e.preventDefault()},n.prototype.stopPropagation=function(e){return e.stopPropagation()},n.prototype.onFormChange=function(){return this.form.validate(),this.options.config.save(this.form.getValue(),{propertySheetChanging:!0})},n}(n.ItemView)})}.call(this),define("text!templates/tray/gadget.html",[],function(){return'<div class="js-gadget-icon gadget-icon"></div>\n<div class="tray-gadget-title"><%- title %></div>\n<div class="js-draggable gadget-icon-draggable" draggable="true"></div>\n<div class="js-version-controls version-controls">\n  <div class="js-upgrade-icon upgrade-icon">\n    <i class="arrow-icon icon-circle-arrow-up"></i>\n  </div>\n  <div class="js-revert-icon revert-icon">\n    <i class="arrow-icon icon-circle-arrow-down"></i>\n  </div>\n</div>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("models/manifest_viewmodel",["cdn.backbone"],function(e){var n,r;return n=function(e){function n(){return r=n.__super__.constructor.apply(this,arguments),r}return t(n,e),n.prototype.defaults={title:"Untitled gadget",author:"Unknown author",version:"-.-.-"},n}(e.Model)})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/tray/item",["cdn.underscore","cdn.marionette","text!templates/tray/gadget.html","models/manifest_viewmodel","views/gadget/drag_image","app/mediator"],function(t,r,i,s,o,u){var a,f;return a=function(r){function a(){return this.onDragStart=e(this.onDragStart,this),f=a.__super__.constructor.apply(this,arguments),f}return n(a,r),a.prototype.template=t.template(i),a.prototype.className="tray-gadget",a.prototype.ui={icon:".js-gadget-icon",versionControls:".js-version-controls"},a.prototype.events={dblclick:"onGadgetSelected","dragstart .js-draggable":"onDragStart","drag .js-draggable":"onDrag","dragend .js-draggable":"onDragEnd"},a.prototype.triggers={"click .js-upgrade-icon":"upgrade","click .js-revert-icon":"revert"},a.prototype._checksum=function(e){var n;return n=t.reduce(e.split(""),function(e,t){return e+t.charCodeAt(0)},0),n%10},a.prototype._iconPath=function(e){return e.replace(/^(https?:\/\/)((staging)?stack)/,"$1$2-"+this._checksum(e))},a.prototype.onRender=function(){this.ui.icon.css({"background-image":"url("+this._iconPath(this.model.icon())+")"}),this.$el.data("project",this.model);if(this._isUpgradable())return this.showUpgradable();if(this.options.revertable())return this.showRevertable()},a.prototype._isUpgradable=function(){var e;return e=this.model.get("latestVersion"),e!=null&&this.model.get("version")!==e},a.prototype.showUpgradable=function(){return this.ui.versionControls.removeClass("reverting").addClass("upgrading")},a.prototype.showRevertable=function(){return this.ui.versionControls.removeClass("upgrading").addClass("reverting")},a.prototype.onGadgetSelected=function(){return u.trigger("tray:gadgetSelected",this.model)},a.prototype.onDragStart=function(e){var n,r,i,s,a=this;return n=$(e.target),r=e!=null?(s=e.originalEvent)!=null?s.dataTransfer:void 0:void 0,r!=null&&(r.effectAllowed="move",i={action:"create",type:this.model.shortType()},r.setData("Text",JSON.stringify(i))),this._dragImage=new o({model:this._makeManifestOfProject(this.model)}),this._dragImage.render().$el.appendTo("body"),(r!=null?r.setDragImage:void 0)!=null?(r.setDragImage(this._dragImage.el,30,30),t.delay(function(){return a._dragImage.remove()})):(this._dragImageNotSupported=!0,n=$(e.target),n.hide(),t.delay(function(){return n.show()})),u.trigger("gadget:dragstart"),u.trigger("tray:gadget:dragstart")},a.prototype.onDrag=function(e){var t,n;if(this._dragImageNotSupported){t={top:e.originalEvent.clientY-30,left:e.originalEvent.clientX-30,"z-index":3100,opacity:.5};if(t.top&&t.left)return(n=this._dragImage)!=null?n.$el.css(t):void 0}},a.prototype.onDragEnd=function(){var e;u.trigger("gadget:dragend"),u.trigger("tray:gadget:dragend");if(this._dragImageNotSupported)return(e=this._dragImage)!=null?e.remove():void 0},a.prototype._makeManifestOfProject=function(e){var n;return n=t.pick(e.attributes,"title","author","version"),n.icon=this._iconPath(t.result(e,"icon")),new s(n)},a}(r.ItemView)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=[].slice;define("models/property_sheet_schema",["cdn.underscore","cdn.backbone"],function(e,r){var i,s;return i=function(r){function i(){return s=i.__super__.constructor.apply(this,arguments),s}return t(i,r),i.prototype.whiteListedAttributes={Text:[],Number:[],TextArea:[],Checkbox:[],Color:[],Select:["options"],Radio:["options"],Checkboxes:["options"],Date:["yearStart","yearEnd"],DateTime:["yearStart","yearEnd","minsInterval"],Range:["min","max","step"],Tags:["options","lowercase","duplicates","minLength","maxLength","updateAutoComplete"]},i.prototype.sanitizedSchema=function(){var e,t,n,r,i;r={},i=this.attributes;for(t in i)e=i[t],r[t]==null&&(n=this.sanitizedAttributes(e),n!=null&&(r[t]=n));return r},i.prototype.isEmpty=function(){return e.keys(this.sanitizedSchema()).length===0},i.prototype.sanitizedAttributes=function(t){var r;return typeof t=="string"?this.sanitizedAttributes({type:t}):typeof t!="object"?null:(r=this.whiteListedAttributes[t.type],r==null?null:e.pick.apply(e,[t,"type","title","validators"].concat(n.call(r))))},i.prototype._defaultDefinitionForValue=function(t){switch(typeof t){case"boolean":return"Checkbox";case"number":return"Number";case"string":return/^\#[a-f0-9]{6}$/i.test(t)?"Color":t.length>20?"TextArea":"Text";case"object":return e.isArray(t)&&e.every(t,function(e){var t;return(t=typeof e)==="string"||t==="number"})?{type:"Tags",options:e.uniq(t),updateAutoComplete:!0}:null;default:return null}},i}(r.Model)})}.call(this),define("text!templates/gadget_instance.html",[],function(){return'<div class="toolbar">\n  <i class="drag js-draggable icon-reorder" draggable="true"></i>\n  <i class="edit js-edit icon-cog"></i>\n  <i class="delete js-trash icon-trash"></i>\n</div>\n\n<div class="gadgetContent"></div>\n<div class="js-placeholder placeholder">Click to edit this gadget</div>\n<div class="drag-overlay"></div>\n\n<div class="toolbar-right"></div>\n\n<div class="collab-overlay"></div>\n<div class="collab-lock"></div>\n'}),define("text!templates/gadget_instance_error.html",[],function(){return'<div class="alert alert-error">\n  Something went wrong and this gadget didn\'t load properly.<br>\n  We\'re on it. Please check back in a bit.\n  <!--\n    Technical details:\n    <%- errorDescription %>\n  -->\n  <div class="error-controls">\n    <button class="js-hide">close</button>\n    <button class="action delete-button js-delete">remove</button>\n  </div>\n</div>\n'}),define("text!templates/gadget_delete_warn.html",[],function(){return'<div class="alert alert-warn js-alert-warn">\n  <div class="alert-controls">\n    <div class="alert-msg">Are you sure you want to remove this gadget?</div>\n    <button class="undo-button js-undo-delete">no</button>\n    <button class="action delete-button js-delete">yes</button>\n  </div>\n</div>\n'}),define("text!templates/gadget_child_picker.html",[],function(){return"<div class='gadget-child-picker-inner'>\n  <h2 class=\"gadget-child-picker-heading\">Select slide content</h2>\n\n  <ul class='gadget-child-picker-list'>\n    <% for(var gadgetType in gadgetTypes) { %>\n      <li class='gadget-child-picker-item js-choose-type' data-type='<%= gadgetType %>'>\n        <img class=\"gadget-child-picker-image\" src='<%= gadgetTypes[gadgetType].imageUrl %>'>\n        <label class='gadget-child-picker-title'><%= gadgetTypes[gadgetType].title %></label>\n        <label class='gadget-child-picker-author'><%= gadgetTypes[gadgetType].author %></label>\n      </li>\n    <% } %>\n  </ul>\n</div>\n"}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/gadget/child_picker",["cdn.marionette","text!templates/gadget_child_picker.html"],function(t,r){var i,s;return i=function(t){function i(){return this.templateHelpers=e(this.templateHelpers,this),s=i.__super__.constructor.apply(this,arguments),s}return n(i,t),i.prototype.template=_.template(r),i.prototype.className="gadget-child-picker",i.prototype.events={"click .js-choose-type":"_onTypeClick"},i.prototype._onTypeClick=function(e){var t;return t=$(e.target).closest("li").data("type"),this.trigger("gadget_picked_of_type",t),!1},i.prototype._imageUrl=function(e){return this.options.gadgetBaseUrl+("/assets/"+e)},i.prototype.templateHelpers=function(){return{gadgetTypes:{"versal/image":{title:"Image",author:"Versal",imageUrl:this._imageUrl("image.png")},"versal/video":{title:"Video",author:"Versal",imageUrl:this._imageUrl("video.png")},"versal/markdown":{title:"Markdown",author:"Versal",imageUrl:this._imageUrl("markdown.png")}}}},i}(t.ItemView)})}.call(this),define("text!templates/gadget_child_container.html",[],function(){return"<div class='gadget-child-container-picker-region js-picker-region'></div>\n"}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/gadget/child_container",["cdn.marionette","views/gadget/child_picker","text!templates/gadget_child_container.html"],function(e,n,r){var i,s;return i=function(e){function i(){return s=i.__super__.constructor.apply(this,arguments),s}return t(i,e),i.prototype.template=_.template(r),i.prototype.className="gadget-child-container",i.prototype.regions={pickerRegion:".js-picker-region"},i.prototype.onRender=function(){return this.options.gadgetId!=null?this._renderGadget(this.options.gadgetId):this._renderChildPicker()},i.prototype._renderGadget=function(e){return this.pickerRegion.close(),this.options.children.useGadgetAndMoveToEl(e,this.$el)},i.prototype._renderChildPicker=function(){var e;return e=new n({gadgetBaseUrl:this.options.gadgetBaseUrl}),this.listenTo(e,"gadget_picked_of_type",this._gadgetPickedOfType),this.pickerRegion.show(e)},i.prototype._gadgetPickedOfType=function(e){var t=this;return this.options.children.build(e,function(e){return t._renderGadget(e),t.options.children.toggleEdit(!0),t.trigger("selected_gadget",e)})},i}(e.Layout)})}.call(this),function(){define("launchers/legacy/containers_interface",["cdn.underscore","views/gadget/child_container","app/mediator"],function(e,t,n){var r;return r=function(){function r(e){var t;this.gadgetConfig=e.gadgetConfig,this.lesson=e.lesson,this.gadgetBaseUrl=e.gadgetBaseUrl,this._children=(t=this.gadgetConfig.get("_children"))!=null?t:[]}return r.prototype.build=function(e,t,r){var i=this;return n.trigger("catalog:findByType",e,function(e){var n;return n=i.lesson.insertGadgetProjectAt(e,i.lesson.children.length),n.config.save("_versal_container_child",!0),n!=null?n.once("sync",function(){return i._children.push(n.id),i.gadgetConfig.save({_children:i._children}),t(n.id)}):void 0})},r.prototype.getGadgetChildContainerView=function(e){return e==null&&(e=null),new t({gadgetId:e,children:this,gadgetBaseUrl:this.gadgetBaseUrl})},r.prototype.useGadgetAndMoveToEl=function(t,n){var r,i;if(!e.contains(this._children,t))return;this._childrenInUse.push(t),r=this.lesson.collection.get(t);if(!r)return;return r.config.save("_versal_container_child",!0),this.gadgetConfig.gadget.on("destroy",function(){return r.destroy()}),i=this.lesson.children.findByModel(r),n.empty(),i.$el.detach().find(".gadgetContent").appendTo(n),i.setElement(n)},r.prototype.renderById=function(e,t){return this.useGadgetAndMoveToEl(e,t)},r.prototype.destroy=function(t){var n;if(!e.contains(this._children,t))return;return n=this.lesson.collection.get(t),n!=null&&n.destroy(),this._children=e.without(this._children,t),this._childrenInUse=e.without(this._childrenInUse,t)},r.prototype.toggleEdit=function(t){var n=this;return e.each(this._childrenInUse,function(e){var r;if(r=n.lesson.collection.get(e))return r.set({isEditing:t})})},r.prototype._childrenInUse=[],r}()})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/gadget/instance",["cdn.jquery","cdn.underscore","cdn.marionette","app/mediator","plugins/vs.collab","plugins/tracker","views/gadget/drag_image","views/property_sheet","views/tray/item","models/property_sheet_schema","models/manifest_viewmodel","text!templates/gadget_instance.html","text!templates/gadget_instance_error.html","text!templates/gadget_delete_warn.html","launchers/legacy/containers_interface"],function(t,r,i,s,o,u,a,f,l,c,h,p,d,v,m){var g,y;return g=function(i){function o(){return this._trackGadgetSeen=e(this._trackGadgetSeen,this),this._scrollIntoViewIfNeeded=e(this._scrollIntoViewIfNeeded,this),this._gadgetDropped=e(this._gadgetDropped,this),this.stopEditing=e(this.stopEditing,this),this._onPopulateGadgetCommentsRegion=e(this._onPopulateGadgetCommentsRegion,this),this._onPopulateGadgetLockRegion=e(this._onPopulateGadgetLockRegion,this),y=o.__super__.constructor.apply(this,arguments),y}return n(o,i),o.prototype.reportActivityEveryMs=6e4,o.prototype.template=r.template(p),o.prototype.className="gadget js-gadget",o.prototype.regions={lockRegion:".collab-lock",commentsRegion:".toolbar-right"},o.prototype.events={"click .js-edit":"onEditClick","click .js-trash":"onTrashClick","click .js-hide":"onHideClick","click .js-delete":"onDeleteClick","click .js-undo-delete":"onUndoDelete","click .gadgetContent":"onContentClick","click .js-placeholder":"onPlaceholderClick","click .toolbar-right":"prevent","selectstart .js-placeholder":r.identity(!1),"dragstart .js-draggable":"ondragstart","dragend .js-draggable":"ondragend","drag .js-draggable":"ondrag"},o.prototype.modelEvents={destroy:"onModelDestroy","change:isEditing":"_onIsEditingChanged"},o.prototype.ui={toolbar:".toolbar",gadgetContent:".gadgetContent",commentsBox:".js-comments-box",editButton:".js-edit",placeholder:".js-placeholder"},o.prototype.initialize=function(e){var n,r,i,o,a,f,l,h,p,d,v=this;this.isEditable=e.isEditable,this.project=e.project,this.currentLesson=e.currentLesson,this.assetUrlTemplate=e.assetUrlTemplate,i=e.dropped,this._tracker=new u("gadget"),this._tracker.setMetadata({lessonId:(l=this.currentLesson)!=null?(h=l.model)!=null?h.id:void 0:void 0,gadgetId:this.model.id,gadgetType:(p=this.project)!=null?p.type():void 0}),this.gadgetRendering=t.Deferred(),this.once("gadgetRendered",function(){return v.gadgetRendering.resolve()}),i&&this.gadgetRendering.done(this._gadgetDropped),this.listenTo(this.model.config,"change",this._onGadgetConfigChange),this.listenTo(this.model.userState,"change",this._onGadgetUserStateChange),this.listenTo(this.model.userState,"sync",this._onGadgetUserStateSync),this.listenTo(this.model.userState,"change:progress",this._onGadgetProgressChanged),s.on("plugin:populate:gadgetCommentsRegion",this._onPopulateGadgetCommentsRegion),s.on("plugin:populate:gadgetLockRegion",this._onPopulateGadgetLockRegion),this._propertySheetSchema=new c;switch((d=this.project)!=null?d.get("launcher"):void 0){case"iframe":this._launcher=document.createElement("VERSAL-IFRAME-LAUNCHER"),a=this.project.path("versal.html"),a=a.replace("https:","").replace("http:",""),this._launcher.setAttribute("src",a);break;default:this._launcher=document.createElement("VERSAL-LEGACY-LAUNCHER"),o={"gadget-base-url":this.project.path(),"gadget-instance-url":this.model.has("url")?this.model.url():null,"gadget-css-class-name":this.project.cssClassName()},this.isEditable&&(o["editing-allowed"]="true"),this.isChild()||(o["should-fire-close-event-on-detached"]="true");for(n in o)r=o[n],this._launcher.setAttribute(n,r);typeof (f=this._launcher).setLegacyContainers=="function"&&f.setLegacyContainers(new m({gadgetConfig:this.model.config,lesson:this.currentLesson,gadgetBaseUrl:this.project.path()}))}return Object.keys(this._launcherHandlers).forEach(function(e){return v._launcher.addEventListener(e,v._launcherHandlers[e].bind(v))})},o.prototype.onClose=function(){return s.off("plugin:populate:gadgetCommentsRegion",this._onPopulateGadgetCommentsRegion),s.off("plugin:populate:gadgetLockRegion",this._onPopulateGadgetLockRegion),this.ui.gadgetContent.off()},o.prototype.ondragstart=function(e){var n,i,o,u,f=this;return i=e!=null?(u=e.originalEvent)!=null?u.dataTransfer:void 0:void 0,i!=null&&(i.effectAllowed="move",o={action:"reorder",index:this.$el.index()},e.originalEvent.dataTransfer.setData("Text",JSON.stringify(o))),this._dragImage=new a({model:this._makeManifestOfProject(this.project)}),this._dragImage.render().$el.appendTo("body"),(i!=null?i.setDragImage:void 0)!=null?(e.originalEvent.dataTransfer.setDragImage(this._dragImage.el,30,30),r.delay(function(){return f._dragImage.remove()})):(this._dragImageNotSupported=!0,n=t(e.target),n.hide(),r.delay(function(){return n.show()})),this._closePropertySheet(),r.delay(function(){return f.$el.addClass("gadget-dragging"),s.trigger("gadget:dragstart")})},o.prototype.ondrag=function(e){var t,n;if(this._dragImageNotSupported){t={top:e.originalEvent.clientY-30,left:e.originalEvent.clientX-30,"z-index":3100,opacity:.5};if(t.top&&t.left)return(n=this._dragImage)!=null?n.$el.css(t):void 0}},o.prototype.ondragend=function(){var e;(e=this._dragImage)!=null&&e.remove(),this.$el.removeClass("gadget-dragging"),s.trigger("gadget:dragend");if(this.isEditing())return this._openPropertySheet()},o.prototype._checksum=function(e){var t;return t=r.reduce(e.split(""),function(e,t){return e+t.charCodeAt(0)},0),t%10},o.prototype._iconPath=function(e){return e.replace(/^(https?:\/\/)((staging)?stack)/,"$1$2-"+this._checksum(e))},o.prototype._makeManifestOfProject=function(e){var t;return t=r.pick(e.attributes,"title","author","version"),t.icon=this._iconPath(r.result(e,"icon")),new h(t)},o.prototype._onPopulateGadgetLockRegion=function(e){if(e.gadget.id!==this.model.id)return;return this.lockRegion.show(e)},o.prototype._onPopulateGadgetCommentsRegion=function(e){if(e.gadget.id!==this.model.id)return;return this.commentsRegion.show(e)},o.prototype.onContentClick=function(e){if(this.project.get("noToggleSwitch"))return this.startEditing(),e.stopPropagation()},o.prototype.onPlaceholderClick=function(e){return this.startEditing(),e.stopPropagation()},o.prototype.isEditing=function(){return!!this.model.get("isEditing")},o.prototype.onEditClick=function(e){return this._toggleEditing(),e.stopPropagation()},o.prototype._toggleEditing=function(){if(this.isChild()||!this.isEditable)return;return this.isEditing()?this.stopEditing():this.startEditing()},o.prototype.startEditing=function(){if(this.isChild()||!this.isEditable)return;if(this.isEditing())return;return this.trigger("before:startEditing"),this._configBeforeEditing=this.model.config.toJSON(),this.model.set({isEditing:!0}),s.trigger("gadget:editing:start",this.model),this.$el.on("click",this.prevent),t(window).one("click",this.stopEditing),this.trigger("after:startEditing")},o.prototype.stopEditing=function(){if(!this.isEditing())return;return r.isEqual(this.model.config.toJSON(),this._configBeforeEditing)||s.trigger("gadget:changed",this.model),this.model.set({isEditing:!1}),s.trigger("gadget:editing:stop",this.model),t(window).off("click",this.stopEditing),this.$el.off("click",this.prevent)},o.prototype._onIsEditingChanged=function(e,t){return this.$el.toggleClass("editing",t),t?(this._launcher.setAttribute("editable","true"),this._openPropertySheet()):(this._launcher.removeAttribute("editable"),this._closePropertySheet())},o.prototype._openPropertySheet=function(){if(!this.isEditing())return;if(this.isChild())return;return this._propertySheetView=new f({model:this.model,config:this.model.config,propertySheetSchema:this._propertySheetSchema,targetElement:this.ui.editButton}),this._propertySheetView.render()},o.prototype._closePropertySheet=function(){var e;return(e=this._propertySheetView)!=null?e.close():void 0},o.prototype.prevent=function(e){return e.stopPropagation()},o.prototype.isChild=function(){return!!this.model.config.get("_versal_container_child")},o.prototype._gadgetDropped=function(){return this._scrollIntoViewIfNeeded(),this.startEditing()},o.prototype._scrollIntoViewIfNeeded=function(){var e;e=this.el.getBoundingClientRect();if(e.top<=0){this.el.scrollIntoView(!0);if(e.top<=0)return window.scrollBy(0,-37)}else if(e.bottom>t(window).height())return this.el.scrollIntoView(!1)},o.prototype.onModelDestroy=function(){return s.trigger("gadget:deleted",this.model)},o.prototype.onTrashClick=function(){return this.showDeleteMsg()},o.prototype.onHideClick=function(){return this.$el.fadeOut(1200)},o.prototype.showDeleteMsg=function(){var e,n;if(this.deleteShowing)return;return this.deleteShowing=!0,e=this.$el.height(),n=t(v),e<100&&n.addClass("minimized"),this.$el.append(n)},o.prototype.onUndoDelete=function(){return this.stopEditing(),this.deleteShowing=!1,this.$el.find(".js-alert-warn").remove()},o.prototype.onDeleteClick=function(){return this.stopEditing(),this.model.destroy()},o.prototype.onRender=function(){var e,t,n;if(this.project==null)return this.showCouldNotLoad("Gadget Project is missing");this.ui.gadgetContent.addClass(this.project.cssClassName()),this.isEditable&&this.project.get("noToggleSwitch")&&this.$el.addClass("noToggleSwitch"),this.el.setAttribute("id","gadget-"+this.model.cid),this.el.setAttribute("data-type",this.model.get("type")),this.el.addEventListener("elementWasSeen",this._trackGadgetSeen),n={"data-environment":{assetUrlTemplate:this.assetUrlTemplate},"data-config":this.model.config.toJSON(),"data-userstate":this.model.userState.toJSON()},this.isEditing()&&(n.editable="true");for(t in n)e=n[t],this._launcher.setAttribute(t,JSON.stringify(e));return this.ui.gadgetContent.append(this._launcher),this._launcher.tagName==="VERSAL-IFRAME-LAUNCHER"&&this._gadgetRendered(),this.startReportingActivity()},o.prototype._gadgetRendered=function(){return this.trigger("gadgetRendered"),s.trigger("gadget:rendered",this.model)},o.prototype.startReportingActivity=function(){var e,t,n;return e="scroll mousedown DOMMouseScroll mousewheel keyup",t=function(){return s.trigger("gadget:activity")},n=r.debounce(t,this.reportActivityEveryMs,!0),this.ui.gadgetContent.on(e,n),this.listenTo(s,"course:click",n)},o.prototype.showCouldNotLoad=function(e){return typeof console.error=="function"&&console.error(e),this.$el.html(r.template(d,{errorDescription:e})),this._tracker.track("gadget-error",{description:e}),this.trigger("gadgetRendered")},o.prototype.toggleEmpty=function(e){return e&&(this._emptyState=this.model.config.toJSON()),this.$el.toggleClass("empty",e)},o.prototype._onGadgetConfigChange=function(e){return this._emptyState&&!r.isEqual(e.toJSON(),this._emptyState)&&this.toggleEmpty(!1),this._launcher.setAttribute("data-config",JSON.stringify(e.toJSON()))},o.prototype._onGadgetUserStateChange=function(e){return this._launcher.setAttribute("data-userstate",JSON.stringify(e.toJSON()))},o.prototype._onGadgetUserStateSync=function(e,t,n){this.trigger("lessonIsCompleteMayHaveChanged");if(t.results!=null)return this._launcher.setAttribute("data-userstate",JSON.stringify(this.model.userState.toJSON()))},o.prototype._trackGadgetSeen=function(){return this._tracker.track("gadget-seen")},o.prototype._launcherHandlers={rendered:function(e){return this._gadgetRendered()},setAttributes:function(e){return this.model.config.save(e.detail)},setLearnerState:function(e){return this.model.userState.save(e.detail)},selectAsset:function(e){return s.trigger("asset:select",e.detail)},requestAsset:function(e){var t,n=this;return t=e.detail,s.trigger("asset:select",{type:t.type,success:function(e){if(t.attribute)return n.model.config.save(t.attribute,e)}})},setPropertySheetAttributes:function(e){return this._propertySheetSchema.set(e.detail)},setEmpty:function(){return this.toggleEmpty(!0)},track:function(e){var t;return t=e.detail,this._tracker.track(t["@type"],r.omit(t,"@type"))},changeBlocking:function(){return s.trigger("blocking:changed")},error:function(e){var t,n;return n=e.detail,t=[n.message,n.stacktrace].join("\n"),this.showCouldNotLoad(t||"Something bad happened to this gadget...")}},o}(i.Layout)})}.call(this),function(){define("plugins/feature-detection",[],function(){var e;return e=function(){function e(){}return e.prototype.userAgent=function(){return this._userAgent!=null?this._userAgent:this._userAgent=navigator.userAgent.toLowerCase()},e.prototype.edgeScroll=function(){return this.isIE()||this.isChrome()},e.prototype.isIE=function(){return this.userAgent().indexOf("trident")>0},e.prototype.isChrome=function(){return this.userAgent().indexOf("chrome")>0},e}(),new e})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/lesson_screen",["cdn.backbone","plugins/feature-detection"],function(t,r){var i,s;return i=function(t){function i(){return this._stopScrolling=e(this._stopScrolling,this),this._scrollOneStep=e(this._scrollOneStep,this),this._startScrolling=e(this._startScrolling,this),s=i.__super__.constructor.apply(this,arguments),s}return n(i,t),i.prototype.className="lesson-screen",i.prototype.events={dragenter:"onDragEnter",dragleave:"onDragLeave",dragover:"onDragOver",drop:"onDrop"},i.prototype._scrollSpeed=25,i.prototype._scrollDuration=50,i.prototype._scrollDirection=0,i.prototype.initialize=function(e){return this.lessonView=e.lessonView,this._scrollContainer=$(".js-main-container"),this._edgeScrollEnabled=r.edgeScroll()},i.prototype.onDragEnter=function(e){return e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move",this._scrollRect=this._scrollContainer.get(0).getBoundingClientRect(),this._dropIndicator().appendTo(this.el)},i.prototype.onDragLeave=function(e){return this._dropIndicator().detach(),this._stopScrolling()},i.prototype.onDragOver=function(e){var t,n,r,i;e.preventDefault(),e.originalEvent.dataTransfer.dropEffect="move",n=e!=null?(i=e.originalEvent)!=null?i.clientY:void 0:void 0,this._positionDropIndicator(n);if(!this._edgeScrollEnabled&&this._scrollRect)return r=n-this._scrollRect.top,t=this._scrollRect.bottom-n,0<r&&r<50?this._startScrolling(-1):0<t&&t<50?this._startScrolling(1):this._stopScrolling()},i.prototype.onDrop=function(e){var t,n,r,i,s=this;return e.preventDefault(),e.stopPropagation(),this._stopScrolling(),i=e.originalEvent.clientY,n=this.lessonView.gadgetAtCursor(i),n?r=$(n).index()+this._cursorPosition(n,i):r=this.lessonView.$el.find(".js-gadget").length,t=JSON.parse(e.originalEvent.dataTransfer.getData("text")),_.defer(function(){var e;switch(t.action){case"reorder":return e=t.index,e<r&&r--,s.lessonView.moveGadgetToIndex(e,r);case"create":return s.lessonView.createGadgetTypeAt(t.type,r)}})},i.prototype._startScrolling=function(e){if(this._scrollDirection===e)return;return this._scrollDirection=e,setTimeout(this._scrollOneStep.bind(this),250)},i.prototype._scrollOneStep=function(){var e;if(this._scrollDirection===0)return;return e=this._scrollContainer.scrollTop()+this._scrollDirection*this._scrollSpeed,this._scrollContainer.animate({scrollTop:e},this._scrollDuration,"linear",this._scrollOneStep.bind(this))},i.prototype._stopScrolling=function(){if(this._scrollDirection===0)return;return this._scrollDirection=0},i.prototype._positionDropIndicator=function(e){var t,n;return t=this.lessonView.gadgetAtCursor(e)||this.lessonView.$(".gadget").last()[0],t?(n=t.offsetTop-1,n+=this._cursorPosition(t,e)*(t.clientHeight+2)):n=0,n+=this._gadgetsOffset(),this._dropIndicator().css({top:n})},i.prototype._gadgetsOffset=function(){return this.lessonView.ui.lessonContent.position().top},i.prototype._cursorPosition=function(e,t){var n,r;return r=e.getBoundingClientRect(),n=r.top+r.height/2,t>n?1:0},i.prototype._dropIndicator=function(){return this.__dropIndicator!=null?this.__dropIndicator:this.__dropIndicator=$("<div>").addClass("gadget-drop-target").appendTo(this.el)},i}(t.View)})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/lesson",["cdn.marionette","app/mediator","messages/player_tracker","libs/vs.ui","text!templates/lesson.html","views/gadget/instance","views/lesson_screen","cdn.jqueryui"],function(t,r,i,s,o,u,a){var f,l;return f=function(t){function f(){return this.showGadget=e(this.showGadget,this),this.fixSizing=e(this.fixSizing,this),this.onTitleEdited=e(this.onTitleEdited,this),this.stopEditingTitle=e(this.stopEditingTitle,this),this._onDragEnd=e(this._onDragEnd,this),this._onDragStart=e(this._onDragStart,this),this._onGadgetInserted=e(this._onGadgetInserted,this),this.itemViewOptions=e(this.itemViewOptions,this),l=f.__super__.constructor.apply(this,arguments),l}return n(f,t),f.prototype.template=_.template(o),f.prototype.ui={gadgets:".gadgets",lessonTitle:".js-lesson-title",lessonContent:".js-lesson-content",screen:".js-lesson-screen",canvasMessage:".canvas-message"},f.prototype.events={"click .js-lesson-title":"startEditingTitle"},f.prototype.className="lesson",f.prototype.itemViewContainer=".gadgets",f.prototype.itemView=u,f.prototype.itemViewOptions=function(e){var t;return{project:(t=this.palette)!=null?t.findByType(e.get("type")):void 0,isEditable:this.isEditable,assetUrlTemplate:this.assetUrlTemplate,currentLesson:this,dropped:e.dropped}},f.prototype.initialize=function(e){var t=this;return this.palette=e.palette,this.isEditable=e.isEditable,this.assetUrlTemplate=e.assetUrlTemplate,this.collection=this.model.gadgets,this.activeView=null,this.on("itemview:lessonIsCompleteMayHaveChanged",function(){return t.trigger("lessonIsCompleteMayHaveChanged")}),this.on("itemview:before:startEditing",this.onBeforeStartEditingGadget),this.on("itemview:gadgetRendered",this._onGadgetRendered),this.listenTo(this.model.gadgets,"remove",this.onGadgetDeleted),this.listenTo(this.model.gadgets,"change:isEditing",this.onGadgetEditingChanged),this.listenTo(this.model,"change:title",this.onChangeTitle),this.listenTo(this,"composite:collection:rendered",this.onCollectionRender),this.listenTo(this.model.gadgets,"add remove",this.fixCanvasMessage),r.on("tray:gadgetSelected",this.addGadgetToTheEnd,this),r.on("gadget:dragstart",this._onDragStart,this),r.on("gadget:dragend",this._onDragEnd,this),this.fixSizingThrottled=_.throttle(this.fixSizing,200),$(window).on("resize",this.fixSizingThrottled)},f.prototype.onRender=function(){var e;return this.fixSizing(),this.fixCanvasMessage(),this.isEditable&&(new a({el:this.ui.screen,lessonView:this})).render(),this.children.length===0&&r.trigger("lesson:allGadgetsRendered",this.model),this.isEditable&&!this.editableTitle&&(this.editableTitle=new s.EditableText({el:this.ui.lessonTitle,success:this.onTitleEdited,complete:this.stopEditingTitle})),e=60},f.prototype.onClose=function(){return r.off("tray:gadgetSelected",this.addGadgetToTheEnd,this),$(window).off("resize",this.fixSizingThrottled)},f.prototype.onGadgetEditingChanged=function(e,t){return this.$el.toggleClass("has-editing-gadget",t)},f.prototype.onBeforeStartEditingGadget=function(e){var t;return(t=this._currentlyEditingGadget)!=null&&t.stopEditing(),this._currentlyEditingGadget=e},f.prototype.onBeforeStartCommentingGadget=function(e){var t;return(t=this._currentlyCommentingGadget)!=null&&t.stopCommenting(),this._currentlyCommentingGadget=e},f.prototype.createGadgetTypeAt=function(e,t){var n;return n=r.catalogue.findByType(e),n?this.insertGadgetProjectAt(n,t):(console.error("Project not found: ",e),i.track("lesson-error",{message:"project not found",type:e}))},f.prototype.insertGadgetProjectAt=function(e,t){var n;return this.palette.add(e),(n=e.buildInstance({index:t}))?(n.dropped=!0,this.collection.create(n,{at:t,success:this._onGadgetInserted}),n):console.error("Failed grabbing gadget ",e)},f.prototype._onGadgetInserted=function(e){return this.fixSizing(),r.trigger("lesson:gadget:added",this,e)},f.prototype.onGadgetDeleted=function(e){return r.trigger("lesson:gadget:deleted",this,e)},f.prototype.moveGadgetToIndex=function(e,t){var n,i,s;if(e===t)return;return i=this.collection.at(e),this.collection.move(i,t),n=this.children.findByModel(i).$el.detach(),t===0?this.ui.gadgets.prepend(n):(s=this.children.findByModel(this.collection.at(t-1)),n.insertAfter(s.el)),r.trigger("lesson:gadget:moved",this),this._relegateChildGadgets()},f.prototype._onDragStart=function(e){return this.$el.addClass("dragover")},f.prototype._onDragEnd=function(){return this.$el.removeClass("dragover")},f.prototype.gadgetAtCursor=function(e){var t;return this._cursorInsideElement(e,this._activeGadget)||(t=this.el.querySelectorAll(".js-gadget"),t.length===0?this._activeGadget=null:t[0].getBoundingClientRect().top>=e?this._activeGadget=t[0]:this._activeGadget=_.find(t,this._cursorInsideElement.bind(null,e))),this._activeGadget},f.prototype._cursorInsideElement=function(e,t){var n;if(!t)return;return n=t.getBoundingClientRect(),n.top<=e&&e<n.bottom},f.prototype.onCollectionRender=function(){return this._currentlyCommentingGadget=null,this._currentlyEditingGadget=null},f.prototype.startEditingTitle=function(){var e;return(e=this.editableTitle)!=null?e.toggleEdit(!0):void 0},f.prototype.stopEditingTitle=function(){var e;return(e=this.editableTitle)!=null?e.toggleEdit(!1):void 0},f.prototype.onTitleEdited=function(e){return this.model.save({title:e})},f.prototype.fixSizing=function(){var e=this;return _.defer(function(){var t;return typeof (t=e.ui.gadgets).css=="function"?t.css({"min-height":e.availableHeight()}):void 0})},f.prototype.availableHeight=function(){return $(window).height()-120-$(".tray-container").outerHeight()},f.prototype.appendHtml=function(e,t,n){var r;return t.isChild()?(this._onGadgetRendered(t),!1):(r=this.ui.gadgets.children(),r.size()<=n?this.ui.gadgets.append(t.el):r.eq(n).before(t.el),this.fixSizing())},f.prototype._onGadgetRendered=function(e){var t;e.rendered=!0,t=this.children.every(function(e){return e.rendered});if(t)return r.trigger("lesson:allGadgetsRendered",this.model)},f.prototype.showHoverables=function(e){return e==null&&(e=!0),this.children.each(function(t){return t.showHoverables(e)})},f.prototype.showGadget=function(e){var t,n;return t=$(".js-main-container"),n=this.children.findByIndex(e-1),this._showGadget==null&&(this._showGadget=_.debounce(function(e){return e.gadgetRendering.done(function(){var n;return n=e.$el.offset().top+t.scrollTop(),t.animate({scrollTop:n},"fast")})},250,!0)),this._showGadget(n)},f.prototype.isComplete=function(){if(this.model.collection.indexOf(this.model)<this.model.collection.length-1)throw"Only call isComplete on the last lesson";return this.model.gadgets.every(function(e){var t;return e.get("type")!=="6/quiz@1.0.04"||((t=e.userState.get("results"))!=null?t.pass:void 0)===!0})},f.prototype.onChangeTitle=function(e,t){return this.ui.lessonTitle.text(t),this.ui.lessonTitle.scrollLeft(0)},f.prototype.addGadgetToTheEnd=function(e){return this.insertGadgetProjectAt(e,this.children.length)},f.prototype._relegateChildGadgets=function(){var e,t=this;return e=[],this.collection.each(function(n){if(n.isChild)return e.push(n),t.collection.remove(n,{silent:!0})}),this.collection.add(e,{silent:!0})},f.prototype.fixCanvasMessage=function(){return this.ui.canvasMessage.toggleClass("hidden",!!this.collection.length)},f}(t.CompositeView)})}.call(this),define("text!templates/loading.html",[],function(){return'<div class="loading-overlay">\n  <div class="loading-content">\n    <i class="spin-holder"></i>\n    Loading...\n  </div>\n</div>\n\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/loading",["cdn.marionette","libs/vs.ui","text!templates/loading.html"],function(e,n,r){var i,s;return i=function(e){function i(){return s=i.__super__.constructor.apply(this,arguments),s}return t(i,e),i.prototype.className="loading-page",i.prototype.template=_.template(r),i.prototype.onRender=function(){return new n.LoadingIndicator(this.$(".spin-holder"))},i.prototype.hide=function(e){var t=this;return this.$(".loading-overlay").fadeOut(400,function(){return typeof e=="function"?e():void 0})},i}(e.ItemView)})}.call(this),define("text!templates/nav-buttons.html",[],function(){return"<%= buttonIf(previousAvailable(), 'js-prev previous-button', 'previous lesson', 'left') %>\n<%= buttonIf(nextAvailable(), 'js-next next-button', 'next lesson', 'right') %>\n<%= buttonIf(isComplete() && !nextAvailable(), 'js-finish finish-button', 'finish course', 'right') %>\n<div class=\"clearfix\"></div>\n"}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/nav_buttons",["cdn.marionette","text!templates/nav-buttons.html","app/mediator","plugins/vs.api"],function(t,r,i,s){var o,u;return o=function(t){function o(){return this.templateHelpers=e(this.templateHelpers,this),this.buttonIf=e(this.buttonIf,this),this.isComplete=e(this.isComplete,this),this.nextAvailable=e(this.nextAvailable,this),this.previousAvailable=e(this.previousAvailable,this),this._onCourseEnd=e(this._onCourseEnd,this),u=o.__super__.constructor.apply(this,arguments),u}return n(o,t),o.prototype.className="nav-buttons",o.prototype.initialize=function(){return i.on("lesson:rendered",this.updateButtons,this),this._isEditable=this.model.get("isEditable")},o.prototype.onClose=function(){return i.off("lesson:rendered",this.updateButtons)},o.prototype.events={"click .js-prev":"onPreviousClick","click .js-next":"onNextClick","click .js-finish":"onFinishClick"},o.prototype.ui={finishButton:".js-finish",nextButton:".js-next",prevButton:".js-prev"},o.prototype.template=_.template(r),o.prototype.updateButtons=function(e){var t,n,r;return(t=this.lessonView)!=null&&t.off("lessonIsCompleteMayHaveChanged",this.render),(n=this.next)!=null&&n.off("change:isAccessible",this.render),this.lessonView=e,this.prev=this.model.lessons.at(this.model.lessons.indexOf(this.lessonView.model)-1),this.next=this.model.lessons.at(this.model.lessons.indexOf(this.lessonView.model)+1),this.lessonView.on("lessonIsCompleteMayHaveChanged",this.render,this),(r=this.next)!=null&&r.on("change:isAccessible",this.render,this),this.render()},o.prototype.onPreviousClick=function(){var e;return this.ui.prevButton.addClass("disabled"),e=1+this.model.lessons.indexOf(this.prev),i.trigger("navigate:lesson",e)},o.prototype.onNextClick=function(){var e;return this.ui.nextButton.addClass("disabled"),e=1+this.model.lessons.indexOf(this.next),i.trigger("navigate:lesson",e)},o.prototype._fetchCurrentUser=function(){return(new s.User).fetch({self:!0})},o.prototype._onCourseEnd=function(e){return _.each(["courseEnd","player:course:completed"],function(t){return i.trigger("parent:notify",{event:t,user:_.pick(e,"email","id")})}),this.ui.finishButton.removeClass("disabled")},o.prototype.onFinishClick=function(){if(this.ui.finishButton.hasClass("disabled"))return;return this.ui.finishButton.addClass("disabled"),this.model.complete().then(this._fetchCurrentUser).then(this._onCourseEnd)},o.prototype.previousAvailable=function(){return this.prev!=null&&(this.prev.get("isAccessible")||this._isEditable)},o.prototype.nextAvailable=function(){return this.next!=null&&(this.next.get("isAccessible")||this._isEditable)},o.prototype.isComplete=function(){var e;return!this.next&&((e=this.lessonView)!=null?e.isComplete():void 0)},o.prototype.buttonIf=function(e,t,n,r){if(e)return"<a class='nav-button "+t+" pull-"+r+"'>\n  <i class='icon-caret-"+r+" pull-"+r+"'></i>\n  <span class='nav-button-text'>"+n+"</span>\n</a>"},o.prototype.templateHelpers=function(){return{previousAvailable:this.previousAvailable,nextAvailable:this.nextAvailable,isComplete:this.isComplete,buttonIf:this.buttonIf}},o}(t.CompositeView)})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/course",["cdn.marionette","text!templates/course.html","views/lesson","views/loading","app/mediator","messages/player_tracker","views/nav_buttons"],function(t,r,i,s,o,u,a){var f,l;return f=function(t){function f(){return this._refetchSections=e(this._refetchSections,this),this.onClick=e(this.onClick,this),l=f.__super__.constructor.apply(this,arguments),l}return n(f,t),f.prototype.initialize=function(){return this.listenTo(this.model.lessons,"add",this.onLessonsAdd,this),this.listenTo(this.model.lessons,"select",this.onLessonSelected,this),o.on("tray:gadgetUpdated",this.rerenderLesson,this),o.on("blocking:changed",this._onBlockingChanged,this),o.on("plugin:populate:updateBar",this._onPopulateUpdateBar,this),this._isEditable=this.model.get("isEditable")},f.prototype.onClose=function(){return o.off("tray:gadgetUpdated",this.rerenderLesson,this),o.off("blocking:changed",this._onBlockingChanged,this),o.off("plugin:populate:updateBar",this._onPopulateUpdateBar,this),o.off("course:save:error",this.showSaveErrorMsg,this),o.off("course:save:success",this.hideSaveErrorMsg,this)},f.prototype.ui={saveErrorMsg:".saveErrorMsg"},f.prototype.regions={updateNotificationContainer:".js-update-notification-container",lessonRegion:".js-lessons",loadingRegion:".js-loading",nav:".js-nav"},f.prototype.template=_.template(r),f.prototype.className=function(){return this._isEditable?"course editable":"course"},f.prototype.getLessonView=function(e){return this.children.findByModel(e)},f.prototype.activeLessonIndex=function(){return this.model.lessons.indexOf(this._activeLesson)},f.prototype.activateLesson=function(e){var t,n=this;return(t=this.model.lessons.findWhere({isActive:true}))!=null&&t.set({isActive:!1}),e.set({isActive:!0}),this.loadingLesson&&this.loadingLesson.abort(),this.renderingLesson=$.Deferred(),this.model.lessons.indexOf(e)===-1||e===this._activeLesson?(this.renderingLesson.resolve(),!1):(this.loadingLesson=e.fetch(),u.timeXHR(this.loadingLesson,"fetch-lesson",{lessonId:e.id}),this._activeLesson&&(this._loadingView=new s,this.loadingRegion.show(this._loadingView)),this.loadingLesson.done(function(){return n.displayLesson(e)}))},f.prototype.displayLesson=function(e){var t,n,r,s,u=this;return t=this._activeLesson,this._activeLesson=e,this._loadingView&&this._loadingView.hide(function(){return u.loadingRegion.close()}),n=this.activeLessonIndex()+1,this.model.progress.get("lessonIndex")!==n&&(r=this.renderingLesson)!=null&&r.done(function(){return u.model.progress.save({lessonIndex:n})}),(s=this._lessonView)!=null&&s.close(),this._lessonView=new i({model:this._activeLesson,palette:this.model.palette,isEditable:this._isEditable,assetUrlTemplate:this.model.get("assetUrlTemplate")}),this.lessonRegion.show(this._lessonView),$(".js-main-container").scrollTop(0),this.renderingLesson&&this.renderingLesson.resolve(),o.trigger("lesson:rendered",this._lessonView),t&&o.trigger("lesson:closed",t),o.trigger("lesson:opened",this._activeLesson)},f.prototype.addNewLesson=function(e){var t;return t=e||this.activeLessonIndex()+1,this.model.lessons.create({},{at:t}),this.displayLesson(this.model.lessons.at(t))},f.prototype.startEditing=function(e){if(!this._isEditable)return;return e.toggleEdit(!0),e.$el.parent().addClass("editing"),this._lessonView.showHoverables(!1)},f.prototype.onLessonSelected=function(e){return this.activateLesson(e)},f.prototype.onRender=function(){return this._rendered=!0,this.el.className=this.className(),this.activateLesson(this._activeLesson||this.model.lessons.first()),this.navView=new a({model:this.model}),this.nav.show(this.navView),o.on("course:save:error",this.showSaveErrorMsg,this),o.on("course:save:success",this.hideSaveErrorMsg,this)},f.prototype._onPopulateUpdateBar=function(e){return this.updateNotificationContainer.show(e),$(window).on("click",this.onClick)},f.prototype.onShow=function(){return o.trigger("player:course:ready")},f.prototype.onClick=function(e){if(!this.isModalOpen())return o.trigger("course:click",e)},f.prototype.isModalOpen=function(){return!!$(".modal").length},f.prototype.showLesson=function(e){var t;if(t=this.model.lessons.at(e-1))return this.activateLesson(t)},f.prototype.showGadget=function(e,t){var n=this;return this.showLesson(e),this.renderingLesson.done(function(){return n._lessonView.showGadget(t)})},f.prototype.showSaveErrorMsg=function(){if(!this.saveErrorShowing&&!!this._isEditable)return this.ui.saveErrorMsg.slideDown(50),this.saveErrorShowing=!0},f.prototype.hideSaveErrorMsg=function(){if(this.saveErrorShowing)return this.saveErrorShowing=!1,this.ui.saveErrorMsg.slideUp(50)},f.prototype._onBlockingChanged=function(){return setTimeout(this._refetchSections,100)},f.prototype._refetchSections=function(){var e,t=this;return e=this.model.fetch({data:{depth:"sections"},success:function(){return t._activeLesson.set({isActive:!0}),t.navView.updateButtons(t._lessonView)}}),u.timeXHR(e,"fetch-sections",{courseId:this.model.id})},f.prototype.rerenderLesson=function(){return this.displayLesson(this._activeLesson)},f}(t.Layout)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("plugins/marionette.filter",["cdn.marionette"],function(e){var n,r;return n=function(e){function n(){return r=n.__super__.constructor.apply(this,arguments),r}return t(n,e),n.prototype._match=function(e){var t,n,r;r=this.filters;for(t in r){n=r[t];if(n instanceof RegExp){if(!e.get(t).match(n))return!1}else if(e.get(t)!==n)return!1}return!0},n.prototype.addItemView=function(e){return this._match(e)?n.__super__.addItemView.apply(this,arguments):!1},n.prototype.removeItemView=function(e){return this._match(e)?n.__super__.removeItemView.apply(this,arguments):!1},n}(e.CompositeView)})}.call(this),define("text!templates/sidebar/lesson.html",[],function(){return'<div class="js-handle drag-handle">\n  <i class="icon-reorder"></i>\n</div>\n<div class="js-delete delete-button">\n  <i class="icon-remove"></i>\n</div>\n<div class="js-edit edit-button">\n  <i class="icon-pencil"></i>\n</div>\n<div class="sidebar-lesson-title js-sidebar-lesson-title" title="<%- title %>"><%- title %></div>\n<div class="sidebar-lesson-sections js-sidebar-lesson-sections"></div>\n\n<i class="icon-lock" title="This lesson is locked by one or more quizzes"></i>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/sidebar/lesson",["cdn.marionette","app/mediator","plugins/marionette.filter","text!templates/sidebar/lesson.html","libs/vs.ui"],function(t,r,i,s,o){var u,a,f,l;return a=function(t){function r(){return this.template=e(this.template,this),f=r.__super__.constructor.apply(this,arguments),f}return n(r,t),r.prototype.initialize=function(){return this.listenTo(this.model.config,"change",this.render)},r.prototype.tagName="div",r.prototype.className="sidebar-section-title js-sidebar-section-title",r.prototype.attributes=function(){return{"data-index":this.model.collection.indexOf(this.model)}},r.prototype.template=function(){return _.escape($.trim(this.model.config.get("content")))},r}(t.ItemView),u=function(t){function i(){return this.onTitleChange=e(this.onTitleChange,this),this.toggleEdit=e(this.toggleEdit,this),this.onSectionClick=e(this.onSectionClick,this),l=i.__super__.constructor.apply(this,arguments),l}return n(i,t),i.prototype.template=_.template(s),i.prototype.itemView=a,i.prototype.itemViewContainer=".js-sidebar-lesson-sections",i.prototype.events={"click .js-sidebar-lesson-title":"onTitleClick","mousedown .js-delete":"onDeleteClick","click .js-edit":"onEditClick","click .js-sidebar-section-title":"onSectionClick"},i.prototype.ui={lessonTitle:".js-sidebar-lesson-title"},i.prototype.initialize=function(e){return this.isEditable=e.isEditable,this.editing=!1,this.collection=this.model.gadgets,this.filters={type:/^versal\/header/},this.listenTo(this.model,"change",this.render),this.listenTo(this.collection,"sort",this.render)},i.prototype.className=function(){var e;return e="sidebar-lesson",this.isDisabled()&&(e+=" disabled"),this.model.isNew()&&(e+=" pending"),this.model.get("isActive")&&(e+=" active"),e},i.prototype.onTitleClick=function(){var e;if(this.editing)return;if(this.isDisabled())return;return e=1+this.model.collection.indexOf(this.model),r.trigger("navigate:lesson",e)},i.prototype.onSectionClick=function(e){var t,n;if(this.isDisabled())return;return n=1+this.model.collection.indexOf(this.model),t=1+$(e.target).data("index"),r.trigger("navigate:gadget",n,t)},i.prototype.attributes=function(){return{"data-cid":this.model.cid}},i.prototype.onDeleteClick=function(){if(this.isDisabled())return;if(confirm("Are you sure you want to delete this lesson?"))return this.model.destroy()},i.prototype.isDisabled=function(){return!this.model.get("isAccessible")&&!this.isEditable},i.prototype.onRender=function(){var e;if(this.isDisabled())return;return(e=this.editable)!=null&&e.destroy(),this.editable=new o.EditableText({type:"input",el:this.ui.lessonTitle,success:this.onTitleChange,complete:this.toggleEdit}),this.$el.attr("class",_.result(this,"className"))},i.prototype.onEditClick=function(e){return this.toggleEdit(),e.preventDefault(),e.stopPropagation()},i.prototype.toggleEdit=function(){return this.editing=!this.editing,this.$el.toggleClass("editing",this.editing),this.editable.toggleEdit(this.editing)},i.prototype.onTitleChange=function(e){return this.model.save({title:e})},i.prototype.appendHtml=function(e,t,n){var r;return r=this.getItemViewContainer(e),n>=r.children().length?r.append(t.el):r.children().eq(n).before(t.el)},i}(i)})}.call(this),define("text!templates/sidebar/sidebar.html",[],function(){return'<div class="sidebar-body js-scroll-container">\n  <div class="course-title js-fixed-pane js-course-title">\n    <i class="icon-toggle-options js-toggle-options"></i>\n    <i class="icon-pencil js-edit-course-title"></i>\n    <div class="main-title js-title-content"><%- title %></div>\n    <% if(isAuthor) { %>\n      <div class="options-dropdown js-options-dropdown">\n        <ul class="options">\n          <li><b>view as learner</b></li>\n          <li><a target="_blank" href="<%- site %>/c/<%- id %>/learn">this revision</a></li>\n          <% if(isPublished) { %>\n            <li><a target="_blank" href="<%- site %>/c/<%- id %>/learn?revision=true">published course</a></li>\n          <% } %>\n        </ul>\n      </div>\n    <% } %>\n  </div>\n\n  <div class="js-sidebar-lessons-container"></div>\n\n  <% if (isAuthor) { %>\n    <div class="sidebar-lesson">\n      <a href="#" class="js-add-lesson add-lesson">Add a lesson</a>\n    </div>\n  <% } %>\n</div>\n\n<% if (isAuthor) { %>\n  <div class="sidebar-footer fix-bottom js-fixed-pane">\n    <span class="last-saved js-last-saved">seconds</span>\n    <div class="contributors-container js-contributors"></div>\n  </div>\n<% } %>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/sidebar/sidebar",["cdn.underscore","cdn.marionette","libs/vs.ui","./lesson","text!templates/sidebar/sidebar.html","app/mediator","models/settings"],function(t,r,i,s,o,u,a){var f,l;return f=function(r){function f(){return this.templateHelpers=e(this.templateHelpers,this),l=f.__super__.constructor.apply(this,arguments),l}return n(f,r),f.prototype.className="sidebar",f.prototype.template=t.template(o),f.prototype.itemView=s,f.prototype.itemViewContainer=".js-sidebar-lessons-container",f.prototype.events={"click .js-title-content":"_onTitleClick"},f.prototype.ui={fixedPanes:".js-fixed-pane",scrollContainer:".js-scroll-container",courseTitle:".js-course-title"},f.prototype.itemViewOptions=function(){return{isEditable:this._isEditable}},f.prototype.initialize=function(){return this.collection=this.model.lessons,u.on("toc:toggle",this._onTocToggle,this),this._isEditable=this.model.get("isEditable")},f.prototype.onClose=function(){return u.off("toc:toggle",this._onTocToggle,this)},f.prototype.templateHelpers=function(){return{isAuthor:!!this.author,id:this.model.id||1,site:a.get("site")}},f.prototype.onRender=function(){var e,n=this;return(e=this._scroll)!=null&&e.destroy(),t.defer(function(){return n._scroll=new i.Scroll(n.ui.scrollContainer,{horizontal:!1})})},f.prototype.fixSizing=function(){return console.warn("We don't fix sizing in javascript anymore!")},f.prototype._onTocToggle=function(){return this.$el.toggleClass("visible")},f.prototype._onTitleClick=function(){if(this._editingTitle)return;return u.trigger("parent:notify",{event:"publishCourse"})},f}(r.CompositeView)})}.call(this),function(){define("plugins/time_since",[],function(){return function(e){var t,n,r,i,s,o,u,a,f,l;t=+(new Date)-e;if(t<=3e4)n="seconds";else if(3e4<t&&t<=6e4)n="less than a minute";else{f=[["minute",6e4,36e5],["hour",36e5,864e5],["day",864e5,Infinity]];for(u=0,a=f.length;u<a;u++)l=f[u],s=l[0],i=l[1],r=l[2],i<t&&t<=r&&(o=Math.floor(t/i),n=""+o+" "+s,o>1&&(n+="s"))}return n}})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/sidebar/author",["app/mediator","cdn.underscore","./sidebar","plugins/time_since","libs/vs.ui"],function(t,r,i,s,o){var u,a;return u=function(u){function f(){return this._onTitleChange=e(this._onTitleChange,this),this._onLessonMoved=e(this._onLessonMoved,this),this._moveLesson=e(this._moveLesson,this),this._onAjaxComplete=e(this._onAjaxComplete,this),this._toggleEditTitle=e(this._toggleEditTitle,this),a=f.__super__.constructor.apply(this,arguments),a}return n(f,u),f.prototype.author=!0,f.prototype.className="sidebar author-sidebar",f.prototype.events=r.extend({},i.prototype.events,{"click .js-add-lesson":"_onAddLessonClick","click .js-toggle-options":"_onOptionToggleClick","click .js-edit-course-title":"_onEditTitleClick"}),f.prototype.ui=r.extend({},i.prototype.ui,{lessons:".js-sidebar-lessons-container",titleContent:".js-title-content",lastSavedTime:".js-last-saved",optionsDropdown:".js-options-dropdown",contributors:".js-contributors"}),f.prototype.initialize=function(){var e=this;return this.lastSavedTime=+(new Date),$(document).ajaxComplete(this._onAjaxComplete),setInterval(function(){return e.updateSavedLabel()},1e4),this.editing=!1,t.on("course:click",this._onCourseClick,this),t.on("plugin:populate:contributorsRegion",this._onPopulateContributors,this),this.listenTo(this.model.lessons,"remove",this._onLessonsRemove,this),this._ensureLesson(),this.contribRegion=new Marionette.Region({el:this.ui.contributors}),f.__super__.initialize.apply(this,arguments)},f.prototype.onClose=function(){return t.off("course:click",this._onCourseClick,this),t.off("plugin:populate:contributorsRegion",this._onPopulateContributors,this),this.contribRegion.close()},f.prototype._onEditTitleClick=function(){return this._toggleEditTitle()},f.prototype._toggleEditTitle=function(){return this._editingTitle=!this._editingTitle,this.editable.toggleEdit(this._editingTitle)},f.prototype._onAjaxComplete=function(){return this.lastSavedTime=+(new Date),this.updateSavedLabel()},f.prototype.updateSavedLabel=function(){var e;return typeof (e=this.ui.lastSavedTime).html=="function"?e.html(s(this.lastSavedTime)):void 0},f.prototype.onRender=function(){return f.__super__.onRender.apply(this,arguments),this.ui.lessons.sortable({handle:".js-handle",axis:"y",containment:".author-sidebar",tolerance:"pointer"}),this.ui.lessons.on("sortupdate",this._moveLesson),this.editable=new o.EditableText({type:"input",el:this.ui.titleContent,success:this._onTitleChange,complete:this._toggleEditTitle,maxlength:60}),this._optionsVisible=!1},f.prototype.onShow=function(){return t.trigger("player:authorSideBar:ready")},f.prototype._onPopulateContributors=function(e){return this.contribRegion.show(e),this.listenTo(e,"toggleCollapse",this._toggleCollapse,this)},f.prototype._toggleCollapse=function(){return t.trigger("contrib:collapse")},f.prototype._moveLesson=function(e,t){var n;return n=this.model.lessons.get(t.item.data("cid")),this.model.lessons.move(n,t.item.index(),{success:this._onLessonMoved})},f.prototype._ensureLesson=function(e){return this.model.lessons.length===0?this.model.lessons.create({},{success:e}):typeof e=="function"?e():void 0},f.prototype._onLessonMoved=function(){var e,n;return e=this.model.lessons.findWhere({isActive:!0}),n=this.model.lessons.indexOf(e)+1,t.trigger("navigate:lesson",n,{trigger:!1})},f.prototype._onOptionToggleClick=function(){return this.ui.courseTitle.toggleClass("options-expanded")},f.prototype._onAddLessonClick=function(){var e=this;return this.model.lessons.create({},{success:function(){return t.trigger("navigate:lesson",e.model.lessons.length)}})},f.prototype._onTitleChange=function(e){return this.model.save({title:e})},f.prototype._onCourseClick=function(e){if(this._optionsVisible&&!$(e.target).closest(".js-options-dropdown").length)return this._toggleOptions()},f.prototype._onLessonsRemove=function(e,n,r){var i=this;return t.trigger("lesson:deleted",e),this._ensureLesson(function(){var t;if(e.get("isActive"))return t=Math.min(r.index,n.length-1),i.model.lessons.trigger("select",i.model.lessons.at(t))})},f.prototype.serializeData=function(){return r.extend(this.model.toJSON(),{isPublished:this.model.isPublished()})},f}(i)})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/sidebar/learner",["./sidebar"],function(e){var n,r;return n=function(e){function n(){return r=n.__super__.constructor.apply(this,arguments),r}return t(n,e),n.prototype.className="sidebar learner-sidebar",n}(e)})}.call(this),define("text!templates/tray/tray.html",[],function(){return'<div class="tray-gadgets-scroller js-tray-gadgets-scroller">\n  <div class="prev-arrow js-scroll-prev">\n    <i class="icon-caret-left"></i>\n  </div>\n\n  <div class="js-tray-gadgets tray-gadgets"></div>\n\n  <div class="next-arrow js-scroll-next">\n    <i class="icon-caret-right"></i>\n  </div>\n</div>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/modal",["cdn.marionette"],function(t){var r,i;return r=function(t){function r(){return this._onKeyDown=e(this._onKeyDown,this),i=r.__super__.constructor.apply(this,arguments),i}return n(r,t),r.prototype.onClose=function(){return $(document).off("keydown",this._onKeyDown),this.remove()},r.prototype._onBackdropClick=function(){return this.close()},r.prototype._onModalClick=function(e){return e.stopPropagation()},r.prototype._onCloseModalClick=function(){return this.close()},r.prototype._onKeyDown=function(e){if(e.keyCode===27)return this.close()},r.prototype.onRender=function(){return $(document).on("keydown",this._onKeyDown)},r.prototype._prevent=function(e){return e.stopPropagation(),e.preventDefault()},r.prototype.events={click:"_onModalClick","click .js-close":"_onCloseModalClick","click .modal-backdrop":"_onBackdropClick"},r}(t.ItemView)})}.call(this),define("text!templates/tray/version_modal.html",[],function(){return'<div class="gadget-version-modal modal">\n  <div class="js-instructions instructions">\n    <%- prompt %>\n  </div>\n  <div class="gadget-info">\n    <div class="icon" style="background-image: url(<%- icon %>)"></div>\n    <div class="title"><%- title %></div>\n    <div class="author"><%- author %></div>\n    <div class="version">\n      <%- fromVersion %> &#8594; <%- toVersion %>\n    </div>\n  </div>\n  <div class="js-error-text error-text">Gadget <%- operation %> failed, please check your connection and try again</div>\n  <div class="js-button-controls button-controls">\n    <button class="version-change-cancel js-close">maybe later</button>\n    <button class="version-change-ok js-ok action">\n      <span class="js-okay-text"><%- operation %></span>\n      <div class="js-spinner spinner"></div>\n    </button>\n  </div>\n  <div class="js-done-controls button-controls done-controls">\n    <button class="js-done js-close action">okay</button>\n  </div>\n</div>\n<div class="js-modal-backdrop modal-backdrop"></div>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/tray/version_modal",["views/modal","text!templates/tray/version_modal.html","app/mediator"],function(t,r,i){var s,o;return s=function(t){function s(){return this.templateHelpers=e(this.templateHelpers,this),this.onVersionChangeFailed=e(this.onVersionChangeFailed,this),this.onVersionChangeSuccess=e(this.onVersionChangeSuccess,this),o=s.__super__.constructor.apply(this,arguments),o}return n(s,t),s.prototype.template=_.template(r),s.prototype.events=_.extend({},s.prototype.events,{"click .js-ok":"onVersionChangeClick","click .js-modal-backdrop":"close"}),s.prototype.ui={confirmButton:".js-ok",okayText:".js-okay-text",spinner:".js-spinner",controls:".js-button-controls",doneControls:".js-done-controls",instructions:".js-instructions",errorText:".js-error-text"},s.prototype.initialize=function(){return this.upgrading=!this.options.toVersion,this.toVersion=this.options.toVersion||this.options.model.get("latestVersion"),this.fromVersion=this.options.model.get("version")},s.prototype.onVersionChangeClick=function(){return this.showLoading(),this.options.palette.changeVersion(this.options.model.type().split("@")[0],this.toVersion).done(this.onVersionChangeSuccess).fail(this.onVersionChangeFailed)},s.prototype.showLoading=function(){return this.indicator||(this.indicator=new vs.ui.LoadingIndicator(this.ui.spinner,"#fff")),this.ui.okayText.addClass("invisible"),this.ui.errorText.hide()},s.prototype.showDone=function(){var e;return this.ui.spinner.hide(),this.ui.okayText.removeClass("invisible"),this.ui.controls.hide(),e=this.upgrading?"updated":"reverted",this.ui.instructions.text("All instances of this gadget have been "+e),this.ui.doneControls.show()},s.prototype.onVersionChangeSuccess=function(){return this.showDone(),i.trigger("tray:gadgetUpdated",this.options.model)},s.prototype.onVersionChangeFailed=function(){return this.ui.okayText.text("try again").removeClass("invisible"),this.ui.errorText.show(),this.ui.spinner.hide()},s.prototype.serializeData=function(){return _.extend({icon:this.options.model.icon()},this.options.model.toJSON())},s.prototype.templateHelpers=function(){return{operation:this.upgrading?"upgrade":"revert",fromVersion:this.fromVersion,toVersion:this.toVersion,prompt:this.upgrading?"Upgrade each instance of this gadget in the current course":"Revert each instance of this gadget back to its previous version"}},s}(t)})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/tray/tray",["cdn.marionette","./item","text!templates/tray/tray.html","app/mediator","./version_modal"],function(t,r,i,s,o){var u,a;return u=function(t){function u(){return this.selectCatalog=e(this.selectCatalog,this),this.itemViewOptions=e(this.itemViewOptions,this),a=u.__super__.constructor.apply(this,arguments),a}return n(u,t),u.prototype.template=_.template(i),u.prototype.className="tray",u.prototype.ui={gadgetList:".js-tray-gadgets",gadgetScroller:".js-tray-gadgets-scroller"},u.prototype.events={"click .js-scroll-next":"scrollNext","click .js-scroll-prev":"scrollPrev"},u.prototype.initialize=function(e){return this.catalogs=e.catalogs,this.model=e.model,this.gadgetsPerRow=10,this.palette=this.model.palette,this.storePaletteHistory(),this.palette.on("sync",this.render,this),this.collection=new Backbone.Collection,this.on("itemview:upgrade",this.onGadgetUpgradeRequest,this),this.on("itemview:revert",this.onGadgetRevertRequest,this),this.listenTo(s,"lesson:deleted gadget:deleted",this.onFragmentRemove),this.listenTo(s,"tray:catalog:changed",this.selectCatalog),this.listenTo(this,"composite:collection:rendered",this._onCollectionRendered)},u.prototype.itemViewContainer=".js-tray-gadgets",u.prototype.itemView=r,u.prototype.getModelType=function(e){return e.type().split("@")[0]},u.prototype.onBeforeItemAdded=function(e){var t;t=this.palette.findByType(this.getModelType(e.model));if(t)return e.model.set(t.toJSON(),{silent:!0})},u.prototype.itemViewOptions=function(e){var t=this;return{revertable:function(){var n;return n=t.paletteHistory[t.getModelType(e)],n?n!==e.get("latestVersion"):!1}}},u.prototype.storePaletteHistory=function(){var e,t,n=this;return e=this.palette.map(function(e){return n.getModelType(e)}),t=this.palette.pluck("version"),this.paletteHistory=_.object(e,t)},u.prototype.onRender=function(){return this.scrollIndex==null&&(this.scrollIndex=0),this._updatePageArrows()},u.prototype.selectCatalog=function(e){return this.scrollIndex=0,this.collection=this.catalogs[e],this.render()},u.prototype._onCollectionRendered=function(){var e=this;this.icons=this.ui.gadgetList.children();if(this.icons.length>0)return _.defer(function(){var t;return t=e.icons.first().offset().left,e.icons.each(function(e){return $(this).data("leftPos",$(this).offset().left-t)}),e.scrollToChild(e.scrollIndex,!1)})},u.prototype.scrollToChild=function(e,t){var n,r;return t==null&&(t=!0),r=e-e%this.gadgetsPerRow,n=this.icons.eq(r).data("leftPos"),t?this.ui.gadgetScroller.animate({scrollLeft:n}):this.ui.gadgetScroller.scrollLeft(n),this._updatePageArrows()},u.prototype._updatePageArrows=function(){return this.ui.gadgetScroller.toggleClass("first-page",this.scrollIndex===0),this.ui.gadgetScroller.toggleClass("last-page",this.scrollIndex+this.gadgetsPerRow>=this.icons.length)},u.prototype.scrollNext=function(){return this.scrollIndex=Math.min(this.icons.length-1,this.scrollIndex+this.gadgetsPerRow),this.scrollToChild(this.scrollIndex)},u.prototype.scrollPrev=function(){return this.scrollIndex=Math.max(0,this.scrollIndex-this.gadgetsPerRow),this.scrollToChild(this.scrollIndex)},u.prototype.appendHtml=function(e,t){var n,r;n=_.compact((r=this.model)!=null?r.authors.map(function(e){return e.get("username")}):void 0);if(t.model.get("hidden")&&!_.contains(n,t.model.get("username")))return;return u.__super__.appendHtml.apply(this,arguments),setTimeout(function(){return $(window).trigger("resize")},200)},u.prototype.showVersionModal=function(e,t){var n;return n=new o({model:e,palette:this.palette,toVersion:t}),n.render(),$("body").append(n.$el)},u.prototype.onGadgetUpgradeRequest=function(e){return this.showVersionModal(this.palette.findByType(this.getModelType(e.model)))},u.prototype.onGadgetRevertRequest=function(e){var t;return t=this.paletteHistory[this.getModelType(e.model)],this.showVersionModal(e.model,t)},u.prototype.onFragmentRemove=function(e){return this._pendingRemove&&this.stopListening(this._pendingRemove,"sync"),this._pendingRemove=e,this.listenToOnce(e,"sync",this.onRemoveComplete)},u.prototype.onRemoveComplete=function(){return this.palette.fetch()},u}(t.CompositeView)})}.call(this),define("text!templates/tray/tray_filters.html",[],function(){return'<% catalogs.forEach(function(cat){ %>\n  <a class="tray-filter js-choose-catalog js-catalog-label" data-catalog="<%- cat %>"><%- cat %></a>\n<% }) %>\n\n<a class="tray-filter js-tray-toggle tray-toggle">\n  <i class="tray-toggle-expand icon-double-angle-up"></i>\n  <i class="tray-toggle-collapse icon-double-angle-down"></i>\n</a>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/tray/tray_filters",["cdn.marionette","text!templates/tray/tray_filters.html","app/mediator"],function(t,r,i){var s,o;return s=function(t){function s(){return this._activeCatalogs=e(this._activeCatalogs,this),this._onCatalogClick=e(this._onCatalogClick,this),this._showSelectedCatalog=e(this._showSelectedCatalog,this),this.templateHelpers=e(this.templateHelpers,this),o=s.__super__.constructor.apply(this,arguments),o}return n(s,t),s.prototype.template=_.template(r),s.prototype.className="tray-filters",s.prototype.ui={labels:".js-catalog-label"},s.prototype.events={"click .js-choose-catalog":"_onCatalogClick","click .js-tray-toggle":"_onTrayToggleClick"},s.prototype.templateHelpers=function(){return{catalogs:_.keys(this.catalogs)}},s.prototype.initialize=function(e){return this.catalogs=e.catalogs,this.listenTo(this.catalogs.all,"sync",this._updateLabels),this.listenTo(this.catalogs.course,"add remove",this._updateLabels),this.listenTo(i,"tray:gadget:dragstart",this._onTrayGadgetDragStart),this.listenTo(i,"gadget:editing:start",this._onGadgetEditingStart),this.listenTo(i,"gadget:editing:stop",this._onGadgetEditingStop)},s.prototype.onRender=function(){return this._updateLabels()},s.prototype.selectCatalog=function(e){return this._activeCatalog=e,this._showSelectedCatalog(this._activeCatalog),this._setExpanded(!0),localStorage.versalTrayExpanded=!0,i.trigger("tray:catalog:changed",this._activeCatalog)},s.prototype._showSelectedCatalog=function(e){this.ui.labels.removeClass("active");if(e)return this.$("[data-catalog="+e+"]").addClass("active")},s.prototype._onCatalogClick=function(e){var t;return t=$(e.target).data("catalog"),this._activeCatalog?this._expanded?this.selectCatalog(t):this._setExpanded(!0):this.selectCatalog(t)},s.prototype._onTrayGadgetDragStart=function(){if(!this._usedOpenButtonToExpand)return this._setExpanded(!1)},s.prototype._activeCatalogs=function(){return _.compact(_.map(this.catalogs,function(e,t){if(e!=null?e.length:void 0)return t}))},s.prototype._updateLabels=function(){var e=this;return this.ui.labels.each(function(t,n){return $(n).toggleClass("hidden",!_.contains(e._activeCatalogs(),$(n).data("catalog")))})},s.prototype._onTrayToggleClick=function(){return this._activeCatalog?this._setExpanded(!this._expanded):this.selectCatalog("all"),this._usedOpenButtonToExpand=!0,localStorage.versalTrayExpanded=this._expanded},s.prototype._setExpanded=function(e){if(e===this._expanded)return;return e?this._showSelectedCatalog(this._activeCatalog):this._showSelectedCatalog(null),this._expanded=e,this._usedOpenButtonToExpand=!1,i.trigger("tray:expanded",this._expanded)},s.prototype._onGadgetEditingStart=function(){return this._setExpanded(!1)},s.prototype._onGadgetEditingStop=function(){var e;return e=localStorage.versalTrayExpanded,this._setExpanded(e==="true"||e===void 0)},s}(t.ItemView)})}.call(this),define("text!templates/header.html",[],function(){return'<i class="toc-icon js-toggle-toc icon-reorder"></i>\n<span class="course-title"><%- title %></span>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/header",["cdn.marionette","text!templates/header.html","app/mediator"],function(e,n,r){var i,s;return i=function(e){function i(){return s=i.__super__.constructor.apply(this,arguments),s}return t(i,e),i.prototype.template=_.template(n),i.prototype.className="player-header",i.prototype.events={"click .js-toggle-toc":"onToggleClick"},i.prototype.initialize=function(){return this.listenTo(this.model,"change",this.render)},i.prototype.onToggleClick=function(e){return e.stopPropagation(),r.trigger("toc:toggle")},i}(e.ItemView)})}.call(this),function(){define("plugins/vs-sticky",["cdn.underscore","cdn.jquery"],function(e,t){var n,r;return r=["","-webkit-","-moz-","-ms-","-o-"],n=function(){function n(n){this.el=n,this.refresh=e.throttle(this.refresh.bind(this),10),this._current=null,this._stickyContainer=t('<div class="vs-sticky-container" />'),this.enable()}return n.prototype.selector=".js-sticky-header",n.prototype.enable=function(){return t(this.el).on("scroll",this.refresh)},n.prototype.disable=function(){return t(this.el).off("scroll",this.refresh)},n.prototype.refresh=function(){var t,n,r,i,s;return r=this.el.getBoundingClientRect().top,t=this.el.querySelectorAll(this.selector),t.length?(s=e.reduce(t,e.partial(this.findCurrent,r),null),n=s.current,i=s.next,this._sticky!==n&&this.setStickyHeader(n),this.adjustCurrent(r,n,i)):this.setStickyHeader(null)},n.prototype.findCurrent=function(e,t,n){return t==null&&(t={current:null,next:null}),t.next||(n.getBoundingClientRect().top<=e&&(t.current=n),t.current!==n&&(t.next=n)),t},n.prototype.setStickyHeader=function(n){var r;return this._sticky&&t(this._sticky).css("visibility","visible"),this._sticky=n,n?(r=window.getComputedStyle(n),this._stickyContainer.text(n.textContent).css(e.pick(r,"color","fontSize","fontFamily","fontWeight","fontVariant")).appendTo(this.el),t(this._sticky).css("visibility","hidden")):this._stickyContainer.detach()},n.prototype.adjustCurrent=function(n,i,s){var o,u,a;if(!i)return;return u=((s!=null?s.getBoundingClientRect().top:void 0)||this.el.getBoundingClientRect().bottom)-n,o=u-i.getBoundingClientRect().height,a=o<=0?"translateY("+o+"px)":"none",t(this._stickyContainer).css(e.object(e.map(r,function(e){return[""+e+"transform",a]})))},n}()})}.call(this),!function(){for(var e=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=(new Date).getTime(),r=Math.max(0,16-(n-e)),i=window.setTimeout(function(){t(n+r)},r);return e=n+r,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(e){function t(e,t){return function(){e.apply(t,arguments)}}function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function r(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(e,t(s,this),t(o,this))}function i(e){var t=this;return null===this._state?void this._deferreds.push(e):void l(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return void (t._state?e.resolve:e.reject)(t._value);var r;try{r=n(t._value)}catch(i){return void e.reject(i)}e.resolve(r)})}function s(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void f(t(n,e),t(s,this),t(o,this))}this._state=!0,this._value=e,u.call(this)}catch(r){o.call(this,r)}}function o(e){this._state=!1,this._value=e,u.call(this)}function u(){for(var e=0,t=this._deferreds.length;t>e;e++)i.call(this,this._deferreds[e]);this._deferreds=null}function a(e,t,n,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r}function f(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(i){if(r)return;r=!0,n(i)}}"undefined"!=typeof module&&module.exports?module.exports=e.Promise?e.Promise:r:e.Promise||(e.Promise=r);var l=function(){function t(){var e=n;r=void 0,n=[];for(var t=0,i=e.length;i>t;t++)e[t]()}var n,r,i;return e.process&&"function"===process.nextTick?process.nextTick:e.MutationObserver?(n=[],i=document.createElement("div"),(new MutationObserver(t)).observe(i,{attributes:!0}),function(e){n.length||i.setAttribute("yes","no"),n.push(e)}):e.setImmediate?e.setImmediate:(n=[],function(e){n.push(e),r||(r=setTimeout(t,0))})}();r.prototype["catch"]=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var n=this;return new r(function(r,s){i.call(n,new a(e,t,r,s))})},r.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&n(arguments[0])?arguments[0]:arguments);return new r(function(t,n){function r(s,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var u=o.then;if("function"==typeof u)return void u.call(o,function(e){r(s,e)},n)}e[s]=o,0===--i&&t(e)}catch(a){n(a)}}if(0===e.length)return t([]);for(var i=e.length,s=0;s<e.length;s++)r(s,e[s])})},r.resolve=function(e){return new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){for(var r=0,i=e.length;i>r;r++)e[r].then(t,n)})}}(this),function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n;try{n=document.createEvent("CustomEvent"),n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail)}catch(r){n=document.createEvent("Event");for(var i in t)n[i]=t[i];n.initEvent(e,t.bubbles,t.cancelable)}return n}"undefined"!=typeof window.CustomEvent&&(e.prototype=window.CustomEvent.prototype),window.CustomEvent=e}(),"undefined"==typeof WeakMap&&!function(){var e=Object.defineProperty,t=Date.now()%1e9,n=function(){this.name="__st"+(1e9*Math.random()>>>0)+(t++ +"__")};n.prototype={set:function(t,n){var r=t[this.name];r&&r[0]===t?r[1]=n:e(t,this.name,{value:[t,n],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){this.set(e,void 0)}},window.WeakMap=n}(),function(e){function t(e){w.push(e),b||(b=!0,m(r))}function n(e){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(e)||e}function r(){b=!1;var e=w;w=[],e.sort(function(e,t){return e.uid_-t.uid_});var t=!1;e.forEach(function(e){var n=e.takeRecords();i(e),n.length&&(e.callback_(n,e),t=!0)}),t&&r()}function i(e){e.nodes_.forEach(function(t){var n=v.get(t);n&&n.forEach(function(t){t.observer===e&&t.removeTransientObservers()})})}function s(e,t){for(var n=e;n;n=n.parentNode){var r=v.get(n);if(r)for(var i=0;i<r.length;i++){var s=r[i],o=s.options;if(n===e||o.subtree){var u=t(o);u&&s.enqueue(u)}}}}function o(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++E}function u(e,t){this.type=e,this.target=t,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function a(e){var t=new u(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t}function f(e,t){return S=new u(e,t)}function l(e){return x?x:(x=a(S),x.oldValue=e,x)}function c(){S=x=void 0}function h(e){return e===x||e===S}function p(e,t){return e===t?e:x&&h(e)?x:null}function d(e,t,n){this.observer=e,this.target=t,this.options=n,this.transientObservedNodes=[]}var v=new WeakMap,m=window.msSetImmediate;if(!m){var g=[],y=String(Math.random());window.addEventListener("message",function(e){if(e.data===y){var t=g;g=[],t.forEach(function(e){e()})}}),m=function(e){g.push(e),window.postMessage(y,"*")}}var b=!1,w=[],E=0;o.prototype={observe:function(e,t){if(e=n(e),!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=v.get(e);r||v.set(e,r=[]);for(var i,s=0;s<r.length;s++)if(r[s].observer===this){i=r[s],i.removeListeners(),i.options=t;break}i||(i=new d(this,e,t),r.push(i),this.nodes_.push(e)),i.addListeners()},disconnect:function(){this.nodes_.forEach(function(e){for(var t=v.get(e),n=0;n<t.length;n++){var r=t[n];if(r.observer===this){r.removeListeners(),t.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}};var S,x;d.prototype={enqueue:function(e){var n=this.observer.records_,r=n.length;if(n.length>0){var i=n[r-1],s=p(i,e);if(s)return void (n[r-1]=s)}else t(this.observer);n[r]=e},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(e){var t=this.options;t.attributes&&e.addEventListener("DOMAttrModified",this,!0),t.characterData&&e.addEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.addEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(e){var t=this.options;t.attributes&&e.removeEventListener("DOMAttrModified",this,!0),t.characterData&&e.removeEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.removeEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(e){if(e!==this.target){this.addListeners_(e),this.transientObservedNodes.push(e);var t=v.get(e);t||v.set(e,t=[]),t.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=v.get(e),n=0;n<t.length;n++)if(t[n]===this){t.splice(n,1);break}},this)},handleEvent:function(e){switch(e.stopImmediatePropagation(),e.type){case"DOMAttrModified":var t=e.attrName,n=e.relatedNode.namespaceURI,r=e.target,i=new f("attributes",r);i.attributeName=t,i.attributeNamespace=n;var o=e.attrChange===MutationEvent.ADDITION?null:e.prevValue;s(r,function(e){return!e.attributes||e.attributeFilter&&e.attributeFilter.length&&-1===e.attributeFilter.indexOf(t)&&-1===e.attributeFilter.indexOf(n)?void 0:e.attributeOldValue?l(o):i});break;case"DOMCharacterDataModified":var r=e.target,i=f("characterData",r),o=e.prevValue;s(r,function(e){return e.characterData?e.characterDataOldValue?l(o):i:void 0});break;case"DOMNodeRemoved":this.addTransientObserver(e.target);case"DOMNodeInserted":var u,a,r=e.relatedNode,h=e.target;"DOMNodeInserted"===e.type?(u=[h],a=[]):(u=[],a=[h]);var p=h.previousSibling,d=h.nextSibling,i=f("childList",r);i.addedNodes=u,i.removedNodes=a,i.previousSibling=p,i.nextSibling=d,s(r,function(e){return e.childList?i:void 0})}c()}},e.JsMutationObserver=o,e.MutationObserver||(e.MutationObserver=o)}(this),window.CustomElements=window.CustomElements||{flags:{}},function(e){function t(e,n,r){var i=e.firstElementChild;if(!i)for(i=e.firstChild;i&&i.nodeType!==Node.ELEMENT_NODE;)i=i.nextSibling;for(;i;)n(i,r)!==!0&&t(i,n,r),i=i.nextElementSibling;return null}function n(e,t){for(var n=e.shadowRoot;n;)r(n,t),n=n.olderShadowRoot}function r(e,r){t(e,function(e){return r(e)?!0:void n(e,r)}),n(e,r)}function i(e){return u(e)?(a(e),!0):void c(e)}function s(e){r(e,function(e){return i(e)?!0:void 0})}function o(e){return i(e)||s(e)}function u(t){if(!t.__upgraded__&&t.nodeType===Node.ELEMENT_NODE){var n=t.getAttribute("is")||t.localName,r=e.registry[n];if(r)return C.dom&&console.group("upgrade:",t.localName),e.upgrade(t),C.dom&&console.groupEnd(),!0}}function a(e){c(e),g(e)&&r(e,function(e){c(e)})}function f(e){if(O.push(e),!A){A=!0;var t=window.Platform&&window.Platform.endOfMicrotask||setTimeout;t(l)}}function l(){A=!1;for(var e,t=O,n=0,r=t.length;r>n&&(e=t[n]);n++)e();O=[]}function c(e){L?f(function(){h(e)}):h(e)}function h(e){(e.attachedCallback||e.detachedCallback||e.__upgraded__&&C.dom)&&(C.dom&&console.group("inserted:",e.localName),g(e)&&(e.__inserted=(e.__inserted||0)+1,e.__inserted<1&&(e.__inserted=1),e.__inserted>1?C.dom&&console.warn("inserted:",e.localName,"insert/remove count:",e.__inserted):e.attachedCallback&&(C.dom&&console.log("inserted:",e.localName),e.attachedCallback())),C.dom&&console.groupEnd())}function p(e){d(e),r(e,function(e){d(e)})}function d(e){L?f(function(){v(e)}):v(e)}function v(e){(e.attachedCallback||e.detachedCallback||e.__upgraded__&&C.dom)&&(C.dom&&console.group("removed:",e.localName),g(e)||(e.__inserted=(e.__inserted||0)-1,e.__inserted>0&&(e.__inserted=0),e.__inserted<0?C.dom&&console.warn("removed:",e.localName,"insert/remove count:",e.__inserted):e.detachedCallback&&e.detachedCallback()),C.dom&&console.groupEnd())}function m(e){return window.ShadowDOMPolyfill?ShadowDOMPolyfill.wrapIfNeeded(e):e}function g(e){for(var t=e,n=m(document);t;){if(t==n)return!0;t=t.parentNode||t.host}}function y(e){if(e.shadowRoot&&!e.shadowRoot.__watched){C.dom&&console.log("watching shadow-root for: ",e.localName);for(var t=e.shadowRoot;t;)b(t),t=t.olderShadowRoot}}function b(e){e.__watched||(S(e),e.__watched=!0)}function w(e){if(C.dom){var t=e[0];if(t&&"childList"===t.type&&t.addedNodes&&t.addedNodes){for(var n=t.addedNodes[0];n&&n!==document&&!n.host;)n=n.parentNode;var r=n&&(n.URL||n._URL||n.host&&n.host.localName)||"";r=r.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",e.length,r||"")}e.forEach(function(e){"childList"===e.type&&(_(e.addedNodes,function(e){e.localName&&o(e)}),_(e.removedNodes,function(e){e.localName&&p(e)}))}),C.dom&&console.groupEnd()}function E(){w(M.takeRecords()),l()}function S(e){M.observe(e,{childList:!0,subtree:!0})}function x(e){S(e)}function T(e){C.dom&&console.group("upgradeDocument: ",e.baseURI.split("/").pop()),o(e),C.dom&&console.groupEnd()}function N(e){e=m(e);for(var t,n=e.querySelectorAll("link[rel="+k+"]"),r=0,i=n.length;i>r&&(t=n[r]);r++)t.import&&t.import.__parsed&&N(t.import);T(e)}var C=window.logFlags||{},k=window.HTMLImports?HTMLImports.IMPORT_LINK_TYPE:"none",L=!window.MutationObserver||window.MutationObserver===window.JsMutationObserver;e.hasPolyfillMutations=L;var A=!1,O=[],M=new MutationObserver(w),_=Array.prototype.forEach.call.bind(Array.prototype.forEach);e.IMPORT_LINK_TYPE=k,e.watchShadow=y,e.upgradeDocumentTree=N,e.upgradeAll=o,e.upgradeSubtree=s,e.insertedNode=a,e.observeDocument=x,e.upgradeDocument=T,e.takeRecords=E}(window.CustomElements),function(e){function t(t,o){var u=o||{};if(!t)throw new Error("document.registerElement: first argument `name` must not be empty");if(t.indexOf("-")<0)throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+String(t)+"'.");if(n(t))throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+String(t)+"'. The type name is invalid.");if(p(t))throw new Error("DuplicateDefinitionError: a type with name '"+String(t)+"' is already registered");if(!u.prototype)throw new Error("Options missing required prototype property");return u.__name=t.toLowerCase(),u.lifecycle=u.lifecycle||{},u.ancestry=r(u.extends),i(u),s(u),c(u.prototype),d(u.__name,u),u.ctor=v(u),u.ctor.prototype=u.prototype,u.prototype.constructor=u.ctor,e.ready&&e.upgradeDocumentTree(document),u.ctor}function n(e){for(var t=0;t<T.length;t++)if(e===T[t])return!0}function r(e){var t=p(e);return t?r(t.extends).concat([t]):[]}function i(e){for(var t,n=e.extends,r=0;t=e.ancestry[r];r++)n=t.is&&t.tag;e.tag=n||e.__name,n&&(e.is=e.__name)}function s(e){if(!Object.__proto__){var t=HTMLElement.prototype;if(e.is){var n=document.createElement(e.tag),r=Object.getPrototypeOf(n);r===e.prototype&&(t=r)}for(var i,s=e.prototype;s&&s!==t;)i=Object.getPrototypeOf(s),s.__proto__=i,s=i;e.native=t}}function o(e){return u(k(e.tag),e)}function u(t,n){return n.is&&t.setAttribute("is",n.is),t.removeAttribute("unresolved"),a(t,n),t.__upgraded__=!0,l(t),e.insertedNode(t),e.upgradeSubtree(t),t}function a(e,t){Object.__proto__?e.__proto__=t.prototype:(f(e,t.prototype,t.native),e.__proto__=t.prototype)}function f(e,t,n){for(var r={},i=t;i!==n&&i!==HTMLElement.prototype;){for(var s,o=Object.getOwnPropertyNames(i),u=0;s=o[u];u++)r[s]||(Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s)),r[s]=1);i=Object.getPrototypeOf(i)}}function l(e){e.createdCallback&&e.createdCallback()}function c(e){if(!e.setAttribute._polyfilled){var t=e.setAttribute;e.setAttribute=function(e,n){h.call(this,e,n,t)};var n=e.removeAttribute;e.removeAttribute=function(e){h.call(this,e,null,n)},e.setAttribute._polyfilled=!0}}function h(e,t,n){e=e.toLowerCase();var r=this.getAttribute(e);n.apply(this,arguments);var i=this.getAttribute(e);this.attributeChangedCallback&&i!==r&&this.attributeChangedCallback(e,r,i)}function p(e){return e?N[e.toLowerCase()]:void 0}function d(e,t){N[e]=t}function v(e){return function(){return o(e)}}function m(e,t,n){return e===C?g(t,n):L(e,t)}function g(e,t){var n=p(t||e);if(n){if(e==n.tag&&t==n.is)return new n.ctor;if(!t&&!n.is)return new n.ctor}if(t){var r=g(e);return r.setAttribute("is",t),r}var r=k(e);return e.indexOf("-")>=0&&a(r,HTMLElement),r}function y(e){if(!e.__upgraded__&&e.nodeType===Node.ELEMENT_NODE){var t=e.getAttribute("is"),n=p(t||e.localName);if(n){if(t&&n.tag==e.localName)return u(e,n);if(!t&&!n.extends)return u(e,n)}}}function b(t){var n=A.call(this,t);return e.upgradeAll(n),n}e||(e=window.CustomElements={flags:{}});var w=e.flags,E=Boolean(document.registerElement),S=!w.register&&E&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||HTMLImports.useNative);if(S){var x=function(){};e.registry={},e.upgradeElement=x,e.watchShadow=x,e.upgrade=x,e.upgradeAll=x,e.upgradeSubtree=x,e.observeDocument=x,e.upgradeDocument=x,e.upgradeDocumentTree=x,e.takeRecords=x,e.reservedTagList=[]}else{var T=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],N={},C="http://www.w3.org/1999/xhtml",k=document.createElement.bind(document),L=document.createElementNS.bind(document),A=Node.prototype.cloneNode;document.registerElement=t,document.createElement=g,document.createElementNS=m,Node.prototype.cloneNode=b,e.registry=N,e.upgrade=y}var O;O=Object.__proto__||S?function(e,t){return e instanceof t}:function(e,t){for(var n=e;n;){if(n===t.prototype)return!0;n=n.__proto__}return!1},e.instanceof=O,e.reservedTagList=T,document.register=document.registerElement,e.hasNative=E,e.useNative=S}(window.CustomElements),function(e){function t(e){return"link"===e.localName&&e.getAttribute("rel")===n}var n=e.IMPORT_LINK_TYPE,r={selectors:["link[rel="+n+"]"],map:{link:"parseLink"},parse:function(e){if(!e.__parsed){e.__parsed=!0;var t=e.querySelectorAll(r.selectors);i(t,function(e){r[r.map[e.localName]](e)}),CustomElements.upgradeDocument(e),CustomElements.observeDocument(e)}},parseLink:function(e){t(e)&&this.parseImport(e)},parseImport:function(e){e.import&&r.parse(e.import)}},i=Array.prototype.forEach.call.bind(Array.prototype.forEach);e.parser=r,e.IMPORT_LINK_TYPE=n}(window.CustomElements),function(e){function t(){CustomElements.parser.parse(document),CustomElements.upgradeDocument(document);var e=window.Platform&&Platform.endOfMicrotask?Platform.endOfMicrotask:setTimeout;e(function(){CustomElements.ready=!0,CustomElements.readyTime=Date.now(),window.HTMLImports&&(CustomElements.elapsed=CustomElements.readyTime-HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0})),window.HTMLImports&&(HTMLImports.__importsParsingHook=function(e){CustomElements.parser.parse(e.import)})})}if("function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e){var t=document.createEvent("HTMLEvents");return t.initEvent(e,!0,!0),t}),"complete"===document.readyState||e.flags.eager)t();else if("interactive"!==document.readyState||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var n=window.HTMLImports&&!HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(n,t)}else t()}(window.CustomElements),function(){function e(){window.HTMLTemplateElement=function(){throw new TypeError("Illegal constructor")},HTMLTemplateElement.prototype=Object.create(HTMLElement.prototype)}function t(){var e=document.createElement("style");e.textContent="template { display: none; }",document.head.appendChild(e)}function n(){HTMLTemplateElement.prototype._templateHostDocument=document.implementation.createHTMLDocument("")}function r(){Object.defineProperty(HTMLTemplateElement.prototype,"content",{get:function(){return this._contentFragment||this._createContentFragment(),this._contentFragment}}),HTMLTemplateElement.prototype._createContentFragment=function(){for(this._contentFragment=this._templateHostDocument.createDocumentFragment();this.firstChild;)this._contentFragment.appendChild(this.removeChild(this.firstChild))}}function i(e){e.htmlTemplatePolyfillApplied||(e.htmlTemplatePolyfillApplied=!0,e.__proto__=HTMLTemplateElement.prototype,e._createContentFragment())}function s(){Array.prototype.forEach.call(document.querySelectorAll("template"),i)}function o(){function e(e){Array.prototype.forEach.call(e,function(e){e.addedNodes&&Array.prototype.forEach.call(e.addedNodes,function(e){e.tagName&&"TEMPLATE"==e.tagName&&i(e)})})}(new MutationObserver(e)).observe(document,{subtree:!0,childList:!0})}window.HTMLTemplateElement&&"content"in window.HTMLTemplateElement.prototype||(t(),e(),n(),r(),s(),o())}(),window.HTMLImports=window.HTMLImports||{flags:{}},function(e){var t=(e.path,e.xhr),n=e.flags,r=function(e,t){this.cache={},this.onload=e,this.oncomplete=t,this.inflight=0,this.pending={}};r.prototype={addNodes:function(e){this.inflight+=e.length;for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)this.require(t);this.checkDone()},addNode:function(e){this.inflight++,this.require(e),this.checkDone()},require:function(e){var t=e.src||e.href;e.__nodeUrl=t,this.dedupe(t,e)||this.fetch(t,e)},dedupe:function(e,t){return this.pending[e]?(this.pending[e].push(t),!0):this.cache[e]?(this.onload(e,t,this.cache[e]),this.tail(),!0):(this.pending[e]=[t],!1)},fetch:function(e,r){if(n.load&&console.log("fetch",e,r),e.match(/^data:/)){var i=e.split(","),s=i[0],o=i[1];o=s.indexOf(";base64")>-1?atob(o):decodeURIComponent(o),setTimeout(function(){this.receive(e,r,null,o)}.bind(this),0)}else{var u=function(t,n,i){this.receive(e,r,t,n,i)}.bind(this);t.load(e,u)}},receive:function(e,t,n,r,i){this.cache[e]=r;var s=this.pending[e];i&&i!==e&&(this.cache[i]=r,s=s.concat(this.pending[i]));for(var o,u=0,a=s.length;a>u&&(o=s[u]);u++)this.onload(i||e,o,r),this.tail();this.pending[e]=null,i&&i!==e&&(this.pending[i]=null)},tail:function(){--this.inflight,this.checkDone()},checkDone:function(){this.inflight||this.oncomplete()}},t=t||{async:!0,ok:function(e){return e.status>=200&&e.status<300||304===e.status||0===e.status},load:function(n,r,i){var s=new XMLHttpRequest;return(e.flags.debug||e.flags.bust)&&(n+="?"+Math.random()),s.open("GET",n,t.async),s.addEventListener("readystatechange",function(){if(4===s.readyState){var e=s.getResponseHeader("Location"),n=null;if(e)var n="/"===e.substr(0,1)?location.origin+e:n;r.call(i,!t.ok(s)&&s,s.response||s.responseText,n)}}),s.send(),s},loadDocument:function(e,t,n){this.load(e,t,n).responseType="document"}},e.xhr=t,e.Loader=r}(window.HTMLImports),function(e){function t(e){return"link"===e.localName&&e.rel===o}function n(e){var t,n=r(e);try{t=btoa(n)}catch(i){t=btoa(unescape(encodeURIComponent(n))),console.warn("Script contained non-latin characters that were forced to latin. Some characters may be wrong.",e)}return"data:text/javascript;base64,"+t}function r(e){return e.textContent+i(e)}function i(e){var t=e.__nodeUrl;if(!t){t=e.ownerDocument.baseURI;var n="["+Math.floor(1e3*(Math.random()+1))+"]",r=e.textContent.match(/Polymer\(['"]([^'"]*)/);n=r&&r[1]||n,t+="/"+n+".js"}return"\n//# sourceURL="+t+"\n"}function s(e){var t=e.ownerDocument.createElement("style");return t.textContent=e.textContent,p.resolveUrlsInStyle(t),t}var o="import",u=e.flags,a=/Trident/.test(navigator.userAgent),f=window.ShadowDOMPolyfill?window.ShadowDOMPolyfill.wrapIfNeeded(document):document,l={documentSelectors:"link[rel="+o+"]",importsSelectors:["link[rel="+o+"]","link[rel=stylesheet]","style","script:not([type])",'script[type="text/javascript"]'].join(","),map:{link:"parseLink",script:"parseScript",style:"parseStyle"},parseNext:function(){var e=this.nextToParse();e&&this.parse(e)},parse:function(e){if(this.isParsed(e))return void (u.parse&&console.log("[%s] is already parsed",e.localName));var t=this[this.map[e.localName]];t&&(this.markParsing(e),t.call(this,e))},markParsing:function(e){u.parse&&console.log("parsing",e),this.parsingElement=e},markParsingComplete:function(e){e.__importParsed=!0,e.__importElement&&(e.__importElement.__importParsed=!0),this.parsingElement=null,u.parse&&console.log("completed",e)},invalidateParse:function(e){e&&e.__importLink&&(e.__importParsed=e.__importLink.__importParsed=!1,this.parseSoon())},parseSoon:function(){this._parseSoon&&cancelAnimationFrame(this._parseDelay);var e=this;this._parseSoon=requestAnimationFrame(function(){e.parseNext()})},parseImport:function(e){if(HTMLImports.__importsParsingHook&&HTMLImports.__importsParsingHook(e),e.import.__importParsed=!0,this.markParsingComplete(e),e.dispatchEvent(e.__resource?new CustomEvent("load",{bubbles:!1}):new CustomEvent("error",{bubbles:!1})),e.__pending)for(var t;e.__pending.length;)t=e.__pending.shift(),t&&t({target:e});this.parseNext()},parseLink:function(e){t(e)?this.parseImport(e):(e.href=e.href,this.parseGeneric(e))},parseStyle:function(e){var t=e;e=s(e),e.__importElement=t,this.parseGeneric(e)},parseGeneric:function(e){this.trackElement(e),document.head.appendChild(e)},trackElement:function(e,t){var n=this,r=function(r){t&&t(r),n.markParsingComplete(e),n.parseNext()};if(e.addEventListener("load",r),e.addEventListener("error",r),a&&"style"===e.localName){var i=!1;if(-1==e.textContent.indexOf("@import"))i=!0;else if(e.sheet){i=!0;for(var s,o=e.sheet.cssRules,u=o?o.length:0,f=0;u>f&&(s=o[f]);f++)s.type===CSSRule.IMPORT_RULE&&(i=i&&Boolean(s.styleSheet))}i&&e.dispatchEvent(new CustomEvent("load",{bubbles:!1}))}},parseScript:function(t){var r=document.createElement("script");r.__importElement=t,r.src=t.src?t.src:n(t),e.currentScript=t,this.trackElement(r,function(){r.parentNode.removeChild(r),e.currentScript=null}),document.head.appendChild(r)},nextToParse:function(){return!this.parsingElement&&this.nextToParseInDoc(f)},nextToParseInDoc:function(e,n){for(var r,i=e.querySelectorAll(this.parseSelectorsForNode(e)),s=0,o=i.length;o>s&&(r=i[s]);s++)if(!this.isParsed(r))return this.hasResource(r)?t(r)?this.nextToParseInDoc(r.import,r):r:void 0;return n},parseSelectorsForNode:function(e){var t=e.ownerDocument||e;return t===f?this.documentSelectors:this.importsSelectors},isParsed:function(e){return e.__importParsed},hasResource:function(e){return t(e)&&!e.import?!1:!0}},c=/(url\()([^)]*)(\))/g,h=/(@import[\s]+(?!url\())([^;]*)(;)/g,p={resolveUrlsInStyle:function(e){var t=e.ownerDocument,n=t.createElement("a");return e.textContent=this.resolveUrlsInCssText(e.textContent,n),e},resolveUrlsInCssText:function(e,t){var n=this.replaceUrls(e,t,c);return n=this.replaceUrls(n,t,h)},replaceUrls:function(e,t,n){return e.replace(n,function(e,n,r,i){var s=r.replace(/["']/g,"");return t.href=s,s=t.href,n+"'"+s+"'"+i})}};e.parser=l,e.path=p,e.isIE=a}(HTMLImports),function(e){function t(e){return n(e,m)}function n(e,t){return"link"===e.localName&&e.getAttribute("rel")===t}function r(e,t){var n=e;n instanceof Document||(n=document.implementation.createHTMLDocument(m)),n._URL=t;var r=n.createElement("base");r.setAttribute("href",t),n.baseURI||(n.baseURI=t);var i=n.createElement("meta");return i.setAttribute("charset","utf-8"),n.head.appendChild(i),n.head.appendChild(r),e instanceof Document||(n.body.innerHTML=e),window.HTMLTemplateElement&&HTMLTemplateElement.bootstrap&&HTMLTemplateElement.bootstrap(n),n}function i(e,t){t=t||g,o(function(){u(e,t)},t)}function s(e){return"complete"===e.readyState||e.readyState===T}function o(e,t){if(s(t))e&&e();else{var n=function(){("complete"===t.readyState||t.readyState===T)&&(t.removeEventListener(N,n),o(e,t))};t.addEventListener(N,n)}}function u(e,t){function n(){s==o&&e&&e()}function r(){s++,n()}var i=t.querySelectorAll("link[rel=import]"),s=0,o=i.length;if(o)for(var u,f=0;o>f&&(u=i[f]);f++)a(u)?r.call(u):(u.addEventListener("load",r),u.addEventListener("error",r));else n()}function a(e){return d?e.import&&"loading"!==e.import.readyState||e.__loaded:e.__importParsed}function f(e){for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)l(t)&&c(t)}function l(e){return"link"===e.localName&&"import"===e.rel}function c(e){var t=e.import;t?h({target:e}):(e.addEventListener("load",h),e.addEventListener("error",h))}function h(e){e.target.__loaded=!0}var p="import"in document.createElement("link"),d=p,v=e.flags,m="import",g=window.ShadowDOMPolyfill?ShadowDOMPolyfill.wrapIfNeeded(document):document;if(d)var y={};else var b=(e.xhr,e.Loader),w=e.parser,y={documents:{},documentPreloadSelectors:"link[rel="+m+"]",importsPreloadSelectors:["link[rel="+m+"]"].join(","),loadNode:function(e){E.addNode(e)},loadSubtree:function(e){var t=this.marshalNodes(e);E.addNodes(t)},marshalNodes:function(e){return e.querySelectorAll(this.loadSelectorsForNode(e))},loadSelectorsForNode:function(e){var t=e.ownerDocument||e;return t===g?this.documentPreloadSelectors:this.importsPreloadSelectors},loaded:function(e,n,i){if(v.load&&console.log("loaded",e,n),n.__resource=i,t(n)){var s=this.documents[e];s||(s=r(i,e),s.__importLink=n,this.bootDocument(s),this.documents[e]=s),n.import=s}w.parseNext()},bootDocument:function(e){this.loadSubtree(e),this.observe(e),w.parseNext()},loadedAll:function(){w.parseNext()}},E=new b(y.loaded.bind(y),y.loadedAll.bind(y));var S={get:function(){return HTMLImports.currentScript||document.currentScript},configurable:!0};if(Object.defineProperty(document,"_currentScript",S),Object.defineProperty(g,"_currentScript",S),!document.baseURI){var x={get:function(){return window.location.href},configurable:!0};Object.defineProperty(document,"baseURI",x),Object.defineProperty(g,"baseURI",x)}var T=HTMLImports.isIE?"complete":"interactive",N="readystatechange";d&&(new MutationObserver(function(e){for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)t.addedNodes&&f(t.addedNodes)})).observe(document.head,{childList:!0}),e.hasNative=p,e.useNative=d,e.importer=y,e.IMPORT_LINK_TYPE=m,e.isImportLoaded=a,e.importLoader=E,e.whenReady=i,e.whenImportsReady=i}(window.HTMLImports),function(e){function t(e){for(var t,r=0,i=e.length;i>r&&(t=e[r]);r++)"childList"===t.type&&t.addedNodes.length&&n(t.addedNodes)}function n(e){for(var t,i,o=0,u=e.length;u>o&&(i=e[o]);o++)t=t||i.ownerDocument,r(i)&&s.loadNode(i),i.children&&i.children.length&&n(i.children)}function r(e){return 1===e.nodeType&&o.call(e,s.loadSelectorsForNode(e))}function i(e){u.observe(e,{childList:!0,subtree:!0})}var s=(e.IMPORT_LINK_TYPE,e.importer),o=(e.parser,HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector),u=new MutationObserver(t);e.observe=i,s.observe=i}(HTMLImports),function(){function e(){HTMLImports.importer.bootDocument(t)}"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,t){var n=document.createEvent("HTMLEvents");return n.initEvent(e,t.bubbles===!1?!1:!0,t.cancelable===!1?!1:!0,t.detail),n});var t=window.ShadowDOMPolyfill?window.ShadowDOMPolyfill.wrapIfNeeded(document):document;HTMLImports.whenImportsReady(function(){HTMLImports.ready=!0,HTMLImports.readyTime=(new Date).getTime(),t.dispatchEvent(new CustomEvent("HTMLImportsLoaded",{bubbles:!0}))}),HTMLImports.useNative||("complete"===document.readyState||"interactive"===document.readyState&&!window.attachEvent?e():document.addEventListener("DOMContentLoaded",e))}(),define("bower_components/versal-component-runtime/dist/runtime.min",function(){}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};define("plugins/vs-element-seeing-observer",["cdn.jquery","cdn.underscore","app/mediator","bower_components/versal-component-runtime/dist/runtime.min"],function(t,n,r){var i;return i=function(){function t(t){this.el=t,this._viewportChanged=e(this._viewportChanged,this);if(!this.el)return;this._debouncedViewportChanged=n.debounce(this._viewportChanged,this._delay),r.on("player:viewportChanged",this._debouncedViewportChanged)}return t.prototype._viewportBottomOffset=28,t.prototype._delay=150,t.prototype.destroy=function(){return r.off("player:viewportChanged",this._debouncedViewportChanged)},t.prototype._viewportChanged=function(){var e,t=this;return e=this.el.querySelectorAll(".gadget"),n.each(e,function(e){var n;if(e.hasAttribute("element-was-seen"))return;n=t._isInViewport(e,innerHeight);if(n)return e.dispatchEvent(new CustomEvent("elementWasSeen")),e.setAttribute("element-was-seen",1)})},t.prototype._isInViewport=function(e,t){var n,r;return n=t+10,r=e.getBoundingClientRect(),r.bottom<n},t}()})}.call(this),define("text!templates/layout.html",[],function(){return'<div>\n  <header class="header-container js-header-container"></header>\n\n  <aside class="sidebar-container js-sidebar-container"></aside>\n\n  <div class="main-container js-main-container">\n    <div class="course-container js-course-container"></div>\n  </div>\n\n  <div class="tray-container js-tray-container"></div>\n  <footer class="footer-container js-footer-container"></footer>\n\n  <div class="dialogs"></div>\n  <div class="loading-container js-loading-container"></div>\n</div>\n'}),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("views/player_layout",["cdn.marionette","app/mediator","plugins/vs-sticky","plugins/vs-element-seeing-observer","text!templates/layout.html"],function(e,n,r,i,s){var o,u;return o=function(e){function o(){return u=o.__super__.constructor.apply(this,arguments),u}return t(o,e),o.prototype.template=s,o.prototype.regions={header:".js-header-container",sidebar:".js-sidebar-container",dialogs:".dialogs",courseContainer:".js-course-container",tray:".js-tray-container",footer:".js-footer-container",loading:".js-loading-container"},o.prototype.ui={mainContainer:".js-main-container"},o.prototype.events={click:"onClick","click .js-sidebar-container":"onSidebarClick"},o.prototype.initialize=function(){return this.listenTo(n,"tray:expanded",function(e){return this.$el.toggleClass("tray-expanded",e)}),this.listenTo(n,"toc:toggle",this.toggleSidebar),this.listenTo(n,"gadget:dragstart",function(){return this.$el.addClass("drag-in-progress")}),this.listenTo(n,"gadget:dragend",function(){return this.$el.removeClass("drag-in-progress")}),this.listenTo(n,"gadget:editing:start",function(){return this.$el.addClass("edit-in-progress")}),this.listenTo(n,"gadget:editing:stop",function(){return this.$el.removeClass("edit-in-progress")}),this.listenTo(n,"course:collab:open",function(){return this.$el.addClass("collab-connected")}),this.listenTo(n,"course:collab:close",function(){return this.$el.removeClass("collab-connected")}),this.listenTo(n,"contrib:collapse",function(){return this.$el.toggleClass("collab-contrib-collapsed")})},o.prototype.onRender=function(){var e,t;try{t=new r(this.ui.mainContainer.get(0)),this.listenTo(n,"lesson:closed",t!=null?t.refresh.bind(t):void 0)}catch(s){e=s,console.warn("Sticky headers:",e)}return new i(this.ui.mainContainer.get(0))},o.prototype.onClick=function(){return this.toggleSidebar(!1)},o.prototype.onSidebarClick=function(e){return e.stopPropagation()},o.prototype.toggleSidebar=function(e){return this.$el.toggleClass("sidebar-expanded",e)},o}(e.Layout)})}.call(this),function(){define("plugins/backbone.prioritize",[],function(){return function(e){return function(t,n){var r,i,s,o,u,a;return u=e.indexOf(t.get("title")),a=e.indexOf(n.get("title")),r=t.get("catalog"),i=n.get("catalog"),r==="approved"&&i==="sandbox"?-1:r==="sandbox"&&i==="approved"?1:(s=t.get("hidden"),o=n.get("hidden"),o&&!s?-1:s&&!o?1:u===a?0:0<=a&&a<u?1:a>=0&&u<0?1:-1)}}})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};define("app/combined_catalogue",["cdn.jquery","app/mediator","plugins/vs.api","plugins/backbone.prioritize"],function(e,n,r,i){var s,o,u;return o=["Section header","Header","Text","Image","Video","Wolfram","Quiz","Survey","Expression","Data viewer","References","Map","Markdown","Image annotator","Image detail","Color bar","R0","3D anatomy","Cellular automaton","Principle of superposition"],s=function(s){function a(){return u=a.__super__.constructor.apply(this,arguments),u}return t(a,s),a.prototype.initialize=function(){var t=this;return this.ready=new e.Deferred,n.on("catalog:findByType",function(e,n){var r;console.warn("mediator catalog:findByType is obsolete"),r=t.findByType(e);if(r==null)throw new Error("Unknown gadget project of type: "+e);return n(r)})},a.prototype.fetchAll=function(t){var n,s=this;return t==null&&(t={}),n=i(o),this.approved=new r.GadgetProjects([],{comparator:n}),this.sandbox=new r.GadgetProjects,e.when(this.approved.fetchApproved(),this.sandbox.fetchSandbox()).then(function(){var e;return e=function(e,t){return s.add(t.models.map(function(t){return t.get("catalog")||t.set({catalog:e}),t}))},e("approved",s.approved),e("sandbox",s.sandbox),s.trigger("reset"),s.trigger("sync"),s.ready.resolve()})},a}(r.GadgetProjects)})}.call(this),define("text!templates/asset_picker/asset_picker.html",[],function(){return'<div class="assets-modal modal">\n  <div class="header">\n    <div class="modal-title">file picker</div>\n    <div class="modal-controls">\n      <button class="cancel js-close">cancel</button>\n      <button class="action js-use-file js-upload">use file</button>\n    </div>\n    <div class="clearfix"></div>\n  </div>\n  <div class="content">\n    <div class="preview-region">\n      <div class="uploading-overlay">\n        <div class="uploading-spinner"></div>\n      </div>\n\n      <div class="choose-overlay">\n        <div class="drop-image"></div>\n        <div class="drop-blurb">\n          drag file here\n          <span class="click-blurb">or click to upload</span>\n        </div>\n        <div class="dropzone"></div>\n      </div>\n\n      <input class="hidden-uploader" type="file">\n      <div class="file-preview"></div>\n\n    </div>\n    <div class="status-message"></div>\n    <% if (getType() == "video") { %>\n      <input class="video-link" placeholder="or paste YouTube or Vimeo link" />\n    <% } %>\n  </div>\n</div>\n<div class="modal-backdrop"></div>\n'}),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define("views/asset_picker/asset_picker",["app/mediator","plugins/vs.api","libs/vs.ui","messages/player_tracker","cdn.marionette","text!templates/asset_picker/asset_picker.html","views/modal"],function(t,r,i,s,o,u,a){var f,l;return f=function(t){function o(){return this.onUploadError=e(this.onUploadError,this),this.onAssetRefetchError=e(this.onAssetRefetchError,this),this.onAssetRefetch=e(this.onAssetRefetch,this),this.onUploadSuccess=e(this.onUploadSuccess,this),this.onDrop=e(this.onDrop,this),this.templateHelpers=e(this.templateHelpers,this),l=o.__super__.constructor.apply(this,arguments),l}return n(o,t),o.prototype.template=_.template(u),o.prototype.templateHelpers=function(){var e=this;return{getType:function(){return e.type}}},o.prototype.initialize=function(e){this.options=e,$(window).on("dragenter dragexit dragover dragleave drop",this._prevent),this.type=this.options.type;if(!this.type)throw new Error("Asset type is required");return this.formats=this.type==="image"?["jpg","jpeg","png","gif"]:this.type==="video"?["mp4","ogg","webm","avi","mov"]:void 0},o.prototype.ui={preview:".preview-region",filePreview:".file-preview",uploading:".uploading-overlay",choose:".choose-overlay",status:".status-message",useButton:".js-use-file",spinner:".uploading-spinner",hiddenUploader:".hidden-uploader",videoInput:".video-link"},o.prototype.events=_.extend({},o.prototype.events,{"click .choose-overlay":"onChooseClick","dragenter .dropzone":"onOverlayDragEnter","dragleave .dropzone":"onOverlayDragLeave","dragenter .preview-region":"onRegionDragEnter","dragexit .dropzone":"_prevent","dragover .dropzone":"_prevent","drop .dropzone":"onDrop","click .js-use-file":"onUseClick","input .video-link":"onVideoInputChange","paste .video-link":"onVideoInputChange"}),o.prototype.onOverlayDragEnter=function(e){return this.ui.choose.addClass("dragenter"),e.preventDefault()},o.prototype.onOverlayDragLeave=function(e){return this.ui.choose.removeClass("dragenter fromRegion"),this.hasFile&&this.ui.choose.hide(),e.preventDefault()},o.prototype.onRegionDragEnter=function(e){if(!this.hasFile)return;return this.ui.choose.addClass("dragenter fromRegion"),this.ui.choose.show(),e.preventDefault()},o.prototype.onDrop=function(e){var t,n;t=e.originalEvent,t.stopPropagation(),t.preventDefault();if(t.dataTransfer.files.length)return this.onChooseComplete((n=t.dataTransfer.files)!=null?n[0]:void 0)},o.prototype.showStatus=function(e,t){return t==null&&(t=!1),this.ui.status.toggleClass("error",t),this.ui.status.text(e)},o.prototype.showPreviewError=function(e){return this.ui.filePreview.text(e)},o.prototype.showUploading=function(){return this.ui.choose.hide(),this.ui.uploading.show(),this.indicator||(this.indicator=new i.LoadingIndicator(this.ui.spinner,"#fff")),this.showStatus("uploading...")},o.prototype.showChoose=function(){return this.ui.uploading.hide(),this.ui.choose.show(),this.showStatus("Accepted file types: "+this.formats.join(", ")),this.hasFile=!1},o.prototype.showFilePreview=function(e){var t,n=this;return t=e.size/1048576,t>5?this.showPreviewError("File too large to preview"):typeof FileReader!="undefined"&&FileReader!==null?(this.fr=new FileReader,this.fr.onload=function(t){return n.onPreviewLoaded.call(n,t,e)},this.fr.readAsDataURL(e)):this.showPreviewError("No preview available")},o.prototype.onPreviewLoaded=function(e,t){var n;if(t.type.split("/")[0]!==this.type)return this.showPreviewError("No preview available");if(this.type==="image")return this.ui.filePreview.html($("<img>").attr("src",e.target.result));if(this.type==="video")return n=$("<video>")[0],!n.canPlayType||!n.canPlayType(t.type).replace(/no/,"")?this.showPreviewError("No preview available"):this.ui.filePreview.html("<video preload='metadata' controls='controls'>\n  <source src='"+e.target.result+"'>\n</video>")},o.prototype.onUploadSuccess=function(e){var t,n,r;return this.ui.uploading.hide(),t=_.partial(_.omit,_,"location"),n=_.map(e.representations.toJSON(),t),this.assetJSON=_.extend(e.toJSON(),{representations:n}),this.showStatus("processing..."),typeof (r=this.options).processing=="function"&&r.processing(),this.checkProcessingStatus(e)},o.prototype.checkProcessingStatus=function(e){return e.fetch({success:this.onAssetRefetch,error:this.onAssetRefetchError})},o.prototype.onAssetRefetch=function(e){return e.representations.findWhere({available:!1})?_.delay(this.checkProcessingStatus.bind(this),3e3,e):this.onProcessingComplete()},o.prototype.onAssetRefetchError=function(e){return this.showStatus("Server error",!0)},o.prototype.onProcessingComplete=function(e){return this.ui.useButton.prop("disabled",!1),this.showStatus("Processing complete")},o.prototype.onUploadError=function(){return this.ui.uploading.hide(),this.showStatus("Error uploading",!0)},o.prototype.onChooseClick=function(){var e=this;return this.ui.hiddenUploader.one("change",function(){var t;return e.onChooseComplete((t=e.ui.hiddenUploader[0].files)!=null?t[0]:void 0)}),this.ui.hiddenUploader.click()},o.prototype.onChooseComplete=function(e){var t,n,i,o,u;return e?(o=_.last(e.name.split(".")),_.contains(this.formats,o.toLowerCase())?(i=e.type||""+this.type+"/x-"+o,n={title:"New File",tags:[this.type],content:e,contentType:i},t=new r.Asset,u=t.save(n,{upload:!0,success:this.onUploadSuccess,error:this.onUploadError}),s.timeXHR(u,"upload-asset",{contentType:i,name:e.name}),this.showUploading(),this.ui.videoInput.css({visibility:"hidden"}),this.showFilePreview(e),this.hasFile=!0):this.showStatus("Unsupported file type chosen. Acceptable formats:          "+this.formats.join(", "),!0)):this.showStatus("No file chosen",!0)},o.prototype.onUseClick=function(){return this.options.success(this.assetJSON),this.close(),s.track("use-asset",{assetJSON:this.assetJSON})},o.prototype.close=function(){return $(window).off("dragenter dragexit dragover dragleave drop",this._prevent),o.__super__.close.apply(this,arguments)},o.prototype.onVideoInputChange=function(){var e,t,n;e=this.ui.videoInput.val();if(this.oldInput===e)return;this.oldInput=e;if(e.length===0){this.render(),this.ui.videoInput.focus();return}n=this.getYoutubeId(e),t=this.getVimeoId(e);if(n||t)this.ui.choose.hide(),this.ui.useButton.prop("disabled",!1),this.showStatus("");return n?(this.assetJSON={type:"youtube",youtube_id:n},this.ui.filePreview.html(this.getYoutubeEmbed(n))):t?(this.assetJSON={type:"vimeo",vimeo_id:t},this.ui.filePreview.html(this.getVimeoEmbed(t))):(this.showStatus("That is not a valid YouTube or Vimeo video url",!0),this.ui.useButton.prop("disabled",!0))},o.prototype.getYoutubeId=function(e){var t,n;return t=/(?:(?:https?:\/\/)?(?:[a-zA_Z]{2,3}.)?)?(?:(?:youtube\.com\/watch\?)(?:[a-z=_&]+|(?:[\w\d\-\_\=]+&amp;(?:amp;)?))*v(?:&lt;[A-Z]+&gt;)?=|youtu.be\/)([0-9a-zA-Z\-\_]+)/,(n=e.match(t))!=null?n[1]:void 0},o.prototype.getVimeoId=function(e){var t,n;return t=/(?:(?:https?:\/\/)?(?:[a-zA_Z]{2,3}.)?)?(?:vimeo\.com\/)([0-9]+)/,(n=e.match(t))!=null?n[1]:void 0},o.prototype.onRender=function(){return o.__super__.onRender.apply(this,arguments),this.ui.useButton.prop("disabled",!0),this.showChoose()},o.prototype.getEmbedCode=function(e){var t;if(e==="asset")return t=_.filter(this.get("representations"),function(e){return e.contentType.indexOf("video/")===0}),t=_.sortBy(t,function(e){return e.contentType==="video/webm"?0:1}),_.template('<video class="myVideo" preload="none" controls="controls">\n  <% _.each(videos, function(vid) { %>\n    <source src="<%= vid.location %>" type="<%= vid.contentType %>">\n  <% }) %>\n</video>',{videos:t})},o.prototype.getYoutubeEmbed=function(e){return'<iframe id="ytplayer" type="text/html" width="100%" height="100%" src="//www.youtube.com/embed/'+e+'" frameborder="0"/>'},o.prototype.getVimeoEmbed=function(e){return'<iframe src="//player.vimeo.com/video/'+e+'" width="100%" height="100%" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},o}(a)})}.call(this),function(){define("messages/handlers/asset_select",["cdn.jquery","views/asset_picker/asset_picker"],function(e,t){return function(n,r){var i,s;return i=this,s=new t(_.pick(n,"success","type","processing")),e("body").append(s.render().$el)}})}.call(this),function(){define("messages/handlers/parent_notify",[],function(){return function(e){return window.parent.postMessage(JSON.stringify(e),"*")}})}.call(this),function(){define("messages/decorate",["app/mediator","messages/handlers/asset_select","messages/handlers/parent_notify"],function(e,t,n){var r;return r={"asset:select":t,"parent:notify":n},_.each(r,function(t,n){return e.on(n,t,e)})})}.call(this),function(){define("app/legacy-gadget-dependencies",["cdn.underscore","cdn.jquery","cdn.backbone","cdn.marionette","cdn.processing","cdn.raphael","cdn.hogan","cdn.jqueryui","cdn.underscore.mixins"],function(e,t,n,r,i,s,o){return window._=e,window.$=t,window.Backbone=n,window.Marionette=r,window.Processing=i,window.Raphael=s,window.Hogan=o,null})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=function(e,t){return function(){return e.apply(t,arguments)}};define("player",["cdn.underscore","cdn.jquery","cdn.marionette","plugins/vs.api","plugins/vs.collab","views/course","views/sidebar/author","views/sidebar/learner","views/tray/tray","views/tray/tray_filters","views/header","views/player_layout","app/combined_catalogue","views/loading","app/mediator","plugins/tracker","messages/player_tracker","models/settings","libs/keen","messages/decorate","libs/modernizr","libs/vs.ui","bower_components/versal-component-runtime/dist/runtime.min","app/legacy-gadget-dependencies"],function(e,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){var E,S,x;return S=function(e){function n(){return x=n.__super__.constructor.apply(this,arguments),x}return t(n,e),n.prototype.routes={"courses/:courseId":"showCourse","courses/:courseId/lessons/:lessonIndex":"showLesson","courses/:courseId/lessons/:lessonIndex/gadgets/:gadgetIndex":"showGadget"},n}(Backbone.Router),E=function(){function t(e){this._onNavigateGadget=n(this._onNavigateGadget,this),this._onNavigateLesson=n(this._onNavigateLesson,this),this.onProgressLoad=n(this.onProgressLoad,this),this.onCourseLoad=n(this.onCourseLoad,this),this._onViewportChanged=n(this._onViewportChanged,this);var t,i,s,o=this;e&&b.set(e),this.initializeApi(),this.installWebComponents(),this._courseRendering=r.Deferred(),this._courseRendering.done(function(){return m.trigger("course:rendered",o.courseView)}),s=b.get("courseId"),(e!=null?!e.noHistory:!void 0)&&this.installHistory(s),this.installNavigation(s);if(i=b.get("container"))t=r(i),t.addClass("versal-player js-versal-player"),b.get("embed")&&t.addClass("embed-frame");this.layout=new p({el:t!=null?t.get(0):void 0}),this.layout.render(),this.loadingView=new v,this.layout.loading.show(this.loadingView),m.on("lesson:allGadgetsRendered",this._onAllGadgetsRendered,this),this.combinedCatalogue=new d,this.combinedCatalogue.fetchAll(),s&&this.loadCourse(s)}return t.prototype._installWebComponent=function(e){var t;return t=document.createElement("link"),t.rel="import",t.href=e,document.head.appendChild(t)},t.prototype.installWebComponents=function(){var e;return e=""+b.get("playerUrl")+"/bower_components/",this._installWebComponent(""+e+"versal-gadget-launchers/iframe-launcher/iframe-launcher.html"),this._installWebComponent(""+e+"versal-gadget-launchers/legacy-launcher/legacy-launcher.html")},t.prototype.installNavigation=function(e){return this.uninstallNavigation(),m.on("navigate:lesson",this._onNavigateLesson),m.on("navigate:gadget",this._onNavigateGadget)},t.prototype.uninstallNavigation=function(){this._onNavigateLesson&&m.off("navigate:lesson",this._onNavigateLesson);if(this._onNavigateGadget)return m.off("navigate:gadget",this._onNavigateGadget)},t.prototype.installHistory=function(e){return this.router=new S,this.router.on("route:showLesson",this.showLesson,this),this.router.on("route:showGadget",this.showGadget,this),e&&(this.router.courseId=e),Backbone.history.start({root:window.location.pathname})},t.prototype.close=function(){return this.uninstallNavigation(),this.router&&Backbone.history.stop(),m.off("lesson:allGadgetsRendered",this._onAllGadgetsRendered,this)},t.prototype.onClose=function(){return this.layout.ui.mainContainer.off("load resize scroll",this._onViewportChanged)},t.prototype._onViewportChanged=function(){return m.trigger("player:viewportChanged")},t.prototype.initializeApi=function(){var e=this;return s.init(b.get("api")),s.on("xhr:error",function(e,t,n){return m.trigger("course:save:error")}),s.on("xhr:success",function(e,t,n){return m.trigger("course:save:success")})},t.prototype.initializeCollab=function(){if(b.get("collabUrl"))return o.init(m,b.toJSON())},t.prototype.loadCourse=function(e){var t,n,r,i=this;return r=new s.Course({id:e}),b.get("revision")&&(t=r.url(),r.url=function(){return"/catalogs/staged"+t}),n=r.fetch({data:{depth:"sections"},silent:!0,error:this.onCourseLoadError,success:this.onCourseLoad}),y.timeXHR(n,"fetch-course",{courseId:e.toString()}),this._renderTimer=y.createTimer("render-course",{courseId:e.toString()})},t.prototype.handleException=function(e){return e instanceof s.errors.ApplicationError?console.log("app error"):e instanceof s.errors.NotFound?console.log("not found"):e instanceof s.errors.PermissionDenied?console.log("permission denied"):console.log("error")},t.prototype.onCourseLoad=function(e){var t,n,i=this;return this.course=e,this.onProgressLoad(e.progress),m.catalogue=new s.GadgetProjects(e.palette.models),this._configureTracking(),(b.get("noEditable")||b.get("embed"))&&e.set({isEditable:!1}),e.get("isEditable")&&this.initializeCollab(),this.layout.header.show(new h({model:e})),e.get("isEditable")?(t={all:this.combinedCatalogue,course:e.palette,sandbox:this.combinedCatalogue.sandbox},this.layout.sidebar.show(new a({model:e})),this.layout.tray.show(new l({model:e,catalogs:t})),this.layout.footer.show(n=new c({catalogs:t})),this.combinedCatalogue.ready.done(function(){var e;m.catalogue.add(i.combinedCatalogue.models),e=!0,localStorage.hasOwnProperty("versalTrayExpanded")&&(e=localStorage.versalTrayExpanded==="true");if(e)return n.selectCatalog("all"),n._usedOpenButtonToExpand=!0}),r(this.layout.el).addClass("editable")):this.layout.sidebar.show(new f({model:e})),this.courseView=new u({model:e}),this.layout.courseContainer.show(this.courseView),e.get("currentPosition")==null&&e.start(),this.course.on("change:title",this._notifyTitleChanged),this._courseRendering.resolve()},t.prototype.onCourseLoadError=function(e,t,n){return m.trigger("parent:notify",{event:"player:loadingError",data:{status:t.status,message:t.responseText}})},t.prototype.onProgressLoad=function(e){var t,n;e==null&&(e={}),n=e.get("lessonIndex"),t=e.get("gadgetIndex"),this.lessonIndex&&m.trigger("navigate:lesson",this.lessonIndex);if(n!=null&&this.router)return t!=null?m.trigger("navigate:gadget",n,t):m.trigger("navigate:lesson",n)},t.prototype.showLesson=function(e,t){var n=this;return this._courseRendering.done(function(){return n.courseView.showLesson(t)})},t.prototype.showGadget=function(e,t,n){var r=this;return this._courseRendering.done(function(){return r.courseView.showGadget(t,n)})},t.prototype._navigateTo=function(e){if(!this.router)return;return this.router.navigate("courses/"+this.course.id+"/"+e,{trigger:!0})},t.prototype._onAllGadgetsRendered=function(e){var t,n,r=this;this.loadingView.hide(function(){return r.layout.loading.reset()}),this._onViewportChanged();if(this._playerLoaded)return;return t={event:"player:loaded",course:this.course.pick("title","isEditable")},m.trigger("parent:notify",t),this._playerLoaded=!0,(n=this._renderTimer)!=null&&n.stop(),this.layout.ui.mainContainer.on("load resize scroll",this._onViewportChanged)},t.prototype._onNavigateLesson=function(e){this.lessonIndex=e;if(!this.course)return;return this._navigateTo("lessons/"+this.lessonIndex),this.showLesson(this.course.id,this.lessonIndex),m.trigger("parent:notify",{event:"player:navigate:lesson",data:{lessonIndex:this.lessonIndex}})},t.prototype._onNavigateGadget=function(e,t){this.lessonIndex=e;if(!this.course)return;return this._navigateTo("lessons/"+this.lessonIndex+"/gadgets/"+t),this.showGadget(this.course.id,this.lessonIndex,t),m.trigger("parent:notify",{event:"player:navigate:gadget",data:{lessonIndex:this.lessonIndex,gadgetIndex:t}})},t.prototype._configureTracking=function(){var t,n,r,i;return n=e.random(1e15,1e16).toString(32),t=b.get("courseId"),r=(i=this.course.get("currentPosition"))!=null?i.userId:void 0,g.addSessionData({interactionId:n,courseId:t,userId:r}),b.get("keen")?w.configure({projectId:b.get("keen").projectId,writeKey:b.get("keen").writeKey}):w.configure({projectId:"5347d64bd97b853f7d00002f",writeKey:"c2a6c9c3b2e88f8db4526d95f40e30c1ea110be01d4c7ddd56eeb3e16ada40b048d92c428b39c4738260974a95671b33615bb5b3e45f9b8f621ae7996638d04d69c6657c74891adb5b1b7a67a1b8e54b4bfb86e2d947bedcf7edcf7f2a46445cf4fa5cb9689edb74a5d0ab97101f0740"})},t.prototype._notifyTitleChanged=function(e){var t;return t={event:"course:title:changed",detail:e.get("title")},m.trigger("parent:notify",t)},t}()})}.call(this);